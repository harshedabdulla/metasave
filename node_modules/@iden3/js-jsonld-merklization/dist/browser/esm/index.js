import{poseidon as e}from"@iden3/js-crypto";import{InMemoryDB as t,str2Bytes as r,Merkletree as n}from"@iden3/js-merkletree";const i=Object.freeze({ERRORS:{CONTEXT_NOT_DEFINED:new Error("error: context not defined on the object"),PARSED_CONTEXT_IS_NULL:new Error("error: parsed context is null"),TERM_IS_NOT_DEFINED:new Error("error: term is not defined"),NO_ID_ATTR:new Error("error: no @id attribute is defined"),CTX_TYP_IS_EMPTY:new Error("error: ctx type is empty"),FIELD_PATH_IS_EMPTY:new Error("error: filed path is empty"),UNEXPECTED_ARR_ELEMENT:new Error("error: unexpected array elements"),INVALID_REFERENCE_TYPE:new Error("error: invalid reference type"),MULTIPLE_PARENTS_FOUND:new Error("error: multiple parents found"),PARENT_NOT_FOUND:new Error("error: parent not found"),GRAPH_NOT_FOUND:new Error("error: graph not found"),QUAD_NOT_FOUND:new Error("error: quad not found"),MT_VALUE_INCORRECT_TYPE:new Error("error: incorrect type")},DEFAULT_GRAPH_NODE_NAME:"@default",DEFAULT_GRAPH_TERM_TYPE:"DefaultGraph",QUADS_FORMAT:"application/n-quads",DIGITS_ONLY_REGEX:/^\d+$/,Q:BigInt("21888242871839275222246405745257275088548364400416034343698204186575808495617")});class o{constructor(t=e){this._hasher=t}async hash(e){return this._hasher.hash(e)}async hashBytes(e){return this._hasher.hashBytes(e)}prime(){return i.Q}}const a=new o;var s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function l(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function c(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})})),r}var u={exports:{}};u.exports=function(){var e=Math.imul,t=Math.clz32;function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r,n=0;n<t.length;n++)(r=t[n]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function u(){return u=c()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&l(i,r.prototype),i},u.apply(null,arguments)}function d(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function h(e){var t="function"==typeof Map?new Map:void 0;return h=function(e){function r(){return u(e,arguments,s(this).constructor)}if(null===e||!d(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),l(r,e)},h(e)}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}function m(e){var t=c();return function(){var r,n=s(e);if(t){var i=s(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return p(this,r)}}function y(e,t){return g(e)||v(e,t)||w(e,t)||_()}function g(e){if(Array.isArray(e))return e}function v(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}}function w(e,t){if(e){if("string"==typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=w(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}var T=function(e){var t=Math.abs,i=Math.max,s=Math.floor;function l(e,t){var r;if(n(this,l),(r=c.call(this,e)).sign=t,Object.setPrototypeOf(f(r),l.prototype),e>l.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");return r}a(l,e);var c=m(l);return o(l,[{key:"toDebugString",value:function(){var e,t=["BigInt["],r=E(this);try{for(r.s();!(e=r.n()).done;){var n=e.value;t.push((n?(n>>>0).toString(16):n)+", ")}}catch(e){r.e(e)}finally{r.f()}return t.push("]"),t.join("")}},{key:"toString",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10;if(2>e||36<e)throw new RangeError("toString() radix argument must be between 2 and 36");return 0===this.length?"0":0==(e&e-1)?l.__toStringBasePowerOfTwo(this,e):l.__toStringGeneric(this,e,!1)}},{key:"valueOf",value:function(){throw new Error("Convert JSBI instances to native numbers using `toNumber`.")}},{key:"__copy",value:function(){for(var e=new l(this.length,this.sign),t=0;t<this.length;t++)e[t]=this[t];return e}},{key:"__trim",value:function(){for(var e=this.length,t=this[e-1];0===t;)t=this[--e-1],this.pop();return 0===e&&(this.sign=!1),this}},{key:"__initializeDigits",value:function(){for(var e=0;e<this.length;e++)this[e]=0}},{key:"__clzmsd",value:function(){return l.__clz30(this.__digit(this.length-1))}},{key:"__inplaceMultiplyAdd",value:function(e,t,r){r>this.length&&(r=this.length);for(var n=32767&e,i=e>>>15,o=0,a=t,s=0;s<r;s++){var c=this.__digit(s),u=32767&c,d=c>>>15,h=l.__imul(u,n),f=l.__imul(u,i),p=l.__imul(d,n),m=a+h+o;o=m>>>30,m&=1073741823,o+=(m+=((32767&f)<<15)+((32767&p)<<15))>>>30,a=l.__imul(d,i)+(f>>>15)+(p>>>15),this.__setDigit(s,1073741823&m)}if(0!==o||0!==a)throw new Error("implementation bug")}},{key:"__inplaceAdd",value:function(e,t,r){for(var n,i=0,o=0;o<r;o++)i=(n=this.__halfDigit(t+o)+e.__halfDigit(o)+i)>>>15,this.__setHalfDigit(t+o,32767&n);return i}},{key:"__inplaceSub",value:function(e,t,r){var n=0;if(1&t){t>>=1;for(var i=this.__digit(t),o=32767&i,a=0;a<r-1>>>1;a++){var s=e.__digit(a),l=(i>>>15)-(32767&s)-n;n=1&l>>>15,this.__setDigit(t+a,(32767&l)<<15|32767&o),n=1&(o=(32767&(i=this.__digit(t+a+1)))-(s>>>15)-n)>>>15}var c=e.__digit(a),u=(i>>>15)-(32767&c)-n;if(n=1&u>>>15,this.__setDigit(t+a,(32767&u)<<15|32767&o),t+a+1>=this.length)throw new RangeError("out of bounds");0==(1&r)&&(n=1&(o=(32767&(i=this.__digit(t+a+1)))-(c>>>15)-n)>>>15,this.__setDigit(t+e.length,1073709056&i|32767&o))}else{t>>=1;for(var d=0;d<e.length-1;d++){var h=this.__digit(t+d),f=e.__digit(d),p=(32767&h)-(32767&f)-n,m=(h>>>15)-(f>>>15)-(n=1&p>>>15);n=1&m>>>15,this.__setDigit(t+d,(32767&m)<<15|32767&p)}var y=this.__digit(t+d),g=e.__digit(d),v=(32767&y)-(32767&g)-n;n=1&v>>>15;var w=0;0==(1&r)&&(n=1&(w=(y>>>15)-(g>>>15)-n)>>>15),this.__setDigit(t+d,(32767&w)<<15|32767&v)}return n}},{key:"__inplaceRightShift",value:function(e){if(0!==e){for(var t,r=this.__digit(0)>>>e,n=this.length-1,i=0;i<n;i++)t=this.__digit(i+1),this.__setDigit(i,1073741823&t<<30-e|r),r=t>>>e;this.__setDigit(n,r)}}},{key:"__digit",value:function(e){return this[e]}},{key:"__unsignedDigit",value:function(e){return this[e]>>>0}},{key:"__setDigit",value:function(e,t){this[e]=0|t}},{key:"__setDigitGrow",value:function(e,t){this[e]=0|t}},{key:"__halfDigitLength",value:function(){var e=this.length;return 32767>=this.__unsignedDigit(e-1)?2*e-1:2*e}},{key:"__halfDigit",value:function(e){return 32767&this[e>>>1]>>>15*(1&e)}},{key:"__setHalfDigit",value:function(e,t){var r=e>>>1,n=this.__digit(r),i=1&e?32767&n|t<<15:1073709056&n|32767&t;this.__setDigit(r,i)}}],[{key:"BigInt",value:function(e){var t=Number.isFinite;if("number"==typeof e){if(0===e)return l.__zero();if(l.__isOneDigitInt(e))return 0>e?l.__oneDigit(-e,!0):l.__oneDigit(e,!1);if(!t(e)||s(e)!==e)throw new RangeError("The number "+e+" cannot be converted to BigInt because it is not an integer");return l.__fromDouble(e)}if("string"==typeof e){var n=l.__fromString(e);if(null===n)throw new SyntaxError("Cannot convert "+e+" to a BigInt");return n}if("boolean"==typeof e)return!0===e?l.__oneDigit(1,!1):l.__zero();if("object"===r(e)){if(e.constructor===l)return e;var i=l.__toPrimitive(e);return l.BigInt(i)}throw new TypeError("Cannot convert "+e+" to a BigInt")}},{key:"toNumber",value:function(e){var t=e.length;if(0===t)return 0;if(1===t){var r=e.__unsignedDigit(0);return e.sign?-r:r}var n=e.__digit(t-1),i=l.__clz30(n),o=30*t-i;if(1024<o)return e.sign?-1/0:1/0;var a=o-1,s=n,c=t-1,u=i+3,d=32===u?0:s<<u;d>>>=12;var h=u-12,f=12<=u?0:s<<20+u,p=20+u;for(0<h&&0<c&&(c--,d|=(s=e.__digit(c))>>>30-h,f=s<<h+2,p=h+2);0<p&&0<c;)c--,s=e.__digit(c),f|=30<=p?s<<p-30:s>>>30-p,p-=30;var m=l.__decideRounding(e,p,c,s);if((1===m||0===m&&1==(1&f))&&0==(f=f+1>>>0)&&0!=++d>>>20&&(d=0,1023<++a))return e.sign?-1/0:1/0;var y=e.sign?-2147483648:0;return a=a+1023<<20,l.__kBitConversionInts[1]=y|a|d,l.__kBitConversionInts[0]=f,l.__kBitConversionDouble[0]}},{key:"unaryMinus",value:function(e){if(0===e.length)return e;var t=e.__copy();return t.sign=!e.sign,t}},{key:"bitwiseNot",value:function(e){return e.sign?l.__absoluteSubOne(e).__trim():l.__absoluteAddOne(e,!0)}},{key:"exponentiate",value:function(e,t){if(t.sign)throw new RangeError("Exponent must be positive");if(0===t.length)return l.__oneDigit(1,!1);if(0===e.length)return e;if(1===e.length&&1===e.__digit(0))return e.sign&&0==(1&t.__digit(0))?l.unaryMinus(e):e;if(1<t.length)throw new RangeError("BigInt too big");var r=t.__unsignedDigit(0);if(1===r)return e;if(r>=l.__kMaxLengthBits)throw new RangeError("BigInt too big");if(1===e.length&&2===e.__digit(0)){var n=1+(0|r/30),i=new l(n,e.sign&&0!=(1&r));i.__initializeDigits();var o=1<<r%30;return i.__setDigit(n-1,o),i}var a=null,s=e;for(0!=(1&r)&&(a=e),r>>=1;0!==r;r>>=1)s=l.multiply(s,s),0!=(1&r)&&(a=null===a?s:l.multiply(a,s));return a}},{key:"multiply",value:function(e,t){if(0===e.length)return e;if(0===t.length)return t;var r=e.length+t.length;30<=e.__clzmsd()+t.__clzmsd()&&r--;var n=new l(r,e.sign!==t.sign);n.__initializeDigits();for(var i=0;i<e.length;i++)l.__multiplyAccumulate(t,e.__digit(i),n,i);return n.__trim()}},{key:"divide",value:function(e,t){if(0===t.length)throw new RangeError("Division by zero");if(0>l.__absoluteCompare(e,t))return l.__zero();var r,n=e.sign!==t.sign,i=t.__unsignedDigit(0);if(1===t.length&&32767>=i){if(1===i)return n===e.sign?e:l.unaryMinus(e);r=l.__absoluteDivSmall(e,i,null)}else r=l.__absoluteDivLarge(e,t,!0,!1);return r.sign=n,r.__trim()}},{key:"remainder",value:function(e,t){if(0===t.length)throw new RangeError("Division by zero");if(0>l.__absoluteCompare(e,t))return e;var r=t.__unsignedDigit(0);if(1===t.length&&32767>=r){if(1===r)return l.__zero();var n=l.__absoluteModSmall(e,r);return 0===n?l.__zero():l.__oneDigit(n,e.sign)}var i=l.__absoluteDivLarge(e,t,!1,!0);return i.sign=e.sign,i.__trim()}},{key:"add",value:function(e,t){var r=e.sign;return r===t.sign?l.__absoluteAdd(e,t,r):0<=l.__absoluteCompare(e,t)?l.__absoluteSub(e,t,r):l.__absoluteSub(t,e,!r)}},{key:"subtract",value:function(e,t){var r=e.sign;return r===t.sign?0<=l.__absoluteCompare(e,t)?l.__absoluteSub(e,t,r):l.__absoluteSub(t,e,!r):l.__absoluteAdd(e,t,r)}},{key:"leftShift",value:function(e,t){return 0===t.length||0===e.length?e:t.sign?l.__rightShiftByAbsolute(e,t):l.__leftShiftByAbsolute(e,t)}},{key:"signedRightShift",value:function(e,t){return 0===t.length||0===e.length?e:t.sign?l.__leftShiftByAbsolute(e,t):l.__rightShiftByAbsolute(e,t)}},{key:"unsignedRightShift",value:function(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}},{key:"lessThan",value:function(e,t){return 0>l.__compareToBigInt(e,t)}},{key:"lessThanOrEqual",value:function(e,t){return 0>=l.__compareToBigInt(e,t)}},{key:"greaterThan",value:function(e,t){return 0<l.__compareToBigInt(e,t)}},{key:"greaterThanOrEqual",value:function(e,t){return 0<=l.__compareToBigInt(e,t)}},{key:"equal",value:function(e,t){if(e.sign!==t.sign)return!1;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e.__digit(r)!==t.__digit(r))return!1;return!0}},{key:"notEqual",value:function(e,t){return!l.equal(e,t)}},{key:"bitwiseAnd",value:function(e,t){if(!e.sign&&!t.sign)return l.__absoluteAnd(e,t).__trim();if(e.sign&&t.sign){var r=i(e.length,t.length)+1,n=l.__absoluteSubOne(e,r),o=l.__absoluteSubOne(t);return n=l.__absoluteOr(n,o,n),l.__absoluteAddOne(n,!0,n).__trim()}if(e.sign){var a=[t,e];e=a[0],t=a[1]}return l.__absoluteAndNot(e,l.__absoluteSubOne(t)).__trim()}},{key:"bitwiseXor",value:function(e,t){if(!e.sign&&!t.sign)return l.__absoluteXor(e,t).__trim();if(e.sign&&t.sign){var r=i(e.length,t.length),n=l.__absoluteSubOne(e,r),o=l.__absoluteSubOne(t);return l.__absoluteXor(n,o,n).__trim()}var a=i(e.length,t.length)+1;if(e.sign){var s=[t,e];e=s[0],t=s[1]}var c=l.__absoluteSubOne(t,a);return c=l.__absoluteXor(c,e,c),l.__absoluteAddOne(c,!0,c).__trim()}},{key:"bitwiseOr",value:function(e,t){var r=i(e.length,t.length);if(!e.sign&&!t.sign)return l.__absoluteOr(e,t).__trim();if(e.sign&&t.sign){var n=l.__absoluteSubOne(e,r),o=l.__absoluteSubOne(t);return n=l.__absoluteAnd(n,o,n),l.__absoluteAddOne(n,!0,n).__trim()}if(e.sign){var a=[t,e];e=a[0],t=a[1]}var s=l.__absoluteSubOne(t,r);return s=l.__absoluteAndNot(s,e,s),l.__absoluteAddOne(s,!0,s).__trim()}},{key:"asIntN",value:function(e,t){if(0===t.length)return t;if(0>(e=s(e)))throw new RangeError("Invalid value: not (convertible to) a safe integer");if(0===e)return l.__zero();if(e>=l.__kMaxLengthBits)return t;var r=0|(e+29)/30;if(t.length<r)return t;var n=t.__unsignedDigit(r-1),i=1<<(e-1)%30;if(t.length===r&&n<i)return t;if((n&i)!==i)return l.__truncateToNBits(e,t);if(!t.sign)return l.__truncateAndSubFromPowerOfTwo(e,t,!0);if(0==(n&i-1)){for(var o=r-2;0<=o;o--)if(0!==t.__digit(o))return l.__truncateAndSubFromPowerOfTwo(e,t,!1);return t.length===r&&n===i?t:l.__truncateToNBits(e,t)}return l.__truncateAndSubFromPowerOfTwo(e,t,!1)}},{key:"asUintN",value:function(e,t){if(0===t.length)return t;if(0>(e=s(e)))throw new RangeError("Invalid value: not (convertible to) a safe integer");if(0===e)return l.__zero();if(t.sign){if(e>l.__kMaxLengthBits)throw new RangeError("BigInt too big");return l.__truncateAndSubFromPowerOfTwo(e,t,!1)}if(e>=l.__kMaxLengthBits)return t;var r=0|(e+29)/30;if(t.length<r)return t;var n=e%30;if(t.length==r){if(0===n)return t;if(0==t.__digit(r-1)>>>n)return t}return l.__truncateToNBits(e,t)}},{key:"ADD",value:function(e,t){if(e=l.__toPrimitive(e),t=l.__toPrimitive(t),"string"==typeof e)return"string"!=typeof t&&(t=t.toString()),e+t;if("string"==typeof t)return e.toString()+t;if(e=l.__toNumeric(e),t=l.__toNumeric(t),l.__isBigInt(e)&&l.__isBigInt(t))return l.add(e,t);if("number"==typeof e&&"number"==typeof t)return e+t;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}},{key:"LT",value:function(e,t){return l.__compare(e,t,0)}},{key:"LE",value:function(e,t){return l.__compare(e,t,1)}},{key:"GT",value:function(e,t){return l.__compare(e,t,2)}},{key:"GE",value:function(e,t){return l.__compare(e,t,3)}},{key:"EQ",value:function(e,t){for(;;){if(l.__isBigInt(e))return l.__isBigInt(t)?l.equal(e,t):l.EQ(t,e);if("number"==typeof e){if(l.__isBigInt(t))return l.__equalToNumber(t,e);if("object"!==r(t))return e==t;t=l.__toPrimitive(t)}else if("string"==typeof e){if(l.__isBigInt(t))return null!==(e=l.__fromString(e))&&l.equal(e,t);if("object"!==r(t))return e==t;t=l.__toPrimitive(t)}else if("boolean"==typeof e){if(l.__isBigInt(t))return l.__equalToNumber(t,+e);if("object"!==r(t))return e==t;t=l.__toPrimitive(t)}else if("symbol"===r(e)){if(l.__isBigInt(t))return!1;if("object"!==r(t))return e==t;t=l.__toPrimitive(t)}else{if("object"!==r(e))return e==t;if("object"===r(t)&&t.constructor!==l)return e==t;e=l.__toPrimitive(e)}}}},{key:"NE",value:function(e,t){return!l.EQ(e,t)}},{key:"DataViewGetBigInt64",value:function(e,t){var r=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];return l.asIntN(64,l.DataViewGetBigUint64(e,t,r))}},{key:"DataViewGetBigUint64",value:function(e,t){var r=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2],n=y(r?[4,0]:[0,4],2),i=n[0],o=n[1],a=e.getUint32(t+i,r),s=e.getUint32(t+o,r),c=new l(3,!1);return c.__setDigit(0,1073741823&s),c.__setDigit(1,(268435455&a)<<2|s>>>30),c.__setDigit(2,a>>>28),c.__trim()}},{key:"DataViewSetBigInt64",value:function(e,t,r){var n=!!(3<arguments.length&&void 0!==arguments[3])&&arguments[3];l.DataViewSetBigUint64(e,t,r,n)}},{key:"DataViewSetBigUint64",value:function(e,t,r){var n=!!(3<arguments.length&&void 0!==arguments[3])&&arguments[3],i=0,o=0;if(0<(r=l.asUintN(64,r)).length&&(o=r.__digit(0),1<r.length)){var a=r.__digit(1);o|=a<<30,i=a>>>2,2<r.length&&(i|=r.__digit(2)<<28)}var s=y(n?[4,0]:[0,4],2),c=s[0],u=s[1];e.setUint32(t+c,i,n),e.setUint32(t+u,o,n)}},{key:"__zero",value:function(){return new l(0,!1)}},{key:"__oneDigit",value:function(e,t){var r=new l(1,t);return r.__setDigit(0,e),r}},{key:"__decideRounding",value:function(e,t,r,n){if(0<t)return-1;var i;if(0>t)i=-t-1;else{if(0===r)return-1;r--,n=e.__digit(r),i=29}var o=1<<i;if(0==(n&o))return-1;if(0!=(n&(o-=1)))return 1;for(;0<r;)if(r--,0!==e.__digit(r))return 1;return 0}},{key:"__fromDouble",value:function(e){l.__kBitConversionDouble[0]=e;var t,r=(2047&l.__kBitConversionInts[1]>>>20)-1023,n=1+(0|r/30),i=new l(n,0>e),o=1048575&l.__kBitConversionInts[1]|1048576,a=l.__kBitConversionInts[0],s=20,c=r%30,u=0;if(c<s){var d=s-c;u=d+32,t=o>>>d,o=o<<32-d|a>>>d,a<<=32-d}else if(c===s)u=32,t=o,o=a,a=0;else{var h=c-s;u=32-h,t=o<<h|a>>>32-h,o=a<<h,a=0}i.__setDigit(n-1,t);for(var f=n-2;0<=f;f--)0<u?(u-=30,t=o>>>2,o=o<<30|a>>>2,a<<=30):t=0,i.__setDigit(f,t);return i.__trim()}},{key:"__isWhitespace",value:function(e){return!!(13>=e&&9<=e)||(159>=e?32==e:131071>=e?160==e||5760==e:196607>=e?10>=(e&=131071)||40==e||41==e||47==e||95==e||4096==e:65279==e)}},{key:"__fromString",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=0,n=e.length,i=0;if(i===n)return l.__zero();for(var o=e.charCodeAt(i);l.__isWhitespace(o);){if(++i===n)return l.__zero();o=e.charCodeAt(i)}if(43===o){if(++i===n)return null;o=e.charCodeAt(i),r=1}else if(45===o){if(++i===n)return null;o=e.charCodeAt(i),r=-1}if(0===t){if(t=10,48===o){if(++i===n)return l.__zero();if(88===(o=e.charCodeAt(i))||120===o){if(t=16,++i===n)return null;o=e.charCodeAt(i)}else if(79===o||111===o){if(t=8,++i===n)return null;o=e.charCodeAt(i)}else if(66===o||98===o){if(t=2,++i===n)return null;o=e.charCodeAt(i)}}}else if(16===t&&48===o){if(++i===n)return l.__zero();if(88===(o=e.charCodeAt(i))||120===o){if(++i===n)return null;o=e.charCodeAt(i)}}if(0!==r&&10!==t)return null;for(;48===o;){if(++i===n)return l.__zero();o=e.charCodeAt(i)}var a=n-i,s=l.__kMaxBitsPerChar[t],c=l.__kBitsPerCharTableMultiplier-1;if(a>1073741824/s)return null;var u=new l(0|(29+(s*a+c>>>l.__kBitsPerCharTableShift))/30,!1),d=10>t?t:10,h=10<t?t-10:0;if(0==(t&t-1)){s>>=l.__kBitsPerCharTableShift;var f=[],p=[],m=!1;do{for(var y,g=0,v=0;;){if(y=void 0,o-48>>>0<d)y=o-48;else{if(!((32|o)-97>>>0<h)){m=!0;break}y=(32|o)-87}if(v+=s,g=g<<s|y,++i===n){m=!0;break}if(o=e.charCodeAt(i),30<v+s)break}f.push(g),p.push(v)}while(!m);l.__fillFromParts(u,f,p)}else{u.__initializeDigits();var w=!1,b=0;do{for(var _,E=0,T=1;;){if(_=void 0,o-48>>>0<d)_=o-48;else{if(!((32|o)-97>>>0<h)){w=!0;break}_=(32|o)-87}var x=T*t;if(1073741823<x)break;if(T=x,E=E*t+_,b++,++i===n){w=!0;break}o=e.charCodeAt(i)}var I=0|(s*b+(c=30*l.__kBitsPerCharTableMultiplier-1)>>>l.__kBitsPerCharTableShift)/30;u.__inplaceMultiplyAdd(T,E,I)}while(!w)}if(i!==n){if(!l.__isWhitespace(o))return null;for(i++;i<n;i++)if(o=e.charCodeAt(i),!l.__isWhitespace(o))return null}return u.sign=-1===r,u.__trim()}},{key:"__fillFromParts",value:function(e,t,r){for(var n=0,i=0,o=0,a=t.length-1;0<=a;a--){var s=t[a],l=r[a];i|=s<<o,30===(o+=l)?(e.__setDigit(n++,i),o=0,i=0):30<o&&(e.__setDigit(n++,1073741823&i),i=s>>>l-(o-=30))}if(0!==i){if(n>=e.length)throw new Error("implementation bug");e.__setDigit(n++,i)}for(;n<e.length;n++)e.__setDigit(n,0)}},{key:"__toStringBasePowerOfTwo",value:function(e,t){var r=e.length,n=t-1,i=n=(15&(n=(51&(n=(85&n>>>1)+(85&n))>>>2)+(51&n))>>>4)+(15&n),o=t-1,a=e.__digit(r-1),s=0|(30*r-l.__clz30(a)+i-1)/i;if(e.sign&&s++,268435456<s)throw new Error("string too long");for(var c=Array(s),u=s-1,d=0,h=0,f=0;f<r-1;f++){var p=e.__digit(f),m=(d|p<<h)&o;c[u--]=l.__kConversionChars[m];var y=i-h;for(d=p>>>y,h=30-y;h>=i;)c[u--]=l.__kConversionChars[d&o],d>>>=i,h-=i}var g=(d|a<<h)&o;for(c[u--]=l.__kConversionChars[g],d=a>>>i-h;0!==d;)c[u--]=l.__kConversionChars[d&o],d>>>=i;if(e.sign&&(c[u--]="-"),-1!==u)throw new Error("implementation bug");return c.join("")}},{key:"__toStringGeneric",value:function(e,t,r){var n=e.length;if(0===n)return"";if(1===n){var i=e.__unsignedDigit(0).toString(t);return!1===r&&e.sign&&(i="-"+i),i}var o,a,s=30*n-l.__clz30(e.__digit(n-1)),c=l.__kMaxBitsPerChar[t]-1,u=s*l.__kBitsPerCharTableMultiplier,d=1+(u=0|(u+=c-1)/c)>>1,h=l.exponentiate(l.__oneDigit(t,!1),l.__oneDigit(d,!1)),f=h.__unsignedDigit(0);if(1===h.length&&32767>=f){(o=new l(e.length,!1)).__initializeDigits();for(var p,m=0,y=2*e.length-1;0<=y;y--)p=m<<15|e.__halfDigit(y),o.__setHalfDigit(y,0|p/f),m=0|p%f;a=m.toString(t)}else{var g=l.__absoluteDivLarge(e,h,!0,!0);o=g.quotient;var v=g.remainder.__trim();a=l.__toStringGeneric(v,t,!0)}o.__trim();for(var w=l.__toStringGeneric(o,t,!0);a.length<d;)a="0"+a;return!1===r&&e.sign&&(w="-"+w),w+a}},{key:"__unequalSign",value:function(e){return e?-1:1}},{key:"__absoluteGreater",value:function(e){return e?-1:1}},{key:"__absoluteLess",value:function(e){return e?1:-1}},{key:"__compareToBigInt",value:function(e,t){var r=e.sign;if(r!==t.sign)return l.__unequalSign(r);var n=l.__absoluteCompare(e,t);return 0<n?l.__absoluteGreater(r):0>n?l.__absoluteLess(r):0}},{key:"__compareToNumber",value:function(e,r){if(l.__isOneDigitInt(r)){var n=e.sign,i=0>r;if(n!==i)return l.__unequalSign(n);if(0===e.length){if(i)throw new Error("implementation bug");return 0===r?0:-1}if(1<e.length)return l.__absoluteGreater(n);var o=t(r),a=e.__unsignedDigit(0);return a>o?l.__absoluteGreater(n):a<o?l.__absoluteLess(n):0}return l.__compareToDouble(e,r)}},{key:"__compareToDouble",value:function(e,t){if(t!=t)return t;if(t===1/0)return-1;if(t===-1/0)return 1;var r=e.sign;if(r!==0>t)return l.__unequalSign(r);if(0===t)throw new Error("implementation bug: should be handled elsewhere");if(0===e.length)return-1;l.__kBitConversionDouble[0]=t;var n=2047&l.__kBitConversionInts[1]>>>20;if(2047==n)throw new Error("implementation bug: handled elsewhere");var i=n-1023;if(0>i)return l.__absoluteGreater(r);var o=e.length,a=e.__digit(o-1),s=l.__clz30(a),c=30*o-s,u=i+1;if(c<u)return l.__absoluteLess(r);if(c>u)return l.__absoluteGreater(r);var d=1048576|1048575&l.__kBitConversionInts[1],h=l.__kBitConversionInts[0],f=20,p=29-s;if(p!==(0|(c-1)%30))throw new Error("implementation bug");var m,y=0;if(p<f){var g=f-p;y=g+32,m=d>>>g,d=d<<32-g|h>>>g,h<<=32-g}else if(p===f)y=32,m=d,d=h,h=0;else{var v=p-f;y=32-v,m=d<<v|h>>>32-v,d=h<<v,h=0}if((a>>>=0)>(m>>>=0))return l.__absoluteGreater(r);if(a<m)return l.__absoluteLess(r);for(var w=o-2;0<=w;w--){0<y?(y-=30,m=d>>>2,d=d<<30|h>>>2,h<<=30):m=0;var b=e.__unsignedDigit(w);if(b>m)return l.__absoluteGreater(r);if(b<m)return l.__absoluteLess(r)}if(0!==d||0!==h){if(0===y)throw new Error("implementation bug");return l.__absoluteLess(r)}return 0}},{key:"__equalToNumber",value:function(e,r){return l.__isOneDigitInt(r)?0===r?0===e.length:1===e.length&&e.sign===0>r&&e.__unsignedDigit(0)===t(r):0===l.__compareToDouble(e,r)}},{key:"__comparisonResultToBool",value:function(e,t){return 0===t?0>e:1===t?0>=e:2===t?0<e:3===t?0<=e:void 0}},{key:"__compare",value:function(e,t,r){if(e=l.__toPrimitive(e),t=l.__toPrimitive(t),"string"==typeof e&&"string"==typeof t)switch(r){case 0:return e<t;case 1:return e<=t;case 2:return e>t;case 3:return e>=t}if(l.__isBigInt(e)&&"string"==typeof t)return null!==(t=l.__fromString(t))&&l.__comparisonResultToBool(l.__compareToBigInt(e,t),r);if("string"==typeof e&&l.__isBigInt(t))return null!==(e=l.__fromString(e))&&l.__comparisonResultToBool(l.__compareToBigInt(e,t),r);if(e=l.__toNumeric(e),t=l.__toNumeric(t),l.__isBigInt(e)){if(l.__isBigInt(t))return l.__comparisonResultToBool(l.__compareToBigInt(e,t),r);if("number"!=typeof t)throw new Error("implementation bug");return l.__comparisonResultToBool(l.__compareToNumber(e,t),r)}if("number"!=typeof e)throw new Error("implementation bug");if(l.__isBigInt(t))return l.__comparisonResultToBool(l.__compareToNumber(t,e),2^r);if("number"!=typeof t)throw new Error("implementation bug");return 0===r?e<t:1===r?e<=t:2===r?e>t:3===r?e>=t:void 0}},{key:"__absoluteAdd",value:function(e,t,r){if(e.length<t.length)return l.__absoluteAdd(t,e,r);if(0===e.length)return e;if(0===t.length)return e.sign===r?e:l.unaryMinus(e);var n=e.length;(0===e.__clzmsd()||t.length===e.length&&0===t.__clzmsd())&&n++;for(var i,o=new l(n,r),a=0,s=0;s<t.length;s++)a=(i=e.__digit(s)+t.__digit(s)+a)>>>30,o.__setDigit(s,1073741823&i);for(;s<e.length;s++){var c=e.__digit(s)+a;a=c>>>30,o.__setDigit(s,1073741823&c)}return s<o.length&&o.__setDigit(s,a),o.__trim()}},{key:"__absoluteSub",value:function(e,t,r){if(0===e.length)return e;if(0===t.length)return e.sign===r?e:l.unaryMinus(e);for(var n,i=new l(e.length,r),o=0,a=0;a<t.length;a++)o=1&(n=e.__digit(a)-t.__digit(a)-o)>>>30,i.__setDigit(a,1073741823&n);for(;a<e.length;a++){var s=e.__digit(a)-o;o=1&s>>>30,i.__setDigit(a,1073741823&s)}return i.__trim()}},{key:"__absoluteAddOne",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=e.length;null===r?r=new l(n,t):r.sign=t;for(var i,o=1,a=0;a<n;a++)o=(i=e.__digit(a)+o)>>>30,r.__setDigit(a,1073741823&i);return 0!==o&&r.__setDigitGrow(n,1),r}},{key:"__absoluteSubOne",value:function(e,t){for(var r,n=e.length,i=new l(t=t||n,!1),o=1,a=0;a<n;a++)o=1&(r=e.__digit(a)-o)>>>30,i.__setDigit(a,1073741823&r);if(0!==o)throw new Error("implementation bug");for(var s=n;s<t;s++)i.__setDigit(s,0);return i}},{key:"__absoluteAnd",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=e.length,i=t.length,o=i;if(n<i){o=n;var a=e,s=n;e=t,n=i,t=a,i=s}var c=o;null===r?r=new l(c,!1):c=r.length;for(var u=0;u<o;u++)r.__setDigit(u,e.__digit(u)&t.__digit(u));for(;u<c;u++)r.__setDigit(u,0);return r}},{key:"__absoluteAndNot",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=e.length,i=t.length,o=i;n<i&&(o=n);var a=n;null===r?r=new l(a,!1):a=r.length;for(var s=0;s<o;s++)r.__setDigit(s,e.__digit(s)&~t.__digit(s));for(;s<n;s++)r.__setDigit(s,e.__digit(s));for(;s<a;s++)r.__setDigit(s,0);return r}},{key:"__absoluteOr",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=e.length,i=t.length,o=i;if(n<i){o=n;var a=e,s=n;e=t,n=i,t=a,i=s}var c=n;null===r?r=new l(c,!1):c=r.length;for(var u=0;u<o;u++)r.__setDigit(u,e.__digit(u)|t.__digit(u));for(;u<n;u++)r.__setDigit(u,e.__digit(u));for(;u<c;u++)r.__setDigit(u,0);return r}},{key:"__absoluteXor",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=e.length,i=t.length,o=i;if(n<i){o=n;var a=e,s=n;e=t,n=i,t=a,i=s}var c=n;null===r?r=new l(c,!1):c=r.length;for(var u=0;u<o;u++)r.__setDigit(u,e.__digit(u)^t.__digit(u));for(;u<n;u++)r.__setDigit(u,e.__digit(u));for(;u<c;u++)r.__setDigit(u,0);return r}},{key:"__absoluteCompare",value:function(e,t){var r=e.length-t.length;if(0!=r)return r;for(var n=e.length-1;0<=n&&e.__digit(n)===t.__digit(n);)n--;return 0>n?0:e.__unsignedDigit(n)>t.__unsignedDigit(n)?1:-1}},{key:"__multiplyAccumulate",value:function(e,t,r,n){if(0!==t){for(var i=32767&t,o=t>>>15,a=0,s=0,c=0;c<e.length;c++,n++){var u=r.__digit(n),d=e.__digit(c),h=32767&d,f=d>>>15,p=l.__imul(h,i),m=l.__imul(h,o),y=l.__imul(f,i);a=(u+=s+p+a)>>>30,u&=1073741823,a+=(u+=((32767&m)<<15)+((32767&y)<<15))>>>30,s=l.__imul(f,o)+(m>>>15)+(y>>>15),r.__setDigit(n,1073741823&u)}for(;0!==a||0!==s;n++){var g=r.__digit(n);g+=a+s,s=0,a=g>>>30,r.__setDigit(n,1073741823&g)}}}},{key:"__internalMultiplyAdd",value:function(e,t,r,n,i){for(var o=r,a=0,s=0;s<n;s++){var c=e.__digit(s),u=l.__imul(32767&c,t),d=l.__imul(c>>>15,t),h=u+((32767&d)<<15)+a+o;o=h>>>30,a=d>>>15,i.__setDigit(s,1073741823&h)}if(i.length>n)for(i.__setDigit(n++,o+a);n<i.length;)i.__setDigit(n++,0);else if(0!==o+a)throw new Error("implementation bug")}},{key:"__absoluteDivSmall",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;null===r&&(r=new l(e.length,!1));for(var n=0,i=2*e.length-1;0<=i;i-=2){var o=(n<<15|e.__halfDigit(i))>>>0,a=0|o/t,s=0|(o=((n=0|o%t)<<15|e.__halfDigit(i-1))>>>0)/t;n=0|o%t,r.__setDigit(i>>>1,a<<15|s)}return r}},{key:"__absoluteModSmall",value:function(e,t){for(var r=0,n=2*e.length-1;0<=n;n--)r=0|((r<<15|e.__halfDigit(n))>>>0)%t;return r}},{key:"__absoluteDivLarge",value:function(e,t,r,n){var i=t.__halfDigitLength(),o=t.length,a=e.__halfDigitLength()-i,s=null;r&&(s=new l(a+2>>>1,!1)).__initializeDigits();var c=new l(i+2>>>1,!1);c.__initializeDigits();var u=l.__clz15(t.__halfDigit(i-1));0<u&&(t=l.__specialLeftShift(t,u,0));for(var d=l.__specialLeftShift(e,u,1),h=t.__halfDigit(i-1),f=0,p=a;0<=p;p--){var m=32767,y=d.__halfDigit(p+i);if(y!==h){var g=(y<<15|d.__halfDigit(p+i-1))>>>0;m=0|g/h;for(var v=0|g%h,w=t.__halfDigit(i-2),b=d.__halfDigit(p+i-2);l.__imul(m,w)>>>0>(v<<16|b)>>>0&&(m--,!(32767<(v+=h))););}l.__internalMultiplyAdd(t,m,0,o,c);var _=d.__inplaceSub(c,p,i+1);0!==_&&(_=d.__inplaceAdd(t,p,i),d.__setHalfDigit(p+i,32767&d.__halfDigit(p+i)+_),m--),r&&(1&p?f=m<<15:s.__setDigit(p>>>1,f|m))}if(n)return d.__inplaceRightShift(u),r?{quotient:s,remainder:d}:d;if(r)return s;throw new Error("unreachable")}},{key:"__clz15",value:function(e){return l.__clz30(e)-15}},{key:"__specialLeftShift",value:function(e,t,r){var n=e.length,i=new l(n+r,!1);if(0===t){for(var o=0;o<n;o++)i.__setDigit(o,e.__digit(o));return 0<r&&i.__setDigit(n,0),i}for(var a,s=0,c=0;c<n;c++)a=e.__digit(c),i.__setDigit(c,1073741823&a<<t|s),s=a>>>30-t;return 0<r&&i.__setDigit(n,s),i}},{key:"__leftShiftByAbsolute",value:function(e,t){var r=l.__toShiftAmount(t);if(0>r)throw new RangeError("BigInt too big");var n=0|r/30,i=r%30,o=e.length,a=0!==i&&0!=e.__digit(o-1)>>>30-i,s=o+n+(a?1:0),c=new l(s,e.sign);if(0===i){for(var u=0;u<n;u++)c.__setDigit(u,0);for(;u<s;u++)c.__setDigit(u,e.__digit(u-n))}else{for(var d=0,h=0;h<n;h++)c.__setDigit(h,0);for(var f,p=0;p<o;p++)f=e.__digit(p),c.__setDigit(p+n,1073741823&f<<i|d),d=f>>>30-i;if(a)c.__setDigit(o+n,d);else if(0!==d)throw new Error("implementation bug")}return c.__trim()}},{key:"__rightShiftByAbsolute",value:function(e,t){var r=e.length,n=e.sign,i=l.__toShiftAmount(t);if(0>i)return l.__rightShiftByMaximum(n);var o=0|i/30,a=i%30,s=r-o;if(0>=s)return l.__rightShiftByMaximum(n);var c=!1;if(n)if(0!=(e.__digit(o)&(1<<a)-1))c=!0;else for(var u=0;u<o;u++)if(0!==e.__digit(u)){c=!0;break}c&&0===a&&0==~e.__digit(r-1)&&s++;var d=new l(s,n);if(0===a){d.__setDigit(s-1,0);for(var h=o;h<r;h++)d.__setDigit(h-o,e.__digit(h))}else{for(var f,p=e.__digit(o)>>>a,m=r-o-1,y=0;y<m;y++)f=e.__digit(y+o+1),d.__setDigit(y,1073741823&f<<30-a|p),p=f>>>a;d.__setDigit(m,p)}return c&&(d=l.__absoluteAddOne(d,!0,d)),d.__trim()}},{key:"__rightShiftByMaximum",value:function(e){return e?l.__oneDigit(1,!0):l.__zero()}},{key:"__toShiftAmount",value:function(e){if(1<e.length)return-1;var t=e.__unsignedDigit(0);return t>l.__kMaxLengthBits?-1:t}},{key:"__toPrimitive",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"default";if("object"!==r(e))return e;if(e.constructor===l)return e;if("undefined"!=typeof Symbol&&"symbol"===r(Symbol.toPrimitive)){var n=e[Symbol.toPrimitive];if(n){var i=n(t);if("object"!==r(i))return i;throw new TypeError("Cannot convert object to primitive value")}}var o=e.valueOf;if(o){var a=o.call(e);if("object"!==r(a))return a}var s=e.toString;if(s){var c=s.call(e);if("object"!==r(c))return c}throw new TypeError("Cannot convert object to primitive value")}},{key:"__toNumeric",value:function(e){return l.__isBigInt(e)?e:+e}},{key:"__isBigInt",value:function(e){return"object"===r(e)&&null!==e&&e.constructor===l}},{key:"__truncateToNBits",value:function(e,t){for(var r=0|(e+29)/30,n=new l(r,t.sign),i=r-1,o=0;o<i;o++)n.__setDigit(o,t.__digit(o));var a=t.__digit(i);if(0!=e%30){var s=32-e%30;a=a<<s>>>s}return n.__setDigit(i,a),n.__trim()}},{key:"__truncateAndSubFromPowerOfTwo",value:function(e,t,r){for(var n,i=Math.min,o=0|(e+29)/30,a=new l(o,r),s=0,c=o-1,u=0,d=i(c,t.length);s<d;s++)u=1&(n=0-t.__digit(s)-u)>>>30,a.__setDigit(s,1073741823&n);for(;s<c;s++)a.__setDigit(s,0|1073741823&-u);var h,f=c<t.length?t.__digit(c):0,p=e%30;if(0===p)h=0-f-u,h&=1073741823;else{var m=32-p,y=1<<32-m;h=y-(f=f<<m>>>m)-u,h&=y-1}return a.__setDigit(c,h),a.__trim()}},{key:"__digitPow",value:function(e,t){for(var r=1;0<t;)1&t&&(r*=e),t>>>=1,e*=e;return r}},{key:"__isOneDigitInt",value:function(e){return(1073741823&e)===e}}]),l}(h(Array));return T.__kMaxLength=33554432,T.__kMaxLengthBits=T.__kMaxLength<<5,T.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],T.__kBitsPerCharTableShift=5,T.__kBitsPerCharTableMultiplier=1<<T.__kBitsPerCharTableShift,T.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],T.__kBitConversionBuffer=new ArrayBuffer(8),T.__kBitConversionDouble=new Float64Array(T.__kBitConversionBuffer),T.__kBitConversionInts=new Int32Array(T.__kBitConversionBuffer),T.__clz30=t?function(e){return t(e)-2}:function(e){var t=Math.LN2,r=Math.log;return 0===e?30:0|29-(0|r(e>>>0)/t)},T.__imul=e||function(e,t){return 0|e*t},T}();var d=l(u.exports);const h={};function f(e,t){Object.defineProperty(e.prototype,Symbol.toStringTag,{value:t,writable:!1,enumerable:!1,configurable:!0});for(const t of Object.getOwnPropertyNames(e)){const r=Object.getOwnPropertyDescriptor(e,t);r.configurable&&r.enumerable&&(r.enumerable=!1,Object.defineProperty(e,t,r))}for(const t of Object.getOwnPropertyNames(e.prototype)){const r=Object.getOwnPropertyDescriptor(e.prototype,t);r.configurable&&r.enumerable&&(r.enumerable=!1,Object.defineProperty(e.prototype,t,r))}p(t,e),p(`${t}.prototype`,e.prototype)}function p(e,t){const r=`%${e}%`;if(void 0!==h[r])throw new Error(`intrinsic ${e} already exists`);h[r]=t}function m(e){return h[e]}var y,g;const v="slot-epochNanoSeconds",w="slot-timezone-identifier",b="slot-year",_="slot-month",E="slot-day",T="slot-hour",x="slot-minute",I="slot-second",S="slot-millisecond",R="slot-microsecond",k="slot-nanosecond",D="slot-calendar",j="slot-date-brand",N="slot-year-month-brand",O="slot-month-day-brand",C="slot-cached-instant",A="slot-time-zone",M="slot-years",L="slot-months",P="slot-weeks",B="slot-days",$="slot-hours",F="slot-minutes",U="slot-seconds",q="slot-milliseconds",Y="slot-microseconds",W="slot-nanoseconds",z="slot-calendar-identifier",G=new WeakMap,J=Symbol.for("@@Temporal__GetSlots");(y=globalThis)[J]||(y[J]=function(e){return G.get(e)});const H=globalThis[J],V=Symbol.for("@@Temporal__CreateSlots");(g=globalThis)[V]||(g[V]=function(e){G.set(e,Object.create(null))});const Q=globalThis[V];function Z(e,...t){if(!e||"object"!=typeof e)return!1;const r=H(e);return!!r&&t.every((e=>e in r))}function K(e,t){const r=H(e)?.[t];if(void 0===r)throw new TypeError(`Missing internal slot ${t}`);return r}function X(e,t,r){const n=H(e);if(void 0===n)throw new TypeError("Missing slots for the given container");if(n[t])throw new TypeError(`${t} already has set`);n[t]=r}const ee=/\.[-A-Za-z_]|\.\.[-A-Za-z._]{1,12}|\.[-A-Za-z_][-A-Za-z._]{0,12}|[A-Za-z_][-A-Za-z._]{0,13}/,te=new RegExp("(?:"+[`(?:${ee.source})(?:\\/(?:${ee.source}))*`,"Etc/GMT(?:0|[-+]\\d{1,2})","GMT[-+]?0","EST5EDT","CST6CDT","MST7MDT","PST8PDT",/(?:[+\u2212-][0-2][0-9](?::?[0-5][0-9](?::?[0-5][0-9](?:[.,]\d{1,9})?)?)?)/.source].join("|")+")"),re=/(?:[+\u2212-]\d{6}|\d{4})/,ne=/(?:0[1-9]|1[0-2])/,ie=/(?:0[1-9]|[12]\d|3[01])/,oe=new RegExp(`(${re.source})(?:-(${ne.source})-(${ie.source})|(${ne.source})(${ie.source}))`),ae=/(\d{2})(?::(\d{2})(?::(\d{2})(?:[.,](\d{1,9}))?)?|(\d{2})(?:(\d{2})(?:[.,](\d{1,9}))?)?)?/,se=/([+\u2212-])([01][0-9]|2[0-3])(?::?([0-5][0-9])(?::?([0-5][0-9])(?:[.,](\d{1,9}))?)?)?/,le=new RegExp(`([zZ])|${se.source}?`),ce=/\[(!)?([a-z_][a-z0-9_-]*)=([A-Za-z0-9]+(?:-[A-Za-z0-9]+)*)\]/g,ue=new RegExp([`^${oe.source}`,`(?:(?:T|\\s+)${ae.source}(?:${le.source})?)?`,`(?:\\[!?(${te.source})\\])?`,`((?:${ce.source})*)$`].join(""),"i"),de=new RegExp([`^T?${ae.source}`,`(?:${le.source})?`,`(?:\\[!?${te.source}\\])?`,`((?:${ce.source})*)$`].join(""),"i"),he=new RegExp(`^(${re.source})-?(${ne.source})(?:\\[!?${te.source}\\])?((?:${ce.source})*)$`),fe=new RegExp(`^(?:--)?(${ne.source})-?(${ie.source})(?:\\[!?${te.source}\\])?((?:${ce.source})*)$`),pe=/(\d+)(?:[.,](\d{1,9}))?/,me=new RegExp(`(?:${pe.source}H)?(?:${pe.source}M)?(?:${pe.source}S)?`),ye=new RegExp(`^([+−-])?P${/(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)W)?(?:(\d+)D)?/.source}(?:T(?!$)${me.source})?$`,"i"),ge=Array.prototype.includes,ve=Array.prototype.push,we=globalThis.Intl.DateTimeFormat,be=Math.min,_e=Math.max,Ee=Math.abs,Te=Math.floor,xe=Math.sign,Ie=Math.trunc,Se=Number.isNaN,Re=Number.isFinite,ke=Number,De=String,je=Number.MAX_SAFE_INTEGER,Ne=Object.create,Oe=Object.getOwnPropertyDescriptor,Ce=Reflect.apply,Ae=Reflect.ownKeys,Me=d.BigInt(0),Le=d.BigInt(1),Pe=d.BigInt(60),Be=d.BigInt(24),$e=d.BigInt(1e3),Fe=d.BigInt(1e6),Ue=d.BigInt(1e9),qe=d.BigInt(-1),Ye=d.multiply(d.BigInt(3600),Ue),We=d.multiply(Pe,Ue),ze=d.multiply(Ye,Be),Ge=d.multiply(d.BigInt(-86400),d.BigInt(1e17)),Je=d.multiply(d.BigInt(86400),d.BigInt(1e17)),He=-271821,Ve=275760,Qe=d.multiply(d.BigInt(-388152),d.BigInt(1e13)),Ze=d.multiply(ze,d.BigInt(3660)),Ke=d.multiply(ze,d.BigInt(366)),Xe=d.multiply(ze,d.BigInt(14)),et=["iso8601","hebrew","islamic","islamic-umalqura","islamic-tbla","islamic-civil","islamic-rgsa","islamicc","persian","ethiopic","ethioaa","coptic","chinese","dangi","roc","indian","buddhist","japanese","gregory"];function tt(e){return d.equal(e,Me)}function rt(e,t){const r=e[t];if(void 0!==r)return r}function nt(e,t,r){return Ce(e,t,arguments.length>2?r:[])}function it(e){return"object"==typeof e&&null!==e||"function"==typeof e}function ot(e){if("bigint"==typeof e)throw new TypeError("Cannot convert BigInt to number");return ke(e)}function at(e){const t=ot(e);if(Se(t)||0===t)return 0;if(!Re(t))return t;const r=Te(Ee(t));return 0===r?0:xe(t)*r}function st(e){if("number"!=typeof e||Se(e)||!Re(e))return!1;const t=Ee(e);return Te(t)===t}function lt(e){if("symbol"==typeof e)throw new TypeError("Cannot convert a Symbol value to a String");return De(e)}function ct(e){const t=ot(e);if(0===t)return 0;if(Se(t)||!Re(t))throw new RangeError("invalid number value");const r=Ie(t);return 0===r?0:r}function ut(e,t){const r=ct(e);if(r<=0){if(void 0!==t)throw new RangeError(`property '${t}' cannot be a a number less than one`);throw new RangeError("Cannot convert a number less than one to a positive integer")}return r}function dt(e){const t=ot(e);if(!Re(t))throw new RangeError("infinity is out of range");if(!st(t))throw new RangeError(`unsupported fractional value ${e}`);return 0===t?0:t}function ht(e,t){return{quotient:d.divide(e,t),remainder:d.remainder(e,t)}}function ft(e){return d.lessThan(e,Me)}function pt(e){return tt(e)?0:ft(e)?-1:1}function mt(e){return d.lessThan(e,Me)?d.multiply(e,qe):e}const yt=new Map([["year",ct],["month",ut],["monthCode",lt],["day",ut],["hour",ct],["minute",ct],["second",ct],["millisecond",ct],["microsecond",ct],["nanosecond",ct],["years",dt],["months",dt],["weeks",dt],["days",dt],["hours",dt],["minutes",dt],["seconds",dt],["milliseconds",dt],["microseconds",dt],["nanoseconds",dt],["era",lt],["eraYear",at],["offset",lt]]),gt=new Map([["hour",0],["minute",0],["second",0],["millisecond",0],["microsecond",0],["nanosecond",0]]),vt=[["years","year","date"],["months","month","date"],["weeks","week","date"],["days","day","date"],["hours","hour","time"],["minutes","minute","time"],["seconds","second","time"],["milliseconds","millisecond","time"],["microseconds","microsecond","time"],["nanoseconds","nanosecond","time"]],wt=new Map(vt.map((e=>[e[0],e[1]]))),bt=new Map(vt.map((([e,t])=>[t,e]))),_t=vt.map((([,e])=>e)),Et=Array.from(wt.keys()).sort(),Tt=new Map;function xt(e){let t=Tt.get(e);return void 0===t&&(t=new we("en-us",{timeZone:De(e),hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),Tt.set(e,t)),t}function It(e){if(null==e)throw new TypeError(`Expected object not ${e}`);return Object(e)}function St(e,t,r,n){if(null==t)return;const i=Ae(t);for(const o of i)if(!r.some((e=>Object.is(e,o)))&&Object.prototype.propertyIsEnumerable.call(t,o)){const r=t[o];if(n&&n.some((e=>Object.is(e,r))))continue;e[o]=r}}function Rt(e){return Z(e,v)&&!Z(e,A,D)}function kt(e){return Z(e,w)}function Dt(e){return Z(e,z)}function jt(e){return Z(e,M,L,B,$,F,U,q,Y,W)}function Nt(e){return Z(e,j)}function Ot(e){return Z(e,T,x,I,S,R,k)&&!Z(e,b,_,E)}function Ct(e){return Z(e,b,_,E,T,x,I,S,R,k)}function At(e){return Z(e,N)}function Mt(e){return Z(e,O)}function Lt(e){return Z(e,v,A,D)}function Pt(e){if(Z(e,D)||Z(e,A))throw new TypeError("with() does not support a calendar or timeZone property");if(Ot(e))throw new TypeError("with() does not accept Temporal.PlainTime, use withPlainTime() instead");if(void 0!==e.calendar)throw new TypeError("with() does not support a calendar property");if(void 0!==e.timeZone)throw new TypeError("with() does not support a timeZone property")}function Bt(e,t){return"never"===t?"":$t(Vr(e),t)}function $t(e,t){return"never"===t||"auto"===t&&"iso8601"===e?"":`[${"critical"===t?"!":""}u-ca=${e}]`}function Ft(e){const t=ue.exec(e);if(!t)throw new RangeError(`invalid ISO 8601 string: ${e}`);let r=t[1];if("−"===r[0]&&(r=`-${r.slice(1)}`),"-000000"===r)throw new RangeError(`invalid ISO 8601 string: ${e}`);const n=at(r),i=at(t[2]||t[4]),o=at(t[3]||t[5]),a=at(t[6]),s=void 0!==t[6],l=at(t[7]||t[10]);let c=at(t[8]||t[11]);60===c&&(c=59);const u=(t[9]||t[12])+"000000000",d=at(u.slice(0,3)),h=at(u.slice(3,6)),f=at(u.slice(6,9));let p,m=!1;if(t[13])p=void 0,m=!0;else if(t[14]&&t[15]){const e="-"===t[14]||"−"===t[14]?"-":"+",r=t[15]||"00",n=t[16]||"00",i=t[17]||"00";let o=t[18]||"0";if(p=`${e}${r}:${n}`,+o){for(;o.endsWith("0");)o=o.slice(0,-1);p+=`:${i}.${o}`}else+i&&(p+=`:${i}`);"-00:00"===p&&(p="+00:00")}const y=t[19],g=t[20];let v;for(const[,e,t,r]of g.matchAll(ce))if("u-ca"===t)void 0===v&&(v=r);else if("!"===e)throw new RangeError(`Unrecognized annotation: !${t}=${r}`);return li(n,i,o,a,l,c,d,h,f),{year:n,month:i,day:o,hasTime:s,hour:a,minute:l,second:c,millisecond:d,microsecond:h,nanosecond:f,ianaName:y,offset:p,z:m,calendar:v}}function Ut(e){const t=he.exec(e);let r,n,i,o;if(t){let o=t[1];if("−"===o[0]&&(o=`-${o.slice(1)}`),"-000000"===o)throw new RangeError(`invalid ISO 8601 string: ${e}`);r=at(o),n=at(t[2]);const a=t[3];for(const[,e,t,r]of a.matchAll(ce))if("u-ca"===t)void 0===i&&(i=r);else if("!"===e)throw new RangeError(`Unrecognized annotation: !${t}=${r}`);if(void 0!==i&&"iso8601"!==i)throw new RangeError("YYYY-MM format is only valid with iso8601 calendar")}else{let t;if(({year:r,month:n,calendar:i,day:o,z:t}=Ft(e)),t)throw new RangeError("Z designator not supported for PlainYearMonth")}return{year:r,month:n,calendar:i,referenceISODay:o}}function qt(e){const t=fe.exec(e);let r,n,i,o;if(t){r=at(t[1]),n=at(t[2]);const e=t[3];for(const[,t,r,n]of e.matchAll(ce))if("u-ca"===r)void 0===i&&(i=n);else if("!"===t)throw new RangeError(`Unrecognized annotation: !${r}=${n}`);if(void 0!==i&&"iso8601"!==i)throw new RangeError("MM-DD format is only valid with iso8601 calendar")}else{let t;if(({month:r,day:n,calendar:i,year:o,z:t}=Ft(e)),t)throw new RangeError("Z designator not supported for PlainMonthDay")}return{month:r,day:n,calendar:i,referenceISOYear:o}}function Yt(e,t,r,n){let i=e,o=t,a=r;switch(n){case"reject":oi(i,o,a);break;case"constrain":({year:i,month:o,day:a}=ni(i,o,a))}return{year:i,month:o,day:a}}function Wt(e,t,r,n,i,o,a){let s=e,l=t,c=r,u=n,d=i,h=o;switch(a){case"reject":si(s,l,c,u,d,h);break;case"constrain":({hour:s,minute:l,second:c,millisecond:u,microsecond:d,nanosecond:h}=function(e,t,r,n,i,o){return{hour:ri(e,0,23),minute:ri(t,0,59),second:ri(r,0,59),millisecond:ri(n,0,999),microsecond:ri(i,0,999),nanosecond:ri(o,0,999)}}(s,l,c,u,d,h))}return{hour:s,minute:l,second:c,millisecond:u,microsecond:d,nanosecond:h}}function zt(e){if(!it(e))return function(e){const t=ye.exec(e);if(!t)throw new RangeError(`invalid duration: ${e}`);if(t.slice(2).every((e=>void 0===e)))throw new RangeError(`invalid duration: ${e}`);const r="-"===t[1]||"−"===t[1]?-1:1,n=void 0===t[2]?0:ct(t[2])*r,i=void 0===t[3]?0:ct(t[3])*r,o=void 0===t[4]?0:ct(t[4])*r,a=void 0===t[5]?0:ct(t[5])*r,s=void 0===t[6]?0:ct(t[6])*r,l=t[7],c=t[8],u=t[9],d=t[10],h=t[11];let f=0,p=0,m=0;if(void 0!==l){if(c??u??d??h)throw new RangeError("only the smallest unit can be fractional");m=3600*at((l+"000000000").slice(0,9))*r}else if(f=void 0===c?0:ct(c)*r,void 0!==u){if(d??h)throw new RangeError("only the smallest unit can be fractional");m=60*at((u+"000000000").slice(0,9))*r}else p=void 0===d?0:ct(d)*r,void 0!==h&&(m=at((h+"000000000").slice(0,9))*r);const y=m%1e3,g=Ie(m/1e3)%1e3,v=Ie(m/1e6)%1e3;return p+=Ie(m/1e9)%60,f+=Ie(m/6e10),di(n,i,o,a,s,f,p,v,g,y),{years:n,months:i,weeks:o,days:a,hours:s,minutes:f,seconds:p,milliseconds:v,microseconds:g,nanoseconds:y}}(lt(e));if(jt(e))return{years:K(e,M),months:K(e,L),weeks:K(e,P),days:K(e,B),hours:K(e,$),minutes:K(e,F),seconds:K(e,U),milliseconds:K(e,q),microseconds:K(e,Y),nanoseconds:K(e,W)};const t={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};let r=function(e){if(!it(e))throw new TypeError("invalid duration-like");const t={years:void 0,months:void 0,weeks:void 0,days:void 0,hours:void 0,minutes:void 0,seconds:void 0,milliseconds:void 0,microseconds:void 0,nanoseconds:void 0};let r=!1;for(const n of Et){const i=e[n];void 0!==i&&(r=!0,t[n]=dt(i))}if(!r)throw new TypeError("invalid duration-like");return t}(e);for(const e of Et){const n=r[e];void 0!==n&&(t[e]=n)}let{years:n,months:i,weeks:o,days:a,hours:s,minutes:l,seconds:c,milliseconds:u,microseconds:d,nanoseconds:h}=t;return di(n,i,o,a,s,l,c,u,d,h),{years:n,months:i,weeks:o,days:a,hours:s,minutes:l,seconds:c,milliseconds:u,microseconds:d,nanoseconds:h}}function Gt(e){return void 0===e?"constrain":no(e,"overflow",["constrain","reject"],"constrain")}function Jt(e){return void 0===e?"compatible":no(e,"disambiguation",["compatible","earlier","later","reject"],"compatible")}function Ht(e,t){return no(e,"roundingMode",["ceil","floor","expand","trunc","halfCeil","halfFloor","halfExpand","halfTrunc","halfEven"],t)}function Vt(e,t){return void 0===e?t:no(e,"offset",["prefer","use","ignore","reject"],t)}function Qt(e){return no(e,"calendarName",["auto","always","never","critical"],"auto")}function Zt(e){let t=e.roundingIncrement;if(void 0===t)return 1;if(t=ot(t),!Re(t))throw new RangeError("roundingIncrement must be finite");const r=Ie(t);if(r<1||r>1e9)throw new RangeError(`roundingIncrement must be at least 1 and at most 1e9, not ${t}`);return r}function Kt(e,t,r){const n=r?t:t-1;if(e>n)throw new RangeError(`roundingIncrement must be at least 1 and less than ${n}, not ${e}`);if(t%e!=0)throw new RangeError(`Rounding increment must divide evenly into ${t}`)}function Xt(e){const t=e.fractionalSecondDigits;if(void 0===t)return"auto";if("number"!=typeof t){if("auto"!==lt(t))throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${t}`);return"auto"}const r=Te(t);if(!Re(r)||r<0||r>9)throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${t}`);return r}function er(e,t){switch(e){case"minute":return{precision:"minute",unit:"minute",increment:1};case"second":return{precision:0,unit:"second",increment:1};case"millisecond":return{precision:3,unit:"millisecond",increment:1};case"microsecond":return{precision:6,unit:"microsecond",increment:1};case"nanosecond":return{precision:9,unit:"nanosecond",increment:1}}switch(t){case"auto":return{precision:t,unit:"nanosecond",increment:1};case 0:return{precision:t,unit:"second",increment:1};case 1:case 2:case 3:return{precision:t,unit:"millisecond",increment:10**(3-t)};case 4:case 5:case 6:return{precision:t,unit:"microsecond",increment:10**(6-t)};case 7:case 8:case 9:return{precision:t,unit:"nanosecond",increment:10**(9-t)};default:throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${t}`)}}const tr=Symbol("~required~");function rr(e,t,r,n,i=[]){const o=[];for(const[,e,t]of vt)"datetime"!==r&&r!==t||o.push(e);o.push(...i);let a=n;a===tr?a=void 0:void 0!==a&&o.push(a);const s=[...o];for(const e of o){const t=bt.get(e);void 0!==t&&s.push(t)}let l=no(e,t,s,a);if(void 0===l&&n===tr)throw new RangeError(`${t} is required`);return wt.has(l)?wt.get(l):l}function nr(e){const t=e.relativeTo;if(void 0===t)return t;let r,n,i,o,a,s,l,c,u,d,h,f,p="option",m=!1;if(it(t)){if(Lt(t)||Nt(t))return t;if(Ct(t))return ln(t);d=Hr(t);const e=kr(d,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);e.push("timeZone","offset");const m=ar(t,e,[]),y=Ne(null);y.overflow="constrain",({year:r,month:n,day:i,hour:o,minute:a,second:s,millisecond:l,microsecond:c,nanosecond:u}=cr(d,m,y)),f=m.offset,void 0===f&&(p="wall"),h=m.timeZone,void 0!==h&&(h=nn(h))}else{let e,y;if(({year:r,month:n,day:i,hour:o,minute:a,second:s,millisecond:l,microsecond:c,nanosecond:u,calendar:d,ianaName:e,offset:f,z:y}=Ft(lt(t))),e)h=nn(e),y?p="exact":f||(p="wall"),m=!0;else if(y)throw new RangeError("Z designator not supported for PlainDate relativeTo; either remove the Z or add a bracketed time zone");if(d||(d="iso8601"),!io(d))throw new RangeError(`invalid calendar identifier ${d}`);d=oo(d)}return void 0===h?wr(r,n,i,d):Rr(yr(r,n,i,o,a,s,l,c,u,p,"option"===p?Rn(f):0,h,"compatible","reject",m),h,d)}function ir(e,t,r,n,i,o,a,s,l,c){for(const[u,d]of[["years",e],["months",t],["weeks",r],["days",n],["hours",i],["minutes",o],["seconds",a],["milliseconds",s],["microseconds",l],["nanoseconds",c]])if(0!==d)return wt.get(u);return"nanosecond"}function or(e,t){return _t.indexOf(e)>_t.indexOf(t)?t:e}function ar(e,t,r,{emptySourceErrorMessage:n}={emptySourceErrorMessage:"no supported properties found"}){const i=Ne(null);let o=!1;t.sort();for(const n of t){let t=e[n];if(void 0!==t)o=!0,yt.has(n)&&(t=yt.get(n)(t)),i[n]=t;else if("partial"!==r){if(ge.call(r,n))throw new TypeError(`required property '${n}' missing or undefined`);t=gt.get(n),i[n]=t}}if("partial"===r&&!o)throw new TypeError(n);return i}function sr(e,t="complete"){const r=["hour","microsecond","millisecond","minute","nanosecond","second"],n=ar(e,r,"partial",{emptySourceErrorMessage:"invalid time-like"}),i={};for(const e of r){const r=Oe(n,e);void 0!==r?i[e]=r.value:"complete"===t&&(i[e]=0)}return i}function lr(e,t){let r=e;if(it(r)){if(Nt(r))return r;if(Lt(r)&&(Gt(t),r=hn(K(r,A),K(r,C),K(r,D))),Ct(r))return Gt(t),wr(K(r,b),K(r,_),K(r,E),K(r,D));const e=Hr(r);return en(e,ar(r,kr(e,["day","month","monthCode","year"]),[]),t)}Gt(t);let{year:n,month:i,day:o,calendar:a,z:s}=function(e){return Ft(e)}(lt(r));if(s)throw new RangeError("Z designator not supported for PlainDate");if(a||(a="iso8601"),!io(a))throw new RangeError(`invalid calendar identifier ${a}`);return a=oo(a),wr(n,i,o,a)}function cr(e,t,r){let{hour:n,minute:i,second:o,millisecond:a,microsecond:s,nanosecond:l}=sr(t);const c=Gt(r),u=en(e,t,r),d=K(u,b),h=K(u,_),f=K(u,E);return({hour:n,minute:i,second:o,millisecond:a,microsecond:s,nanosecond:l}=Wt(n,i,o,a,s,l,c)),{year:d,month:h,day:f,hour:n,minute:i,second:o,millisecond:a,microsecond:s,nanosecond:l}}function ur(e,t){let r,n,i,o,a,s,l,c,u,d;if(it(e)){if(Ct(e))return e;if(Lt(e))return Gt(t),hn(K(e,A),K(e,C),K(e,D));if(Nt(e))return Gt(t),_r(K(e,b),K(e,_),K(e,E),0,0,0,0,0,0,K(e,D));d=Hr(e);const h=ar(e,kr(d,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]),[]);({year:r,month:n,day:i,hour:o,minute:a,second:s,millisecond:l,microsecond:c,nanosecond:u}=cr(d,h,t))}else{let h;if(Gt(t),({year:r,month:n,day:i,hour:o,minute:a,second:s,millisecond:l,microsecond:c,nanosecond:u,calendar:d,z:h}=function(e){return Ft(e)}(lt(e))),h)throw new RangeError("Z designator not supported for PlainDateTime");if(li(r,n,i,o,a,s,l,c,u),d||(d="iso8601"),!io(d))throw new RangeError(`invalid calendar identifier ${d}`);d=oo(d)}return _r(r,n,i,o,a,s,l,c,u,d)}function dr(e){if(jt(e))return e;let{years:t,months:r,weeks:n,days:i,hours:o,minutes:a,seconds:s,milliseconds:l,microseconds:c,nanoseconds:u}=zt(e);return new(m("%Temporal.Duration%"))(t,r,n,i,o,a,s,l,c,u)}function hr(e){if(Rt(e))return e;if(Lt(e))return new(m("%Temporal.Instant%"))(K(e,v));const t=function(e){let{year:t,month:r,day:n,hour:i,minute:o,second:a,millisecond:s,microsecond:l,nanosecond:c,offset:u,z:d}=function(e){const t=Ft(e);if(!t.z&&!t.offset)throw new RangeError("Temporal.Instant requires a time zone offset");return t}(e);if(!d&&!u)throw new RangeError("Temporal.Instant requires a time zone offset");const h=d?0:Rn(u);({year:t,month:r,day:n,hour:i,minute:o,second:a,millisecond:s,microsecond:l,nanosecond:c}=Jn(t,r,n,i,o,a,s,l,c-h));const f=On(t,r,n,i,o,a,s,l,c);if(null===f)throw new RangeError("DateTime outside of supported range");return f}(lt(e));return new(m("%Temporal.Instant%"))(t)}function fr(e,t){let r=e;if(it(r)){if(Mt(r))return r;let e,n;if(Z(r,D))e=K(r,D),n=!1;else{let t=r.calendar;n=void 0===t,void 0===t&&(t="iso8601"),e=Jr(t)}const i=ar(r,kr(e,["day","month","monthCode","year"]),[]);return n&&void 0!==i.month&&void 0===i.monthCode&&void 0===i.year&&(i.year=1972),rn(e,i,t)}Gt(t);let{month:n,day:i,referenceISOYear:o,calendar:a}=qt(lt(r));if(void 0===a&&(a="iso8601"),!io(a))throw new RangeError(`invalid calendar identifier ${a}`);return a=oo(a),void 0===o?(oi(1972,n,i),Tr(n,i,a)):rn(a,Tr(n,i,a,o))}function pr(e,t="constrain"){let r,n,i,o,a,s,l=e;if(it(l)){if(Ot(l))return l;if(Lt(l)&&(l=hn(K(l,A),K(l,C),K(l,D))),Ct(l))return new(m("%Temporal.PlainTime%"))(K(l,T),K(l,x),K(l,I),K(l,S),K(l,R),K(l,k));({hour:r,minute:n,second:i,millisecond:o,microsecond:a,nanosecond:s}=sr(l)),({hour:r,minute:n,second:i,millisecond:o,microsecond:a,nanosecond:s}=Wt(r,n,i,o,a,s,t))}else({hour:r,minute:n,second:i,millisecond:o,microsecond:a,nanosecond:s}=function(e){const t=de.exec(e);let r,n,i,o,a,s,l;if(t){r=at(t[1]),n=at(t[2]||t[5]),i=at(t[3]||t[6]),60===i&&(i=59);const e=(t[4]||t[7])+"000000000";o=at(e.slice(0,3)),a=at(e.slice(3,6)),s=at(e.slice(6,9)),l=t[14];for(const[,e,t,r]of l.matchAll(ce))if("u-ca"!==t&&"!"===e)throw new RangeError(`Unrecognized annotation: !${t}=${r}`);if(t[8])throw new RangeError("Z designator not supported for PlainTime")}else{let t,l;if(({hasTime:l,hour:r,minute:n,second:i,millisecond:o,microsecond:a,nanosecond:s,z:t}=Ft(e)),!l)throw new RangeError(`time is missing in string: ${e}`);if(t)throw new RangeError("Z designator not supported for PlainTime")}if(/[tT ][0-9][0-9]/.test(e))return{hour:r,minute:n,second:i,millisecond:o,microsecond:a,nanosecond:s};try{const{month:t,day:r}=qt(e);oi(1972,t,r)}catch{try{const{year:t,month:r}=Ut(e);oi(t,r,1)}catch{return{hour:r,minute:n,second:i,millisecond:o,microsecond:a,nanosecond:s}}}throw new RangeError(`invalid ISO 8601 time-only string ${e}; may need a T prefix`)}(lt(l))),si(r,n,i,o,a,s);return new(m("%Temporal.PlainTime%"))(r,n,i,o,a,s)}function mr(e,t){if(it(e)){if(At(e))return e;const r=Hr(e);return tn(r,ar(e,kr(r,["month","monthCode","year"]),[]),t)}Gt(t);let{year:r,month:n,referenceISODay:i,calendar:o}=Ut(lt(e));if(void 0===o&&(o="iso8601"),!io(o))throw new RangeError(`invalid calendar identifier ${o}`);return o=oo(o),void 0===i?(oi(r,n,1),Ir(r,n,o)):tn(o,Ir(r,n,o,i))}function yr(e,t,r,n,i,o,a,s,l,c,u,h,f,p,y){const g=new(m("%Temporal.PlainDateTime%"))(e,t,r,n,i,o,a,s,l);if("wall"===c||"ignore"===p)return K(fn(h,g,f),v);if("exact"===c||"use"===p){const c=On(e,t,r,n,i,o,a,s,l);if(null===c)throw new RangeError("ZonedDateTime outside of supported range");return d.subtract(c,d.BigInt(u))}const b=mn(h,g);for(const e of b){const t=un(h,e),r=d.toNumber(Li(d.BigInt(t),We,"halfExpand"));if(t===u||y&&r===u)return K(e,v)}if("reject"===p){const e=jn(u),t=kt(h)?K(h,w):"time zone";throw new RangeError(`Offset ${e} is invalid for ${g.toString()} in ${t}`)}return K(pn(b,h,g,f),v)}function gr(e,t){let r,n,i,o,a,s,l,c,u,d,h,f,p,m,y=!1,g="option";if(it(e)){if(Lt(e))return e;f=Hr(e);const y=kr(f,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);y.push("timeZone","offset");const v=ar(e,y,["timeZone"]);d=nn(v.timeZone),h=v.offset,void 0===h&&(g="wall"),p=Jt(t),m=Vt(t,"reject"),({year:r,month:n,day:i,hour:o,minute:a,second:s,millisecond:l,microsecond:c,nanosecond:u}=cr(f,v,t))}else{let v,w;if(({year:r,month:n,day:i,hour:o,minute:a,second:s,millisecond:l,microsecond:c,nanosecond:u,ianaName:v,offset:h,z:w,calendar:f}=function(e){const t=Ft(e);if(!t.ianaName)throw new RangeError("Temporal.ZonedDateTime requires a time zone ID in brackets");return t}(lt(e))),d=nn(v),w?g="exact":h||(g="wall"),f||(f="iso8601"),!io(f))throw new RangeError(`invalid calendar identifier ${f}`);f=oo(f),y=!0,p=Jt(t),m=Vt(t,"reject"),Gt(t)}let v=0;return"option"===g&&(v=Rn(h)),Rr(yr(r,n,i,o,a,s,l,c,u,g,v,d,p,m,y),d,f)}function vr(e,t,r,n,i){oi(t,r,n),ai(t,r,n),Q(e),X(e,b,t),X(e,_,r),X(e,E,n),X(e,D,i),X(e,j,!0)}function wr(e,t,r,n="iso8601"){const i=m("%Temporal.PlainDate%"),o=Ne(i.prototype);return vr(o,e,t,r,n),o}function br(e,t,r,n,i,o,a,s,l,c,u){li(t,r,n,i,o,a,s,l,c),ci(t,r,n,i,o,a,s,l,c),Q(e),X(e,b,t),X(e,_,r),X(e,E,n),X(e,T,i),X(e,x,o),X(e,I,a),X(e,S,s),X(e,R,l),X(e,k,c),X(e,D,u)}function _r(e,t,r,n,i,o,a,s,l,c="iso8601"){const u=m("%Temporal.PlainDateTime%"),d=Ne(u.prototype);return br(d,e,t,r,n,i,o,a,s,l,c),d}function Er(e,t,r,n,i){oi(i,t,r),ai(i,t,r),Q(e),X(e,_,t),X(e,E,r),X(e,b,i),X(e,D,n),X(e,O,!0)}function Tr(e,t,r="iso8601",n=1972){const i=m("%Temporal.PlainMonthDay%"),o=Ne(i.prototype);return Er(o,e,t,r,n),o}function xr(e,t,r,n,i){oi(t,r,i),function(e,t){ii(e,He,Ve),e===He?ii(t,4,12):e===Ve&&ii(t,1,9)}(t,r),Q(e),X(e,b,t),X(e,_,r),X(e,E,i),X(e,D,n),X(e,N,!0)}function Ir(e,t,r="iso8601",n=1){const i=m("%Temporal.PlainYearMonth%"),o=Ne(i.prototype);return xr(o,e,t,r,n),o}function Sr(e,t,r,n){ui(t),Q(e),X(e,v,t),X(e,A,r),X(e,D,n);const i=new(m("%Temporal.Instant%"))(K(e,v));X(e,C,i)}function Rr(e,t,r="iso8601"){const n=m("%Temporal.ZonedDateTime%"),i=Ne(n.prototype);return Sr(i,e,t,r),i}function kr(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.fields%"),r,[t])}const r=nt(rt(e,"fields"),e,[t]),n=[];for(const e of r){if("string"!=typeof e)throw new TypeError("bad return from calendar.fields()");ve.call(n,e)}return n}function Dr(e,t,r){if("string"==typeof e){const n=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.mergeFields%"),n,[t,r])}const n=nt(rt(e,"mergeFields"),e,[t,r]);if(!it(n))throw new TypeError("bad return from calendar.mergeFields()");return n}function jr(e,t,r,n,i){let o=i;if("string"==typeof e){const i=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.dateAdd%"),i,[t,r,n])}void 0===o&&(o=rt(e,"dateAdd"));const a=Ce(o,e,[t,r,n]);if(!Nt(a))throw new TypeError("invalid result");return a}function Nr(e,t,r,n,i){let o=i;if("string"==typeof e){const i=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.dateUntil%"),i,[t,r,n])}void 0===o&&(o=rt(e,"dateUntil"));const a=Ce(o,e,[t,r,n]);if(!jt(a))throw new TypeError("invalid result");return a}function Or(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.year%"),r,[t])}let r=nt(rt(e,"year"),e,[t]);if("number"!=typeof r)throw new TypeError("calendar year result must be an integer");if(!st(r))throw new RangeError("calendar year result must be an integer");return r}function Cr(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.month%"),r,[t])}let r=nt(rt(e,"month"),e,[t]);if("number"!=typeof r)throw new TypeError("calendar month result must be a positive integer");if(!st(r)||r<1)throw new RangeError("calendar month result must be a positive integer");return r}function Ar(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.monthCode%"),r,[t])}let r=nt(rt(e,"monthCode"),e,[t]);if("string"!=typeof r)throw new TypeError("calendar monthCode result must be a string");return r}function Mr(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.day%"),r,[t])}const r=nt(rt(e,"day"),e,[t]);if("number"!=typeof r)throw new TypeError("calendar day result must be a positive integer");if(!st(r)||r<1)throw new RangeError("calendar day result must be a positive integer");return r}function Lr(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.era%"),r,[t])}let r=nt(rt(e,"era"),e,[t]);if(void 0===r)return r;if("string"!=typeof r)throw new TypeError("calendar era result must be a string or undefined");return r}function Pr(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.eraYear%"),r,[t])}let r=nt(rt(e,"eraYear"),e,[t]);if(void 0===r)return r;if("number"!=typeof r)throw new TypeError("calendar eraYear result must be an integer or undefined");if(!st(r))throw new RangeError("calendar eraYear result must be an integer or undefined");return r}function Br(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.dayOfWeek%"),r,[t])}const r=nt(rt(e,"dayOfWeek"),e,[t]);if("number"!=typeof r)throw new TypeError("calendar dayOfWeek result must be a positive integer");if(!st(r)||r<1)throw new RangeError("calendar dayOfWeek result must be a positive integer");return r}function $r(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.dayOfYear%"),r,[t])}const r=nt(rt(e,"dayOfYear"),e,[t]);if("number"!=typeof r)throw new TypeError("calendar dayOfYear result must be a positive integer");if(!st(r)||r<1)throw new RangeError("calendar dayOfYear result must be a positive integer");return r}function Fr(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.weekOfYear%"),r,[t])}const r=nt(rt(e,"weekOfYear"),e,[t]);if("number"!=typeof r)throw new TypeError("calendar weekOfYear result must be a positive integer");if(!st(r)||r<1)throw new RangeError("calendar weekOfYear result must be a positive integer");return r}function Ur(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.yearOfWeek%"),r,[t])}const r=nt(rt(e,"yearOfWeek"),e,[t]);if("number"!=typeof r)throw new TypeError("calendar yearOfWeek result must be an integer");if(!st(r))throw new RangeError("calendar yearOfWeek result must be an integer");return r}function qr(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.daysInWeek%"),r,[t])}const r=nt(rt(e,"daysInWeek"),e,[t]);if("number"!=typeof r)throw new TypeError("calendar daysInWeek result must be a positive integer");if(!st(r)||r<1)throw new RangeError("calendar daysInWeek result must be a positive integer");return r}function Yr(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.daysInMonth%"),r,[t])}const r=nt(rt(e,"daysInMonth"),e,[t]);if("number"!=typeof r)throw new TypeError("calendar daysInMonth result must be a positive integer");if(!st(r)||r<1)throw new RangeError("calendar daysInMonth result must be a positive integer");return r}function Wr(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.daysInYear%"),r,[t])}const r=nt(rt(e,"daysInYear"),e,[t]);if("number"!=typeof r)throw new TypeError("calendar daysInYear result must be a positive integer");if(!st(r)||r<1)throw new RangeError("calendar daysInYear result must be a positive integer");return r}function zr(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.monthsInYear%"),r,[t])}const r=nt(rt(e,"monthsInYear"),e,[t]);if("number"!=typeof r)throw new TypeError("calendar monthsInYear result must be a positive integer");if(!st(r)||r<1)throw new RangeError("calendar monthsInYear result must be a positive integer");return r}function Gr(e,t){if("string"==typeof e){const r=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.inLeapYear%"),r,[t])}const r=nt(rt(e,"inLeapYear"),e,[t]);if("boolean"!=typeof r)throw new TypeError("calendar inLeapYear result must be a boolean");return r}function Jr(e){if(it(e)){if(Z(e,D))return K(e,D);if(!function(e){return!!Dt(e)||"dateAdd"in e&&"dateFromFields"in e&&"dateUntil"in e&&"day"in e&&"dayOfWeek"in e&&"dayOfYear"in e&&"daysInMonth"in e&&"daysInWeek"in e&&"daysInYear"in e&&"fields"in e&&"id"in e&&"inLeapYear"in e&&"mergeFields"in e&&"month"in e&&"monthCode"in e&&"monthDayFromFields"in e&&"monthsInYear"in e&&"weekOfYear"in e&&"year"in e&&"yearMonthFromFields"in e&&"yearOfWeek"in e}(e))throw new TypeError("expected a Temporal.Calendar or object implementing the Temporal.Calendar protocol");return e}const t=lt(e);if(io(t))return oo(t);let r;try{({calendar:r}=Ft(t))}catch{try{({calendar:r}=Ut(t))}catch{({calendar:r}=qt(t))}}if(r||(r="iso8601"),!io(r))throw new RangeError(`invalid calendar identifier ${r}`);return oo(r)}function Hr(e){if(Z(e,D))return K(e,D);const{calendar:t}=e;return void 0===t?"iso8601":Jr(t)}function Vr(e){if("string"==typeof e)return e;const t=e.id;if("string"!=typeof t)throw new TypeError("calendar.id should be a string");return t}function Qr(e){return it(e)?e:new(m("%Temporal.Calendar%"))(e)}function Zr(e,t){return e===t||Vr(e)===Vr(t)}function Kr(e,t,r){if(e===t)return;const n=Vr(e),i=Vr(t);if(n!==i)throw new RangeError(`cannot ${r} of ${n} and ${i} calendars`)}function Xr(e,t){if(e===t)return t;const r=Vr(e),n=Vr(t);if(r===n||"iso8601"===r)return t;if("iso8601"===n)return e;throw new RangeError("irreconcilable calendars")}function en(e,t,r,n){if("string"==typeof e){const n=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.dateFromFields%"),n,[t,r])}const i=nt(n??rt(e,"dateFromFields"),e,[t,r]);if(!Nt(i))throw new TypeError("invalid result");return i}function tn(e,t,r){if("string"==typeof e){const n=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.yearMonthFromFields%"),n,[t,r])}let n=nt(rt(e,"yearMonthFromFields"),e,[t,r]);if(!At(n))throw new TypeError("invalid result");return n}function rn(e,t,r){if("string"==typeof e){const n=new(m("%Temporal.Calendar%"))(e);return nt(m("%Temporal.Calendar.prototype.monthDayFromFields%"),n,[t,r])}let n=nt(rt(e,"monthDayFromFields"),e,[t,r]);if(!Mt(n))throw new TypeError("invalid result");return n}function nn(e){if(it(e)){if(Lt(e))return K(e,A);if(!function(e){return!!kt(e)||"getOffsetNanosecondsFor"in e&&"getPossibleInstantsFor"in e&&"id"in e}(e))throw new TypeError("expected a Temporal.TimeZone or object implementing the Temporal.TimeZone protocol");return e}return function(e){const{ianaName:t,offset:r,z:n}=function(e){if(new RegExp(`^${te.source}$`,"i").test(e))return{ianaName:e};try{const t=Ft(e);if(t.z||t.offset||t.ianaName)return t}catch{}throw new RangeError(`Invalid time zone: ${e}`)}(e);return t?kn(t):n?"UTC":jn(Rn(r))}(lt(e))}function on(e){if("string"==typeof e)return e;const t=e.id;if("string"!=typeof t)throw new TypeError("timeZone.id should be a string");return t}function an(e){return it(e)?e:new(m("%Temporal.TimeZone%"))(e)}function sn(e,t){return e===t||on(e)===on(t)}function ln(e){return wr(K(e,b),K(e,_),K(e,E),K(e,D))}function cn(e){return new(m("%Temporal.PlainTime%"))(K(e,T),K(e,x),K(e,I),K(e,S),K(e,R),K(e,k))}function un(e,t,r){if("string"==typeof e){const r=new(m("%Temporal.TimeZone%"))(e);return nt(m("%Temporal.TimeZone.prototype.getOffsetNanosecondsFor%"),r,[t])}const n=nt(r??rt(e,"getOffsetNanosecondsFor"),e,[t]);if("number"!=typeof n)throw new TypeError("bad return from getOffsetNanosecondsFor");if(!st(n)||Ee(n)>=864e11)throw new RangeError("out-of-range return from getOffsetNanosecondsFor");return n}function dn(e,t){return jn(un(e,t))}function hn(e,t,r){const n=K(t,v),i=un(e,t);let{year:o,month:a,day:s,hour:l,minute:c,second:u,millisecond:d,microsecond:h,nanosecond:f}=Cn(n);return({year:o,month:a,day:s,hour:l,minute:c,second:u,millisecond:d,microsecond:h,nanosecond:f}=Jn(o,a,s,l,c,u,d,h,f+i)),_r(o,a,s,l,c,u,d,h,f,r)}function fn(e,t,r){return pn(mn(e,t),e,t,r)}function pn(e,t,r,n){const i=m("%Temporal.Instant%"),o=e.length;if(1===o)return e[0];if(o)switch(n){case"compatible":case"earlier":return e[0];case"later":return e[o-1];case"reject":throw new RangeError("multiple instants found")}const a=K(r,b),s=K(r,_),l=K(r,E),c=K(r,T),u=K(r,x),h=K(r,I),f=K(r,S),p=K(r,R),y=K(r,k),g=On(a,s,l,c,u,h,f,p,y);if(null===g)throw new RangeError("DateTime outside of supported range");const v=new i(d.subtract(g,ze)),w=new i(d.add(g,ze)),j=un(t,v),N=un(t,w)-j;switch(n){case"earlier":{const e=K(r,D),n=m("%Temporal.PlainDateTime%"),i=ki(a,s,l,c,u,h,f,p,y,e,0,0,0,0,0,0,0,0,0,-N,void 0);return mn(t,new n(i.year,i.month,i.day,i.hour,i.minute,i.second,i.millisecond,i.microsecond,i.nanosecond,e))[0]}case"compatible":case"later":{const e=K(r,D),n=m("%Temporal.PlainDateTime%"),i=ki(a,s,l,c,u,h,f,p,y,e,0,0,0,0,0,0,0,0,0,N,void 0),o=mn(t,new n(i.year,i.month,i.day,i.hour,i.minute,i.second,i.millisecond,i.microsecond,i.nanosecond,e));return o[o.length-1]}case"reject":throw new RangeError("no such instant found")}}function mn(e,t,r){if("string"==typeof e){const r=new(m("%Temporal.TimeZone%"))(e);return nt(m("%Temporal.TimeZone.prototype.getPossibleInstantsFor%"),r,[t])}const n=nt(r??rt(e,"getPossibleInstantsFor"),e,[t]),i=[];for(const e of n){if(!Rt(e))throw new TypeError("bad return from getPossibleInstantsFor");ve.call(i,e)}return i}function yn(e){let t;return t=e<0||e>9999?(e<0?"-":"+")+`000000${Ee(e)}`.slice(-6):`0000${e}`.slice(-4),t}function gn(e){return`00${e}`.slice(-2)}function vn(e,t,r,n,i){if("minute"===i)return"";const o=`:${gn(e)}`;let a,s=1e6*t+1e3*r+n;if("auto"===i){if(0===s)return o;for(a=`${s}`.padStart(9,"0");"0"===a[a.length-1];)a=a.slice(0,-1)}else{if(0===i)return o;a=`${s}`.padStart(9,"0").slice(0,i)}return`${o}.${a}`}function wn(e,t,r){let n=t;void 0===n&&(n="UTC");const i=hn(n,e,"iso8601"),o=yn(K(i,b)),a=gn(K(i,_)),s=gn(K(i,E)),l=gn(K(i,T)),c=gn(K(i,x)),u=vn(K(i,I),K(i,S),K(i,R),K(i,k),r);let d="Z";return void 0!==t&&(d=Nn(un(n,e))),`${o}-${a}-${s}T${l}:${c}${u}${d}`}function bn(e,t="auto",r){function n(e){return e<=je?e.toString(10):d.BigInt(e).toString(10)}const i=K(e,M),o=K(e,L),a=K(e,P),s=K(e,B),l=K(e,$),c=K(e,F);let u=K(e,U),h=K(e,q),f=K(e,Y),p=K(e,W);const m=Wn(i,o,a,s,l,c,u,h,f,p);if(r){const{unit:e,increment:t,roundingMode:n}=r;({seconds:u,milliseconds:h,microseconds:f,nanoseconds:p}=Wi(0,0,0,0,0,0,u,h,f,p,t,e,n))}const y=[];i&&y.push(`${n(Ee(i))}Y`),o&&y.push(`${n(Ee(o))}M`),a&&y.push(`${n(Ee(a))}W`),s&&y.push(`${n(Ee(s))}D`);const g=[];l&&g.push(`${n(Ee(l))}H`),c&&g.push(`${n(Ee(c))}M`);const v=[];let w,b,_,E,T=Vn(0,0,0,u,h,f,p,0);({quotient:T,remainder:w}=ht(T,$e)),({quotient:T,remainder:b}=ht(T,$e)),({quotient:E,remainder:_}=ht(T,$e));const x=1e6*Ee(d.toNumber(_))+1e3*Ee(d.toNumber(b))+Ee(d.toNumber(w));let I;if("auto"===t){if(0!==x)for(I=`${x}`.padStart(9,"0");"0"===I[I.length-1];)I=I.slice(0,-1)}else 0!==t&&(I=`${x}`.padStart(9,"0").slice(0,t));return I&&v.unshift(".",I),d.equal(E,Me)&&!v.length&&"auto"===t||v.unshift(mt(E).toString()),v.length&&g.push(`${v.join("")}S`),g.length&&g.unshift("T"),y.length||g.length?`${m<0?"-":""}P${y.join("")}${g.join("")}`:"PT0S"}function _n(e,t="auto"){return`${yn(K(e,b))}-${gn(K(e,_))}-${gn(K(e,E))}${Bt(K(e,D),t)}`}function En(e,t,r="auto",n){let i=K(e,b),o=K(e,_),a=K(e,E),s=K(e,T),l=K(e,x),c=K(e,I),u=K(e,S),d=K(e,R),h=K(e,k);if(n){const{unit:e,increment:t,roundingMode:r}=n;({year:i,month:o,day:a,hour:s,minute:l,second:c,millisecond:u,microsecond:d,nanosecond:h}=Bi(i,o,a,s,l,c,u,d,h,t,e,r))}return`${yn(i)}-${gn(o)}-${gn(a)}T${gn(s)}:${gn(l)}${vn(c,u,d,h,t)}${Bt(K(e,D),r)}`}function Tn(e,t="auto"){let r=`${gn(K(e,_))}-${gn(K(e,E))}`;const n=Vr(K(e,D));"always"!==t&&"critical"!==t&&"iso8601"===n||(r=`${yn(K(e,b))}-${r}`);const i=$t(n,t);return i&&(r+=i),r}function xn(e,t="auto"){let r=`${yn(K(e,b))}-${gn(K(e,_))}`;const n=Vr(K(e,D));"always"!==t&&"critical"!==t&&"iso8601"===n||(r+=`-${gn(K(e,E))}`);const i=$t(n,t);return i&&(r+=i),r}function In(e,t,r="auto",n="auto",i="auto",o){let a=K(e,C);if(o){const{unit:t,increment:r,roundingMode:n}=o,i=Pi(K(e,v),r,t,n);a=new(m("%Temporal.Instant%"))(i)}const s=K(e,A),l=hn(s,a,"iso8601");let c=`${yn(K(l,b))}-${gn(K(l,_))}-${gn(K(l,E))}T${gn(K(l,T))}:${gn(K(l,x))}${vn(K(l,I),K(l,S),K(l,R),K(l,k),t)}`;return"never"!==i&&(c+=Nn(un(s,a))),"never"!==n&&(c+=`[${"critical"===n?"!":""}${on(s)}]`),c+=Bt(K(e,D),r),c}function Sn(e){return ao.test(De(e))}function Rn(e){const t=ao.exec(De(e));if(!t)throw new RangeError(`invalid time zone offset: ${e}`);return("-"===t[1]||"−"===t[1]?-1:1)*(1e9*(60*(60*+t[2]+ +(t[3]||0))+ +(t[4]||0))+ +((t[5]||0)+"000000000").slice(0,9))}function kn(e){return Sn(e)?jn(Rn(e)):xt(De(e)).resolvedOptions().timeZone}function Dn(e,t){const{year:r,month:n,day:i,hour:o,minute:a,second:s,millisecond:l,microsecond:c,nanosecond:u}=An(e,t),h=r%400,f=(r-h)/400,p=d.multiply(d.BigInt(146097),ze),m=On(h,n,i,o,a,s,l,c,u),y=d.add(m,d.multiply(p,d.BigInt(f)));return d.toNumber(d.subtract(y,t))}function jn(e){const t=e<0?"-":"+",r=Ee(e),n=r%1e9,i=Te(r/1e9)%60,o=Te(r/6e10)%60,a=gn(Te(r/36e11)),s=gn(o),l=gn(i);let c="";if(n){let e=`${n}`.padStart(9,"0");for(;"0"===e[e.length-1];)e=e.slice(0,-1);c=`:${l}.${e}`}else i&&(c=`:${l}`);return`${t}${a}:${s}${c}`}function Nn(e){let t=d.toNumber(Li(d.BigInt(e),We,"halfExpand"));const r=t<0?"-":"+";t=Ee(t);const n=t/6e10%60;return`${r}${gn(Te(t/36e11))}:${gn(n)}`}function On(e,t,r,n,i,o,a,s,l){const c=new Date;c.setUTCHours(n,i,o,a),c.setUTCFullYear(e,t-1,r);const u=c.getTime();if(Se(u))return null;let h=d.multiply(d.BigInt(u),Fe);return h=d.add(h,d.multiply(d.BigInt(s),$e)),h=d.add(h,d.BigInt(l)),d.lessThan(h,Ge)||d.greaterThan(h,Je)?null:h}function Cn(e){const{quotient:t,remainder:r}=ht(e,Fe);let n=d.toNumber(t),i=d.toNumber(r);i<0&&(i+=1e6,n-=1);const o=Te(i/1e3)%1e3,a=i%1e3,s=new Date(n);return{epochMilliseconds:n,year:s.getUTCFullYear(),month:s.getUTCMonth()+1,day:s.getUTCDate(),hour:s.getUTCHours(),minute:s.getUTCMinutes(),second:s.getUTCSeconds(),millisecond:s.getUTCMilliseconds(),microsecond:o,nanosecond:a}}function An(e,t){const{epochMilliseconds:r,millisecond:n,microsecond:i,nanosecond:o}=Cn(t),{year:a,month:s,day:l,hour:c,minute:u,second:d}=function(e,t){return function(e){const t=e.split(/[^\w]+/);if(7!==t.length)throw new RangeError(`expected 7 parts in "${e}`);const r=+t[0],n=+t[1];let i=+t[2];const o=t[3].toUpperCase();if("B"===o||"BC"===o)i=1-i;else if("A"!==o&&"AD"!==o)throw new RangeError(`Unknown era ${o} in "${e}`);let a=+t[4];24===a&&(a=0);const s=+t[5],l=+t[6];if(!(Re(i)&&Re(r)&&Re(n)&&Re(a)&&Re(s)&&Re(l)))throw new RangeError(`Invalid number in "${e}`);return{year:i,month:r,day:n,hour:a,minute:s,second:l}}(xt(e).format(new Date(t)))}(e,r);return Jn(a,s,l,c,u,d,n,i,o)}function Mn(e,t){return d.lessThan(e,t)?t:e}function Ln(){return d.add(Zi(),Ze)}function Pn(e,t){if(d.lessThan(t,Qe))return Pn(e,Qe);const r=d.add(t,Ke),n=Mn(Ln(),r);let i=Mn(Qe,t);const o=Dn(e,i);let a=i,s=o;for(;o===s&&d.lessThan(d.BigInt(i),n);){if(a=d.add(i,Xe),d.greaterThan(a,Je))return null;s=Dn(e,a),o===s&&(i=a)}return o===s?null:so((t=>Dn(e,t)),i,a,o,s)}function Bn(e,t){const r=Ln(),n=d.greaterThan(t,r),i=n?d.subtract(t,Ke):Qe;if("Africa/Casablanca"===e||"Africa/El_Aaiun"===e){const r=K(hr("2088-01-01T00Z"),v);if(d.lessThan(r,t))return Bn(e,r)}let o=d.subtract(t,Le);if(d.lessThan(o,Qe))return null;const a=Dn(e,o);let s=o,l=a;for(;a===l&&d.greaterThan(o,i);){if(s=d.subtract(o,Xe),d.lessThan(s,Qe))return null;l=Dn(e,s),a===l&&(o=s)}if(a===l){if(n){const t=d.subtract(r,ze);return Bn(e,t)}return null}return so((t=>Dn(e,t)),s,o,l,a)}function $n(e){return void 0!==e&&!(e%4!=0||e%100==0&&e%400!=0)}function Fn(e,t){return{standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]}[$n(e)?"leapyear":"standard"][t-1]}function Un(e,t,r){const n=t+(t<3?10:-2),i=e-(t<3?1:0),o=Te(i/100),a=i-100*o,s=(r+Te(2.6*n-.2)+(a+Te(a/4))+(Te(o/4)-2*o))%7;return s+(s<=0?7:0)}function qn(e,t,r){let n=r;for(let r=t-1;r>0;r--)n+=Fn(e,r);return n}function Yn(e,t,r){const n=qn(e,t,r),i=Un(e,t,r)||7,o=Un(e,1,1),a=Te((n-i+10)/7);return a<1?5===o||6===o&&$n(e-1)?{week:53,year:e-1}:{week:52,year:e-1}:53===a&&($n(e)?366:365)-n<4-i?{week:1,year:e+1}:{week:a,year:e}}function Wn(e,t,r,n,i,o,a,s,l,c){for(const u of[e,t,r,n,i,o,a,s,l,c])if(0!==u)return u<0?-1:1;return 0}function zn(e,t){let r=e,n=t;if(!Re(r)||!Re(n))throw new RangeError("infinity is out of range");return n-=1,r+=Te(n/12),n%=12,n<0&&(n+=12),n+=1,{year:r,month:n}}function Gn(e,t,r){let n=e,i=t,o=r;if(!Re(o))throw new RangeError("infinity is out of range");({year:n,month:i}=zn(n,i));const a=146097;if(Ee(o)>a){const e=Ie(o/a);n+=400*e,o-=e*a}let s=0,l=i>2?n:n-1;for(;s=$n(l)?366:365,o<-s;)n-=1,l-=1,o+=s;for(l+=1;s=$n(l)?366:365,o>s;)n+=1,l+=1,o-=s;for(;o<1;)({year:n,month:i}=zn(n,i-1)),o+=Fn(n,i);for(;o>Fn(n,i);)o-=Fn(n,i),({year:n,month:i}=zn(n,i+1));return{year:n,month:i,day:o}}function Jn(e,t,r,n,i,o,a,s,l){const{deltaDays:c,hour:u,minute:d,second:h,millisecond:f,microsecond:p,nanosecond:m}=Hn(n,i,o,a,s,l),{year:y,month:g,day:v}=Gn(e,t,r+c);return{year:y,month:g,day:v,hour:u,minute:d,second:h,millisecond:f,microsecond:p,nanosecond:m}}function Hn(e,t,r,n,i,o){let a,s=d.BigInt(e),l=d.BigInt(t),c=d.BigInt(r),u=d.BigInt(n),h=d.BigInt(i),f=d.BigInt(o);return({quotient:a,remainder:f}=Gi(f,$e)),h=d.add(h,a),({quotient:a,remainder:h}=Gi(h,$e)),u=d.add(u,a),({quotient:a,remainder:u}=Gi(u,$e)),c=d.add(c,a),({quotient:a,remainder:c}=Gi(c,Pe)),l=d.add(l,a),({quotient:a,remainder:l}=Gi(l,Pe)),s=d.add(s,a),({quotient:a,remainder:s}=Gi(s,Be)),{deltaDays:d.toNumber(a),hour:d.toNumber(s),minute:d.toNumber(l),second:d.toNumber(c),millisecond:d.toNumber(u),microsecond:d.toNumber(h),nanosecond:d.toNumber(f)}}function Vn(e,t,r,n,i,o,a,s){const l=d.BigInt(e);let c=d.BigInt(a);0!==e&&(c=d.subtract(d.BigInt(a),d.BigInt(s)));const u=d.add(d.BigInt(t),d.multiply(l,d.BigInt(24))),h=d.add(d.BigInt(r),d.multiply(u,Pe)),f=d.add(d.BigInt(n),d.multiply(h,Pe)),p=d.add(d.BigInt(i),d.multiply(f,$e)),m=d.add(d.BigInt(o),d.multiply(p,$e));return d.add(d.BigInt(c),d.multiply(m,$e))}function Qn(e,t){const r=m("%Temporal.Instant%"),n=xe(d.toNumber(e));let i=d.BigInt(e),o=864e11;if(0===n)return{days:0,nanoseconds:Me,dayLengthNs:o};if(!Lt(t)){let e;return({quotient:e,remainder:i}=ht(i,d.BigInt(o))),{days:d.toNumber(e),nanoseconds:i,dayLengthNs:o}}const a=K(t,v),s=K(t,C),l=d.add(a,i),c=new r(l),u=K(t,A),h=K(t,D),f=hn(u,s,h),p=hn(u,c,h);let{days:y}=mi(K(f,b),K(f,_),K(f,E),K(f,T),K(f,x),K(f,I),K(f,S),K(f,R),K(f,k),K(p,b),K(p,_),K(p,E),K(p,T),K(p,x),K(p,I),K(p,S),K(p,R),K(p,k),h,"day",Ne(null)),g=Di(s,u,h,0,0,0,y,0,0,0,0,0,0),w=d.BigInt(y);if(1===n)for(;d.greaterThan(w,Me)&&d.greaterThan(g,l);)w=d.subtract(w,Le),g=Di(s,u,h,0,0,0,d.toNumber(w),0,0,0,0,0,0);i=d.subtract(l,g);let j=!1,N=new r(g);do{const e=Di(N,u,h,0,0,0,n,0,0,0,0,0,0),t=K(N,v);o=d.toNumber(d.subtract(e,t)),j=d.greaterThanOrEqual(d.multiply(d.subtract(i,d.BigInt(o)),d.BigInt(n)),Me),j&&(i=d.subtract(i,d.BigInt(o)),N=new r(e),w=d.add(w,d.BigInt(n)))}while(j);if(!tt(w)&&pt(w)!==n)throw new RangeError("Time zone or calendar converted nanoseconds into a number of days with the opposite sign");if(!tt(i)&&pt(i)!==n){if(ft(i)&&1===n)throw new Error("assert not reached");throw new RangeError("Time zone or calendar ended up with a remainder of nanoseconds with the opposite sign")}if(d.greaterThanOrEqual(mt(i),mt(d.BigInt(o))))throw new Error("assert not reached");return{days:d.toNumber(w),nanoseconds:i,dayLengthNs:Ee(o)}}function Zn(e,t,r,n,i,o,a,s,l){let c=Kn(e,t,r,n,i,o,a,s,l);if("positive overflow"===c||"negative overflow"===c)throw new RangeError("Duration out of range");return c}function Kn(e,t,r,n,i,o,a,s,l){let c,u,h,f,p,m,y=e;if(Lt(l)){const e=Di(K(l,C),K(l,A),K(l,D),0,0,0,y,t,r,n,i,o,a),s=K(l,v);c=d.subtract(e,s)}else c=Vn(y,t,r,n,i,o,a,0);"year"===s||"month"===s||"week"===s||"day"===s?({days:y,nanoseconds:c}=Qn(c,l)):y=0;const g=d.lessThan(c,Me)?-1:1;switch(c=mt(c),u=h=f=p=m=Me,s){case"year":case"month":case"week":case"day":case"hour":({quotient:u,remainder:c}=ht(c,$e)),({quotient:h,remainder:u}=ht(u,$e)),({quotient:f,remainder:h}=ht(h,$e)),({quotient:p,remainder:f}=ht(f,Pe)),({quotient:m,remainder:p}=ht(p,Pe));break;case"minute":({quotient:u,remainder:c}=ht(c,$e)),({quotient:h,remainder:u}=ht(u,$e)),({quotient:f,remainder:h}=ht(h,$e)),({quotient:p,remainder:f}=ht(f,Pe));break;case"second":({quotient:u,remainder:c}=ht(c,$e)),({quotient:h,remainder:u}=ht(u,$e)),({quotient:f,remainder:h}=ht(h,$e));break;case"millisecond":({quotient:u,remainder:c}=ht(c,$e)),({quotient:h,remainder:u}=ht(u,$e));break;case"microsecond":({quotient:u,remainder:c}=ht(c,$e));break;case"nanosecond":break;default:throw new Error("assert not reached")}const w=d.toNumber(m)*g,b=d.toNumber(p)*g,_=d.toNumber(f)*g,E=d.toNumber(h)*g,T=d.toNumber(u)*g,x=d.toNumber(c)*g;for(const e of[y,w,b,_,E,T,x])if(!Re(e))return 1===g?"positive overflow":"negative overflow";return{days:y,hours:w,minutes:b,seconds:_,milliseconds:E,microseconds:T,nanoseconds:x}}function Xn(e,t,r,n,i,o){const a=m("%Temporal.Duration%"),s=Wn(e,t,r,n,0,0,0,0,0,0);if(0===s)return{years:e,months:t,weeks:r,days:n};const l=d.BigInt(s);let c,u,h=d.BigInt(e),f=d.BigInt(t),p=d.BigInt(r),y=d.BigInt(n);o&&(u=lr(o),c=K(u,D));const g=new a(s),v=new a(0,s),w=new a(0,0,s);switch(i){case"year":break;case"month":{if(!c)throw new RangeError("a starting point is required for months balancing");let e,t;for("string"!=typeof c&&(e=rt(c,"dateAdd"),t=rt(c,"dateUntil"));!tt(h);){const r=jr(c,u,g,void 0,e),n=Ne(null);n.largestUnit="month";const i=Nr(c,u,r,n,t),o=d.BigInt(K(i,L));u=r,f=d.add(f,o),h=d.subtract(h,l)}}break;case"week":{if(!c)throw new RangeError("a starting point is required for weeks balancing");const e="string"!=typeof c?rt(c,"dateAdd"):void 0;for(;!tt(h);){let t;({relativeTo:u,days:t}=Ui(c,u,g,e)),y=d.add(y,d.BigInt(t)),h=d.subtract(h,l)}for(;!tt(f);){let t;({relativeTo:u,days:t}=Ui(c,u,v,e)),y=d.add(y,d.BigInt(t)),f=d.subtract(f,l)}break}default:{if(tt(h)&&tt(f)&&tt(p))break;if(!c)throw new RangeError("a starting point is required for balancing calendar units");const e="string"!=typeof c?rt(c,"dateAdd"):void 0;for(;!tt(h);){let t;({relativeTo:u,days:t}=Ui(c,u,g,e)),y=d.add(y,d.BigInt(t)),h=d.subtract(h,l)}for(;!tt(f);){let t;({relativeTo:u,days:t}=Ui(c,u,v,e)),y=d.add(y,d.BigInt(t)),f=d.subtract(f,l)}for(;!tt(p);){let t;({relativeTo:u,days:t}=Ui(c,u,w,e)),y=d.add(y,d.BigInt(t)),p=d.subtract(p,l)}break}}return{years:d.toNumber(h),months:d.toNumber(f),weeks:d.toNumber(p),days:d.toNumber(y)}}function ei(e,t,r,n,i){if(Lt(e)){const o=K(e,C),a=K(e,A),s=K(e,D),l=un(a,o),c=Di(o,a,s,t,r,n,i,0,0,0,0,0,0);return un(a,new(m("%Temporal.Instant%"))(c))-l}return 0}function ti(e){return new(m("%Temporal.Duration%"))(-K(e,M),-K(e,L),-K(e,P),-K(e,B),-K(e,$),-K(e,F),-K(e,U),-K(e,q),-K(e,Y),-K(e,W))}function ri(e,t,r){return be(r,_e(t,e))}function ni(e,t,r){const n=ri(t,1,12);return{year:e,month:n,day:ri(r,1,Fn(e,n))}}function ii(e,t,r){if(e<t||e>r)throw new RangeError(`value out of range: ${t} <= ${e} <= ${r}`)}function oi(e,t,r){ii(t,1,12),ii(r,1,Fn(e,t))}function ai(e,t,r){ci(e,t,r,12,0,0,0,0,0)}function si(e,t,r,n,i,o){ii(e,0,23),ii(t,0,59),ii(r,0,59),ii(n,0,999),ii(i,0,999),ii(o,0,999)}function li(e,t,r,n,i,o,a,s,l){oi(e,t,r),si(n,i,o,a,s,l)}function ci(e,t,r,n,i,o,a,s,l){if(ii(e,He,Ve),e===He&&null==On(e,t,r+1,n,i,o,a,s,l-1)||e===Ve&&null==On(e,t,r-1,n,i,o,a,s,l+1))throw new RangeError("DateTime outside of supported range")}function ui(e){if(d.lessThan(e,Ge)||d.greaterThan(e,Je))throw new RangeError("Instant outside of supported range")}function di(e,t,r,n,i,o,a,s,l,c){const u=Wn(e,t,r,n,i,o,a,s,l,c);for(const d of[e,t,r,n,i,o,a,s,l,c]){if(!Re(d))throw new RangeError("infinite values not allowed as duration fields");const e=xe(d);if(0!==e&&e!==u)throw new RangeError("mixed-sign values not allowed as duration fields")}}function hi(e,t,r,n,i,o,a){switch(a){case"year":case"month":{const s=-zi(e,t,r,n,i,o);if(0===s)return{years:0,months:0,weeks:0,days:0};const l={year:e,month:t,day:r},c={year:n,month:i,day:o};let u=c.year-l.year,d=xi(e,t,r,u,0,0,0,"constrain"),h=-zi(d.year,d.month,d.day,n,i,o);if(0===h)return"year"===a?{years:u,months:0,weeks:0,days:0}:{years:0,months:12*u,weeks:0,days:0};let f=c.month-l.month;if(h!==s&&(u-=s,f+=12*s),d=xi(e,t,r,u,f,0,0,"constrain"),h=-zi(d.year,d.month,d.day,n,i,o),0===h)return"year"===a?{years:u,months:f,weeks:0,days:0}:{years:0,months:f+12*u,weeks:0,days:0};h!==s&&(f-=s,f===-s&&(u-=s,f=11*s),d=xi(e,t,r,u,f,0,0,"constrain"));let p=0;return p=d.month===c.month?c.day-d.day:s<0?-d.day-(Fn(c.year,c.month)-c.day):c.day+(Fn(d.year,d.month)-d.day),"month"===a&&(f+=12*u,u=0),{years:u,months:f,weeks:0,days:p}}case"week":case"day":{let s,l,c;zi(e,t,r,n,i,o)<0?(l={year:e,month:t,day:r},s={year:n,month:i,day:o},c=1):(l={year:n,month:i,day:o},s={year:e,month:t,day:r},c=-1);let u=qn(s.year,s.month,s.day)-qn(l.year,l.month,l.day);for(let e=l.year;e<s.year;++e)u+=$n(e)?366:365;let d=0;return"week"===a&&(d=Te(u/7),u%=7),d*=c,u*=c,{years:0,months:0,weeks:d,days:u}}default:throw new Error("assert not reached")}}function fi(e,t,r,n,i,o,a,s,l,c,u,d){let h=a-e,f=s-t,p=l-r,m=c-n,y=u-i,g=d-o;const v=Wn(0,0,0,0,h,f,p,m,y,g);h*=v,f*=v,p*=v,m*=v,y*=v,g*=v;let w=0;if(({deltaDays:w,hour:h,minute:f,second:p,millisecond:m,microsecond:y,nanosecond:g}=Hn(h,f,p,m,y,g)),0!=w)throw new Error("assertion failure in DifferenceTime: _bt_.[[Days]] should be 0");return h*=v,f*=v,p*=v,m*=v,y*=v,g*=v,{hours:h,minutes:f,seconds:p,milliseconds:m,microseconds:y,nanoseconds:g}}function pi(e,t,r,n,i,o){const a=d.subtract(t,e);let s=0,l=0,c=d.toNumber(d.remainder(a,$e)),u=d.toNumber(d.remainder(d.divide(a,$e),$e)),h=d.toNumber(d.remainder(d.divide(a,Fe),$e)),f=d.toNumber(d.divide(a,Ue));return({hours:s,minutes:l,seconds:f,milliseconds:h,microseconds:u,nanoseconds:c}=Wi(0,0,0,0,0,0,f,h,u,c,r,n,o)),Zn(0,s,l,f,h,u,c,i)}function mi(e,t,r,n,i,o,a,s,l,c,u,d,h,f,p,m,y,g,v,w,b){let _=e,E=t,T=r,{hours:x,minutes:I,seconds:S,milliseconds:R,microseconds:k,nanoseconds:D}=fi(n,i,o,a,s,l,h,f,p,m,y,g);const j=Wn(0,0,0,0,x,I,S,R,k,D);zi(c,u,d,_,E,T)===-j&&(({year:_,month:E,day:T}=Gn(_,E,T-j)),({hours:x,minutes:I,seconds:S,milliseconds:R,microseconds:k,nanoseconds:D}=Zn(-j,x,I,S,R,k,D,w)));const N=wr(_,E,T,v),O=wr(c,u,d,v),C=or("day",w),A=ro(b);A.largestUnit=C;let{years:M,months:L,weeks:P,days:B}=Nr(v,N,O,A);return({days:B,hours:x,minutes:I,seconds:S,milliseconds:R,microseconds:k,nanoseconds:D}=Zn(B,x,I,S,R,k,D,w)),{years:M,months:L,weeks:P,days:B,hours:x,minutes:I,seconds:S,milliseconds:R,microseconds:k,nanoseconds:D}}function yi(e,t,r,n,i,o){const a=d.subtract(t,e);if(d.equal(a,Me))return{years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};const s=m("%Temporal.Instant%"),l=new s(e),c=new s(t),u=hn(r,l,n),h=hn(r,c,n);let{years:f,months:p,weeks:y,days:g}=mi(K(u,b),K(u,_),K(u,E),K(u,T),K(u,x),K(u,I),K(u,S),K(u,R),K(u,k),K(h,b),K(h,_),K(h,E),K(h,T),K(h,x),K(h,I),K(h,S),K(h,R),K(h,k),n,i,o);const v=Di(l,r,n,f,p,y,0,0,0,0,0,0,0);let w=d.subtract(t,v);const D=Rr(v,r,n);({nanoseconds:w,days:g}=Qn(w,D));const{hours:j,minutes:N,seconds:O,milliseconds:C,microseconds:A,nanoseconds:M}=Zn(0,0,0,0,0,0,d.toNumber(w),"hour");return{years:f,months:p,weeks:y,days:g,hours:j,minutes:N,seconds:O,milliseconds:C,microseconds:A,nanoseconds:M}}function gi(e,t,r,n,i,o){const a=vt.reduce(((e,t)=>{const i=t[0],o=t[1],a=t[2];return"datetime"!==r&&a!==r||n.includes(o)||e.push(o,i),e}),[]);let s=rr(t,"largestUnit",r,"auto");if(n.includes(s))throw new RangeError(`largestUnit must be one of ${a.join(", ")}, not ${s}`);const l=Zt(t);let c=Ht(t,"trunc");"since"===e&&(c=function(e){switch(e){case"ceil":return"floor";case"floor":return"ceil";case"halfCeil":return"halfFloor";case"halfFloor":return"halfCeil";default:return e}}(c));const u=rr(t,"smallestUnit",r,i);if(n.includes(u))throw new RangeError(`smallestUnit must be one of ${a.join(", ")}, not ${u}`);const d=or(o,u);if("auto"===s&&(s=d),or(s,u)!==s)throw new RangeError(`largestUnit ${s} cannot be smaller than smallestUnit ${u}`);const h={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[u];return void 0!==h&&Kt(l,h,!1),{largestUnit:s,roundingIncrement:l,roundingMode:c,smallestUnit:u}}function vi(e,t,r,n){const i="since"===e?-1:1,o=hr(r),a=gi(e,ro(n),"time",[],"nanosecond","second"),s=K(t,v),l=K(o,v);let{hours:c,minutes:u,seconds:d,milliseconds:h,microseconds:f,nanoseconds:p}=pi(s,l,a.roundingIncrement,a.smallestUnit,a.largestUnit,a.roundingMode);return new(m("%Temporal.Duration%"))(0,0,0,0,i*c,i*u,i*d,i*h,i*f,i*p)}function wi(e,t,r,n){const i="since"===e?-1:1,o=lr(r),a=K(t,D);Kr(a,K(o,D),"compute difference between dates");const s=ro(n),l=gi(e,s,"date",[],"day","day");s.largestUnit=l.largestUnit;let{years:c,months:u,weeks:d,days:h}=Nr(a,t,o,s);return"day"===l.smallestUnit&&1===l.roundingIncrement||({years:c,months:u,weeks:d,days:h}=Wi(c,u,d,h,0,0,0,0,0,0,l.roundingIncrement,l.smallestUnit,l.roundingMode,t)),new(m("%Temporal.Duration%"))(i*c,i*u,i*d,i*h,0,0,0,0,0,0)}function bi(e,t,r,n){const i="since"===e?-1:1,o=ur(r),a=K(t,D);Kr(a,K(o,D),"compute difference between dates");const s=ro(n),l=gi(e,s,"datetime",[],"nanosecond","day");let{years:c,months:u,weeks:d,days:h,hours:f,minutes:p,seconds:y,milliseconds:g,microseconds:v,nanoseconds:w}=mi(K(t,b),K(t,_),K(t,E),K(t,T),K(t,x),K(t,I),K(t,S),K(t,R),K(t,k),K(o,b),K(o,_),K(o,E),K(o,T),K(o,x),K(o,I),K(o,S),K(o,R),K(o,k),a,l.largestUnit,s);const j=ln(t);return({years:c,months:u,weeks:d,days:h,hours:f,minutes:p,seconds:y,milliseconds:g,microseconds:v,nanoseconds:w}=Wi(c,u,d,h,f,p,y,g,v,w,l.roundingIncrement,l.smallestUnit,l.roundingMode,j)),({days:h,hours:f,minutes:p,seconds:y,milliseconds:g,microseconds:v,nanoseconds:w}=Zn(h,f,p,y,g,v,w,l.largestUnit)),new(m("%Temporal.Duration%"))(i*c,i*u,i*d,i*h,i*f,i*p,i*y,i*g,i*v,i*w)}function _i(e,t,r,n){const i="since"===e?-1:1,o=pr(r),a=gi(e,ro(n),"time",[],"nanosecond","hour");let{hours:s,minutes:l,seconds:c,milliseconds:u,microseconds:d,nanoseconds:h}=fi(K(t,T),K(t,x),K(t,I),K(t,S),K(t,R),K(t,k),K(o,T),K(o,x),K(o,I),K(o,S),K(o,R),K(o,k));return({hours:s,minutes:l,seconds:c,milliseconds:u,microseconds:d,nanoseconds:h}=Wi(0,0,0,0,s,l,c,u,d,h,a.roundingIncrement,a.smallestUnit,a.roundingMode)),({hours:s,minutes:l,seconds:c,milliseconds:u,microseconds:d,nanoseconds:h}=Zn(0,s,l,c,u,d,h,a.largestUnit)),new(m("%Temporal.Duration%"))(0,0,0,0,i*s,i*l,i*c,i*u,i*d,i*h)}function Ei(e,t,r,n){const i="since"===e?-1:1,o=mr(r),a=K(t,D);Kr(a,K(o,D),"compute difference between months");const s=ro(n),l=gi(e,s,"date",["week","day"],"month","year");s.largestUnit=l.largestUnit;const c=kr(a,["monthCode","year"]),u=ar(t,c,[]);u.day=1;const d=en(a,u),h=ar(o,c,[]);h.day=1;const f=en(a,h);let{years:p,months:y}=Nr(a,d,f,s);return"month"===l.smallestUnit&&1===l.roundingIncrement||({years:p,months:y}=Wi(p,y,0,0,0,0,0,0,0,0,l.roundingIncrement,l.smallestUnit,l.roundingMode,d)),new(m("%Temporal.Duration%"))(i*p,i*y,0,0,0,0,0,0,0,0)}function Ti(e,t,r,n){const i="since"===e?-1:1,o=gr(r),a=K(t,D);Kr(a,K(o,D),"compute difference between dates");const s=ro(n),l=gi(e,s,"datetime",[],"nanosecond","hour");s.largestUnit=l.largestUnit;const c=K(t,v),u=K(o,v);let d,h,f,p,y,g,w,b,_,E;if("year"!==l.largestUnit&&"month"!==l.largestUnit&&"week"!==l.largestUnit&&"day"!==l.largestUnit)d=0,h=0,f=0,p=0,({hours:y,minutes:g,seconds:w,milliseconds:b,microseconds:_,nanoseconds:E}=pi(c,u,l.roundingIncrement,l.smallestUnit,l.largestUnit,l.roundingMode));else{const e=K(t,A);if(!sn(e,K(o,A)))throw new RangeError("When calculating difference between time zones, largestUnit must be 'hours' or smaller because day lengths can vary between time zones due to DST or time zone offset changes.");({years:d,months:h,weeks:f,days:p,hours:y,minutes:g,seconds:w,milliseconds:b,microseconds:_,nanoseconds:E}=yi(c,u,e,a,l.largestUnit,s)),({years:d,months:h,weeks:f,days:p,hours:y,minutes:g,seconds:w,milliseconds:b,microseconds:_,nanoseconds:E}=Wi(d,h,f,p,y,g,w,b,_,E,l.roundingIncrement,l.smallestUnit,l.roundingMode,t)),({years:d,months:h,weeks:f,days:p,hours:y,minutes:g,seconds:w,milliseconds:b,microseconds:_,nanoseconds:E}=Yi(d,h,f,p,y,g,w,b,_,E,l.roundingIncrement,l.smallestUnit,l.roundingMode,t))}return new(m("%Temporal.Duration%"))(i*d,i*h,i*f,i*p,i*y,i*g,i*w,i*b,i*_,i*E)}function xi(e,t,r,n,i,o,a,s){let l=e,c=t,u=r,d=o,h=a;return l+=n,c+=i,({year:l,month:c}=zn(l,c)),({year:l,month:c,day:u}=Yt(l,c,u,s)),h+=7*d,u+=h,({year:l,month:c,day:u}=Gn(l,c,u)),{year:l,month:c,day:u}}function Ii(e,t,r,n,i,o,a,s,l,c,u,d){let h=e,f=t,p=r,m=n,y=i,g=o;h+=a,f+=s,p+=l,m+=c,y+=u,g+=d;let v=0;return({deltaDays:v,hour:h,minute:f,second:p,millisecond:m,microsecond:y,nanosecond:g}=Hn(h,f,p,m,y,g)),{deltaDays:v,hour:h,minute:f,second:p,millisecond:m,microsecond:y,nanosecond:g}}function Si(e,t,r,n,i,o,a,s,l,c,u,h,f,p,y,g,w,b,_,E,T){const x=or(ir(e,t,r,n,i,o,a,s,l,c),ir(u,h,f,p,y,g,w,b,_,E));let I,S,R,k,j,N,O,M,L,P;if(T)if(Nt(T)){const v=m("%Temporal.Duration%"),C=K(T,D),A=new v(e,t,r,n,0,0,0,0,0,0),B=new v(u,h,f,p,0,0,0,0,0,0),$="string"!=typeof C?rt(C,"dateAdd"):void 0,F=jr(C,T,A,void 0,$),U=jr(C,F,B,void 0,$),q=or("day",x),Y=Ne(null);Y.largestUnit=q,({years:I,months:S,weeks:R,days:k}=Nr(C,T,U,Y)),({days:k,hours:j,minutes:N,seconds:O,milliseconds:M,microseconds:L,nanoseconds:P}=Zn(k,d.add(d.BigInt(i),d.BigInt(y)),d.add(d.BigInt(o),d.BigInt(g)),d.add(d.BigInt(a),d.BigInt(w)),d.add(d.BigInt(s),d.BigInt(b)),d.add(d.BigInt(l),d.BigInt(_)),d.add(d.BigInt(c),d.BigInt(E)),x))}else{const d=m("%Temporal.Instant%"),B=K(T,A),$=K(T,D),F=Di(K(T,C),B,$,e,t,r,n,i,o,a,s,l,c),U=Di(new d(F),B,$,u,h,f,p,y,g,w,b,_,E);"year"!==x&&"month"!==x&&"week"!==x&&"day"!==x?(I=0,S=0,R=0,k=0,({hours:j,minutes:N,seconds:O,milliseconds:M,microseconds:L,nanoseconds:P}=pi(K(T,v),U,1,"nanosecond",x,"halfExpand"))):({years:I,months:S,weeks:R,days:k,hours:j,minutes:N,seconds:O,milliseconds:M,microseconds:L,nanoseconds:P}=yi(K(T,v),U,B,$,x,Ne(null)))}else{if("year"===x||"month"===x||"week"===x)throw new RangeError("relativeTo is required for years, months, or weeks arithmetic");I=S=R=0,({days:k,hours:j,minutes:N,seconds:O,milliseconds:M,microseconds:L,nanoseconds:P}=Zn(n+p,d.add(d.BigInt(i),d.BigInt(y)),d.add(d.BigInt(o),d.BigInt(g)),d.add(d.BigInt(a),d.BigInt(w)),d.add(d.BigInt(s),d.BigInt(b)),d.add(d.BigInt(l),d.BigInt(_)),d.add(d.BigInt(c),d.BigInt(E)),x))}return di(I,S,R,k,j,N,O,M,L,P),{years:I,months:S,weeks:R,days:k,hours:j,minutes:N,seconds:O,milliseconds:M,microseconds:L,nanoseconds:P}}function Ri(e,t,r,n,i,o,a){let s=Me;s=d.add(s,d.BigInt(a)),s=d.add(s,d.multiply(d.BigInt(o),$e)),s=d.add(s,d.multiply(d.BigInt(i),Fe)),s=d.add(s,d.multiply(d.BigInt(n),Ue)),s=d.add(s,d.multiply(d.BigInt(r),d.BigInt(6e10))),s=d.add(s,d.multiply(d.BigInt(t),d.BigInt(36e11)));const l=d.add(e,s);return ui(l),l}function ki(e,t,r,n,i,o,a,s,l,c,u,d,h,f,p,y,g,v,w,T,x){let I=f,{deltaDays:S,hour:R,minute:k,second:D,millisecond:j,microsecond:N,nanosecond:O}=Ii(n,i,o,a,s,l,p,y,g,v,w,T);I+=S;const C=m("%Temporal.Duration%"),A=jr(c,wr(e,t,r,c),new C(u,d,h,I,0,0,0,0,0,0),x);return{year:K(A,b),month:K(A,_),day:K(A,E),hour:R,minute:k,second:D,millisecond:j,microsecond:N,nanosecond:O}}function Di(e,t,r,n,i,o,a,s,l,c,u,d,h,f){const p=m("%Temporal.Duration%");if(0===Wn(n,i,o,a,0,0,0,0,0,0))return Ri(K(e,v),s,l,c,u,d,h);const y=hn(t,e,r),g=jr(r,wr(K(y,b),K(y,_),K(y,E),r),new p(n,i,o,a,0,0,0,0,0,0),f),w=_r(K(g,b),K(g,_),K(g,E),K(y,T),K(y,x),K(y,I),K(y,S),K(y,R),K(y,k),r);return Ri(K(fn(t,w,"compatible"),v),s,l,c,u,d,h)}function ji(e,t,r,n){const i="subtract"===e?-1:1;let{years:o,months:a,weeks:s,days:l,hours:c,minutes:u,seconds:d,milliseconds:h,microseconds:f,nanoseconds:p}=zt(r);const y=nr(eo(n));return({years:o,months:a,weeks:s,days:l,hours:c,minutes:u,seconds:d,milliseconds:h,microseconds:f,nanoseconds:p}=Si(K(t,M),K(t,L),K(t,P),K(t,B),K(t,$),K(t,F),K(t,U),K(t,q),K(t,Y),K(t,W),i*o,i*a,i*s,i*l,i*c,i*u,i*d,i*h,i*f,i*p,y)),new(m("%Temporal.Duration%"))(o,a,s,l,c,u,d,h,f,p)}function Ni(e,t,r){const n="subtract"===e?-1:1,{hours:i,minutes:o,seconds:a,milliseconds:s,microseconds:l,nanoseconds:c}=function(e,t){let r=zt(e);for(const e of t)if(0!==r[e])throw new RangeError(`Duration field ${e} not supported by Temporal.Instant. Try Temporal.ZonedDateTime instead.`);return r}(r,["years","months","weeks","days"]),u=Ri(K(t,v),n*i,n*o,n*a,n*s,n*l,n*c);return new(m("%Temporal.Instant%"))(u)}function Oi(e,t,r,n){const i="subtract"===e?-1:1,{years:o,months:a,weeks:s,days:l,hours:c,minutes:u,seconds:d,milliseconds:h,microseconds:f,nanoseconds:p}=zt(r),m=eo(n),y=K(t,D),{year:g,month:v,day:w,hour:j,minute:N,second:O,millisecond:C,microsecond:A,nanosecond:M}=ki(K(t,b),K(t,_),K(t,E),K(t,T),K(t,x),K(t,I),K(t,S),K(t,R),K(t,k),y,i*o,i*a,i*s,i*l,i*c,i*u,i*d,i*h,i*f,i*p,m);return _r(g,v,w,j,N,O,C,A,M,y)}function Ci(e,t,r){const n="subtract"===e?-1:1,{hours:i,minutes:o,seconds:a,milliseconds:s,microseconds:l,nanoseconds:c}=zt(r);let{hour:u,minute:d,second:h,millisecond:f,microsecond:p,nanosecond:y}=Ii(K(t,T),K(t,x),K(t,I),K(t,S),K(t,R),K(t,k),n*i,n*o,n*a,n*s,n*l,n*c);return({hour:u,minute:d,second:h,millisecond:f,microsecond:p,nanosecond:y}=Wt(u,d,h,f,p,y,"reject")),new(m("%Temporal.PlainTime%"))(u,d,h,f,p,y)}function Ai(e,t,r,n){let i=zt(r);"subtract"===e&&(i={years:-i.years,months:-i.months,weeks:-i.weeks,days:-i.days,hours:-i.hours,minutes:-i.minutes,seconds:-i.seconds,milliseconds:-i.milliseconds,microseconds:-i.microseconds,nanoseconds:-i.nanoseconds});let{years:o,months:a,weeks:s,days:l,hours:c,minutes:u,seconds:d,milliseconds:h,microseconds:f,nanoseconds:p}=i;({days:l}=Zn(l,c,u,d,h,f,p,"day"));const y=eo(n),g=K(t,D),v=kr(g,["monthCode","year"]),w=ar(t,v,[]),b=Ne(null);St(b,w,[]),w.day=1;let _=en(g,w);const E=Wn(o,a,s,l,0,0,0,0,0,0),T=rt(g,"dateAdd"),x=m("%Temporal.Duration%");if(E<0){const e=jr(g,_,new x(0,1,0,0,0,0,0,0,0,0),void 0,T),t=jr(g,e,new x(0,0,0,-1,0,0,0,0,0,0),void 0,T);b.day=Mr(g,t),_=en(g,b)}const I=new x(o,a,s,l,0,0,0,0,0,0),S=ro(y);return tn(g,ar(jr(g,_,I,y,T),v,[]),S)}function Mi(e,t,r,n){const i="subtract"===e?-1:1,{years:o,months:a,weeks:s,days:l,hours:c,minutes:u,seconds:d,milliseconds:h,microseconds:f,nanoseconds:p}=zt(r),m=eo(n),y=K(t,A),g=K(t,D);return Rr(Di(K(t,C),y,g,i*o,i*a,i*s,i*l,i*c,i*u,i*d,i*h,i*f,i*p,m),y,g)}function Li(e,t,r){if(d.equal(t,Le))return e;let{quotient:n,remainder:i}=ht(e,t);if(d.equal(i,Me))return e;const o=d.lessThan(i,Me)?-1:1,a=mt(d.multiply(i,d.BigInt(2))),s=d.equal(a,t),l=d.greaterThan(a,t);switch(r){case"ceil":o>0&&(n=d.add(n,d.BigInt(o)));break;case"floor":o<0&&(n=d.add(n,d.BigInt(o)));break;case"expand":n=d.add(n,d.BigInt(o));break;case"trunc":break;case"halfCeil":(l||s&&o>0)&&(n=d.add(n,d.BigInt(o)));break;case"halfFloor":(l||s&&o<0)&&(n=d.add(n,d.BigInt(o)));break;case"halfExpand":(l||s)&&(n=d.add(n,d.BigInt(o)));break;case"halfTrunc":l&&(n=d.add(n,d.BigInt(o)));break;case"halfEven":(l||s&&1===d.toNumber(d.remainder(mt(n),d.BigInt(2))))&&(n=d.add(n,d.BigInt(o)))}return d.multiply(n,t)}function Pi(e,t,r,n){let{remainder:i}=Gi(e,ze);const o=d.subtract(e,i),a=Li(i,d.BigInt(lo[r]*t),n);return d.add(o,a)}function Bi(e,t,r,n,i,o,a,s,l,c,u,d,h=864e11){const{deltaDays:f,hour:p,minute:m,second:y,millisecond:g,microsecond:v,nanosecond:w}=$i(n,i,o,a,s,l,c,u,d,h),{year:b,month:_,day:E}=Gn(e,t,r+f);return{year:b,month:_,day:E,hour:p,minute:m,second:y,millisecond:g,microsecond:v,nanosecond:w}}function $i(e,t,r,n,i,o,a,s,l,c=864e11){let u=Me;switch(s){case"day":case"hour":u=d.BigInt(e);case"minute":u=d.add(d.multiply(u,Pe),d.BigInt(t));case"second":u=d.add(d.multiply(u,Pe),d.BigInt(r));case"millisecond":u=d.add(d.multiply(u,$e),d.BigInt(n));case"microsecond":u=d.add(d.multiply(u,$e),d.BigInt(i));case"nanosecond":u=d.add(d.multiply(u,$e),d.BigInt(o))}const h="day"===s?c:lo[s],f=Li(u,d.BigInt(h*a),l),p=d.toNumber(d.divide(f,d.BigInt(h)));switch(s){case"day":return{deltaDays:p,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0};case"hour":return Hn(p,0,0,0,0,0);case"minute":return Hn(e,p,0,0,0,0);case"second":return Hn(e,t,p,0,0,0);case"millisecond":return Hn(e,t,r,p,0,0);case"microsecond":return Hn(e,t,r,n,p,0);case"nanosecond":return Hn(e,t,r,n,i,p);default:throw new Error(`Invalid unit ${s}`)}}function Fi(e,t){return hi(K(e,b),K(e,_),K(e,E),K(t,b),K(t,_),K(t,E),"day").days}function Ui(e,t,r,n){const i=jr(e,t,r,void 0,n);return{relativeTo:i,days:Fi(t,i)}}function qi(e,t,r,n,i){const o=K(e,A),a=K(e,D);return Rr(Di(K(e,C),o,a,t,r,n,i,0,0,0,0,0,0),o,a)}function Yi(e,t,r,n,i,o,a,s,l,c,u,h,f,p){let y=e,g=t,v=r,w=n,b=i,_=o,E=a,T=s,x=l,I=c;if(!Lt(p)||"year"===h||"month"===h||"week"===h||"day"===h||"nanosecond"===h&&1===u)return{years:y,months:g,weeks:v,days:w,hours:b,minutes:_,seconds:E,milliseconds:T,microseconds:x,nanoseconds:I};let S=Vn(0,b,_,E,T,x,I,0);const R=xe(d.toNumber(S)),k=K(p,A),j=K(p,D),N=Di(K(p,C),k,j,y,g,v,w,0,0,0,0,0,0),O=Di(new(m("%Temporal.Instant%"))(N),k,j,0,0,0,R,0,0,0,0,0,0),M=d.subtract(O,N);return d.greaterThanOrEqual(d.multiply(d.subtract(S,M),d.BigInt(R)),Me)&&(({years:y,months:g,weeks:v,days:w}=Si(y,g,v,w,0,0,0,0,0,0,0,0,0,R,0,0,0,0,0,0,p)),S=Pi(d.subtract(S,M),u,h,f),({hours:b,minutes:_,seconds:E,milliseconds:T,microseconds:x,nanoseconds:I}=Zn(0,0,0,0,0,0,d.toNumber(S),"hour"))),{years:y,months:g,weeks:v,days:w,hours:b,minutes:_,seconds:E,milliseconds:T,microseconds:x,nanoseconds:I}}function Wi(e,t,r,n,i,o,a,s,l,c,u,h,f,p){let y=e,g=t,v=r,w=n,b=i,_=o,E=a,T=s,x=l,I=d.BigInt(c);const S=m("%Temporal.Duration%");let R,k,j,N,O=p;if(O){if(Lt(O))k=O,O=lr(O);else if(!Nt(O))throw new TypeError("starting point must be PlainDate or ZonedDateTime");R=K(O,D)}if("year"===h||"month"===h||"week"===h||"day"===h){let e,t,r;I=Vn(0,b,_,E,T,x,c,0),k&&(e=qi(k,y,g,v,w)),({days:t,nanoseconds:I,dayLengthNs:r}=Qn(I,e)),j=d.BigInt(r),w+=t,b=_=E=T=x=0}switch(h){case"year":{if(!R)throw new RangeError("A starting point is required for years rounding");const e=new S(y),t="string"!=typeof R?rt(R,"dateAdd"):void 0,r=jr(R,O,e,void 0,t),n=jr(R,O,new S(y,g,v),void 0,t);O=r,w+=Fi(r,n);const i=jr(R,O,new S(0,0,0,w),void 0,t),o=Ne(null);o.largestUnit="year";const a=Nr(R,O,i,o).years;y+=a;const s=O;O=jr(R,O,new S(a),void 0,t),w-=Fi(s,O);const l=new S(w<0?-1:1);let{days:c}=Ui(R,O,l,t);c=Ee(c);const h=d.multiply(d.BigInt(c),j);I=d.add(d.add(d.multiply(h,d.BigInt(y)),d.multiply(d.BigInt(w),j)),I);const p=Li(I,d.multiply(h,d.BigInt(u)),f);N=Hi(I,h),y=d.toNumber(d.divide(p,h)),I=Me,g=v=w=0;break}case"month":{if(!R)throw new RangeError("A starting point is required for months rounding");const e=new S(y,g),t="string"!=typeof R?rt(R,"dateAdd"):void 0,r=jr(R,O,e,void 0,t),n=jr(R,O,new S(y,g,v),void 0,t);O=r,w+=Fi(r,n);const i=xe(w),o=new S(0,w<0?-1:1);let a;for(({relativeTo:O,days:a}=Ui(R,O,o,t));Ee(w)>=Ee(a);)g+=i,w-=a,({relativeTo:O,days:a}=Ui(R,O,o,t));a=Ee(a);const s=d.multiply(d.BigInt(a),j);I=d.add(d.add(d.multiply(s,d.BigInt(g)),d.multiply(d.BigInt(w),j)),I);const l=Li(I,d.multiply(s,d.BigInt(u)),f);N=Hi(I,s),g=d.toNumber(d.divide(l,s)),I=Me,v=w=0;break}case"week":{if(!R)throw new RangeError("A starting point is required for weeks rounding");const e=xe(w),t=new S(0,0,w<0?-1:1),r="string"!=typeof R?rt(R,"dateAdd"):void 0;let n;for(({relativeTo:O,days:n}=Ui(R,O,t,r));Ee(w)>=Ee(n);)v+=e,w-=n,({relativeTo:O,days:n}=Ui(R,O,t,r));n=Ee(n);const i=d.multiply(d.BigInt(n),j);I=d.add(d.add(d.multiply(i,d.BigInt(v)),d.multiply(d.BigInt(w),j)),I);const o=Li(I,d.multiply(i,d.BigInt(u)),f);N=Hi(I,i),v=d.toNumber(d.divide(o,i)),I=Me,w=0;break}case"day":{const e=j;I=d.add(d.multiply(e,d.BigInt(w)),I);const t=Li(I,d.multiply(e,d.BigInt(u)),f);N=Hi(I,e),w=d.toNumber(d.divide(t,e)),I=Me;break}case"hour":{const e=36e11;let t=d.multiply(d.BigInt(b),d.BigInt(36e11));t=d.add(t,d.multiply(d.BigInt(_),d.BigInt(6e10))),t=d.add(t,d.multiply(d.BigInt(E),Ue)),t=d.add(t,d.multiply(d.BigInt(T),Fe)),t=d.add(t,d.multiply(d.BigInt(x),$e)),t=d.add(t,I),N=Hi(t,d.BigInt(e));const r=Li(t,d.BigInt(e*u),f);b=d.toNumber(d.divide(r,d.BigInt(e))),I=Me,_=E=T=x=0;break}case"minute":{const e=6e10;let t=d.multiply(d.BigInt(_),d.BigInt(6e10));t=d.add(t,d.multiply(d.BigInt(E),Ue)),t=d.add(t,d.multiply(d.BigInt(T),Fe)),t=d.add(t,d.multiply(d.BigInt(x),$e)),t=d.add(t,I),N=Hi(t,d.BigInt(e));const r=Li(t,d.BigInt(e*u),f);_=d.toNumber(d.divide(r,d.BigInt(e))),I=Me,E=T=x=0;break}case"second":{const e=1e9;let t=d.multiply(d.BigInt(E),Ue);t=d.add(t,d.multiply(d.BigInt(T),Fe)),t=d.add(t,d.multiply(d.BigInt(x),$e)),t=d.add(t,I),N=Hi(t,d.BigInt(e));const r=Li(t,d.BigInt(e*u),f);E=d.toNumber(d.divide(r,d.BigInt(e))),I=Me,T=x=0;break}case"millisecond":{const e=1e6;let t=d.multiply(d.BigInt(T),Fe);t=d.add(t,d.multiply(d.BigInt(x),$e)),t=d.add(t,I),N=Hi(t,d.BigInt(e));const r=Li(t,d.BigInt(e*u),f);T=d.toNumber(d.divide(r,d.BigInt(e))),I=Me,x=0;break}case"microsecond":{const e=1e3;let t=d.multiply(d.BigInt(x),$e);t=d.add(t,I),N=Hi(t,d.BigInt(e));const r=Li(t,d.BigInt(e*u),f);x=d.toNumber(d.divide(r,d.BigInt(e))),I=Me;break}case"nanosecond":N=d.toNumber(I),I=Li(d.BigInt(I),d.BigInt(u),f)}return{years:y,months:g,weeks:v,days:w,hours:b,minutes:_,seconds:E,milliseconds:T,microseconds:x,nanoseconds:d.toNumber(I),total:N}}function zi(e,t,r,n,i,o){for(const[a,s]of[[e,n],[t,i],[r,o]])if(a!==s)return Xi(a-s);return 0}function Gi(e,t){let{quotient:r,remainder:n}=ht(e,t);return d.lessThan(n,Me)&&(r=d.subtract(r,Le),n=d.add(n,t)),{quotient:r,remainder:n}}function Ji(e,t){const{quotient:r,remainder:n}=ht(e,t);return tt(n)||!ft(e)==!ft(t)?r:d.subtract(r,Le)}function Hi(e,t){const{quotient:r,remainder:n}=ht(e,t);return d.toNumber(r)+d.toNumber(n)/d.toNumber(t)}function Vi(e){const t=Qi(e);return void 0!==globalThis.BigInt?globalThis.BigInt(t.toString(10)):t}function Qi(e){let t=e;if("object"==typeof e){const r=e[Symbol.toPrimitive];r&&"function"==typeof r&&(t=Ce(r,e,["number"]))}if("number"==typeof t)throw new TypeError("cannot convert number to bigint");return"bigint"==typeof t?d.BigInt(t.toString(10)):d.BigInt(t)}const Zi=(()=>{let e=d.BigInt(Date.now()%1e6);return()=>{const t=d.BigInt(Date.now()),r=d.add(d.multiply(t,Fe),e);return e=d.remainder(t,Fe),d.greaterThan(r,Je)?Je:d.lessThan(r,Ge)?Ge:r}})();function Ki(){return(new we).resolvedOptions().timeZone}function Xi(e){return e<0?-1:e>0?1:e}function eo(e){if(void 0===e)return Ne(null);if(it(e)&&null!==e)return e;throw new TypeError("Options parameter must be an object, not "+(null===e?"null":typeof e))}function to(e,t){const r=Ne(null);return r[e]=t,r}function ro(e){const t=Ne(null);return St(t,eo(e),[]),t}function no(e,t,r,n){let i=e[t];if(void 0!==i){if(i=lt(i),!r.includes(i))throw new RangeError(`${t} must be one of ${r.join(", ")}, not ${i}`);return i}return n}function io(e){return et.includes(oo(e))}function oo(e){return e.replace(/[A-Z]/g,(e=>{const t=e.charCodeAt(0);return String.fromCharCode(t+32)}))}const ao=new RegExp(`^${se.source}$`);function so(e,t,r,n=e(t),i=e(r)){let o=d.BigInt(t),a=d.BigInt(r),s=n,l=i;for(;d.greaterThan(d.subtract(a,o),Le);){const t=d.divide(d.add(o,a),d.BigInt(2)),r=e(t);if(r===s)o=t,s=r;else{if(r!==l)throw new Error(`invalid state in bisection ${s} - ${r} - ${l}`);a=t,l=r}}return a}const lo={hour:36e11,minute:6e10,second:1e9,millisecond:1e6,microsecond:1e3,nanosecond:1},co=Symbol("date"),uo=Symbol("ym"),ho=Symbol("md"),fo=Symbol("time"),po=Symbol("datetime"),mo=Symbol("instant"),yo=Symbol("original"),go=Symbol("timezone"),vo=Symbol("calendar-id"),wo=Symbol("locale"),bo=Symbol("options"),_o=e=>({value:e,enumerable:!0,writable:!1,configurable:!0}),Eo=globalThis.Intl.DateTimeFormat,To=Object.assign,xo=Object.prototype.hasOwnProperty,Io=Reflect.apply;function So(e,t){let r=e[t];return"function"==typeof r&&(r=new Eo(e[wo],r(e[bo])),e[t]=r),r}function Ro(e,t={}){if(!(this instanceof Ro))return new Ro(e,t);const r=void 0!==t,n=r?To({},t):{},i=new Eo(e,n),o=i.resolvedOptions();if(r){const e=To({},o);for(const t in e)Io(xo,n,[t])||delete e[t];this[bo]=e}else this[bo]=n;this[wo]=o.locale,this[yo]=i,this[go]=o.timeZone,this[vo]=o.calendar,this[co]=Ao,this[uo]=Oo,this[ho]=Co,this[fo]=No,this[po]=Mo,this[mo]=Lo}Object.defineProperty(Ro,"name",{writable:!0,value:"DateTimeFormat"}),Ro.supportedLocalesOf=function(e,t){return Eo.supportedLocalesOf(e,t)};const ko={resolvedOptions:_o((function(){return this[yo].resolvedOptions()})),format:_o((function(e,...t){let{instant:r,formatter:n}=Uo(e,this);return r&&n?n.format(r.epochMilliseconds):this[yo].format(e,...t)})),formatRange:_o((function(e,t){if($o(e)||$o(t)){if(!Fo(e,t))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");const{instant:r,formatter:n}=Uo(e,this),{instant:i,formatter:o}=Uo(t,this);if(r&&i&&n&&o&&n===o)return n.formatRange(r.epochMilliseconds,i.epochMilliseconds)}return this[yo].formatRange(e,t)}))};"formatToParts"in Eo.prototype&&(ko.formatToParts=_o((function(e,...t){let{instant:r,formatter:n}=Uo(e,this);return r&&n?n.formatToParts(r.epochMilliseconds):this[yo].formatToParts(e,...t)}))),"formatRangeToParts"in Eo.prototype&&(ko.formatRangeToParts=_o((function(e,t){if($o(e)||$o(t)){if(!Fo(e,t))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");const{instant:r,formatter:n}=Uo(e,this),{instant:i,formatter:o}=Uo(t,this);if(r&&i&&n&&o&&n===o)return n.formatRangeToParts(r.epochMilliseconds,i.epochMilliseconds)}return this[yo].formatRangeToParts(e,t)}))),Ro.prototype=Object.create(Eo.prototype,ko),Object.defineProperty(Ro,"prototype",{writable:!1,enumerable:!1,configurable:!1});const Do=Ro;function jo(e={},t={}){const r=To({},e);for(const e of["year","month","day","hour","minute","second","weekday","dayPeriod","timeZoneName","dateStyle","timeStyle"])r[e]=e in t?t[e]:r[e],!1!==r[e]&&void 0!==r[e]||delete r[e];return r}function No(e){let t=jo(e,{year:!1,month:!1,day:!1,weekday:!1,timeZoneName:!1,dateStyle:!1});return Bo(t)||(t=To({},t,{hour:"numeric",minute:"numeric",second:"numeric"})),t}function Oo(e){let t=jo(e,{day:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,dateStyle:!1,timeStyle:!1});return"year"in t||"month"in t||(t=To(t,{year:"numeric",month:"numeric"})),t}function Co(e){let t=jo(e,{year:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,dateStyle:!1,timeStyle:!1});return"month"in t||"day"in t||(t=To({},t,{month:"numeric",day:"numeric"})),t}function Ao(e){let t=jo(e,{hour:!1,minute:!1,second:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});return Po(t)||(t=To({},t,{year:"numeric",month:"numeric",day:"numeric"})),t}function Mo(e){let t=jo(e,{timeZoneName:!1});return Bo(t)||Po(t)||(t=To({},t,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),t}function Lo(e){let t=e;return Bo(t)||Po(t)||(t=To({},t,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),t}function Po(e){return"year"in e||"month"in e||"day"in e||"weekday"in e||"dateStyle"in e}function Bo(e){return"hour"in e||"minute"in e||"second"in e||"timeStyle"in e||"dayPeriod"in e}function $o(e){return Nt(e)||Ot(e)||Ct(e)||Lt(e)||At(e)||Mt(e)||Rt(e)}function Fo(e,t){return!(!$o(e)||!$o(t)||Ot(e)&&!Ot(t)||Nt(e)&&!Nt(t)||Ct(e)&&!Ct(t)||Lt(e)&&!Lt(t)||At(e)&&!At(t)||Mt(e)&&!Mt(t)||Rt(e)&&!Rt(t))}function Uo(e,t){const r=m("%Temporal.PlainDateTime%");if(Ot(e)){const n=new r(1970,1,1,K(e,T),K(e,x),K(e,I),K(e,S),K(e,R),K(e,k),t[vo]);return{instant:fn(t[go],n,"compatible"),formatter:So(t,fo)}}if(At(e)){const n=K(e,b),i=K(e,_),o=K(e,E),a=Vr(K(e,D));if(a!==t[vo])throw new RangeError(`cannot format PlainYearMonth with calendar ${a} in locale with calendar ${t[vo]}`);const s=new r(n,i,o,12,0,0,0,0,0,a);return{instant:fn(t[go],s,"compatible"),formatter:So(t,uo)}}if(Mt(e)){const n=K(e,b),i=K(e,_),o=K(e,E),a=Vr(K(e,D));if(a!==t[vo])throw new RangeError(`cannot format PlainMonthDay with calendar ${a} in locale with calendar ${t[vo]}`);const s=new r(n,i,o,12,0,0,0,0,0,a);return{instant:fn(t[go],s,"compatible"),formatter:So(t,ho)}}if(Nt(e)){const n=K(e,b),i=K(e,_),o=K(e,E),a=Vr(K(e,D));if("iso8601"!==a&&a!==t[vo])throw new RangeError(`cannot format PlainDate with calendar ${a} in locale with calendar ${t[vo]}`);const s=new r(n,i,o,12,0,0,0,0,0,t[vo]);return{instant:fn(t[go],s,"compatible"),formatter:So(t,co)}}if(Ct(e)){const n=K(e,b),i=K(e,_),o=K(e,E),a=K(e,T),s=K(e,x),l=K(e,I),c=K(e,S),u=K(e,R),d=K(e,k),h=Vr(K(e,D));if("iso8601"!==h&&h!==t[vo])throw new RangeError(`cannot format PlainDateTime with calendar ${h} in locale with calendar ${t[vo]}`);let f=e;return"iso8601"===h&&(f=new r(n,i,o,a,s,l,c,u,d,t[vo])),{instant:fn(t[go],f,"compatible"),formatter:So(t,po)}}if(Lt(e))throw new TypeError("Temporal.ZonedDateTime not supported in DateTimeFormat methods. Use toLocaleString() instead.");return Rt(e)?{instant:e,formatter:So(t,mo)}:{}}class qo{constructor(e){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");const t=Qi(e);ui(t),Q(this),X(this,v,t)}get epochSeconds(){if(!Rt(this))throw new TypeError("invalid receiver");const e=K(this,v);return d.toNumber(Ji(e,Ue))}get epochMilliseconds(){if(!Rt(this))throw new TypeError("invalid receiver");const e=d.BigInt(K(this,v));return d.toNumber(Ji(e,Fe))}get epochMicroseconds(){if(!Rt(this))throw new TypeError("invalid receiver");return Vi(Ji(d.BigInt(K(this,v)),$e))}get epochNanoseconds(){if(!Rt(this))throw new TypeError("invalid receiver");return Vi(d.BigInt(K(this,v)))}add(e){if(!Rt(this))throw new TypeError("invalid receiver");return Ni("add",this,e)}subtract(e){if(!Rt(this))throw new TypeError("invalid receiver");return Ni("subtract",this,e)}until(e,t){if(!Rt(this))throw new TypeError("invalid receiver");return vi("until",this,e,t)}since(e,t){if(!Rt(this))throw new TypeError("invalid receiver");return vi("since",this,e,t)}round(e){if(!Rt(this))throw new TypeError("invalid receiver");if(void 0===e)throw new TypeError("options parameter is required");const t="string"==typeof e?to("smallestUnit",e):eo(e),r=Zt(t),n=Ht(t,"halfExpand"),i=rr(t,"smallestUnit","time",tr);Kt(r,{hour:24,minute:1440,second:86400,millisecond:864e5,microsecond:864e8,nanosecond:864e11}[i],!0);const o=Pi(K(this,v),r,i,n);return new qo(o)}equals(e){if(!Rt(this))throw new TypeError("invalid receiver");const t=hr(e),r=K(this,v),n=K(t,v);return d.equal(d.BigInt(r),d.BigInt(n))}toString(e){if(!Rt(this))throw new TypeError("invalid receiver");const t=eo(e),r=Xt(t),n=Ht(t,"trunc"),i=rr(t,"smallestUnit","time",void 0);if("hour"===i)throw new RangeError('smallestUnit must be a time unit other than "hour"');let o=t.timeZone;void 0!==o&&(o=nn(o));const{precision:a,unit:s,increment:l}=er(i,r),c=Pi(K(this,v),l,s,n);return wn(new qo(c),o,a)}toJSON(){if(!Rt(this))throw new TypeError("invalid receiver");return wn(this,void 0,"auto")}toLocaleString(e,t){if(!Rt(this))throw new TypeError("invalid receiver");return new Do(e,t).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.Instant")}toZonedDateTime(e){if(!Rt(this))throw new TypeError("invalid receiver");if(!it(e))throw new TypeError("invalid argument in toZonedDateTime");const t=e.calendar;if(void 0===t)throw new TypeError("missing calendar property in toZonedDateTime");const r=Jr(t),n=e.timeZone;if(void 0===n)throw new TypeError("missing timeZone property in toZonedDateTime");const i=nn(n);return Rr(K(this,v),i,r)}toZonedDateTimeISO(e){if(!Rt(this))throw new TypeError("invalid receiver");const t=nn(e);return Rr(K(this,v),t,"iso8601")}static fromEpochSeconds(e){const t=ot(e),r=d.multiply(d.BigInt(t),Ue);return ui(r),new qo(r)}static fromEpochMilliseconds(e){const t=ot(e),r=d.multiply(d.BigInt(t),Fe);return ui(r),new qo(r)}static fromEpochMicroseconds(e){const t=Qi(e),r=d.multiply(t,$e);return ui(r),new qo(r)}static fromEpochNanoseconds(e){const t=Qi(e);return ui(t),new qo(t)}static from(e){return Rt(e)?new qo(K(e,v)):hr(e)}static compare(e,t){const r=hr(e),n=hr(t),i=K(r,v),o=K(n,v);return d.lessThan(i,o)?-1:d.greaterThan(i,o)?1:0}}f(qo,"Temporal.Instant");const Yo=Array.prototype.includes,Wo=Array.prototype.push,zo=globalThis.Intl.DateTimeFormat,Go=Array.prototype.sort,Jo=Math.abs,Ho=Math.floor,Vo=Object.create,Qo=Object.entries,Zo=Set,Ko=Reflect.ownKeys,Xo=Set.prototype.add,ea=Set.prototype.values,ta={};class ra{constructor(e){if(arguments.length<1)throw new RangeError("missing argument: id is required");const t=lt(e);if(!io(t))throw new RangeError(`invalid calendar identifier ${t}`);Q(this),X(this,z,oo(t))}get id(){if(!Dt(this))throw new TypeError("invalid receiver");return K(this,z)}dateFromFields(e,t){if(!Dt(this))throw new TypeError("invalid receiver");if(!it(e))throw new TypeError("invalid fields");const r=eo(t),n=K(this,z);return ta[n].dateFromFields(e,r,n)}yearMonthFromFields(e,t){if(!Dt(this))throw new TypeError("invalid receiver");if(!it(e))throw new TypeError("invalid fields");const r=eo(t),n=K(this,z);return ta[n].yearMonthFromFields(e,r,n)}monthDayFromFields(e,t){if(!Dt(this))throw new TypeError("invalid receiver");if(!it(e))throw new TypeError("invalid fields");const r=eo(t),n=K(this,z);return ta[n].monthDayFromFields(e,r,n)}fields(e){if(!Dt(this))throw new TypeError("invalid receiver");const t=[],r=new Set(["year","month","monthCode","day","hour","minute","second","millisecond","microsecond","nanosecond"]);for(const n of e){if("string"!=typeof n)throw new TypeError("invalid fields");if(!r.has(n))throw new RangeError(`invalid field name ${n}`);r.delete(n),Wo.call(t,n)}return ta[K(this,z)].fields(t)}mergeFields(e,t){if(!Dt(this))throw new TypeError("invalid receiver");const r=It(e),n=Vo(null);St(n,r,[],[void 0]);const i=It(t),o=Vo(null);St(o,i,[],[void 0]);const a=Ko(o),s=ta[K(this,z)].fieldKeysToIgnore(a),l=Vo(null),c=Ko(n);for(const e of c){let t;t=nt(Yo,s,[e])?o[e]:n[e],void 0!==t&&(l[e]=t)}return St(l,o,[]),l}dateAdd(e,t,r){if(!Dt(this))throw new TypeError("invalid receiver");const n=lr(e),i=dr(t),o=Gt(eo(r)),{days:a}=Zn(K(i,B),K(i,$),K(i,F),K(i,U),K(i,q),K(i,Y),K(i,W),"day"),s=K(this,z);return ta[s].dateAdd(n,K(i,M),K(i,L),K(i,P),a,o,s)}dateUntil(e,t,r){if(!Dt(this))throw new TypeError("invalid receiver");const n=lr(e),i=lr(t);let o=rr(eo(r),"largestUnit","date","auto");"auto"===o&&(o="day");const{years:a,months:s,weeks:l,days:c}=ta[K(this,z)].dateUntil(n,i,o);return new(m("%Temporal.Duration%"))(a,s,l,c,0,0,0,0,0,0)}year(e){let t=e;if(!Dt(this))throw new TypeError("invalid receiver");return At(t)||(t=lr(t)),ta[K(this,z)].year(t)}month(e){let t=e;if(!Dt(this))throw new TypeError("invalid receiver");if(Mt(t))throw new TypeError("use monthCode on PlainMonthDay instead");return At(t)||(t=lr(t)),ta[K(this,z)].month(t)}monthCode(e){let t=e;if(!Dt(this))throw new TypeError("invalid receiver");return At(t)||Mt(t)||(t=lr(t)),ta[K(this,z)].monthCode(t)}day(e){let t=e;if(!Dt(this))throw new TypeError("invalid receiver");return Mt(t)||(t=lr(t)),ta[K(this,z)].day(t)}era(e){let t=e;if(!Dt(this))throw new TypeError("invalid receiver");return At(t)||(t=lr(t)),ta[K(this,z)].era(t)}eraYear(e){let t=e;if(!Dt(this))throw new TypeError("invalid receiver");return At(t)||(t=lr(t)),ta[K(this,z)].eraYear(t)}dayOfWeek(e){if(!Dt(this))throw new TypeError("invalid receiver");const t=lr(e);return ta[K(this,z)].dayOfWeek(t)}dayOfYear(e){if(!Dt(this))throw new TypeError("invalid receiver");const t=lr(e);return ta[K(this,z)].dayOfYear(t)}weekOfYear(e){if(!Dt(this))throw new TypeError("invalid receiver");const t=lr(e);return ta[K(this,z)].weekOfYear(t)}yearOfWeek(e){if(!Dt(this))throw new TypeError("invalid receiver");const t=lr(e);return ta[K(this,z)].yearOfWeek(t)}daysInWeek(e){if(!Dt(this))throw new TypeError("invalid receiver");const t=lr(e);return ta[K(this,z)].daysInWeek(t)}daysInMonth(e){let t=e;if(!Dt(this))throw new TypeError("invalid receiver");return At(t)||(t=lr(t)),ta[K(this,z)].daysInMonth(t)}daysInYear(e){let t=e;if(!Dt(this))throw new TypeError("invalid receiver");return At(t)||(t=lr(t)),ta[K(this,z)].daysInYear(t)}monthsInYear(e){let t=e;if(!Dt(this))throw new TypeError("invalid receiver");return At(t)||(t=lr(t)),ta[K(this,z)].monthsInYear(t)}inLeapYear(e){let t=e;if(!Dt(this))throw new TypeError("invalid receiver");return At(t)||(t=lr(t)),ta[K(this,z)].inLeapYear(t)}toString(){if(!Dt(this))throw new TypeError("invalid receiver");return K(this,z)}toJSON(){if(!Dt(this))throw new TypeError("invalid receiver");return K(this,z)}static from(e){return Qr(Jr(e))}}function na(e){if(!e.startsWith("M"))throw new RangeError(`Invalid month code: ${e}.  Month codes must start with M.`);const t=+e.slice(1);if(isNaN(t))throw new RangeError(`Invalid month code: ${e}`);return t}function ia(e,t=!1){return`M${e.toString().padStart(2,"0")}${t?"L":""}`}function oa(e,t,r=12){let{month:n,monthCode:i}=e;if(void 0===i){if(void 0===n)throw new TypeError("Either month or monthCode are required");"reject"===t&&ii(n,1,r),"constrain"===t&&(n=ri(n,1,r)),i=ia(n)}else{const e=na(i);if(void 0!==n&&n!==e)throw new RangeError(`monthCode ${i} and month ${n} must match if both are present`);if(i!==ia(e))throw new RangeError(`Invalid month code: ${i}`);if(n=e,n<1||n>r)throw new RangeError(`Invalid monthCode: ${i}`)}return{...e,month:n,monthCode:i}}f(ra,"Temporal.Calendar"),p("Temporal.Calendar.from",ra.from),p("Temporal.Calendar.prototype.dateAdd",ra.prototype.dateAdd),p("Temporal.Calendar.prototype.dateFromFields",ra.prototype.dateFromFields),p("Temporal.Calendar.prototype.dateUntil",ra.prototype.dateUntil),p("Temporal.Calendar.prototype.day",ra.prototype.day),p("Temporal.Calendar.prototype.dayOfWeek",ra.prototype.dayOfWeek),p("Temporal.Calendar.prototype.dayOfYear",ra.prototype.dayOfYear),p("Temporal.Calendar.prototype.daysInMonth",ra.prototype.daysInMonth),p("Temporal.Calendar.prototype.daysInWeek",ra.prototype.daysInWeek),p("Temporal.Calendar.prototype.daysInYear",ra.prototype.daysInYear),p("Temporal.Calendar.prototype.era",ra.prototype.era),p("Temporal.Calendar.prototype.eraYear",ra.prototype.eraYear),p("Temporal.Calendar.prototype.fields",ra.prototype.fields),p("Temporal.Calendar.prototype.inLeapYear",ra.prototype.inLeapYear),p("Temporal.Calendar.prototype.mergeFields",ra.prototype.mergeFields),p("Temporal.Calendar.prototype.month",ra.prototype.month),p("Temporal.Calendar.prototype.monthCode",ra.prototype.monthCode),p("Temporal.Calendar.prototype.monthDayFromFields",ra.prototype.monthDayFromFields),p("Temporal.Calendar.prototype.monthsInYear",ra.prototype.monthsInYear),p("Temporal.Calendar.prototype.weekOfYear",ra.prototype.weekOfYear),p("Temporal.Calendar.prototype.year",ra.prototype.year),p("Temporal.Calendar.prototype.yearMonthFromFields",ra.prototype.yearMonthFromFields),p("Temporal.Calendar.prototype.yearOfWeek",ra.prototype.yearOfWeek),ta.iso8601={dateFromFields(e,t,r){let n=ar(e,["day","month","monthCode","year"],["year","day"]);const i=Gt(t);n=oa(n);let{year:o,month:a,day:s}=n;return({year:o,month:a,day:s}=Yt(o,a,s,i)),wr(o,a,s,r)},yearMonthFromFields(e,t,r){let n=ar(e,["month","monthCode","year"],["year"]);const i=Gt(t);n=oa(n);let{year:o,month:a}=n;return({year:o,month:a}=function(e,t,r){let n=e,i=t;switch(r){case"reject":oi(n,i,1);break;case"constrain":({year:n,month:i}=ni(n,i))}return{year:n,month:i}}(o,a,i)),Ir(o,a,r,1)},monthDayFromFields(e,t,r){let n=ar(e,["day","month","monthCode","year"],["day"]);const i=Gt(t);if(void 0!==n.month&&void 0===n.year&&void 0===n.monthCode)throw new TypeError("either year or monthCode required with month");const o=void 0===n.monthCode;n=oa(n);let{month:a,day:s,year:l}=n;return({month:a,day:s}=Yt(o?l:1972,a,s,i)),Tr(a,s,r,1972)},fields:e=>e,fieldKeysToIgnore(e){const t=new Zo;for(let r=0;r<e.length;r++){const n=e[r];nt(Xo,t,[n]),"month"===n?nt(Xo,t,["monthCode"]):"monthCode"===n&&nt(Xo,t,["month"])}return[...nt(ea,t,[])]},dateAdd(e,t,r,n,i,o,a){let s=K(e,b),l=K(e,_),c=K(e,E);return({year:s,month:l,day:c}=xi(s,l,c,t,r,n,i,o)),wr(s,l,c,a)},dateUntil:(e,t,r)=>hi(K(e,b),K(e,_),K(e,E),K(t,b),K(t,_),K(t,E),r),year:e=>K(e,b),era(){},eraYear(){},month:e=>K(e,_),monthCode:e=>ia(K(e,_)),day:e=>K(e,E),dayOfWeek:e=>Un(K(e,b),K(e,_),K(e,E)),dayOfYear:e=>qn(K(e,b),K(e,_),K(e,E)),weekOfYear:e=>Yn(K(e,b),K(e,_),K(e,E)).week,yearOfWeek:e=>Yn(K(e,b),K(e,_),K(e,E)).year,daysInWeek:()=>7,daysInMonth:e=>Fn(K(e,b),K(e,_)),daysInYear(e){let t=e;return Z(t,b)||(t=lr(t)),$n(K(t,b))?366:365},monthsInYear:()=>12,inLeapYear(e){let t=e;return Z(t,b)||(t=lr(t)),$n(K(t,b))}};class aa{constructor(e){if(this.map=new Map,this.calls=0,this.hits=0,this.misses=0,this.now=globalThis.performance?globalThis.performance.now():Date.now(),void 0!==e){let t=0;for(const r of e.map.entries()){if(++t>aa.MAX_CACHE_ENTRIES)break;this.map.set(...r)}}}get(e){const t=this.map.get(e);return t&&(this.hits++,this.report()),this.calls++,t}set(e,t){this.map.set(e,t),this.misses++,this.report()}report(){}setObject(e){if(aa.objectMap.get(e))throw new RangeError("object already cached");aa.objectMap.set(e,this),this.report()}static getCacheForObject(e){let t=aa.objectMap.get(e);return t||(t=new aa,aa.objectMap.set(e,t)),t}}function sa({isoYear:e,isoMonth:t,isoDay:r}){return`${yn(e)}-${gn(t)}-${gn(r)}T00:00Z`}function la(e,t){return{years:e.year-t.year,months:e.month-t.month,days:e.day-t.day}}aa.objectMap=new WeakMap,aa.MAX_CACHE_ENTRIES=1e3;class ca{constructor(){this.eraLength="short",this.hasEra=!0,this.erasBeginMidYear=!1}getFormatter(){return void 0===this.formatter&&(this.formatter=new zo(`en-US-u-ca-${this.id}`,{day:"numeric",month:"numeric",year:"numeric",era:this.eraLength,timeZone:"UTC"})),this.formatter}isoToCalendarDate(e,t){const{year:r,month:n,day:i}=e,o=JSON.stringify({func:"isoToCalendarDate",isoYear:r,isoMonth:n,isoDay:i,id:this.id}),a=t.get(o);if(a)return a;const s=this.getFormatter();let l,c;try{c=sa({isoYear:r,isoMonth:n,isoDay:i}),l=s.formatToParts(new Date(c))}catch(e){throw new RangeError(`Invalid ISO date: ${JSON.stringify({isoYear:r,isoMonth:n,isoDay:i})}`)}const u={};for(let{type:e,value:t}of l){if("year"===e&&(u.eraYear=+t),"relatedYear"===e&&(u.eraYear=+t),"month"===e){const e=/^([0-9]*)(.*?)$/.exec(t);if(!e||3!=e.length||!e[1]&&!e[2])throw new RangeError(`Unexpected month: ${t}`);if(u.month=e[1]?+e[1]:1,u.month<1)throw new RangeError(`Invalid month ${t} from ${c}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10527)`);if(u.month>13)throw new RangeError(`Invalid month ${t} from ${c}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10529)`);e[2]&&(u.monthExtra=e[2])}"day"===e&&(u.day=+t),this.hasEra&&"era"===e&&null!=t&&""!==t&&(t=t.split(" (")[0],u.era=t.normalize("NFD").replace(/[^-0-9 \p{L}]/gu,"").replace(" ","-").toLowerCase())}if(void 0===u.eraYear)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);if(this.reviseIntlEra){const{era:t,eraYear:r}=this.reviseIntlEra(u,e);u.era=t,u.eraYear=r}this.checkIcuBugs&&this.checkIcuBugs(e);const d=this.adjustCalendarDate(u,t,"constrain",!0);if(void 0===d.year)throw new RangeError(`Missing year converting ${JSON.stringify(e)}`);if(void 0===d.month)throw new RangeError(`Missing month converting ${JSON.stringify(e)}`);if(void 0===d.day)throw new RangeError(`Missing day converting ${JSON.stringify(e)}`);return t.set(o,d),["constrain","reject"].forEach((r=>{const n=JSON.stringify({func:"calendarToIsoDate",year:d.year,month:d.month,day:d.day,overflow:r,id:this.id});t.set(n,e)})),d}validateCalendarDate(e){const{era:t,month:r,year:n,day:i,eraYear:o,monthCode:a,monthExtra:s}=e;if(void 0!==s)throw new RangeError("Unexpected `monthExtra` value");if(void 0===n&&void 0===o)throw new TypeError("year or eraYear is required");if(void 0===r&&void 0===a)throw new TypeError("month or monthCode is required");if(void 0===i)throw new RangeError("Missing day");if(void 0!==a){if("string"!=typeof a)throw new RangeError("monthCode must be a string, not "+typeof a);if(!/^M([01]?\d)(L?)$/.test(a))throw new RangeError(`Invalid monthCode: ${a}`)}if(this.constantEra){if(void 0!==t&&t!==this.constantEra)throw new RangeError(`era must be ${this.constantEra}, not ${t}`);if(void 0!==o&&void 0!==n&&o!==n)throw new RangeError(`eraYear ${o} does not match year ${n}`)}if(this.hasEra&&void 0===e.era!=(void 0===e.eraYear))throw new RangeError("properties 'era' and 'eraYear' must be provided together")}adjustCalendarDate(e,t,r="constrain",n=!1){if("lunisolar"===this.calendarType)throw new RangeError("Override required for lunisolar calendars");let i=e;if(this.validateCalendarDate(i),this.constantEra){const{year:e,eraYear:t}=i;i={...i,era:this.constantEra,year:void 0!==e?e:t,eraYear:void 0!==t?t:e}}const o=this.monthsInYear(i,t);let{month:a,monthCode:s}=i;return({month:a,monthCode:s}=oa(i,r,o)),{...i,month:a,monthCode:s}}regulateMonthDayNaive(e,t,r){const n=this.monthsInYear(e,r);let{month:i,day:o}=e;return"reject"===t?(ii(i,1,n),ii(o,1,this.maximumMonthLength(e))):(i=ri(i,1,n),o=ri(o,1,this.maximumMonthLength({...e,month:i}))),{...e,month:i,day:o}}calendarToIsoDate(e,t="constrain",r){const n=e;let i=this.adjustCalendarDate(e,r,t,!1);i=this.regulateMonthDayNaive(i,t,r);const{year:o,month:a,day:s}=i,l=JSON.stringify({func:"calendarToIsoDate",year:o,month:a,day:s,overflow:t,id:this.id});let c,u=r.get(l);if(u)return u;if(void 0!==n.year&&void 0!==n.month&&void 0!==n.day&&(n.year!==i.year||n.month!==i.month||n.day!==i.day)&&(c=JSON.stringify({func:"calendarToIsoDate",year:n.year,month:n.month,day:n.day,overflow:t,id:this.id}),u=r.get(c),u))return u;let d=this.estimateIsoDate({year:o,month:a,day:s});const h=e=>{let n=this.addDaysIso(d,e);if(i.day>this.minimumMonthLength(i)){let e=this.isoToCalendarDate(n,r);for(;e.month!==a||e.year!==o;){if("reject"===t)throw new RangeError(`day ${s} does not exist in month ${a} of year ${o}`);n=this.addDaysIso(n,-1),e=this.isoToCalendarDate(n,r)}}return n};let f=0,p=this.isoToCalendarDate(d,r),m=la(i,p);if(0!==m.years||0!==m.months||0!==m.days){const e=365*m.years+30*m.months+m.days;d=this.addDaysIso(d,e),p=this.isoToCalendarDate(d,r),m=la(i,p),0===m.years&&0===m.months?d=h(m.days):f=this.compareCalendarDates(i,p)}let y=8;for(;f;){d=this.addDaysIso(d,f*y);const e=p;p=this.isoToCalendarDate(d,r);const o=f;if(f=this.compareCalendarDates(i,p),f)if(m=la(i,p),0===m.years&&0===m.months)d=h(m.days),f=0;else if(o&&f!==o)if(y>1)y/=2;else{if("reject"===t)throw new RangeError(`Can't find ISO date from calendar date: ${JSON.stringify({...n})}`);this.compareCalendarDates(p,e)>0&&(d=this.addDaysIso(d,-1)),f=0}}if(r.set(l,d),c&&r.set(c,d),void 0===i.year||void 0===i.month||void 0===i.day||void 0===i.monthCode||this.hasEra&&(void 0===i.era||void 0===i.eraYear))throw new RangeError("Unexpected missing property");return d}temporalToCalendarDate(e,t){const r={year:K(e,b),month:K(e,_),day:K(e,E)};return this.isoToCalendarDate(r,t)}compareCalendarDates(e,t){const r=ar(e,["day","month","year"],["day","month","year"]),n=ar(t,["day","month","year"],["day","month","year"]);return r.year!==n.year?Xi(r.year-n.year):r.month!==n.month?Xi(r.month-n.month):r.day!==n.day?Xi(r.day-n.day):0}regulateDate(e,t="constrain",r){const n=this.calendarToIsoDate(e,t,r);return this.isoToCalendarDate(n,r)}addDaysIso(e,t){return xi(e.year,e.month,e.day,0,0,0,t,"constrain")}addDaysCalendar(e,t,r){const n=this.calendarToIsoDate(e,"constrain",r),i=this.addDaysIso(n,t);return this.isoToCalendarDate(i,r)}addMonthsCalendar(e,t,r,n){let i=e;const{day:o}=i;for(let e=0,r=Jo(t);e<r;e++){const{month:e}=i,r=i,a=t<0?-Math.max(o,this.daysInPreviousMonth(i,n)):this.daysInMonth(i,n),s=this.calendarToIsoDate(i,"constrain",n);let l=this.addDaysIso(s,a);if(i=this.isoToCalendarDate(l,n),t>0){const t=this.monthsInYear(r,n);for(;i.month-1!=e%t;)l=this.addDaysIso(l,-1),i=this.isoToCalendarDate(l,n)}i.day!==o&&(i=this.regulateDate({...i,day:o},"constrain",n))}if("reject"===r&&i.day!==o)throw new RangeError(`Day ${o} does not exist in resulting calendar month`);return i}addCalendar(e,{years:t=0,months:r=0,weeks:n=0,days:i=0},o,a){const{year:s,day:l,monthCode:c}=e,u=this.adjustCalendarDate({year:s+t,monthCode:c,day:l},a),d=this.addMonthsCalendar(u,r,o,a),h=i+7*n;return this.addDaysCalendar(d,h,a)}untilCalendar(e,t,r,n){let i=0,o=0,a=0,s=0;switch(r){case"day":i=this.calendarDaysUntil(e,t,n);break;case"week":{const r=this.calendarDaysUntil(e,t,n);i=r%7,o=(r-i)/7;break}case"month":case"year":{const o=this.compareCalendarDates(t,e);if(!o)return{years:0,months:0,weeks:0,days:0};const l=t.year-e.year,c=t.day-e.day;if("year"===r&&l){let r=0;t.monthCode>e.monthCode&&(r=1),t.monthCode<e.monthCode&&(r=-1),r||(r=Math.sign(c)),s=r*o<0?l-o:l}let u,d=s?this.addCalendar(e,{years:s},"constrain",n):e;do{a+=o,u=d,d=this.addMonthsCalendar(u,o,"constrain",n),d.day!==e.day&&(d=this.regulateDate({...d,day:e.day},"constrain",n))}while(this.compareCalendarDates(t,d)*o>=0);a-=o,i=this.calendarDaysUntil(u,t,n);break}}return{years:s,months:a,weeks:o,days:i}}daysInMonth(e,t){const{day:r}=e,n=this.maximumMonthLength(e),i=this.minimumMonthLength(e);if(i===n)return i;const o=r<=n-i?n:i,a=this.calendarToIsoDate(e,"constrain",t),s=this.addDaysIso(a,o),l=this.isoToCalendarDate(s,t),c=this.addDaysIso(s,-l.day);return this.isoToCalendarDate(c,t).day}daysInPreviousMonth(e,t){const{day:r,month:n,year:i}=e;let o={year:n>1?i:i-1,month:n,day:1};const a=n>1?n-1:this.monthsInYear(o,t);o={...o,month:a};const s=this.minimumMonthLength(o),l=this.maximumMonthLength(o);if(s===l)return l;const c=this.calendarToIsoDate(e,"constrain",t),u=this.addDaysIso(c,-r);return this.isoToCalendarDate(u,t).day}startOfCalendarYear(e){return{year:e.year,month:1,monthCode:"M01",day:1}}startOfCalendarMonth(e){return{year:e.year,month:e.month,day:1}}calendarDaysUntil(e,t,r){const n=this.calendarToIsoDate(e,"constrain",r),i=this.calendarToIsoDate(t,"constrain",r);return this.isoDaysUntil(n,i)}isoDaysUntil(e,t){return hi(e.year,e.month,e.day,t.year,t.month,t.day,"day").days}monthDayFromFields(e,t,r){let n,i,o,a,s,{monthCode:l,day:c}=e;if(void 0===l){let{year:n,era:i,eraYear:o}=e;if(void 0===n&&(void 0===i||void 0===o))throw new TypeError("when `monthCode` is omitted, `year` (or `era` and `eraYear`) and `month` are required");({monthCode:l,day:c}=this.isoToCalendarDate(this.calendarToIsoDate(e,t,r),r))}const u=this.isoToCalendarDate({year:1972,month:12,day:31},r),d=u.monthCode>l||u.monthCode===l&&u.day>=c?u.year:u.year-1;for(let e=0;e<100;e++){const u=this.adjustCalendarDate({day:c,monthCode:l,year:d-e},r),h=this.calendarToIsoDate(u,"constrain",r),f=this.isoToCalendarDate(h,r);if(({year:n,month:i,day:o}=h),f.monthCode===l&&f.day===c)return{month:i,day:o,year:n};"constrain"===t&&(void 0===a||f.monthCode===a.monthCode&&f.day>a.day)&&(a=f,s=h)}if("constrain"===t&&void 0!==s)return s;throw new RangeError(`No recent ${this.id} year with monthCode ${l} and day ${c}`)}}class ua extends ca{constructor(){super(...arguments),this.id="hebrew",this.calendarType="lunisolar",this.months={Tishri:{leap:1,regular:1,monthCode:"M01",days:30},Heshvan:{leap:2,regular:2,monthCode:"M02",days:{min:29,max:30}},Kislev:{leap:3,regular:3,monthCode:"M03",days:{min:29,max:30}},Tevet:{leap:4,regular:4,monthCode:"M04",days:29},Shevat:{leap:5,regular:5,monthCode:"M05",days:30},Adar:{leap:void 0,regular:6,monthCode:"M06",days:29},"Adar I":{leap:6,regular:void 0,monthCode:"M05L",days:30},"Adar II":{leap:7,regular:void 0,monthCode:"M06",days:29},Nisan:{leap:8,regular:7,monthCode:"M07",days:30},Iyar:{leap:9,regular:8,monthCode:"M08",days:29},Sivan:{leap:10,regular:9,monthCode:"M09",days:30},Tamuz:{leap:11,regular:10,monthCode:"M10",days:29},Av:{leap:12,regular:11,monthCode:"M11",days:30},Elul:{leap:13,regular:12,monthCode:"M12",days:29}},this.hasEra=!1}inLeapYear(e){const{year:t}=e;return(7*t+1)%19<7}monthsInYear(e){return this.inLeapYear(e)?13:12}minimumMonthLength(e){return this.minMaxMonthLength(e,"min")}maximumMonthLength(e){return this.minMaxMonthLength(e,"max")}minMaxMonthLength(e,t){const{month:r,year:n}=e,i=this.getMonthCode(n,r),o=Qo(this.months).find((e=>e[1].monthCode===i));if(void 0===o)throw new RangeError(`unmatched Hebrew month: ${r}`);const a=o[1].days;return"number"==typeof a?a:a[t]}estimateIsoDate(e){const{year:t}=e;return{year:t-3760,month:1,day:1}}getMonthCode(e,t){return this.inLeapYear({year:e})?6===t?ia(5,!0):ia(t<6?t:t-1):ia(t)}adjustCalendarDate(e,t,r="constrain",n=!1){let{year:i,eraYear:o,month:a,monthCode:s,day:l,monthExtra:c}=e;if(void 0===i&&void 0!==o&&(i=o),void 0===o&&void 0!==i&&(o=i),n){if(c){const e=this.months[c];if(!e)throw new RangeError(`Unrecognized month from formatToParts: ${c}`);a=this.inLeapYear({year:i})?e.leap:e.regular}return s=this.getMonthCode(i,a),{year:i,month:a,day:l,era:void 0,eraYear:o,monthCode:s}}if(this.validateCalendarDate(e),void 0===a)if(s.endsWith("L")){if("M05L"!==s)throw new RangeError(`Hebrew leap month must have monthCode M05L, not ${s}`);if(a=6,!this.inLeapYear({year:i})){if("reject"===r)throw new RangeError(`Hebrew monthCode M05L is invalid in year ${i} which is not a leap year`);a=6,s="M06"}}else{a=na(s),this.inLeapYear({year:i})&&a>=6&&a++;const e=this.monthsInYear({year:i});if(a<1||a>e)throw new RangeError(`Invalid monthCode: ${s}`)}else if("reject"===r?(ii(a,1,this.monthsInYear({year:i})),ii(l,1,this.maximumMonthLength({year:i,month:a}))):(a=ri(a,1,this.monthsInYear({year:i})),l=ri(l,1,this.maximumMonthLength({year:i,month:a}))),void 0===s)s=this.getMonthCode(i,a);else if(this.getMonthCode(i,a)!==s)throw new RangeError(`monthCode ${s} doesn't correspond to month ${a} in Hebrew year ${i}`);return{...e,day:l,month:a,monthCode:s,year:i,eraYear:o}}}class da extends ca{constructor(){super(...arguments),this.calendarType="lunar",this.DAYS_PER_ISLAMIC_YEAR=354+11/30,this.DAYS_PER_ISO_YEAR=365.2425,this.constantEra="ah"}inLeapYear(e,t){return 30===this.daysInMonth({year:e.year,month:12,day:1},t)}monthsInYear(){return 12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}estimateIsoDate(e){const{year:t}=this.adjustCalendarDate(e);return{year:Ho(t*this.DAYS_PER_ISLAMIC_YEAR/this.DAYS_PER_ISO_YEAR)+622,month:1,day:1}}}class ha extends da{constructor(){super(...arguments),this.id="islamic"}}class fa extends da{constructor(){super(...arguments),this.id="islamic-umalqura"}}class pa extends da{constructor(){super(...arguments),this.id="islamic-tbla"}}class ma extends da{constructor(){super(...arguments),this.id="islamic-civil"}}class ya extends da{constructor(){super(...arguments),this.id="islamic-rgsa"}}class ga extends da{constructor(){super(...arguments),this.id="islamicc"}}class va extends ca{constructor(){super(...arguments),this.id="persian",this.calendarType="solar",this.constantEra="ap"}inLeapYear(e,t){return ha.prototype.inLeapYear.call(this,e,t)}monthsInYear(){return 12}minimumMonthLength(e){const{month:t}=e;return 12===t?29:t<=6?31:30}maximumMonthLength(e){const{month:t}=e;return 12===t?30:t<=6?31:30}estimateIsoDate(e){const{year:t}=this.adjustCalendarDate(e);return{year:t+621,month:1,day:1}}}class wa extends ca{constructor(){super(...arguments),this.id="indian",this.calendarType="solar",this.constantEra="saka",this.months={1:{length:30,month:3,day:22,leap:{length:31,month:3,day:21}},2:{length:31,month:4,day:21},3:{length:31,month:5,day:22},4:{length:31,month:6,day:22},5:{length:31,month:7,day:23},6:{length:31,month:8,day:23},7:{length:30,month:9,day:23},8:{length:30,month:10,day:23},9:{length:30,month:11,day:22},10:{length:30,month:12,day:22},11:{length:30,month:1,nextYear:!0,day:21},12:{length:30,month:2,nextYear:!0,day:20}},this.vulnerableToBceBug="10/11/-79 Saka"!==new Date("0000-01-01T00:00Z").toLocaleDateString("en-US-u-ca-indian",{timeZone:"UTC"})}inLeapYear(e){return ba(e.year+78)}monthsInYear(){return 12}minimumMonthLength(e){return this.getMonthInfo(e).length}maximumMonthLength(e){return this.getMonthInfo(e).length}getMonthInfo(e){const{month:t}=e;let r=this.months[t];if(void 0===r)throw new RangeError(`Invalid month: ${t}`);return this.inLeapYear(e)&&r.leap&&(r=r.leap),r}estimateIsoDate(e){const t=this.adjustCalendarDate(e),r=this.getMonthInfo(t);return xi(t.year+78+(r.nextYear?1:0),r.month,r.day,0,0,0,t.day-1,"constrain")}checkIcuBugs(e){if(this.vulnerableToBceBug&&e.year<1)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 0001-01-01 (see https://bugs.chromium.org/p/v8/issues/detail?id=10529)`)}}function ba(e){return e%4==0&&(e%100!=0||e%400==0)}class _a extends ca{constructor(e,t){super(),this.calendarType="solar",this.v8IsVulnerableToJulianBug=new Date("+001001-01-01T00:00Z").toLocaleDateString("en-US-u-ca-japanese",{timeZone:"UTC"}).startsWith("12"),this.calendarIsVulnerableToJulianBug=!1,this.id=e;const{eras:r,anchorEra:n}=function(e){let t,r=e;if(0===r.length)throw new RangeError("Invalid era data: eras are required");if(1===r.length&&r[0].reverseOf)throw new RangeError("Invalid era data: anchor era cannot count years backwards");if(1===r.length&&!r[0].name)throw new RangeError("Invalid era data: at least one named era is required");if(r.filter((e=>null!=e.reverseOf)).length>1)throw new RangeError("Invalid era data: only one era can count years backwards");r.forEach((e=>{if(e.isAnchor||!e.anchorEpoch&&!e.reverseOf){if(t)throw new RangeError("Invalid era data: cannot have multiple anchor eras");t=e,e.anchorEpoch={year:e.hasYearZero?0:1}}else if(!e.name)throw new RangeError("If era name is blank, it must be the anchor era")})),r=r.filter((e=>e.name)),r.forEach((e=>{const{reverseOf:t}=e;if(t){const n=r.find((e=>e.name===t));if(void 0===n)throw new RangeError(`Invalid era data: unmatched reverseOf era: ${t}`);e.reverseOf=n,e.anchorEpoch=n.anchorEpoch,e.isoEpoch=n.isoEpoch}void 0===e.anchorEpoch.month&&(e.anchorEpoch.month=1),void 0===e.anchorEpoch.day&&(e.anchorEpoch.day=1)})),Go.call(r,((e,t)=>{if(e.reverseOf)return 1;if(t.reverseOf)return-1;if(!e.isoEpoch||!t.isoEpoch)throw new RangeError("Invalid era data: missing ISO epoch");return t.isoEpoch.year-e.isoEpoch.year}));const n=r[r.length-1].reverseOf;if(n&&n!==r[r.length-2])throw new RangeError("Invalid era data: invalid reverse-sign era");return r.forEach(((e,t)=>{e.genericName="era"+(r.length-1-t)})),{eras:r,anchorEra:t||r[0]}}(t);this.anchorEra=n,this.eras=r}inLeapYear(e){const{year:t}=this.estimateIsoDate({month:1,day:1,year:e.year});return ba(t)}monthsInYear(){return 12}minimumMonthLength(e){const{month:t}=e;return 2===t?this.inLeapYear(e)?29:28:[4,6,9,11].indexOf(t)>=0?30:31}maximumMonthLength(e){return this.minimumMonthLength(e)}completeEraYear(e){const t=(t,r)=>{const n=e[t];if(null!=n&&n!=r)throw new RangeError(`Input ${t} ${n} doesn't match calculated value ${r}`)},r=t=>{let r;const n={...e,year:t},i=this.eras.find(((e,i)=>{if(i===this.eras.length-1){if(e.reverseOf){if(t>0)throw new RangeError(`Signed year ${t} is invalid for era ${e.name}`);return r=e.anchorEpoch.year-t,!0}return r=t-e.anchorEpoch.year+(e.hasYearZero?0:1),!0}return this.compareCalendarDates(n,e.anchorEpoch)>=0&&(r=t-e.anchorEpoch.year+(e.hasYearZero?0:1),!0)}));if(!i)throw new RangeError(`Year ${t} was not matched by any era`);return{eraYear:r,era:i.name}};let{year:n,eraYear:i,era:o}=e;if(null!=n)({eraYear:i,era:o}=r(n)),t("era",o),t("eraYear",i);else{if(null==i)throw new RangeError("Either `year` or `eraYear` and `era` are required");{const e=void 0===o?void 0:this.eras.find((e=>e.name===o||e.genericName===o));if(!e)throw new RangeError(`Era ${o} (ISO year ${i}) was not matched by any era`);if(i<1&&e.reverseOf)throw new RangeError(`Years in ${o} era must be positive, not ${n}`);n=e.reverseOf?e.anchorEpoch.year-i:i+e.anchorEpoch.year-(e.hasYearZero?0:1),t("year",n),({eraYear:i,era:o}=r(n))}}return{...e,year:n,eraYear:i,era:o}}adjustCalendarDate(e,t,r="constrain"){let n=e;const{month:i,monthCode:o}=n;return void 0===i&&(n={...n,month:na(o)}),this.validateCalendarDate(n),n=this.completeEraYear(n),super.adjustCalendarDate(n,t,r)}estimateIsoDate(e){const t=this.adjustCalendarDate(e),{year:r,month:n,day:i}=t,{anchorEra:o}=this;return Yt(r+o.isoEpoch.year-(o.hasYearZero?0:1),n,i,"constrain")}checkIcuBugs(e){if(this.calendarIsVulnerableToJulianBug&&this.v8IsVulnerableToJulianBug&&zi(e.year,e.month,e.day,1582,10,15)<0)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 1582-10-15 (see https://bugs.chromium.org/p/chromium/issues/detail?id=1173158)`)}}class Ea extends _a{constructor(e,t){super(e,t)}inLeapYear(e){const{year:t}=e;return(t+1)%4==0}monthsInYear(){return 13}minimumMonthLength(e){const{month:t}=e;return 13===t?this.inLeapYear(e)?6:5:30}maximumMonthLength(e){return this.minimumMonthLength(e)}}class Ta extends Ea{constructor(){super("ethioaa",[{name:"era0",isoEpoch:{year:-5492,month:7,day:17}}])}}class xa extends Ea{constructor(){super("coptic",[{name:"era1",isoEpoch:{year:284,month:8,day:29}},{name:"era0",reverseOf:"era1"}])}}class Ia extends Ea{constructor(){super("ethiopic",[{name:"era0",isoEpoch:{year:-5492,month:7,day:17}},{name:"era1",isoEpoch:{year:8,month:8,day:27},anchorEpoch:{year:5501}}])}}class Sa extends _a{constructor(){super("roc",[{name:"minguo",isoEpoch:{year:1912,month:1,day:1}},{name:"before-roc",reverseOf:"minguo"}]),this.calendarIsVulnerableToJulianBug=!0}}class Ra extends _a{constructor(){super("buddhist",[{name:"be",hasYearZero:!0,isoEpoch:{year:-543,month:1,day:1}}]),this.calendarIsVulnerableToJulianBug=!0}}class ka extends _a{constructor(){super("gregory",[{name:"ce",isoEpoch:{year:1,month:1,day:1}},{name:"bce",reverseOf:"ce"}])}reviseIntlEra(e){let{era:t,eraYear:r}=e;return"bc"!==t&&"b"!==t||(t="bce"),"ad"!==t&&"a"!==t||(t="ce"),{era:t,eraYear:r}}}class Da extends _a{constructor(){super("japanese",[{name:"reiwa",isoEpoch:{year:2019,month:5,day:1},anchorEpoch:{year:2019,month:5,day:1}},{name:"heisei",isoEpoch:{year:1989,month:1,day:8},anchorEpoch:{year:1989,month:1,day:8}},{name:"showa",isoEpoch:{year:1926,month:12,day:25},anchorEpoch:{year:1926,month:12,day:25}},{name:"taisho",isoEpoch:{year:1912,month:7,day:30},anchorEpoch:{year:1912,month:7,day:30}},{name:"meiji",isoEpoch:{year:1868,month:9,day:8},anchorEpoch:{year:1868,month:9,day:8}},{name:"ce",isoEpoch:{year:1,month:1,day:1}},{name:"bce",reverseOf:"ce"}]),this.calendarIsVulnerableToJulianBug=!0,this.eraLength="long",this.erasBeginMidYear=!0}reviseIntlEra(e,t){const{era:r,eraYear:n}=e,{year:i}=t;return this.eras.find((e=>e.name===r))?{era:r,eraYear:n}:i<1?{era:"bce",eraYear:1-i}:{era:"ce",eraYear:i}}}class ja extends ca{constructor(){super(...arguments),this.calendarType="lunisolar",this.hasEra=!1}inLeapYear(e,t){const r=this.getMonthList(e.year,t);return 13===Qo(r).length}monthsInYear(e,t){return this.inLeapYear(e,t)?13:12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}getMonthList(e,t){if(void 0===e)throw new TypeError("Missing year");const r=JSON.stringify({func:"getMonthList",calendarYear:e,id:this.id}),n=t.get(r);if(n)return n;const i=this.getFormatter(),o=(e,t)=>{const r=sa({isoYear:e,isoMonth:2,isoDay:1}),n=new Date(r);n.setUTCDate(t+1);const o=i.formatToParts(n),a=o.find((e=>"month"===e.type)).value,s=+o.find((e=>"day"===e.type)).value;let l=o.find((e=>"relatedYear"===e.type));if(void 0===l)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);return l=+l.value,{calendarMonthString:a,calendarDay:s,calendarYearToVerify:l}};let a=17,{calendarMonthString:s,calendarDay:l,calendarYearToVerify:c}=o(e,a);"1"!==s&&(a+=29,({calendarMonthString:s,calendarDay:l}=o(e,a))),a-=l-5;const u={};let d,h,f=1,p=!1;do{({calendarMonthString:s,calendarDay:l,calendarYearToVerify:c}=o(e,a)),d&&(u[h].daysInMonth=d+30-l),c!==e?p=!0:(u[s]={monthIndex:f++},a+=30),d=l,h=s}while(!p);return u[h].daysInMonth=d+30-l,t.set(r,u),u}estimateIsoDate(e){const{year:t,month:r}=e;return{year:t,month:r>=12?12:r+1,day:1}}adjustCalendarDate(e,t,r="constrain",n=!1){let{year:i,month:o,monthExtra:a,day:s,monthCode:l,eraYear:c}=e;if(n){if(i=c,a&&"bis"!==a)throw new RangeError(`Unexpected leap month suffix: ${a}`);const e=ia(o,void 0!==a),r=`${o}${a||""}`,n=this.getMonthList(i,t)[r];if(void 0===n)throw new RangeError(`Unmatched month ${r} in Chinese year ${i}`);return o=n.monthIndex,{year:i,month:o,day:s,era:void 0,eraYear:c,monthCode:e}}if(this.validateCalendarDate(e),void 0===i&&(i=c),void 0===c&&(c=i),void 0===o){const e=this.getMonthList(i,t);let n=l.replace("L","bis").slice(1);"0"===n[0]&&(n=n.slice(1));let a=e[n];if(o=a&&a.monthIndex,void 0===o&&l.endsWith("L")&&"M13L"!=l&&"constrain"===r){let t=l.slice(1,-1);"0"===t[0]&&(t=t.slice(1)),a=e[t],a&&(o=a.monthIndex,l=ia(t))}if(void 0===o)throw new RangeError(`Unmatched month ${l} in Chinese year ${i}`)}else if(void 0===l){const e=this.getMonthList(i,t),n=Qo(e),a=n.length;"reject"===r?(ii(o,1,a),ii(s,1,this.maximumMonthLength())):(o=ri(o,1,a),s=ri(s,1,this.maximumMonthLength()));const c=n.find((([,e])=>e.monthIndex===o));if(void 0===c)throw new RangeError(`Invalid month ${o} in Chinese year ${i}`);l=ia(c[0].replace("bis",""),-1!==c[0].indexOf("bis"))}else{const e=this.getMonthList(i,t);let r=l.replace("L","bis").slice(1);"0"===r[0]&&(r=r.slice(1));const n=e[r];if(!n)throw new RangeError(`Unmatched monthCode ${l} in Chinese year ${i}`);if(o!==n.monthIndex)throw new RangeError(`monthCode ${l} doesn't correspond to month ${o} in Chinese year ${i}`)}return{...e,year:i,eraYear:c,month:o,monthCode:l,day:s}}}class Na extends ja{constructor(){super(...arguments),this.id="chinese"}}class Oa extends ja{constructor(){super(...arguments),this.id="dangi"}}class Ca{constructor(e){this.helper=e}dateFromFields(e,t,r){const n=new aa,i=ar(e,this.fields(["day","month","monthCode","year"]),[]),o=Gt(t),{year:a,month:s,day:l}=this.helper.calendarToIsoDate(i,o,n),c=wr(a,s,l,r);return n.setObject(c),c}yearMonthFromFields(e,t,r){const n=new aa,i=ar(e,this.fields(["month","monthCode","year"]),[]),o=Gt(t),{year:a,month:s,day:l}=this.helper.calendarToIsoDate({...i,day:1},o,n),c=Ir(a,s,r,l);return n.setObject(c),c}monthDayFromFields(e,t,r){const n=new aa,i=ar(e,this.fields(["day","month","monthCode","year"]),[]),o=Gt(t),{year:a,month:s,day:l}=this.helper.monthDayFromFields(i,o,n),c=Tr(s,l,r,a);return n.setObject(c),c}fields(e){let t=e;return Yo.call(t,"year")&&(t=[...t,"era","eraYear"]),t}fieldKeysToIgnore(e){const t=new Zo;for(let r=0;r<e.length;r++){const n=e[r];switch(nt(Xo,t,[n]),n){case"era":nt(Xo,t,["eraYear"]),nt(Xo,t,["year"]);break;case"eraYear":nt(Xo,t,["era"]),nt(Xo,t,["year"]);break;case"year":nt(Xo,t,["era"]),nt(Xo,t,["eraYear"]);break;case"month":nt(Xo,t,["monthCode"]),this.helper.erasBeginMidYear&&(nt(Xo,t,["era"]),nt(Xo,t,["eraYear"]));break;case"monthCode":nt(Xo,t,["month"]),this.helper.erasBeginMidYear&&(nt(Xo,t,["era"]),nt(Xo,t,["eraYear"]));break;case"day":this.helper.erasBeginMidYear&&(nt(Xo,t,["era"]),nt(Xo,t,["eraYear"]))}}return[...nt(ea,t,[])]}dateAdd(e,t,r,n,i,o,a){const s=aa.getCacheForObject(e),l=this.helper.temporalToCalendarDate(e,s),c=this.helper.addCalendar(l,{years:t,months:r,weeks:n,days:i},o,s),u=this.helper.calendarToIsoDate(c,"constrain",s),{year:d,month:h,day:f}=u,p=wr(d,h,f,a);return new aa(s).setObject(p),p}dateUntil(e,t,r){const n=aa.getCacheForObject(e),i=aa.getCacheForObject(t),o=this.helper.temporalToCalendarDate(e,n),a=this.helper.temporalToCalendarDate(t,i);return this.helper.untilCalendar(o,a,r,n)}year(e){const t=aa.getCacheForObject(e);return this.helper.temporalToCalendarDate(e,t).year}month(e){const t=aa.getCacheForObject(e);return this.helper.temporalToCalendarDate(e,t).month}day(e){const t=aa.getCacheForObject(e);return this.helper.temporalToCalendarDate(e,t).day}era(e){if(!this.helper.hasEra)return;const t=aa.getCacheForObject(e);return this.helper.temporalToCalendarDate(e,t).era}eraYear(e){if(!this.helper.hasEra)return;const t=aa.getCacheForObject(e);return this.helper.temporalToCalendarDate(e,t).eraYear}monthCode(e){const t=aa.getCacheForObject(e);return this.helper.temporalToCalendarDate(e,t).monthCode}dayOfWeek(e){return ta.iso8601.dayOfWeek(e)}dayOfYear(e){const t=aa.getCacheForObject(e),r=this.helper.isoToCalendarDate(e,t),n=this.helper.startOfCalendarYear(r);return this.helper.calendarDaysUntil(n,r,t)+1}weekOfYear(e){return ta.iso8601.weekOfYear(e)}yearOfWeek(e){return ta.iso8601.yearOfWeek(e)}daysInWeek(e){return ta.iso8601.daysInWeek(e)}daysInMonth(e){const t=aa.getCacheForObject(e),r=this.helper.temporalToCalendarDate(e,t),n=this.helper.maximumMonthLength(r);if(n===this.helper.minimumMonthLength(r))return n;const i=this.helper.startOfCalendarMonth(r),o=this.helper.addMonthsCalendar(i,1,"constrain",t);return this.helper.calendarDaysUntil(i,o,t)}daysInYear(e){let t=e;Z(t,b)||(t=lr(t));const r=aa.getCacheForObject(t),n=this.helper.temporalToCalendarDate(t,r),i=this.helper.startOfCalendarYear(n),o=this.helper.addCalendar(i,{years:1},"constrain",r);return this.helper.calendarDaysUntil(i,o,r)}monthsInYear(e){const t=aa.getCacheForObject(e),r=this.helper.temporalToCalendarDate(e,t);return this.helper.monthsInYear(r,t)}inLeapYear(e){let t=e;Z(t,b)||(t=lr(t));const r=aa.getCacheForObject(t),n=this.helper.temporalToCalendarDate(t,r);return this.helper.inLeapYear(n,r)}}for(const e of[ua,va,Ia,Ta,xa,Na,Oa,Sa,wa,Ra,ka,Da,ha,fa,pa,ma,ya,ga]){const t=new e;ta[t.id]=new Ca(t)}class Aa{constructor(e,t,r,n="iso8601"){vr(this,ct(e),ct(t),ct(r),Jr(n))}get calendarId(){if(!Nt(this))throw new TypeError("invalid receiver");return Vr(K(this,D))}get era(){if(!Nt(this))throw new TypeError("invalid receiver");return Lr(K(this,D),this)}get eraYear(){if(!Nt(this))throw new TypeError("invalid receiver");return Pr(K(this,D),this)}get year(){if(!Nt(this))throw new TypeError("invalid receiver");return Or(K(this,D),this)}get month(){if(!Nt(this))throw new TypeError("invalid receiver");return Cr(K(this,D),this)}get monthCode(){if(!Nt(this))throw new TypeError("invalid receiver");return Ar(K(this,D),this)}get day(){if(!Nt(this))throw new TypeError("invalid receiver");return Mr(K(this,D),this)}get dayOfWeek(){if(!Nt(this))throw new TypeError("invalid receiver");return Br(K(this,D),this)}get dayOfYear(){if(!Nt(this))throw new TypeError("invalid receiver");return $r(K(this,D),this)}get weekOfYear(){if(!Nt(this))throw new TypeError("invalid receiver");return Fr(K(this,D),this)}get yearOfWeek(){if(!Nt(this))throw new TypeError("invalid receiver");return Ur(K(this,D),this)}get daysInWeek(){if(!Nt(this))throw new TypeError("invalid receiver");return qr(K(this,D),this)}get daysInMonth(){if(!Nt(this))throw new TypeError("invalid receiver");return Yr(K(this,D),this)}get daysInYear(){if(!Nt(this))throw new TypeError("invalid receiver");return Wr(K(this,D),this)}get monthsInYear(){if(!Nt(this))throw new TypeError("invalid receiver");return zr(K(this,D),this)}get inLeapYear(){if(!Nt(this))throw new TypeError("invalid receiver");return Gr(K(this,D),this)}with(e,t){if(!Nt(this))throw new TypeError("invalid receiver");if(!it(e))throw new TypeError("invalid argument");Pt(e);const r=eo(t),n=K(this,D),i=kr(n,["day","month","monthCode","year"]);let o=ar(this,i,[]);return o=Dr(n,o,ar(e,i,"partial")),o=ar(o,i,[]),en(n,o,r)}withCalendar(e){if(!Nt(this))throw new TypeError("invalid receiver");const t=Jr(e);return new Aa(K(this,b),K(this,_),K(this,E),t)}add(e,t){if(!Nt(this))throw new TypeError("invalid receiver");const r=dr(e),n=eo(t);return jr(K(this,D),this,r,n)}subtract(e,t){if(!Nt(this))throw new TypeError("invalid receiver");const r=ti(dr(e)),n=eo(t);return jr(K(this,D),this,r,n)}until(e,t){if(!Nt(this))throw new TypeError("invalid receiver");return wi("until",this,e,t)}since(e,t){if(!Nt(this))throw new TypeError("invalid receiver");return wi("since",this,e,t)}equals(e){if(!Nt(this))throw new TypeError("invalid receiver");const t=lr(e);for(const e of[b,_,E])if(K(this,e)!==K(t,e))return!1;return Zr(K(this,D),K(t,D))}toString(e){if(!Nt(this))throw new TypeError("invalid receiver");return _n(this,Qt(eo(e)))}toJSON(){if(!Nt(this))throw new TypeError("invalid receiver");return _n(this)}toLocaleString(e,t){if(!Nt(this))throw new TypeError("invalid receiver");return new Do(e,t).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainDate")}toPlainDateTime(e){if(!Nt(this))throw new TypeError("invalid receiver");const t=K(this,b),r=K(this,_),n=K(this,E),i=K(this,D);if(void 0===e)return _r(t,r,n,0,0,0,0,0,0,i);const o=pr(e);return _r(t,r,n,K(o,T),K(o,x),K(o,I),K(o,S),K(o,R),K(o,k),i)}toZonedDateTime(e){if(!Nt(this))throw new TypeError("invalid receiver");let t,r;if(it(e))if(kt(e))t=e;else{const n=e.timeZone;void 0===n?t=nn(e):(t=nn(n),r=e.plainTime)}else t=nn(e);const n=K(this,b),i=K(this,_),o=K(this,E),a=K(this,D);let s=0,l=0,c=0,u=0,d=0,h=0;return void 0!==r&&(r=pr(r),s=K(r,T),l=K(r,x),c=K(r,I),u=K(r,S),d=K(r,R),h=K(r,k)),Rr(K(fn(t,_r(n,i,o,s,l,c,u,d,h,a),"compatible"),v),t,a)}toPlainYearMonth(){if(!Nt(this))throw new TypeError("invalid receiver");const e=K(this,D);return tn(e,ar(this,kr(e,["monthCode","year"]),[]))}toPlainMonthDay(){if(!Nt(this))throw new TypeError("invalid receiver");const e=K(this,D);return rn(e,ar(this,kr(e,["day","monthCode"]),[]))}getISOFields(){if(!Nt(this))throw new TypeError("invalid receiver");return{calendar:K(this,D),isoDay:K(this,E),isoMonth:K(this,_),isoYear:K(this,b)}}getCalendar(){if(!Nt(this))throw new TypeError("invalid receiver");return Qr(K(this,D))}static from(e,t){const r=eo(t);return Nt(e)?(Gt(r),wr(K(e,b),K(e,_),K(e,E),K(e,D))):lr(e,r)}static compare(e,t){const r=lr(e),n=lr(t);return zi(K(r,b),K(r,_),K(r,E),K(n,b),K(n,_),K(n,E))}}f(Aa,"Temporal.PlainDate");class Ma{constructor(e,t,r,n=0,i=0,o=0,a=0,s=0,l=0,c="iso8601"){br(this,ct(e),ct(t),ct(r),void 0===n?0:ct(n),void 0===i?0:ct(i),void 0===o?0:ct(o),void 0===a?0:ct(a),void 0===s?0:ct(s),void 0===l?0:ct(l),Jr(c))}get calendarId(){if(!Ct(this))throw new TypeError("invalid receiver");return Vr(K(this,D))}get year(){if(!Ct(this))throw new TypeError("invalid receiver");return Or(K(this,D),this)}get month(){if(!Ct(this))throw new TypeError("invalid receiver");return Cr(K(this,D),this)}get monthCode(){if(!Ct(this))throw new TypeError("invalid receiver");return Ar(K(this,D),this)}get day(){if(!Ct(this))throw new TypeError("invalid receiver");return Mr(K(this,D),this)}get hour(){if(!Ct(this))throw new TypeError("invalid receiver");return K(this,T)}get minute(){if(!Ct(this))throw new TypeError("invalid receiver");return K(this,x)}get second(){if(!Ct(this))throw new TypeError("invalid receiver");return K(this,I)}get millisecond(){if(!Ct(this))throw new TypeError("invalid receiver");return K(this,S)}get microsecond(){if(!Ct(this))throw new TypeError("invalid receiver");return K(this,R)}get nanosecond(){if(!Ct(this))throw new TypeError("invalid receiver");return K(this,k)}get era(){if(!Ct(this))throw new TypeError("invalid receiver");return Lr(K(this,D),this)}get eraYear(){if(!Ct(this))throw new TypeError("invalid receiver");return Pr(K(this,D),this)}get dayOfWeek(){if(!Ct(this))throw new TypeError("invalid receiver");return Br(K(this,D),this)}get dayOfYear(){if(!Ct(this))throw new TypeError("invalid receiver");return $r(K(this,D),this)}get weekOfYear(){if(!Ct(this))throw new TypeError("invalid receiver");return Fr(K(this,D),this)}get yearOfWeek(){if(!Ct(this))throw new TypeError("invalid receiver");return Ur(K(this,D),this)}get daysInWeek(){if(!Ct(this))throw new TypeError("invalid receiver");return qr(K(this,D),this)}get daysInYear(){if(!Ct(this))throw new TypeError("invalid receiver");return Wr(K(this,D),this)}get daysInMonth(){if(!Ct(this))throw new TypeError("invalid receiver");return Yr(K(this,D),this)}get monthsInYear(){if(!Ct(this))throw new TypeError("invalid receiver");return zr(K(this,D),this)}get inLeapYear(){if(!Ct(this))throw new TypeError("invalid receiver");return Gr(K(this,D),this)}with(e,t){if(!Ct(this))throw new TypeError("invalid receiver");if(!it(e))throw new TypeError("invalid argument");Pt(e);const r=eo(t),n=K(this,D),i=kr(n,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);let o=ar(this,i,[]);o=Dr(n,o,ar(e,i,"partial")),o=ar(o,i,[]);const{year:a,month:s,day:l,hour:c,minute:u,second:d,millisecond:h,microsecond:f,nanosecond:p}=cr(n,o,r);return _r(a,s,l,c,u,d,h,f,p,n)}withPlainTime(e){if(!Ct(this))throw new TypeError("invalid receiver");const t=K(this,b),r=K(this,_),n=K(this,E),i=K(this,D);if(void 0===e)return _r(t,r,n,0,0,0,0,0,0,i);const o=pr(e);return _r(t,r,n,K(o,T),K(o,x),K(o,I),K(o,S),K(o,R),K(o,k),i)}withPlainDate(e){if(!Ct(this))throw new TypeError("invalid receiver");const t=lr(e),r=K(t,b),n=K(t,_),i=K(t,E);let o=K(t,D);const a=K(this,T),s=K(this,x),l=K(this,I),c=K(this,S),u=K(this,R),d=K(this,k);return o=Xr(K(this,D),o),_r(r,n,i,a,s,l,c,u,d,o)}withCalendar(e){if(!Ct(this))throw new TypeError("invalid receiver");const t=Jr(e);return new Ma(K(this,b),K(this,_),K(this,E),K(this,T),K(this,x),K(this,I),K(this,S),K(this,R),K(this,k),t)}add(e,t){if(!Ct(this))throw new TypeError("invalid receiver");return Oi("add",this,e,t)}subtract(e,t){if(!Ct(this))throw new TypeError("invalid receiver");return Oi("subtract",this,e,t)}until(e,t){if(!Ct(this))throw new TypeError("invalid receiver");return bi("until",this,e,t)}since(e,t){if(!Ct(this))throw new TypeError("invalid receiver");return bi("since",this,e,t)}round(e){if(!Ct(this))throw new TypeError("invalid receiver");if(void 0===e)throw new TypeError("options parameter is required");const t="string"==typeof e?to("smallestUnit",e):eo(e),r=Zt(t),n=Ht(t,"halfExpand"),i=rr(t,"smallestUnit","time",tr,["day"]),o={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[i];Kt(r,o,1===o);let a=K(this,b),s=K(this,_),l=K(this,E),c=K(this,T),u=K(this,x),d=K(this,I),h=K(this,S),f=K(this,R),p=K(this,k);return({year:a,month:s,day:l,hour:c,minute:u,second:d,millisecond:h,microsecond:f,nanosecond:p}=Bi(a,s,l,c,u,d,h,f,p,r,i,n)),_r(a,s,l,c,u,d,h,f,p,K(this,D))}equals(e){if(!Ct(this))throw new TypeError("invalid receiver");const t=ur(e);for(const e of[b,_,E,T,x,I,S,R,k])if(K(this,e)!==K(t,e))return!1;return Zr(K(this,D),K(t,D))}toString(e){if(!Ct(this))throw new TypeError("invalid receiver");const t=eo(e),r=Qt(t),n=Xt(t),i=Ht(t,"trunc"),o=rr(t,"smallestUnit","time",void 0);if("hour"===o)throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:a,unit:s,increment:l}=er(o,n);return En(this,a,r,{unit:s,increment:l,roundingMode:i})}toJSON(){if(!Ct(this))throw new TypeError("invalid receiver");return En(this,"auto")}toLocaleString(e,t){if(!Ct(this))throw new TypeError("invalid receiver");return new Do(e,t).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainDateTime")}toZonedDateTime(e,t){if(!Ct(this))throw new TypeError("invalid receiver");const r=nn(e);return Rr(K(fn(r,this,Jt(eo(t))),v),r,K(this,D))}toPlainDate(){if(!Ct(this))throw new TypeError("invalid receiver");return ln(this)}toPlainYearMonth(){if(!Ct(this))throw new TypeError("invalid receiver");const e=K(this,D);return tn(e,ar(this,kr(e,["monthCode","year"]),[]))}toPlainMonthDay(){if(!Ct(this))throw new TypeError("invalid receiver");const e=K(this,D);return rn(e,ar(this,kr(e,["day","monthCode"]),[]))}toPlainTime(){if(!Ct(this))throw new TypeError("invalid receiver");return cn(this)}getISOFields(){if(!Ct(this))throw new TypeError("invalid receiver");return{calendar:K(this,D),isoDay:K(this,E),isoHour:K(this,T),isoMicrosecond:K(this,R),isoMillisecond:K(this,S),isoMinute:K(this,x),isoMonth:K(this,_),isoNanosecond:K(this,k),isoSecond:K(this,I),isoYear:K(this,b)}}getCalendar(){if(!Ct(this))throw new TypeError("invalid receiver");return Qr(K(this,D))}static from(e,t){const r=eo(t);return Ct(e)?(Gt(r),_r(K(e,b),K(e,_),K(e,E),K(e,T),K(e,x),K(e,I),K(e,S),K(e,R),K(e,k),K(e,D))):ur(e,r)}static compare(e,t){const r=ur(e),n=ur(t);for(const e of[b,_,E,T,x,I,S,R,k]){const t=K(r,e),i=K(n,e);if(t!==i)return Xi(t-i)}return 0}}f(Ma,"Temporal.PlainDateTime");class La{constructor(e=0,t=0,r=0,n=0,i=0,o=0,a=0,s=0,l=0,c=0){const u=void 0===e?0:dt(e),d=void 0===t?0:dt(t),h=void 0===r?0:dt(r),f=void 0===n?0:dt(n),p=void 0===i?0:dt(i),m=void 0===o?0:dt(o),y=void 0===a?0:dt(a),g=void 0===s?0:dt(s),v=void 0===l?0:dt(l),w=void 0===c?0:dt(c);di(u,d,h,f,p,m,y,g,v,w),Q(this),X(this,M,u),X(this,L,d),X(this,P,h),X(this,B,f),X(this,$,p),X(this,F,m),X(this,U,y),X(this,q,g),X(this,Y,v),X(this,W,w)}get years(){if(!jt(this))throw new TypeError("invalid receiver");return K(this,M)}get months(){if(!jt(this))throw new TypeError("invalid receiver");return K(this,L)}get weeks(){if(!jt(this))throw new TypeError("invalid receiver");return K(this,P)}get days(){if(!jt(this))throw new TypeError("invalid receiver");return K(this,B)}get hours(){if(!jt(this))throw new TypeError("invalid receiver");return K(this,$)}get minutes(){if(!jt(this))throw new TypeError("invalid receiver");return K(this,F)}get seconds(){if(!jt(this))throw new TypeError("invalid receiver");return K(this,U)}get milliseconds(){if(!jt(this))throw new TypeError("invalid receiver");return K(this,q)}get microseconds(){if(!jt(this))throw new TypeError("invalid receiver");return K(this,Y)}get nanoseconds(){if(!jt(this))throw new TypeError("invalid receiver");return K(this,W)}get sign(){if(!jt(this))throw new TypeError("invalid receiver");return Wn(K(this,M),K(this,L),K(this,P),K(this,B),K(this,$),K(this,F),K(this,U),K(this,q),K(this,Y),K(this,W))}get blank(){if(!jt(this))throw new TypeError("invalid receiver");return 0===Wn(K(this,M),K(this,L),K(this,P),K(this,B),K(this,$),K(this,F),K(this,U),K(this,q),K(this,Y),K(this,W))}with(e){if(!jt(this))throw new TypeError("invalid receiver");const t=ar(e,["days","hours","microseconds","milliseconds","minutes","months","nanoseconds","seconds","weeks","years"],"partial"),{years:r=K(this,M),months:n=K(this,L),weeks:i=K(this,P),days:o=K(this,B),hours:a=K(this,$),minutes:s=K(this,F),seconds:l=K(this,U),milliseconds:c=K(this,q),microseconds:u=K(this,Y),nanoseconds:d=K(this,W)}=t;return new La(r,n,i,o,a,s,l,c,u,d)}negated(){if(!jt(this))throw new TypeError("invalid receiver");return ti(this)}abs(){if(!jt(this))throw new TypeError("invalid receiver");return new La(Math.abs(K(this,M)),Math.abs(K(this,L)),Math.abs(K(this,P)),Math.abs(K(this,B)),Math.abs(K(this,$)),Math.abs(K(this,F)),Math.abs(K(this,U)),Math.abs(K(this,q)),Math.abs(K(this,Y)),Math.abs(K(this,W)))}add(e,t){if(!jt(this))throw new TypeError("invalid receiver");return ji("add",this,e,t)}subtract(e,t){if(!jt(this))throw new TypeError("invalid receiver");return ji("subtract",this,e,t)}round(e){if(!jt(this))throw new TypeError("invalid receiver");if(void 0===e)throw new TypeError("options parameter is required");let t=K(this,M),r=K(this,L),n=K(this,P),i=K(this,B),o=K(this,$),a=K(this,F),s=K(this,U),l=K(this,q),c=K(this,Y),u=K(this,W),h=ir(t,r,n,i,o,a,s,l,c,u);const f="string"==typeof e?to("smallestUnit",e):eo(e);let p=rr(f,"largestUnit","datetime",void 0,["auto"]),y=nr(f);const g=Zt(f),v=Ht(f,"halfExpand");let w=rr(f,"smallestUnit","datetime",void 0),b=!0;w||(b=!1,w="nanosecond"),h=or(h,w);let _=!0;if(p||(_=!1,p=h),"auto"===p&&(p=h),!b&&!_)throw new RangeError("at least one of smallestUnit or largestUnit is required");if(or(p,w)!==p)throw new RangeError(`largestUnit ${p} cannot be smaller than smallestUnit ${w}`);const E={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[w];return void 0!==E&&Kt(g,E,!1),({years:t,months:r,weeks:n,days:i}=Xn(t,r,n,i,p,y)),({years:t,months:r,weeks:n,days:i,hours:o,minutes:a,seconds:s,milliseconds:l,microseconds:c,nanoseconds:u}=Wi(t,r,n,i,o,a,s,l,c,u,g,w,v,y)),({years:t,months:r,weeks:n,days:i,hours:o,minutes:a,seconds:s,milliseconds:l,microseconds:c,nanoseconds:u}=Yi(t,r,n,i,o,a,s,l,c,u,g,w,v,y)),({days:i,hours:o,minutes:a,seconds:s,milliseconds:l,microseconds:c,nanoseconds:u}=Zn(i,o,a,s,l,c,u,p,y)),({years:t,months:r,weeks:n,days:i}=function(e,t,r,n,i,o){const a=m("%Temporal.Duration%"),s=Wn(e,t,r,n,0,0,0,0,0,0);if(0===s)return{years:e,months:t,weeks:r,days:n};const l=d.BigInt(s);let c,u,h=d.BigInt(e),f=d.BigInt(t),p=d.BigInt(r),y=d.BigInt(n);o&&(u=lr(o),c=K(u,D));const g=new a(s),v=new a(0,s),w=new a(0,0,s);switch(i){case"year":{if(!c)throw new RangeError("a starting point is required for years balancing");const e="string"!=typeof c?rt(c,"dateAdd"):void 0;let t,r,n;for(({relativeTo:t,days:r}=Ui(c,u,g,e));d.greaterThanOrEqual(mt(y),d.BigInt(Ee(r)));)y=d.subtract(y,d.BigInt(r)),h=d.add(h,l),u=t,({relativeTo:t,days:r}=Ui(c,u,g,e));for(({relativeTo:t,days:n}=Ui(c,u,v,e));d.greaterThanOrEqual(mt(y),d.BigInt(Ee(n)));)y=d.subtract(y,d.BigInt(n)),f=d.add(f,l),u=t,({relativeTo:t,days:n}=Ui(c,u,v,e));t=jr(c,u,g,void 0,e);const i="string"!=typeof c?rt(c,"dateUntil"):void 0,o=Ne(null);o.largestUnit="month";let a=Nr(c,u,t,o,i),s=K(a,L);for(;d.greaterThanOrEqual(mt(f),d.BigInt(Ee(s)));){f=d.subtract(f,d.BigInt(s)),h=d.add(h,l),u=t,t=jr(c,u,g,void 0,e);const r=Ne(null);r.largestUnit="month",a=Nr(c,u,t,r,i),s=K(a,L)}break}case"month":{if(!c)throw new RangeError("a starting point is required for months balancing");const e="string"!=typeof c?rt(c,"dateAdd"):void 0;let t,r;for(({relativeTo:t,days:r}=Ui(c,u,v,e));d.greaterThanOrEqual(mt(y),d.BigInt(Ee(r)));)y=d.subtract(y,d.BigInt(r)),f=d.add(f,l),u=t,({relativeTo:t,days:r}=Ui(c,u,v,e));break}case"week":{if(!c)throw new RangeError("a starting point is required for weeks balancing");const e="string"!=typeof c?rt(c,"dateAdd"):void 0;let t,r;for(({relativeTo:t,days:r}=Ui(c,u,w,e));d.greaterThanOrEqual(mt(y),d.BigInt(Ee(r)));)y=d.subtract(y,d.BigInt(r)),p=d.add(p,l),u=t,({relativeTo:t,days:r}=Ui(c,u,w,e));break}}return{years:d.toNumber(h),months:d.toNumber(f),weeks:d.toNumber(p),days:d.toNumber(y)}}(t,r,n,i,p,y)),new La(t,r,n,i,o,a,s,l,c,u)}total(e){if(!jt(this))throw new TypeError("invalid receiver");let t=K(this,M),r=K(this,L),n=K(this,P),i=K(this,B),o=K(this,$),a=K(this,F),s=K(this,U),l=K(this,q),c=K(this,Y),u=K(this,W);if(void 0===e)throw new TypeError("options argument is required");const d="string"==typeof e?to("unit",e):eo(e),h=nr(d),f=rr(d,"unit","datetime",tr);let p;({years:t,months:r,weeks:n,days:i}=Xn(t,r,n,i,f,h)),Lt(h)&&(p=qi(h,t,r,n,0));let m=Kn(i,o,a,s,l,c,u,f,p);if("positive overflow"===m)return 1/0;if("negative overflow"===m)return-1/0;({days:i,hours:o,minutes:a,seconds:s,milliseconds:l,microseconds:c,nanoseconds:u}=m);const{total:y}=Wi(t,r,n,i,o,a,s,l,c,u,1,f,"trunc",h);return y}toString(e){if(!jt(this))throw new TypeError("invalid receiver");const t=eo(e),r=Xt(t),n=Ht(t,"trunc"),i=rr(t,"smallestUnit","time",void 0);if("hour"===i||"minute"===i)throw new RangeError('smallestUnit must be a time unit other than "hours" or "minutes"');const{precision:o,unit:a,increment:s}=er(i,r);return bn(this,o,{unit:a,increment:s,roundingMode:n})}toJSON(){if(!jt(this))throw new TypeError("invalid receiver");return bn(this)}toLocaleString(e,t){if(!jt(this))throw new TypeError("invalid receiver");return"undefined"!=typeof Intl&&void 0!==Intl.DurationFormat?new Intl.DurationFormat(e,t).format(this):(console.warn("Temporal.Duration.prototype.toLocaleString() requires Intl.DurationFormat."),bn(this))}valueOf(){throw new TypeError("use compare() to compare Temporal.Duration")}static from(e){return jt(e)?new La(K(e,M),K(e,L),K(e,P),K(e,B),K(e,$),K(e,F),K(e,U),K(e,q),K(e,Y),K(e,W)):dr(e)}static compare(e,t,r){const n=dr(e),i=dr(t),o=nr(eo(r)),a=K(n,M),s=K(n,L),l=K(n,P);let c=K(n,B);const u=K(n,$),h=K(n,F),f=K(n,U),p=K(n,q),m=K(n,Y);let y=K(n,W);const g=K(i,M),v=K(i,L),w=K(i,P);let b=K(i,B);const _=K(i,$),E=K(i,F),T=K(i,U),x=K(i,q),I=K(i,Y);let S=K(i,W);const R=ei(o,a,s,l,c),k=ei(o,g,v,w,b);0===a&&0===g&&0===s&&0===v&&0===l&&0===w||(({days:c}=Xn(a,s,l,c,"day",o)),({days:b}=Xn(g,v,w,b,"day",o)));const D=Vn(c,u,h,f,p,m,y,R),j=Vn(b,_,E,T,x,I,S,k);return Xi(d.toNumber(d.subtract(D,j)))}}f(La,"Temporal.Duration");const Pa=Object.create;class Ba{constructor(e,t,r="iso8601",n=1972){Er(this,ct(e),ct(t),Jr(r),ct(n))}get monthCode(){if(!Mt(this))throw new TypeError("invalid receiver");return Ar(K(this,D),this)}get day(){if(!Mt(this))throw new TypeError("invalid receiver");return Mr(K(this,D),this)}get calendarId(){if(!Mt(this))throw new TypeError("invalid receiver");return Vr(K(this,D))}with(e,t){if(!Mt(this))throw new TypeError("invalid receiver");if(!it(e))throw new TypeError("invalid argument");Pt(e);const r=eo(t),n=K(this,D),i=kr(n,["day","month","monthCode","year"]);let o=ar(this,i,[]);return o=Dr(n,o,ar(e,i,"partial")),o=ar(o,i,[]),rn(n,o,r)}equals(e){if(!Mt(this))throw new TypeError("invalid receiver");const t=fr(e);for(const e of[_,E,b])if(K(this,e)!==K(t,e))return!1;return Zr(K(this,D),K(t,D))}toString(e){if(!Mt(this))throw new TypeError("invalid receiver");return Tn(this,Qt(eo(e)))}toJSON(){if(!Mt(this))throw new TypeError("invalid receiver");return Tn(this)}toLocaleString(e,t){if(!Mt(this))throw new TypeError("invalid receiver");return new Do(e,t).format(this)}valueOf(){throw new TypeError("use equals() to compare Temporal.PlainMonthDay")}toPlainDate(e){if(!Mt(this))throw new TypeError("invalid receiver");if(!it(e))throw new TypeError("argument should be an object");const t=K(this,D),r=kr(t,["day","monthCode"]),n=ar(this,r,[]),i=kr(t,["year"]);let o=Dr(t,n,ar(e,i,[]));o=ar(o,[...new Set([...r,...i])],[]);const a=Pa(null);return a.overflow="reject",en(t,o,a)}getISOFields(){if(!Mt(this))throw new TypeError("invalid receiver");return{calendar:K(this,D),isoDay:K(this,E),isoMonth:K(this,_),isoYear:K(this,b)}}getCalendar(){if(!Mt(this))throw new TypeError("invalid receiver");return Qr(K(this,D))}static from(e,t){const r=eo(t);return Mt(e)?(Gt(r),Tr(K(e,_),K(e,E),K(e,D),K(e,b))):fr(e,r)}}f(Ba,"Temporal.PlainMonthDay");const $a=()=>new(m("%Temporal.Instant%"))(Zi()),Fa=(e,t=Ki())=>{const r=nn(t),n=Jr(e);return hn(r,$a(),n)},Ua=(e=Ki())=>hn(nn(e),$a(),"iso8601"),qa=(e,t=Ki())=>{const r=nn(t),n=Jr(e);return Rr(Zi(),r,n)},Ya={instant:$a,plainDateTime:Fa,plainDateTimeISO:Ua,plainDate:(e,t=Ki())=>ln(Fa(e,t)),plainDateISO:(e=Ki())=>ln(Ua(e)),plainTimeISO:(e=Ki())=>cn(Ua(e)),timeZoneId:()=>Ki(),zonedDateTime:qa,zonedDateTimeISO:(e=Ki())=>qa("iso8601",e),[Symbol.toStringTag]:"Temporal.Now"};Object.defineProperty(Ya,Symbol.toStringTag,{value:"Temporal.Now",writable:!1,enumerable:!1,configurable:!0});const Wa=Object.assign;function za(e,t,r){let n=K(e,T),i=K(e,x),o=K(e,I),a=K(e,S),s=K(e,R),l=K(e,k);if(r){const{unit:e,increment:t,roundingMode:c}=r;({hour:n,minute:i,second:o,millisecond:a,microsecond:s,nanosecond:l}=$i(n,i,o,a,s,l,t,e,c))}return`${gn(n)}:${gn(i)}${vn(o,a,s,l,t)}`}class Ga{constructor(e=0,t=0,r=0,n=0,i=0,o=0){const a=void 0===e?0:ct(e),s=void 0===t?0:ct(t),l=void 0===r?0:ct(r),c=void 0===n?0:ct(n),u=void 0===i?0:ct(i),d=void 0===o?0:ct(o);si(a,s,l,c,u,d),Q(this),X(this,T,a),X(this,x,s),X(this,I,l),X(this,S,c),X(this,R,u),X(this,k,d)}get hour(){if(!Ot(this))throw new TypeError("invalid receiver");return K(this,T)}get minute(){if(!Ot(this))throw new TypeError("invalid receiver");return K(this,x)}get second(){if(!Ot(this))throw new TypeError("invalid receiver");return K(this,I)}get millisecond(){if(!Ot(this))throw new TypeError("invalid receiver");return K(this,S)}get microsecond(){if(!Ot(this))throw new TypeError("invalid receiver");return K(this,R)}get nanosecond(){if(!Ot(this))throw new TypeError("invalid receiver");return K(this,k)}with(e,t){if(!Ot(this))throw new TypeError("invalid receiver");if(!it(e))throw new TypeError("invalid argument");Pt(e);const r=Gt(eo(t)),n=sr(e,"partial"),i=sr(this);let{hour:o,minute:a,second:s,millisecond:l,microsecond:c,nanosecond:u}=Wa(i,n);return({hour:o,minute:a,second:s,millisecond:l,microsecond:c,nanosecond:u}=Wt(o,a,s,l,c,u,r)),new Ga(o,a,s,l,c,u)}add(e){if(!Ot(this))throw new TypeError("invalid receiver");return Ci("add",this,e)}subtract(e){if(!Ot(this))throw new TypeError("invalid receiver");return Ci("subtract",this,e)}until(e,t){if(!Ot(this))throw new TypeError("invalid receiver");return _i("until",this,e,t)}since(e,t){if(!Ot(this))throw new TypeError("invalid receiver");return _i("since",this,e,t)}round(e){if(!Ot(this))throw new TypeError("invalid receiver");if(void 0===e)throw new TypeError("options parameter is required");const t="string"==typeof e?to("smallestUnit",e):eo(e),r=Zt(t),n=Ht(t,"halfExpand"),i=rr(t,"smallestUnit","time",tr);Kt(r,{hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[i],!1);let o=K(this,T),a=K(this,x),s=K(this,I),l=K(this,S),c=K(this,R),u=K(this,k);return({hour:o,minute:a,second:s,millisecond:l,microsecond:c,nanosecond:u}=$i(o,a,s,l,c,u,r,i,n)),new Ga(o,a,s,l,c,u)}equals(e){if(!Ot(this))throw new TypeError("invalid receiver");const t=pr(e);for(const e of[T,x,I,S,R,k])if(K(this,e)!==K(t,e))return!1;return!0}toString(e){if(!Ot(this))throw new TypeError("invalid receiver");const t=eo(e),r=Xt(t),n=Ht(t,"trunc"),i=rr(t,"smallestUnit","time",void 0);if("hour"===i)throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:o,unit:a,increment:s}=er(i,r);return za(this,o,{unit:a,increment:s,roundingMode:n})}toJSON(){if(!Ot(this))throw new TypeError("invalid receiver");return za(this,"auto")}toLocaleString(e,t){if(!Ot(this))throw new TypeError("invalid receiver");return new Do(e,t).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainTime")}toPlainDateTime(e){if(!Ot(this))throw new TypeError("invalid receiver");const t=lr(e),r=K(t,b),n=K(t,_),i=K(t,E),o=K(t,D);return _r(r,n,i,K(this,T),K(this,x),K(this,I),K(this,S),K(this,R),K(this,k),o)}toZonedDateTime(e){if(!Ot(this))throw new TypeError("invalid receiver");if(!it(e))throw new TypeError("invalid argument");const t=e.plainDate;if(void 0===t)throw new TypeError("missing date property");const r=lr(t),n=e.timeZone;if(void 0===n)throw new TypeError("missing timeZone property");const i=nn(n),o=K(r,b),a=K(r,_),s=K(r,E),l=K(r,D),c=K(this,T),u=K(this,x),d=K(this,I),h=K(this,S),f=K(this,R),p=K(this,k);return Rr(K(fn(i,new(m("%Temporal.PlainDateTime%"))(o,a,s,c,u,d,h,f,p,l),"compatible"),v),i,l)}getISOFields(){if(!Ot(this))throw new TypeError("invalid receiver");return{isoHour:K(this,T),isoMicrosecond:K(this,R),isoMillisecond:K(this,S),isoMinute:K(this,x),isoNanosecond:K(this,k),isoSecond:K(this,I)}}static from(e,t){const r=Gt(eo(t));return Ot(e)?new Ga(K(e,T),K(e,x),K(e,I),K(e,S),K(e,R),K(e,k)):pr(e,r)}static compare(e,t){const r=pr(e),n=pr(t);for(const e of[T,x,I,S,R,k]){const t=K(r,e),i=K(n,e);if(t!==i)return Xi(t-i)}return 0}}f(Ga,"Temporal.PlainTime");class Ja{constructor(e){if(arguments.length<1)throw new RangeError("missing argument: identifier is required");const t=kn(e);Q(this),X(this,w,t)}get id(){if(!kt(this))throw new TypeError("invalid receiver");return K(this,w)}getOffsetNanosecondsFor(e){if(!kt(this))throw new TypeError("invalid receiver");const t=hr(e),r=K(this,w);return Sn(r)?Rn(r):Dn(r,K(t,v))}getOffsetStringFor(e){if(!kt(this))throw new TypeError("invalid receiver");return dn(this,hr(e))}getPlainDateTimeFor(e,t="iso8601"){if(!kt(this))throw new TypeError("invalid receiver");return hn(this,hr(e),Jr(t))}getInstantFor(e,t){if(!kt(this))throw new TypeError("invalid receiver");return fn(this,ur(e),Jt(eo(t)))}getPossibleInstantsFor(e){if(!kt(this))throw new TypeError("invalid receiver");const t=ur(e),r=m("%Temporal.Instant%"),n=K(this,w);if(Sn(n)){const e=On(K(t,b),K(t,_),K(t,E),K(t,T),K(t,x),K(t,I),K(t,S),K(t,R),K(t,k));if(null===e)throw new RangeError("DateTime outside of supported range");const i=Rn(n);return[new r(d.subtract(e,d.BigInt(i)))]}const i=function(e,t,r,n,i,o,a,s,l,c){const u=On(t,r,n,i,o,a,s,l,c);if(null===u)throw new RangeError("DateTime outside of supported range");let h=d.subtract(u,ze);d.lessThan(h,Ge)&&(h=u);let f=d.add(u,ze);d.greaterThan(f,Je)&&(f=u);const p=Dn(e,h),m=Dn(e,f);return(p===m?[p]:[p,m]).map((h=>{const f=d.subtract(u,d.BigInt(h)),p=An(e,f);if(t===p.year&&r===p.month&&n===p.day&&i===p.hour&&o===p.minute&&a===p.second&&s===p.millisecond&&l===p.microsecond&&c===p.nanosecond)return f})).filter((e=>void 0!==e))}(n,K(t,b),K(t,_),K(t,E),K(t,T),K(t,x),K(t,I),K(t,S),K(t,R),K(t,k));return i.map((e=>new r(e)))}getNextTransition(e){if(!kt(this))throw new TypeError("invalid receiver");const t=hr(e),r=K(this,w);if(Sn(r)||"UTC"===r)return null;let n=K(t,v);const i=m("%Temporal.Instant%");return n=Pn(r,n),null===n?null:new i(n)}getPreviousTransition(e){if(!kt(this))throw new TypeError("invalid receiver");const t=hr(e),r=K(this,w);if(Sn(r)||"UTC"===r)return null;let n=K(t,v);const i=m("%Temporal.Instant%");return n=Bn(r,n),null===n?null:new i(n)}toString(){if(!kt(this))throw new TypeError("invalid receiver");return K(this,w)}toJSON(){if(!kt(this))throw new TypeError("invalid receiver");return K(this,w)}static from(e){return an(nn(e))}}f(Ja,"Temporal.TimeZone"),p("Temporal.TimeZone.prototype.getOffsetNanosecondsFor",Ja.prototype.getOffsetNanosecondsFor),p("Temporal.TimeZone.prototype.getPossibleInstantsFor",Ja.prototype.getPossibleInstantsFor);const Ha=Object.create;class Va{constructor(e,t,r="iso8601",n=1){xr(this,ct(e),ct(t),Jr(r),ct(n))}get year(){if(!At(this))throw new TypeError("invalid receiver");return Or(K(this,D),this)}get month(){if(!At(this))throw new TypeError("invalid receiver");return Cr(K(this,D),this)}get monthCode(){if(!At(this))throw new TypeError("invalid receiver");return Ar(K(this,D),this)}get calendarId(){if(!At(this))throw new TypeError("invalid receiver");return Vr(K(this,D))}get era(){if(!At(this))throw new TypeError("invalid receiver");return Lr(K(this,D),this)}get eraYear(){if(!At(this))throw new TypeError("invalid receiver");return Pr(K(this,D),this)}get daysInMonth(){if(!At(this))throw new TypeError("invalid receiver");return Yr(K(this,D),this)}get daysInYear(){if(!At(this))throw new TypeError("invalid receiver");return Wr(K(this,D),this)}get monthsInYear(){if(!At(this))throw new TypeError("invalid receiver");return zr(K(this,D),this)}get inLeapYear(){if(!At(this))throw new TypeError("invalid receiver");return Gr(K(this,D),this)}with(e,t){if(!At(this))throw new TypeError("invalid receiver");if(!it(e))throw new TypeError("invalid argument");Pt(e);const r=eo(t),n=K(this,D),i=kr(n,["month","monthCode","year"]);let o=ar(this,i,[]);return o=Dr(n,o,ar(e,i,"partial")),o=ar(o,i,[]),tn(n,o,r)}add(e,t){if(!At(this))throw new TypeError("invalid receiver");return Ai("add",this,e,t)}subtract(e,t){if(!At(this))throw new TypeError("invalid receiver");return Ai("subtract",this,e,t)}until(e,t){if(!At(this))throw new TypeError("invalid receiver");return Ei("until",this,e,t)}since(e,t){if(!At(this))throw new TypeError("invalid receiver");return Ei("since",this,e,t)}equals(e){if(!At(this))throw new TypeError("invalid receiver");const t=mr(e);for(const e of[b,_,E])if(K(this,e)!==K(t,e))return!1;return Zr(K(this,D),K(t,D))}toString(e){if(!At(this))throw new TypeError("invalid receiver");return xn(this,Qt(eo(e)))}toJSON(){if(!At(this))throw new TypeError("invalid receiver");return xn(this)}toLocaleString(e,t){if(!At(this))throw new TypeError("invalid receiver");return new Do(e,t).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainYearMonth")}toPlainDate(e){if(!At(this))throw new TypeError("invalid receiver");if(!it(e))throw new TypeError("argument should be an object");const t=K(this,D),r=kr(t,["monthCode","year"]),n=ar(this,r,[]),i=kr(t,["day"]);let o=Dr(t,n,ar(e,i,[]));o=ar(o,[...new Set([...r,...i])],[]);const a=Ha(null);return a.overflow="reject",en(t,o,a)}getISOFields(){if(!At(this))throw new TypeError("invalid receiver");return{calendar:K(this,D),isoDay:K(this,E),isoMonth:K(this,_),isoYear:K(this,b)}}getCalendar(){if(!At(this))throw new TypeError("invalid receiver");return Qr(K(this,D))}static from(e,t){const r=eo(t);return At(e)?(Gt(r),Ir(K(e,b),K(e,_),K(e,D),K(e,E))):mr(e,r)}static compare(e,t){const r=mr(e),n=mr(t);return zi(K(r,b),K(r,_),K(r,E),K(n,b),K(n,_),K(n,E))}}f(Va,"Temporal.PlainYearMonth");const Qa=Do.prototype.resolvedOptions,Za=Object.create;class Ka{constructor(e,t,r="iso8601"){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");Sr(this,Qi(e),nn(t),Jr(r))}get calendarId(){if(!Lt(this))throw new TypeError("invalid receiver");return Vr(K(this,D))}get timeZoneId(){if(!Lt(this))throw new TypeError("invalid receiver");return on(K(this,A))}get year(){if(!Lt(this))throw new TypeError("invalid receiver");return Or(K(this,D),Xa(this))}get month(){if(!Lt(this))throw new TypeError("invalid receiver");return Cr(K(this,D),Xa(this))}get monthCode(){if(!Lt(this))throw new TypeError("invalid receiver");return Ar(K(this,D),Xa(this))}get day(){if(!Lt(this))throw new TypeError("invalid receiver");return Mr(K(this,D),Xa(this))}get hour(){if(!Lt(this))throw new TypeError("invalid receiver");return K(Xa(this),T)}get minute(){if(!Lt(this))throw new TypeError("invalid receiver");return K(Xa(this),x)}get second(){if(!Lt(this))throw new TypeError("invalid receiver");return K(Xa(this),I)}get millisecond(){if(!Lt(this))throw new TypeError("invalid receiver");return K(Xa(this),S)}get microsecond(){if(!Lt(this))throw new TypeError("invalid receiver");return K(Xa(this),R)}get nanosecond(){if(!Lt(this))throw new TypeError("invalid receiver");return K(Xa(this),k)}get era(){if(!Lt(this))throw new TypeError("invalid receiver");return Lr(K(this,D),Xa(this))}get eraYear(){if(!Lt(this))throw new TypeError("invalid receiver");return Pr(K(this,D),Xa(this))}get epochSeconds(){if(!Lt(this))throw new TypeError("invalid receiver");const e=K(this,v);return d.toNumber(Ji(e,Ue))}get epochMilliseconds(){if(!Lt(this))throw new TypeError("invalid receiver");const e=K(this,v);return d.toNumber(Ji(e,Fe))}get epochMicroseconds(){if(!Lt(this))throw new TypeError("invalid receiver");return Vi(Ji(K(this,v),$e))}get epochNanoseconds(){if(!Lt(this))throw new TypeError("invalid receiver");return Vi(K(this,v))}get dayOfWeek(){if(!Lt(this))throw new TypeError("invalid receiver");return Br(K(this,D),Xa(this))}get dayOfYear(){if(!Lt(this))throw new TypeError("invalid receiver");return $r(K(this,D),Xa(this))}get weekOfYear(){if(!Lt(this))throw new TypeError("invalid receiver");return Fr(K(this,D),Xa(this))}get yearOfWeek(){if(!Lt(this))throw new TypeError("invalid receiver");return Ur(K(this,D),Xa(this))}get hoursInDay(){if(!Lt(this))throw new TypeError("invalid receiver");const e=Xa(this),t=m("%Temporal.PlainDateTime%"),r=K(e,b),n=K(e,_),i=K(e,E),o=new t(r,n,i,0,0,0,0,0,0),a=xi(r,n,i,0,0,0,1,"reject"),s=new t(a.year,a.month,a.day,0,0,0,0,0,0),l=K(this,A),c=K(fn(l,o,"compatible"),v),u=K(fn(l,s,"compatible"),v);return Hi(d.subtract(u,c),Ye)}get daysInWeek(){if(!Lt(this))throw new TypeError("invalid receiver");return qr(K(this,D),Xa(this))}get daysInMonth(){if(!Lt(this))throw new TypeError("invalid receiver");return Yr(K(this,D),Xa(this))}get daysInYear(){if(!Lt(this))throw new TypeError("invalid receiver");return Wr(K(this,D),Xa(this))}get monthsInYear(){if(!Lt(this))throw new TypeError("invalid receiver");return zr(K(this,D),Xa(this))}get inLeapYear(){if(!Lt(this))throw new TypeError("invalid receiver");return Gr(K(this,D),Xa(this))}get offset(){if(!Lt(this))throw new TypeError("invalid receiver");return dn(K(this,A),K(this,C))}get offsetNanoseconds(){if(!Lt(this))throw new TypeError("invalid receiver");return un(K(this,A),K(this,C))}with(e,t){if(!Lt(this))throw new TypeError("invalid receiver");if(!it(e))throw new TypeError("invalid zoned-date-time-like");Pt(e);const r=eo(t),n=K(this,D);let i=kr(n,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);i.push("offset");let o=ar(this,i,["offset"]);o=Dr(n,o,ar(e,i,"partial")),o=ar(o,i,["offset"]);const a=Jt(r),s=Vt(r,"prefer");let{year:l,month:c,day:u,hour:d,minute:h,second:f,millisecond:p,microsecond:m,nanosecond:y}=cr(n,o,r);const g=Rn(o.offset),v=K(this,A);return Rr(yr(l,c,u,d,h,f,p,m,y,"option",g,v,a,s,!1),v,n)}withPlainDate(e){if(!Lt(this))throw new TypeError("invalid receiver");const t=lr(e),r=K(t,b),n=K(t,_),i=K(t,E);let o=K(t,D);const a=Xa(this),s=K(a,T),l=K(a,x),c=K(a,I),u=K(a,S),d=K(a,R),h=K(a,k);o=Xr(K(this,D),o);const f=K(this,A);return Rr(K(fn(f,new(m("%Temporal.PlainDateTime%"))(r,n,i,s,l,c,u,d,h,o),"compatible"),v),f,o)}withPlainTime(e){if(!Lt(this))throw new TypeError("invalid receiver");const t=m("%Temporal.PlainTime%"),r=void 0===e?new t:pr(e),n=Xa(this),i=K(n,b),o=K(n,_),a=K(n,E),s=K(this,D),l=K(r,T),c=K(r,x),u=K(r,I),d=K(r,S),h=K(r,R),f=K(r,k),p=K(this,A);return Rr(K(fn(p,new(m("%Temporal.PlainDateTime%"))(i,o,a,l,c,u,d,h,f,s),"compatible"),v),p,s)}withTimeZone(e){if(!Lt(this))throw new TypeError("invalid receiver");const t=nn(e);return Rr(K(this,v),t,K(this,D))}withCalendar(e){if(!Lt(this))throw new TypeError("invalid receiver");const t=Jr(e);return Rr(K(this,v),K(this,A),t)}add(e,t){if(!Lt(this))throw new TypeError("invalid receiver");return Mi("add",this,e,t)}subtract(e,t){if(!Lt(this))throw new TypeError("invalid receiver");return Mi("subtract",this,e,t)}until(e,t){if(!Lt(this))throw new TypeError("invalid receiver");return Ti("until",this,e,t)}since(e,t){if(!Lt(this))throw new TypeError("invalid receiver");return Ti("since",this,e,t)}round(e){if(!Lt(this))throw new TypeError("invalid receiver");if(void 0===e)throw new TypeError("options parameter is required");const t="string"==typeof e?to("smallestUnit",e):eo(e),r=Zt(t),n=Ht(t,"halfExpand"),i=rr(t,"smallestUnit","time",tr,["day"]),o={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[i];Kt(r,o,1===o);const a=Xa(this);let s=K(a,b),l=K(a,_),c=K(a,E),u=K(a,T),h=K(a,x),f=K(a,I),p=K(a,S),y=K(a,R),g=K(a,k);const w=m("%Temporal.PlainDateTime%"),j=K(this,A),N=K(this,D),O=fn(j,new w(K(a,b),K(a,_),K(a,E),0,0,0,0,0,0),"compatible"),M=Di(O,j,N,0,0,0,1,0,0,0,0,0,0),L=d.subtract(M,d.BigInt(K(O,v)));if(d.lessThanOrEqual(L,Me))throw new RangeError("cannot round a ZonedDateTime in a calendar with zero or negative length days");return({year:s,month:l,day:c,hour:u,minute:h,second:f,millisecond:p,microsecond:y,nanosecond:g}=Bi(s,l,c,u,h,f,p,y,g,r,i,n,d.toNumber(L))),Rr(yr(s,l,c,u,h,f,p,y,g,"option",un(j,K(this,C)),j,"compatible","prefer",!1),j,K(this,D))}equals(e){if(!Lt(this))throw new TypeError("invalid receiver");const t=gr(e),r=K(this,v),n=K(t,v);return!!d.equal(d.BigInt(r),d.BigInt(n))&&!!sn(K(this,A),K(t,A))&&Zr(K(this,D),K(t,D))}toString(e){if(!Lt(this))throw new TypeError("invalid receiver");const t=eo(e),r=Qt(t),n=Xt(t),i=function(e){return no(e,"offset",["auto","never"],"auto")}(t),o=Ht(t,"trunc"),a=rr(t,"smallestUnit","time",void 0);if("hour"===a)throw new RangeError('smallestUnit must be a time unit other than "hour"');const s=function(e){return no(e,"timeZoneName",["auto","never","critical"],"auto")}(t),{precision:l,unit:c,increment:u}=er(a,n);return In(this,l,r,s,i,{unit:c,increment:u,roundingMode:o})}toLocaleString(e,t){if(!Lt(this))throw new TypeError("invalid receiver");const r=eo(t),n=Za(null);if(St(n,r,["timeZone"]),void 0!==r.timeZone)throw new TypeError("ZonedDateTime toLocaleString does not accept a timeZone option");void 0===n.year&&void 0===n.month&&void 0===n.day&&void 0===n.weekday&&void 0===n.dateStyle&&void 0===n.hour&&void 0===n.minute&&void 0===n.second&&void 0===n.timeStyle&&void 0===n.dayPeriod&&void 0===n.timeZoneName&&(n.timeZoneName="short");let i=on(K(this,A));if(Sn(i))throw new RangeError("toLocaleString does not support offset string time zones");i=kn(i),n.timeZone=i;const o=new Do(e,n),a=nt(Qa,o,[]).calendar,s=Vr(K(this,D));if("iso8601"!==s&&"iso8601"!==a&&a!==s)throw new RangeError(`cannot format ZonedDateTime with calendar ${s} in locale with calendar ${a}`);return o.format(K(this,C))}toJSON(){if(!Lt(this))throw new TypeError("invalid receiver");return In(this,"auto")}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.ZonedDateTime")}startOfDay(){if(!Lt(this))throw new TypeError("invalid receiver");const e=Xa(this),t=m("%Temporal.PlainDateTime%"),r=K(this,D),n=new t(K(e,b),K(e,_),K(e,E),0,0,0,0,0,0,r),i=K(this,A);return Rr(K(fn(i,n,"compatible"),v),i,r)}toInstant(){if(!Lt(this))throw new TypeError("invalid receiver");return new(m("%Temporal.Instant%"))(K(this,v))}toPlainDate(){if(!Lt(this))throw new TypeError("invalid receiver");return ln(Xa(this))}toPlainTime(){if(!Lt(this))throw new TypeError("invalid receiver");return cn(Xa(this))}toPlainDateTime(){if(!Lt(this))throw new TypeError("invalid receiver");return Xa(this)}toPlainYearMonth(){if(!Lt(this))throw new TypeError("invalid receiver");const e=K(this,D);return tn(e,ar(this,kr(e,["monthCode","year"]),[]))}toPlainMonthDay(){if(!Lt(this))throw new TypeError("invalid receiver");const e=K(this,D);return rn(e,ar(this,kr(e,["day","monthCode"]),[]))}getISOFields(){if(!Lt(this))throw new TypeError("invalid receiver");const e=Xa(this),t=K(this,A);return{calendar:K(this,D),isoDay:K(e,E),isoHour:K(e,T),isoMicrosecond:K(e,R),isoMillisecond:K(e,S),isoMinute:K(e,x),isoMonth:K(e,_),isoNanosecond:K(e,k),isoSecond:K(e,I),isoYear:K(e,b),offset:dn(t,K(this,C)),timeZone:t}}getCalendar(){if(!Lt(this))throw new TypeError("invalid receiver");return Qr(K(this,D))}getTimeZone(){if(!Lt(this))throw new TypeError("invalid receiver");return an(K(this,A))}static from(e,t){const r=eo(t);return Lt(e)?(Jt(r),Vt(r,"reject"),Gt(r),Rr(K(e,v),K(e,A),K(e,D))):gr(e,r)}static compare(e,t){const r=gr(e),n=gr(t),i=K(r,v),o=K(n,v);return d.lessThan(d.BigInt(i),d.BigInt(o))?-1:d.greaterThan(d.BigInt(i),d.BigInt(o))?1:0}}function Xa(e){return hn(K(e,A),K(e,C),K(e,D))}f(Ka,"Temporal.ZonedDateTime");var es=Object.freeze({__proto__:null,Calendar:ra,Duration:La,Instant:qo,Now:Ya,PlainDate:Aa,PlainDateTime:Ma,PlainMonthDay:Ba,PlainTime:Ga,PlainYearMonth:Va,TimeZone:Ja,ZonedDateTime:Ka});const ts=[qo,ra,Aa,Ma,La,Ba,Ga,Ja,Va,Ka];for(const e of ts){const t=Object.getOwnPropertyDescriptor(e,"prototype");(t.configurable||t.enumerable||t.writable)&&(t.configurable=!1,t.enumerable=!1,t.writable=!1,Object.defineProperty(e,"prototype",t))}var rs,ns;!function(e){e.BlankNode="BlankNode",e.IRI="NamedNode",e.Literal="Literal",e.Undefined="Undefined"}(rs||(rs={})),function(e){e.Boolean="http://www.w3.org/2001/XMLSchema#boolean",e.Integer="http://www.w3.org/2001/XMLSchema#integer",e.NonNegativeInteger="http://www.w3.org/2001/XMLSchema#nonNegativeInteger",e.NonPositiveInteger="http://www.w3.org/2001/XMLSchema#nonPositiveInteger",e.NegativeInteger="http://www.w3.org/2001/XMLSchema#negativeInteger",e.PositiveInteger="http://www.w3.org/2001/XMLSchema#positiveInteger",e.DateTime="http://www.w3.org/2001/XMLSchema#dateTime",e.Double="http://www.w3.org/2001/XMLSchema#double"}(ns||(ns={}));const is=e=>e.toExponential(15).replace(/(\d)0*e\+?/,"$1E");function os(e){if(!e.graph.value)return i.DEFAULT_GRAPH_NODE_NAME;if("BlankNode"!==e.graph.termType)throw new Error("graph node is not of BlankNode type");return e.graph.value}const as=e=>e.sort(((e,t)=>e<t?-1:e>t?1:0)),ss=new TextEncoder,ls=e=>{const t=e/2n;return{min:t-e+1n,max:t}};const cs=(e,t,r)=>{switch(e){case ns.Boolean:switch(t){case"false":case"0":return!1;case"true":case"1":return!0;default:throw new Error("incorrect boolean value")}case ns.Integer:case ns.NonNegativeInteger:case ns.NonPositiveInteger:case ns.NegativeInteger:case ns.PositiveInteger:const n=BigInt(t),{min:i,max:o}=function(e,t){switch(e){case ns.PositiveInteger:return{min:1n,max:t-1n};case ns.NonNegativeInteger:return{min:0n,max:t-1n};case ns.Integer:return ls(t);case ns.NegativeInteger:return{min:ls(t).min,max:-1n};case ns.NonPositiveInteger:return{min:ls(t).min,max:0n};default:throw new Error(`unsupported XSD type: ${e}`)}}(e,r);if(n>o)throw new Error(`integer exceeds maximum value: ${n}`);if(n<i)throw new Error(`integer is below minimum value: ${n}`);return n;case ns.DateTime:if(isNaN(Date.parse(t)))throw new Error(`error: error parsing time string ${t}`);return/^\d{4}-\d{2}-\d{2}$/.test(t)?es.Instant.from(new Date(t).toISOString()):es.Instant.from(t);case ns.Double:return is(parseFloat(t));default:return t}};var us;const ds=new TextEncoder;class hs{constructor(e,t=a){this.value=e,this.h=t}isString(){return"string"==typeof this.value}asString(){if(!this.isString())throw i.ERRORS.MT_VALUE_INCORRECT_TYPE;return this.value.toString()}isTime(){return this.value instanceof es.Instant}asTime(){if(!this.isTime())throw i.ERRORS.MT_VALUE_INCORRECT_TYPE;return this.value}isNumber(){return"number"==typeof this.value}asNumber(){if(!this.isNumber())throw i.ERRORS.MT_VALUE_INCORRECT_TYPE;return this.value}isBool(){return"boolean"==typeof this.value}asBool(){if(!this.isBool())throw i.ERRORS.MT_VALUE_INCORRECT_TYPE;return this.value}mtEntry(){return hs.mkValueMtEntry(this.h,this.value)}isBigInt(){return"bigint"==typeof this.value}asBigInt(){if(!this.isBigInt())throw i.ERRORS.MT_VALUE_INCORRECT_TYPE;return this.value}static async mkValueInt(e,t){return t>=0?BigInt(t):e.prime()+BigInt(t)}}us=hs,hs.mkValueMtEntry=(e,t)=>{switch(typeof t){case"number":return hs.mkValueInt(e,t);case"string":return hs.mkValueString(e,t);case"boolean":return hs.mkValueBool(e,t);case"bigint":return hs.mkValueBigInt(e,t);default:if(t instanceof es.Instant)return hs.mkValueTime(e,t);throw new Error("error: unexpected type "+typeof t)}},hs.mkValueUInt=(e,t)=>BigInt.asUintN(64,t),hs.mkValueBool=(e,t)=>t?e.hash([BigInt.asIntN(64,BigInt(1))]):e.hash([BigInt.asIntN(64,BigInt(0))]),hs.mkValueString=(e,t)=>e.hashBytes(ds.encode(t)),hs.mkValueTime=async(e,t)=>us.mkValueInt(e,t.epochNanoseconds),hs.mkValueBigInt=async(e,t)=>{const r=e.prime();if(t>=r)throw new Error(`value is too big: ${t}`);if(t<0n){const{min:e}=ls(r);if(t<e)throw new Error(`value is too small: ${t}`);return t+r}return t};var fs={},ps=class e{constructor(e,t=new Map,r=0){this.prefix=e,this._existing=t,this.counter=r}clone(){const{prefix:t,_existing:r,counter:n}=this;return new e(t,new Map(r),n)}getId(e){const t=e&&this._existing.get(e);if(t)return t;const r=this.prefix+this.counter;return this.counter++,e&&this._existing.set(e,r),r}hasId(e){return this._existing.has(e)}getOldIds(){return[...this._existing.keys()]}};
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */
const ms=self.crypto||self.msCrypto;var ys=class{constructor(e){if(!ms||!ms.subtle)throw new Error("crypto.subtle not found.");if("sha256"===e)this.algorithm={name:"SHA-256"};else{if("sha1"!==e)throw new Error(`Unsupported algorithm "${e}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(e){this._content+=e}async digest(){const e=(new TextEncoder).encode(this._content),t=new Uint8Array(await ms.subtle.digest(this.algorithm,e));let r="";for(let e=0;e<t.length;++e)r+=t[e].toString(16).padStart(2,"0");return r}},gs=class{constructor(e){this.current=e.sort(),this.done=!1,this.dir=new Map;for(let t=0;t<e.length;++t)this.dir.set(e[t],!0)}hasNext(){return!this.done}next(){const{current:e,dir:t}=this,r=e.slice();let n=null,i=0;const o=e.length;for(let r=0;r<o;++r){const a=e[r],s=t.get(a);(null===n||a>n)&&(s&&r>0&&a>e[r-1]||!s&&r<o-1&&a>e[r+1])&&(n=a,i=r)}if(null===n)this.done=!0;else{const r=t.get(n)?i-1:i+1;e[i]=e[r],e[r]=n;for(const r of e)r>n&&t.set(r,!t.get(r))}return r}};
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */
const vs="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",ws="http://www.w3.org/2001/XMLSchema#string",bs="NamedNode",_s="BlankNode",Es="Literal",Ts="DefaultGraph",xs={};(()=>{const e="(?:<([^:]+:[^>]*)>)",t="A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_",r=t+"0-9-·̀-ͯ‿-⁀",n="(_:(?:["+t+"0-9])(?:(?:["+r+".])*(?:["+r+"]))?)",i="[ \\t]+",o="[ \\t]*",a="(?:"+e+"|"+n+")"+i,s=e+i,l="(?:"+e+"|"+n+"|"+('(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:'+("(?:\\^\\^"+e+")")+"|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?)")+")"+o,c="(?:\\.|(?:(?:"+e+"|"+n+")"+o+"\\.))";xs.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,xs.empty=new RegExp("^"+o+"$"),xs.quad=new RegExp("^"+o+a+s+l+c+o+"$")})();var Is=class e{static parse(e){const t=[],r={},n=e.split(xs.eoln);let i=0;for(const e of n){if(i++,xs.empty.test(e))continue;const n=e.match(xs.quad);if(null===n)throw new Error("N-Quads parse error on line "+i+".");const o={subject:null,predicate:null,object:null,graph:null};if(void 0!==n[1]?o.subject={termType:bs,value:n[1]}:o.subject={termType:_s,value:n[2]},o.predicate={termType:bs,value:n[3]},void 0!==n[4]?o.object={termType:bs,value:n[4]}:void 0!==n[5]?o.object={termType:_s,value:n[5]}:(o.object={termType:Es,value:void 0,datatype:{termType:bs}},void 0!==n[7]?o.object.datatype.value=n[7]:void 0!==n[8]?(o.object.datatype.value=vs,o.object.language=n[8]):o.object.datatype.value=ws,o.object.value=Ds(n[6])),void 0!==n[9]?o.graph={termType:bs,value:n[9]}:void 0!==n[10]?o.graph={termType:_s,value:n[10]}:o.graph={termType:Ts,value:""},o.graph.value in r){let e=!0;const n=r[o.graph.value];for(const t of n)if(Ss(t,o)){e=!1;break}e&&(n.push(o),t.push(o))}else r[o.graph.value]=[o],t.push(o)}return t}static serialize(t){Array.isArray(t)||(t=e.legacyDatasetToQuads(t));const r=[];for(const n of t)r.push(e.serializeQuad(n));return r.sort().join("")}static serializeQuadComponents(e,t,r,n){let i="";return e.termType===bs?i+=`<${e.value}>`:i+=`${e.value}`,i+=` <${t.value}> `,r.termType===bs?i+=`<${r.value}>`:r.termType===_s?i+=r.value:(i+=`"${function(e){return e.replace(Rs,(function(e){switch(e){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}}))}(r.value)}"`,r.datatype.value===vs?r.language&&(i+=`@${r.language}`):r.datatype.value!==ws&&(i+=`^^<${r.datatype.value}>`)),n.termType===bs?i+=` <${n.value}>`:n.termType===_s&&(i+=` ${n.value}`),i+=" .\n",i}static serializeQuad(t){return e.serializeQuadComponents(t.subject,t.predicate,t.object,t.graph)}static legacyDatasetToQuads(e){const t=[],r={"blank node":_s,IRI:bs,literal:Es};for(const n in e){e[n].forEach((e=>{const i={};for(const t in e){const n=e[t],o={termType:r[n.type],value:n.value};o.termType===Es&&(o.datatype={termType:bs},"datatype"in n&&(o.datatype.value=n.datatype),"language"in n?("datatype"in n||(o.datatype.value=vs),o.language=n.language):"datatype"in n||(o.datatype.value=ws)),i[t]=o}i.graph="@default"===n?{termType:Ts,value:""}:{termType:n.startsWith("_:")?_s:bs,value:n},t.push(i)}))}return t}};function Ss(e,t){return e.subject.termType===t.subject.termType&&e.object.termType===t.object.termType&&(e.subject.value===t.subject.value&&e.predicate.value===t.predicate.value&&e.object.value===t.object.value&&(e.object.termType!==Es||e.object.datatype.termType===t.object.datatype.termType&&e.object.language===t.object.language&&e.object.datatype.value===t.object.datatype.value))}const Rs=/["\\\n\r]/g;const ks=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g;function Ds(e){return e.replace(ks,(function(e,t,r,n){if(t)switch(t){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(r)return String.fromCharCode(parseInt(r,16));if(n)throw new Error("Unsupported U escape")}))}
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */const js=ps,Ns=ys,Os=gs,Cs=Is;var As=class{constructor({createMessageDigest:e=(()=>new Ns("sha256")),canonicalIdMap:t=new Map,maxDeepIterations:r=1/0}={}){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new js("_:c14n",t),this.createMessageDigest=e,this.maxDeepIterations=r,this.quads=null,this.deepIterations=null}async main(e){this.deepIterations=new Map,this.quads=e;for(const t of e)this._addBlankNodeQuadInfo({quad:t,component:t.subject}),this._addBlankNodeQuadInfo({quad:t,component:t.object}),this._addBlankNodeQuadInfo({quad:t,component:t.graph});const t=new Map,r=[...this.blankNodeInfo.keys()];let n=0;for(const e of r)++n%100==0&&await this._yield(),await this._hashAndTrackBlankNode({id:e,hashToBlankNodes:t});const i=[...t.keys()].sort(),o=[];for(const e of i){const r=t.get(e);if(r.length>1){o.push(r);continue}const n=r[0];this.canonicalIssuer.getId(n)}for(const e of o){const t=[];for(const r of e){if(this.canonicalIssuer.hasId(r))continue;const e=new js("_:b");e.getId(r);const n=await this.hashNDegreeQuads(r,e);t.push(n)}t.sort(Ms);for(const e of t){const t=e.issuer.getOldIds();for(const e of t)this.canonicalIssuer.getId(e)}}const a=[];for(const e of this.quads){const t=Cs.serializeQuadComponents(this._componentWithCanonicalId(e.subject),e.predicate,this._componentWithCanonicalId(e.object),this._componentWithCanonicalId(e.graph));a.push(t)}return a.sort(),a.join("")}async hashFirstDegreeQuads(e){const t=[],r=this.blankNodeInfo.get(e),n=r.quads;for(const r of n){const n={subject:null,predicate:r.predicate,object:null,graph:null};n.subject=this.modifyFirstDegreeComponent(e,r.subject,"subject"),n.object=this.modifyFirstDegreeComponent(e,r.object,"object"),n.graph=this.modifyFirstDegreeComponent(e,r.graph,"graph"),t.push(Cs.serializeQuad(n))}t.sort();const i=this.createMessageDigest();for(const e of t)i.update(e);return r.hash=await i.digest(),r.hash}async hashRelatedBlankNode(e,t,r,n){let i;i=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):r.hasId(e)?r.getId(e):this.blankNodeInfo.get(e).hash;const o=this.createMessageDigest();return o.update(n),"g"!==n&&o.update(this.getRelatedPredicate(t)),o.update(i),o.digest()}async hashNDegreeQuads(e,t){const r=this.deepIterations.get(e)||0;if(r>this.maxDeepIterations)throw new Error(`Maximum deep iterations (${this.maxDeepIterations}) exceeded.`);this.deepIterations.set(e,r+1);const n=this.createMessageDigest(),i=await this.createHashToRelated(e,t),o=[...i.keys()].sort();for(const e of o){n.update(e);let r,o="";const a=new Os(i.get(e));let s=0;for(;a.hasNext();){const e=a.next();++s%3==0&&await this._yield();let n=t.clone(),i="";const l=[];let c=!1;for(const t of e)if(this.canonicalIssuer.hasId(t)?i+=this.canonicalIssuer.getId(t):(n.hasId(t)||l.push(t),i+=n.getId(t)),0!==o.length&&i>o){c=!0;break}if(!c){for(const e of l){const t=await this.hashNDegreeQuads(e,n);if(i+=n.getId(e),i+=`<${t.hash}>`,n=t.issuer,0!==o.length&&i>o){c=!0;break}}c||(0===o.length||i<o)&&(o=i,r=n)}}n.update(o),t=r}return{hash:await n.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}async createHashToRelated(e,t){const r=new Map,n=this.blankNodeInfo.get(e).quads;let i=0;for(const o of n)++i%100==0&&await this._yield(),await Promise.all([this._addRelatedBlankNodeHash({quad:o,component:o.subject,position:"s",id:e,issuer:t,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:o,component:o.object,position:"o",id:e,issuer:t,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:o,component:o.graph,position:"g",id:e,issuer:t,hashToRelated:r})]);return r}async _hashAndTrackBlankNode({id:e,hashToBlankNodes:t}){const r=await this.hashFirstDegreeQuads(e),n=t.get(r);n?n.push(e):t.set(r,[e])}_addBlankNodeQuadInfo({quad:e,component:t}){if("BlankNode"!==t.termType)return;const r=t.value,n=this.blankNodeInfo.get(r);n?n.quads.add(e):this.blankNodeInfo.set(r,{quads:new Set([e]),hash:null})}async _addRelatedBlankNodeHash({quad:e,component:t,position:r,id:n,issuer:i,hashToRelated:o}){if("BlankNode"!==t.termType||t.value===n)return;const a=t.value,s=await this.hashRelatedBlankNode(a,e,i,r),l=o.get(s);l?l.push(a):o.set(s,[a])}_componentWithCanonicalId(e){return"BlankNode"!==e.termType||e.value.startsWith(this.canonicalIssuer.prefix)?e:{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}}async _yield(){return new Promise((e=>setImmediate(e)))}};function Ms(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */const Ls=ys,Ps=As;var Bs=class extends Ps{constructor(){super(),this.name="URGNA2012",this.createMessageDigest=()=>new Ls("sha1")}modifyFirstDegreeComponent(e,t,r){return"BlankNode"!==t.termType?t:"graph"===r?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}async createHashToRelated(e,t){const r=new Map,n=this.blankNodeInfo.get(e).quads;let i=0;for(const o of n){let n,a;if("BlankNode"===o.subject.termType&&o.subject.value!==e)a=o.subject.value,n="p";else{if("BlankNode"!==o.object.termType||o.object.value===e)continue;a=o.object.value,n="r"}++i%100==0&&await this._yield();const s=await this.hashRelatedBlankNode(a,o,t,n),l=r.get(s);l?l.push(a):r.set(s,[a])}return r}};
/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */const $s=ps,Fs=ys,Us=gs,qs=Is;var Ys=class{constructor({createMessageDigest:e=(()=>new Fs("sha256")),canonicalIdMap:t=new Map,maxDeepIterations:r=1/0}={}){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new $s("_:c14n",t),this.createMessageDigest=e,this.maxDeepIterations=r,this.quads=null,this.deepIterations=null}main(e){this.deepIterations=new Map,this.quads=e;for(const t of e)this._addBlankNodeQuadInfo({quad:t,component:t.subject}),this._addBlankNodeQuadInfo({quad:t,component:t.object}),this._addBlankNodeQuadInfo({quad:t,component:t.graph});const t=new Map,r=[...this.blankNodeInfo.keys()];for(const e of r)this._hashAndTrackBlankNode({id:e,hashToBlankNodes:t});const n=[...t.keys()].sort(),i=[];for(const e of n){const r=t.get(e);if(r.length>1){i.push(r);continue}const n=r[0];this.canonicalIssuer.getId(n)}for(const e of i){const t=[];for(const r of e){if(this.canonicalIssuer.hasId(r))continue;const e=new $s("_:b");e.getId(r);const n=this.hashNDegreeQuads(r,e);t.push(n)}t.sort(Ws);for(const e of t){const t=e.issuer.getOldIds();for(const e of t)this.canonicalIssuer.getId(e)}}const o=[];for(const e of this.quads){const t=qs.serializeQuadComponents(this._componentWithCanonicalId({component:e.subject}),e.predicate,this._componentWithCanonicalId({component:e.object}),this._componentWithCanonicalId({component:e.graph}));o.push(t)}return o.sort(),o.join("")}hashFirstDegreeQuads(e){const t=[],r=this.blankNodeInfo.get(e),n=r.quads;for(const r of n){const n={subject:null,predicate:r.predicate,object:null,graph:null};n.subject=this.modifyFirstDegreeComponent(e,r.subject,"subject"),n.object=this.modifyFirstDegreeComponent(e,r.object,"object"),n.graph=this.modifyFirstDegreeComponent(e,r.graph,"graph"),t.push(qs.serializeQuad(n))}t.sort();const i=this.createMessageDigest();for(const e of t)i.update(e);return r.hash=i.digest(),r.hash}hashRelatedBlankNode(e,t,r,n){let i;i=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):r.hasId(e)?r.getId(e):this.blankNodeInfo.get(e).hash;const o=this.createMessageDigest();return o.update(n),"g"!==n&&o.update(this.getRelatedPredicate(t)),o.update(i),o.digest()}hashNDegreeQuads(e,t){const r=this.deepIterations.get(e)||0;if(r>this.maxDeepIterations)throw new Error(`Maximum deep iterations (${this.maxDeepIterations}) exceeded.`);this.deepIterations.set(e,r+1);const n=this.createMessageDigest(),i=this.createHashToRelated(e,t),o=[...i.keys()].sort();for(const e of o){n.update(e);let r,o="";const a=new Us(i.get(e));for(;a.hasNext();){const e=a.next();let n=t.clone(),i="";const s=[];let l=!1;for(const t of e)if(this.canonicalIssuer.hasId(t)?i+=this.canonicalIssuer.getId(t):(n.hasId(t)||s.push(t),i+=n.getId(t)),0!==o.length&&i>o){l=!0;break}if(!l){for(const e of s){const t=this.hashNDegreeQuads(e,n);if(i+=n.getId(e),i+=`<${t.hash}>`,n=t.issuer,0!==o.length&&i>o){l=!0;break}}l||(0===o.length||i<o)&&(o=i,r=n)}}n.update(o),t=r}return{hash:n.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}createHashToRelated(e,t){const r=new Map,n=this.blankNodeInfo.get(e).quads;for(const i of n)this._addRelatedBlankNodeHash({quad:i,component:i.subject,position:"s",id:e,issuer:t,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:i,component:i.object,position:"o",id:e,issuer:t,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:i,component:i.graph,position:"g",id:e,issuer:t,hashToRelated:r});return r}_hashAndTrackBlankNode({id:e,hashToBlankNodes:t}){const r=this.hashFirstDegreeQuads(e),n=t.get(r);n?n.push(e):t.set(r,[e])}_addBlankNodeQuadInfo({quad:e,component:t}){if("BlankNode"!==t.termType)return;const r=t.value,n=this.blankNodeInfo.get(r);n?n.quads.add(e):this.blankNodeInfo.set(r,{quads:new Set([e]),hash:null})}_addRelatedBlankNodeHash({quad:e,component:t,position:r,id:n,issuer:i,hashToRelated:o}){if("BlankNode"!==t.termType||t.value===n)return;const a=t.value,s=this.hashRelatedBlankNode(a,e,i,r),l=o.get(s);l?l.push(a):o.set(s,[a])}_componentWithCanonicalId({component:e}){return"BlankNode"!==e.termType||e.value.startsWith(this.canonicalIssuer.prefix)?e:{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}}};function Ws(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}
/*!
 * Copyright (c) 2016-2021 Digital Bazaar, Inc. All rights reserved.
 */const zs=ys,Gs=Ys;var Js=class extends Gs{constructor(){super(),this.name="URGNA2012",this.createMessageDigest=()=>new zs("sha1")}modifyFirstDegreeComponent(e,t,r){return"BlankNode"!==t.termType?t:"graph"===r?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}createHashToRelated(e,t){const r=new Map,n=this.blankNodeInfo.get(e).quads;for(const i of n){let n,o;if("BlankNode"===i.subject.termType&&i.subject.value!==e)o=i.subject.value,n="p";else{if("BlankNode"!==i.object.termType||i.object.value===e)continue;o=i.object.value,n="r"}const a=this.hashRelatedBlankNode(o,i,t,n),s=r.get(a);s?s.push(o):r.set(a,[o])}return r}},Hs=c(Object.freeze({__proto__:null,default:{}}));!function(e){const t=As,r=Bs,n=Ys,i=Js;let o;try{o=Hs}catch(e){}function a(t){return Array.isArray(t)?t:e.NQuads.legacyDatasetToQuads(t)}e.NQuads=Is,e.IdentifierIssuer=ps,e._rdfCanonizeNative=function(e){return e&&(o=e),o},e.canonize=async function(e,n){const i=a(e);if(n.useNative){if(!o)throw new Error("rdf-canonize-native not available");if(n.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "useNative".');return new Promise(((e,t)=>o.canonize(i,n,((r,n)=>r?t(r):e(n)))))}if("URDNA2015"===n.algorithm)return new t(n).main(i);if("URGNA2012"===n.algorithm){if(n.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "URGNA2012".');return new r(n).main(i)}if(!("algorithm"in n))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+n.algorithm)},e._canonizeSync=function(e,t){const r=a(e);if(t.useNative){if(!o)throw new Error("rdf-canonize-native not available");if(t.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "useNative".');return o.canonizeSync(r,t)}if("URDNA2015"===t.algorithm)return new n(t).main(r);if("URGNA2012"===t.algorithm){if(t.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "URGNA2012".');return new i(t).main(r)}if(!("algorithm"in t))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm)}}(fs);var Vs=fs;const Qs={};var Zs=Qs;Qs.isArray=Array.isArray,Qs.isBoolean=e=>"boolean"==typeof e||"[object Boolean]"===Object.prototype.toString.call(e),Qs.isDouble=e=>Qs.isNumber(e)&&(-1!==String(e).indexOf(".")||Math.abs(e)>=1e21),Qs.isEmptyObject=e=>Qs.isObject(e)&&0===Object.keys(e).length,Qs.isNumber=e=>"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e),Qs.isNumeric=e=>!isNaN(parseFloat(e))&&isFinite(e),Qs.isObject=e=>"[object Object]"===Object.prototype.toString.call(e),Qs.isString=e=>"string"==typeof e||"[object String]"===Object.prototype.toString.call(e),Qs.isUndefined=e=>void 0===e;const Ks=Zs,Xs={};var el=Xs;Xs.isSubject=e=>{if(Ks.isObject(e)&&!("@value"in e||"@set"in e||"@list"in e)){return Object.keys(e).length>1||!("@id"in e)}return!1},Xs.isSubjectReference=e=>Ks.isObject(e)&&1===Object.keys(e).length&&"@id"in e,Xs.isValue=e=>Ks.isObject(e)&&"@value"in e,Xs.isList=e=>Ks.isObject(e)&&"@list"in e,Xs.isGraph=e=>Ks.isObject(e)&&"@graph"in e&&1===Object.keys(e).filter((e=>"@id"!==e&&"@index"!==e)).length,Xs.isSimpleGraph=e=>Xs.isGraph(e)&&!("@id"in e),Xs.isBlankNode=e=>{if(Ks.isObject(e)){if("@id"in e){const t=e["@id"];return!Ks.isString(t)||0===t.indexOf("_:")}return 0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e)}return!1};var tl=class extends Error{constructor(e="An unspecified JSON-LD error occurred.",t="jsonld.Error",r={}){super(e),this.name=t,this.message=e,this.details=r}},rl=l(tl);const nl=el,il=Zs,ol=Vs.IdentifierIssuer,al=tl,sl=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,ll=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,cl=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,ul={accept:"application/ld+json, application/json"},dl={};var hl=dl;function fl(e,t){if(il.isArray(t))for(let r=0;r<t.length;++r)t[r]=fl(e,t[r]);else if(nl.isList(t))t["@list"]=fl(e,t["@list"]);else if(il.isObject(t)){nl.isBlankNode(t)&&(t["@id"]=e.getId(t["@id"]));const r=Object.keys(t).sort();for(let n=0;n<r.length;++n){const i=r[n];"@id"!==i&&(t[i]=fl(e,t[i]))}}return t}dl.IdentifierIssuer=ol,dl.REGEX_BCP47=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,dl.REGEX_KEYWORD=/^@[a-zA-Z]+$/,dl.clone=function(e){if(e&&"object"==typeof e){let t;if(il.isArray(e)){t=[];for(let r=0;r<e.length;++r)t[r]=dl.clone(e[r])}else if(e instanceof Map){t=new Map;for(const[r,n]of e)t.set(r,dl.clone(n))}else if(e instanceof Set){t=new Set;for(const r of e)t.add(dl.clone(r))}else if(il.isObject(e)){t={};for(const r in e)t[r]=dl.clone(e[r])}else t=e.toString();return t}return e},dl.asArray=function(e){return Array.isArray(e)?e:[e]},dl.buildHeaders=(e={})=>{const t=Object.keys(e).some((e=>"accept"===e.toLowerCase()));if(t)throw new RangeError('Accept header may not be specified; only "'+ul.accept+'" is supported.');return Object.assign({Accept:ul.accept},e)},dl.parseLinkHeader=e=>{const t={},r=e.match(sl);for(let e=0;e<r.length;++e){let n=r[e].match(ll);if(!n)continue;const i={target:n[1]},o=n[2];for(;n=cl.exec(o);)i[n[1]]=void 0===n[2]?n[3]:n[2];const a=i.rel||"";Array.isArray(t[a])?t[a].push(i):t.hasOwnProperty(a)?t[a]=[t[a],i]:t[a]=i}return t},dl.validateTypeValue=(e,t)=>{if(!(il.isString(e)||il.isArray(e)&&e.every((e=>il.isString(e))))){if(t&&il.isObject(e))switch(Object.keys(e).length){case 0:return;case 1:if("@default"in e&&dl.asArray(e["@default"]).every((e=>il.isString(e))))return}throw new al('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})}},dl.hasProperty=(e,t)=>{if(e.hasOwnProperty(t)){const r=e[t];return!il.isArray(r)||r.length>0}return!1},dl.hasValue=(e,t,r)=>{if(dl.hasProperty(e,t)){let n=e[t];const i=nl.isList(n);if(il.isArray(n)||i){i&&(n=n["@list"]);for(let e=0;e<n.length;++e)if(dl.compareValues(r,n[e]))return!0}else if(!il.isArray(r))return dl.compareValues(r,n)}return!1},dl.addValue=(e,t,r,n)=>{if("propertyIsArray"in(n=n||{})||(n.propertyIsArray=!1),"valueIsArray"in n||(n.valueIsArray=!1),"allowDuplicate"in n||(n.allowDuplicate=!0),"prependValue"in n||(n.prependValue=!1),n.valueIsArray)e[t]=r;else if(il.isArray(r)){0===r.length&&n.propertyIsArray&&!e.hasOwnProperty(t)&&(e[t]=[]),n.prependValue&&(r=r.concat(e[t]),e[t]=[]);for(let i=0;i<r.length;++i)dl.addValue(e,t,r[i],n)}else if(e.hasOwnProperty(t)){const i=!n.allowDuplicate&&dl.hasValue(e,t,r);il.isArray(e[t])||i&&!n.propertyIsArray||(e[t]=[e[t]]),i||(n.prependValue?e[t].unshift(r):e[t].push(r))}else e[t]=n.propertyIsArray?[r]:r},dl.getValues=(e,t)=>[].concat(e[t]||[]),dl.removeProperty=(e,t)=>{delete e[t]},dl.removeValue=(e,t,r,n)=>{"propertyIsArray"in(n=n||{})||(n.propertyIsArray=!1);const i=dl.getValues(e,t).filter((e=>!dl.compareValues(e,r)));0===i.length?dl.removeProperty(e,t):1!==i.length||n.propertyIsArray?e[t]=i:e[t]=i[0]},dl.relabelBlankNodes=(e,t)=>fl((t=t||{}).issuer||new ol("_:b"),e),dl.compareValues=(e,t)=>e===t||(!(!nl.isValue(e)||!nl.isValue(t)||e["@value"]!==t["@value"]||e["@type"]!==t["@type"]||e["@language"]!==t["@language"]||e["@index"]!==t["@index"])||!!(il.isObject(e)&&"@id"in e&&il.isObject(t)&&"@id"in t)&&e["@id"]===t["@id"]),dl.compareShortestLeast=(e,t)=>e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1;const pl="http://www.w3.org/1999/02/22-rdf-syntax-ns#",ml="http://www.w3.org/2001/XMLSchema#";var yl,gl,vl={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:pl,RDF_LIST:pl+"List",RDF_FIRST:pl+"first",RDF_REST:pl+"rest",RDF_NIL:pl+"nil",RDF_TYPE:pl+"type",RDF_PLAIN_LITERAL:pl+"PlainLiteral",RDF_XML_LITERAL:pl+"XMLLiteral",RDF_JSON_LITERAL:pl+"JSON",RDF_OBJECT:pl+"object",RDF_LANGSTRING:pl+"langString",XSD:ml,XSD_BOOLEAN:ml+"boolean",XSD_DOUBLE:ml+"double",XSD_INTEGER:ml+"integer",XSD_STRING:ml+"string"};function wl(){return gl||(gl=1,yl=class{constructor(){this._requests={}}wrapLoader(e){const t=this;return t._loader=e,function(){return t.add.apply(t,arguments)}}async add(e){let t=this._requests[e];if(t)return Promise.resolve(t);t=this._requests[e]=this._loader(e);try{return await t}finally{delete this._requests[e]}}}),yl}const bl=Zs,_l={};var El=_l;_l.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([a-zA-Z][a-zA-Z0-9+-.]*):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},_l.parse=(e,t)=>{const r={},n=_l.parsers[t||"full"],i=n.regex.exec(e);let o=n.keys.length;for(;o--;)r[n.keys[o]]=void 0===i[o]?null:i[o];return("https"===r.scheme&&"443"===r.port||"http"===r.scheme&&"80"===r.port)&&(r.href=r.href.replace(":"+r.port,""),r.authority=r.authority.replace(":"+r.port,""),r.port=null),r.normalizedPath=_l.removeDotSegments(r.path),r},_l.prependBase=(e,t)=>{if(null===e)return t;if(_l.isAbsolute(t))return t;e&&!bl.isString(e)||(e=_l.parse(e||""));const r=_l.parse(t),n={protocol:e.protocol||""};if(null!==r.authority)n.authority=r.authority,n.path=r.path,n.query=r.query;else if(n.authority=e.authority,""===r.path)n.path=e.path,null!==r.query?n.query=r.query:n.query=e.query;else{if(0===r.path.indexOf("/"))n.path=r.path;else{let t=e.path;t=t.substr(0,t.lastIndexOf("/")+1),(t.length>0||e.authority)&&"/"!==t.substr(-1)&&(t+="/"),t+=r.path,n.path=t}n.query=r.query}""!==r.path&&(n.path=_l.removeDotSegments(n.path));let i=n.protocol;return null!==n.authority&&(i+="//"+n.authority),i+=n.path,null!==n.query&&(i+="?"+n.query),null!==r.fragment&&(i+="#"+r.fragment),""===i&&(i="./"),i},_l.removeBase=(e,t)=>{if(null===e)return t;e&&!bl.isString(e)||(e=_l.parse(e||""));let r="";if(""!==e.href?r+=(e.protocol||"")+"//"+(e.authority||""):t.indexOf("//")&&(r+="//"),0!==t.indexOf(r))return t;const n=_l.parse(t.substr(r.length)),i=e.normalizedPath.split("/"),o=n.normalizedPath.split("/"),a=n.fragment||n.query?0:1;for(;i.length>0&&o.length>a&&i[0]===o[0];)i.shift(),o.shift();let s="";if(i.length>0){i.pop();for(let e=0;e<i.length;++e)s+="../"}return s+=o.join("/"),null!==n.query&&(s+="?"+n.query),null!==n.fragment&&(s+="#"+n.fragment),""===s&&(s="./"),s},_l.removeDotSegments=e=>{if(0===e.length)return"";const t=e.split("/"),r=[];for(;t.length>0;){const e=t.shift(),n=0===t.length;"."!==e?".."!==e?r.push(e):(r.pop(),n&&r.push("")):n&&r.push("")}return"/"===e[0]&&r.length>0&&""!==r[0]&&r.unshift(""),1===r.length&&""===r[0]?"/":r.join("/")};const Tl=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;_l.isAbsolute=e=>bl.isString(e)&&Tl.test(e),_l.isRelative=e=>bl.isString(e);const{parseLinkHeader:xl,buildHeaders:Il}=hl,{LINK_HEADER_CONTEXT:Sl}=vl,Rl=tl,kl=wl(),{prependBase:Dl}=El,jl=/(^|(\r\n))link:/i;const Nl=({secure:e,headers:t={},xhr:r}={headers:{}})=>{t=Il(t);return(new kl).wrapLoader((async function n(i){if(0!==i.indexOf("http:")&&0!==i.indexOf("https:"))throw new Rl('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:i});if(e&&0!==i.indexOf("https"))throw new Rl('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:i});let o;try{o=await function(e,t,r){e=e||XMLHttpRequest;const n=new e;return new Promise(((e,i)=>{n.onload=()=>e(n),n.onerror=e=>i(e),n.open("GET",t,!0);for(const e in r)n.setRequestHeader(e,r[e]);n.send()}))}(r,i,t)}catch(e){throw new Rl("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:i,cause:e})}if(o.status>=400)throw new Rl("URL could not be dereferenced: "+o.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:i,httpStatusCode:o.status});let a={contextUrl:null,documentUrl:i,document:o.response},s=null;const l=o.getResponseHeader("Content-Type");let c;jl.test(o.getAllResponseHeaders())&&(c=o.getResponseHeader("Link"));if(c&&"application/ld+json"!==l){const e=xl(c),t=e[Sl];if(Array.isArray(t))throw new Rl("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:i});t&&(a.contextUrl=t.target),s=e.alternate,s&&"application/ld+json"==s.type&&!(l||"").match(/^application\/(\w*\+)?json$/)&&(a=await n(Dl(i,s.target)))}return a}))},Ol={};var Cl,Al,Ml=Ol;Ol.setupDocumentLoaders=function(e){"undefined"!=typeof XMLHttpRequest&&(e.documentLoaders.xhr=Nl,e.useDocumentLoader("xhr"))},Ol.setupGlobals=function(e){void 0===globalThis.JsonLdProcessor&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:e.JsonLdProcessor})};var Ll=Pl;function Pl(e){var t=this;if(t instanceof Pl||(t=new Pl),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)t.push(arguments[r]);return t}function Bl(e,t,r){var n=t===e.head?new Ul(r,null,t,e):new Ul(r,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function $l(e,t){e.tail=new Ul(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function Fl(e,t){e.head=new Ul(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Ul(e,t,r,n){if(!(this instanceof Ul))return new Ul(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}Pl.Node=Ul,Pl.create=Pl,Pl.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},Pl.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},Pl.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},Pl.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)$l(this,arguments[e]);return this.length},Pl.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)Fl(this,arguments[e]);return this.length},Pl.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},Pl.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},Pl.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},Pl.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},Pl.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},Pl.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},Pl.prototype.map=function(e,t){t=t||this;for(var r=new Pl,n=this.head;null!==n;)r.push(e.call(t,n.value,this)),n=n.next;return r},Pl.prototype.mapReverse=function(e,t){t=t||this;for(var r=new Pl,n=this.tail;null!==n;)r.push(e.call(t,n.value,this)),n=n.prev;return r},Pl.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var i=0;null!==n;i++)r=e(r,n.value,i),n=n.next;return r},Pl.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var i=this.length-1;null!==n;i--)r=e(r,n.value,i),n=n.prev;return r},Pl.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},Pl.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},Pl.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new Pl;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=0,i=this.head;null!==i&&n<e;n++)i=i.next;for(;null!==i&&n<t;n++,i=i.next)r.push(i.value);return r},Pl.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new Pl;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=this.length,i=this.tail;null!==i&&n>t;n--)i=i.prev;for(;null!==i&&n>e;n--,i=i.prev)r.push(i.value);return r},Pl.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;null!==i&&n<e;n++)i=i.next;var o=[];for(n=0;i&&n<t;n++)o.push(i.value),i=this.removeNode(i);null===i&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(n=0;n<r.length;n++)i=Bl(this,i,r[n]);return o},Pl.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{(Al||(Al=1,Cl=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),Cl)(Pl)}catch(e){}const ql=Ll,Yl=Symbol("max"),Wl=Symbol("length"),zl=Symbol("lengthCalculator"),Gl=Symbol("allowStale"),Jl=Symbol("maxAge"),Hl=Symbol("dispose"),Vl=Symbol("noDisposeOnSet"),Ql=Symbol("lruList"),Zl=Symbol("cache"),Kl=Symbol("updateAgeOnGet"),Xl=()=>1;const ec=(e,t,r)=>{const n=e[Zl].get(t);if(n){const t=n.value;if(tc(e,t)){if(nc(e,n),!e[Gl])return}else r&&(e[Kl]&&(n.value.now=Date.now()),e[Ql].unshiftNode(n));return t.value}},tc=(e,t)=>{if(!t||!t.maxAge&&!e[Jl])return!1;const r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[Jl]&&r>e[Jl]},rc=e=>{if(e[Wl]>e[Yl])for(let t=e[Ql].tail;e[Wl]>e[Yl]&&null!==t;){const r=t.prev;nc(e,t),t=r}},nc=(e,t)=>{if(t){const r=t.value;e[Hl]&&e[Hl](r.key,r.value),e[Wl]-=r.length,e[Zl].delete(r.key),e[Ql].removeNode(t)}};class ic{constructor(e,t,r,n,i){this.key=e,this.value=t,this.length=r,this.now=n,this.maxAge=i||0}}const oc=(e,t,r,n)=>{let i=r.value;tc(e,i)&&(nc(e,r),e[Gl]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};var ac=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[Yl]=e.max||1/0;const t=e.length||Xl;if(this[zl]="function"!=typeof t?Xl:t,this[Gl]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[Jl]=e.maxAge||0,this[Hl]=e.dispose,this[Vl]=e.noDisposeOnSet||!1,this[Kl]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[Yl]=e||1/0,rc(this)}get max(){return this[Yl]}set allowStale(e){this[Gl]=!!e}get allowStale(){return this[Gl]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[Jl]=e,rc(this)}get maxAge(){return this[Jl]}set lengthCalculator(e){"function"!=typeof e&&(e=Xl),e!==this[zl]&&(this[zl]=e,this[Wl]=0,this[Ql].forEach((e=>{e.length=this[zl](e.value,e.key),this[Wl]+=e.length}))),rc(this)}get lengthCalculator(){return this[zl]}get length(){return this[Wl]}get itemCount(){return this[Ql].length}rforEach(e,t){t=t||this;for(let r=this[Ql].tail;null!==r;){const n=r.prev;oc(this,e,r,t),r=n}}forEach(e,t){t=t||this;for(let r=this[Ql].head;null!==r;){const n=r.next;oc(this,e,r,t),r=n}}keys(){return this[Ql].toArray().map((e=>e.key))}values(){return this[Ql].toArray().map((e=>e.value))}reset(){this[Hl]&&this[Ql]&&this[Ql].length&&this[Ql].forEach((e=>this[Hl](e.key,e.value))),this[Zl]=new Map,this[Ql]=new ql,this[Wl]=0}dump(){return this[Ql].map((e=>!tc(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[Ql]}set(e,t,r){if((r=r||this[Jl])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");const n=r?Date.now():0,i=this[zl](t,e);if(this[Zl].has(e)){if(i>this[Yl])return nc(this,this[Zl].get(e)),!1;const o=this[Zl].get(e).value;return this[Hl]&&(this[Vl]||this[Hl](e,o.value)),o.now=n,o.maxAge=r,o.value=t,this[Wl]+=i-o.length,o.length=i,this.get(e),rc(this),!0}const o=new ic(e,t,i,n,r);return o.length>this[Yl]?(this[Hl]&&this[Hl](e,t),!1):(this[Wl]+=o.length,this[Ql].unshift(o),this[Zl].set(e,this[Ql].head),rc(this),!0)}has(e){if(!this[Zl].has(e))return!1;const t=this[Zl].get(e).value;return!tc(this,t)}get(e){return ec(this,e,!0)}peek(e){return ec(this,e,!1)}pop(){const e=this[Ql].tail;return e?(nc(this,e),e.value):null}del(e){nc(this,this[Zl].get(e))}load(e){this.reset();const t=Date.now();for(let r=e.length-1;r>=0;r--){const n=e[r],i=n.e||0;if(0===i)this.set(n.k,n.v);else{const e=i-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[Zl].forEach(((e,t)=>ec(this,t,!1)))}};const sc=ac;const{isArray:lc,isObject:cc,isString:uc}=Zs,{asArray:dc}=hl,{prependBase:hc}=El,fc=tl,pc=class{constructor({document:e}){this.document=e,this.cache=new sc({max:10})}getProcessed(e){return this.cache.get(e)}setProcessed(e,t){this.cache.set(e,t)}};function mc(e){throw new fc("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:e})}function yc({context:e,base:t}){if(!e)return;const r=e["@context"];if(uc(r))e["@context"]=hc(t,r);else if(lc(r))for(let e=0;e<r.length;++e){const n=r[e];uc(n)?r[e]=hc(t,n):cc(n)&&yc({context:{"@context":n},base:t})}else if(cc(r))for(const e in r)yc({context:r[e],base:t})}var gc=Vs.NQuads;const vc=tl,{isArray:wc}=Zs,{asArray:bc}=hl,_c={};var Ec=_c;function Tc({event:e,handlers:t}){let r=!0;for(let n=0;r&&n<t.length;++n){r=!1;const i=t[n];if(wc(i))r=Tc({event:e,handlers:i});else if("function"==typeof i)i({event:e,next:()=>{r=!0}});else{if("object"!=typeof i)throw new vc("Invalid event handler.","jsonld.InvalidEventHandler",{event:e});e.code in i?i[e.code]({event:e,next:()=>{r=!0}}):r=!0}}return r}_c.defaultEventHandler=null,_c.setupEventHandler=({options:e={}})=>{const t=[].concat(e.safe?_c.safeEventHandler:[],e.eventHandler?bc(e.eventHandler):[],_c.defaultEventHandler?_c.defaultEventHandler:[]);return 0===t.length?null:t},_c.handleEvent=({event:e,options:t})=>{Tc({event:e,handlers:t.eventHandler})};const xc=new Set(["empty object","free-floating scalar","invalid @language value","invalid property","null @id value","null @value value","object with only @id","object with only @language","object with only @list","object with only @value","relative @id reference","relative @type reference","relative @vocab reference","reserved @id value","reserved @reverse value","reserved term","blank node predicate","relative graph reference","relative object reference","relative predicate reference","relative subject reference","rdfDirection not set"]);_c.safeEventHandler=function({event:e,next:t}){if("warning"===e.level&&xc.has(e.code))throw new vc("Safe mode validation error.","jsonld.ValidationError",{event:e});t()},_c.logEventHandler=function({event:e,next:t}){console.log(`EVENT: ${e.message}`,{event:e}),t()},_c.logWarningEventHandler=function({event:e,next:t}){"warning"===e.level&&console.warn(`WARNING: ${e.message}`,{event:e}),t()},_c.unhandledEventHandler=function({event:e}){throw new vc("No handler for event.","jsonld.UnhandledEvent",{event:e})},_c.setDefaultEventHandler=function({eventHandler:e}={}){_c.defaultEventHandler=e?bc(e):null};const Ic=hl,Sc=tl,{isArray:Rc,isObject:kc,isString:Dc,isUndefined:jc}=Zs,{isAbsolute:Nc,isRelative:Oc,prependBase:Cc}=El,{handleEvent:Ac}=Ec,{REGEX_BCP47:Mc,REGEX_KEYWORD:Lc,asArray:Pc,compareShortestLeast:Bc}=hl,$c=new Map,Fc={};var Uc=Fc;function qc(e,t,r,n,i,o){if(null===t||!Dc(t)||Fc.isKeyword(t))return t;if(t.match(Lc))return null;if(n&&n.hasOwnProperty(t)&&!0!==i.get(t)&&Fc.createTermDefinition({activeCtx:e,localCtx:n,term:t,defined:i,options:o}),(r=r||{}).vocab){const r=e.mappings.get(t);if(null===r)return null;if(kc(r)&&"@id"in r)return r["@id"]}const a=t.indexOf(":");if(a>0){const r=t.substr(0,a),s=t.substr(a+1);if("_"===r||0===s.indexOf("//"))return t;n&&n.hasOwnProperty(r)&&Fc.createTermDefinition({activeCtx:e,localCtx:n,term:r,defined:i,options:o});const l=e.mappings.get(r);if(l&&l._prefix)return l["@id"]+s;if(Nc(t))return t}if(r.vocab&&"@vocab"in e){t=e["@vocab"]+t}else if(r.base){let r,n;"@base"in e?e["@base"]?(n=Cc(o.base,e["@base"]),r=Cc(n,t)):(n=e["@base"],r=t):(n=o.base,r=Cc(o.base,t)),t=r}return t}function Yc(e,t){if(!e||"object"!=typeof e||!t||"object"!=typeof t)return e===t;const r=Array.isArray(e);if(r!==Array.isArray(t))return!1;if(r){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(!Yc(e[r],t[r]))return!1;return!0}const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(const r in e){let n=e[r],i=t[r];if("@container"===r&&Array.isArray(n)&&Array.isArray(i)&&(n=n.slice().sort(),i=i.slice().sort()),!Yc(n,i))return!1}return!0}Fc.process=async({activeCtx:e,localCtx:t,options:r,propagate:n=!0,overrideProtected:i=!1,cycles:o=new Set})=>{kc(t)&&"@context"in t&&Rc(t["@context"])&&(t=t["@context"]);if(0===Pc(t).length)return e;const a=[],s=[({event:e,next:t})=>{a.push(e),t()}];r.eventHandler&&s.push(r.eventHandler);const l=r;r={...r,eventHandler:s};const c=await r.contextResolver.resolve({activeCtx:e,context:t,documentLoader:r.documentLoader,base:r.base});kc(c[0].document)&&"boolean"==typeof c[0].document["@propagate"]&&(n=c[0].document["@propagate"]);let u=e;n||u.previousContext||(u=u.clone(),u.previousContext=e);for(const n of c){let{document:s}=n;if(e=u,null===s){if(!i&&0!==Object.keys(e.protected).length)throw new Sc("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});u=e=Fc.getInitialContext(r).clone();continue}const c=n.getProcessed(e);if(c){if(l.eventHandler)for(const e of c.events)Ac({event:e,options:l});u=e=c.context;continue}if(kc(s)&&"@context"in s&&(s=s["@context"]),!kc(s))throw new Sc("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:s});u=u.clone();const d=new Map;if("@version"in s){if(1.1!==s["@version"])throw new Sc("Unsupported JSON-LD version: "+s["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:s});if(e.processingMode&&"json-ld-1.0"===e.processingMode)throw new Sc("@version: "+s["@version"]+" not compatible with "+e.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:s});u.processingMode="json-ld-1.1",u["@version"]=s["@version"],d.set("@version",!0)}if(u.processingMode=u.processingMode||e.processingMode,"@base"in s){let e=s["@base"];if(null===e||Nc(e));else{if(!Oc(e))throw new Sc('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:s});e=Cc(u["@base"],e)}u["@base"]=e,d.set("@base",!0)}if("@vocab"in s){const e=s["@vocab"];if(null===e)delete u["@vocab"];else{if(!Dc(e))throw new Sc('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:s});if(!Nc(e)&&Fc.processingMode(u,1))throw new Sc('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:s});{const t=qc(u,e,{vocab:!0,base:!0},void 0,void 0,r);Nc(t)||r.eventHandler&&Ac({event:{type:["JsonLdEvent"],code:"relative @vocab reference",level:"warning",message:"Relative @vocab reference found.",details:{vocab:t}},options:r}),u["@vocab"]=t}}d.set("@vocab",!0)}if("@language"in s){const e=s["@language"];if(null===e)delete u["@language"];else{if(!Dc(e))throw new Sc('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:s});e.match(Mc)||r.eventHandler&&Ac({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e}},options:r}),u["@language"]=e.toLowerCase()}d.set("@language",!0)}if("@direction"in s){const t=s["@direction"];if("json-ld-1.0"===e.processingMode)throw new Sc("Invalid JSON-LD syntax; @direction not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:s});if(null===t)delete u["@direction"];else{if("ltr"!==t&&"rtl"!==t)throw new Sc('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:s});u["@direction"]=t}d.set("@direction",!0)}if("@propagate"in s){const r=s["@propagate"];if("json-ld-1.0"===e.processingMode)throw new Sc("Invalid JSON-LD syntax; @propagate not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:s});if("boolean"!=typeof r)throw new Sc("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:t});d.set("@propagate",!0)}if("@import"in s){const n=s["@import"];if("json-ld-1.0"===e.processingMode)throw new Sc("Invalid JSON-LD syntax; @import not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:s});if(!Dc(n))throw new Sc("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:t});const i=await r.contextResolver.resolve({activeCtx:e,context:n,documentLoader:r.documentLoader,base:r.base});if(1!==i.length)throw new Sc("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:t});const o=i[0].getProcessed(e);if(o)s=o;else{const r=i[0].document;if("@import"in r)throw new Sc("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:t});for(const e in r)s.hasOwnProperty(e)||(s[e]=r[e]);i[0].setProcessed(e,s)}d.set("@import",!0)}d.set("@protected",s["@protected"]||!1);for(const e in s)if(Fc.createTermDefinition({activeCtx:u,localCtx:s,term:e,defined:d,options:r,overrideProtected:i}),kc(s[e])&&"@context"in s[e]){const t=s[e]["@context"];let n=!0;if(Dc(t)){const e=Cc(r.base,t);o.has(e)?n=!1:o.add(e)}if(n)try{await Fc.process({activeCtx:u.clone(),localCtx:s[e]["@context"],overrideProtected:!0,options:r,cycles:o})}catch(t){throw new Sc("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:s[e]["@context"],term:e})}}n.setProcessed(e,{context:u,events:a})}return u},Fc.createTermDefinition=({activeCtx:e,localCtx:t,term:r,defined:n,options:i,overrideProtected:o=!1})=>{if(n.has(r)){if(n.get(r))return;throw new Sc("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:r})}let a;if(n.set(r,!1),t.hasOwnProperty(r)&&(a=t[r]),"@type"===r&&kc(a)&&"@set"===(a["@container"]||"@set")&&Fc.processingMode(e,1.1)){const e=["@container","@id","@protected"],n=Object.keys(a);if(0===n.length||n.some((t=>!e.includes(t))))throw new Sc("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:r})}else{if(Fc.isKeyword(r))throw new Sc("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:r});if(r.match(Lc))return void(i.eventHandler&&Ac({event:{type:["JsonLdEvent"],code:"reserved term",level:"warning",message:'Terms beginning with "@" are reserved for future use and dropped.',details:{term:r}},options:i}));if(""===r)throw new Sc("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t})}const s=e.mappings.get(r);e.mappings.has(r)&&e.mappings.delete(r);let l=!1;if((Dc(a)||null===a)&&(l=!0,a={"@id":a}),!kc(a))throw new Sc("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});const c={};e.mappings.set(r,c),c.reverse=!1;const u=["@container","@id","@language","@reverse","@type"];Fc.processingMode(e,1.1)&&u.push("@context","@direction","@index","@nest","@prefix","@protected");for(const e in a)if(!u.includes(e))throw new Sc("Invalid JSON-LD syntax; a term definition must not contain "+e,"jsonld.SyntaxError",{code:"invalid term definition",context:t});const d=r.indexOf(":");if(c._termHasColon=d>0,"@reverse"in a){if("@id"in a)throw new Sc("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});if("@nest"in a)throw new Sc("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});const o=a["@reverse"];if(!Dc(o))throw new Sc("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(o.match(Lc))return i.eventHandler&&Ac({event:{type:["JsonLdEvent"],code:"reserved @reverse value",level:"warning",message:'@reverse values beginning with "@" are reserved for future use and dropped.',details:{reverse:o}},options:i}),void(s?e.mappings.set(r,s):e.mappings.delete(r));const l=qc(e,o,{vocab:!0,base:!1},t,n,i);if(!Nc(l))throw new Sc("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});c["@id"]=l,c.reverse=!0}else if("@id"in a){let o=a["@id"];if(o&&!Dc(o))throw new Sc("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(null===o)c["@id"]=null;else{if(!Fc.isKeyword(o)&&o.match(Lc))return i.eventHandler&&Ac({event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:'@id values beginning with "@" are reserved for future use and dropped.',details:{id:o}},options:i}),void(s?e.mappings.set(r,s):e.mappings.delete(r));if(o!==r){if(o=qc(e,o,{vocab:!0,base:!1},t,n,i),!Nc(o)&&!Fc.isKeyword(o))throw new Sc("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(r.match(/(?::[^:])|\//)){if(qc(e,r,{vocab:!0,base:!1},t,new Map(n).set(r,!0),i)!==o)throw new Sc("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t})}c["@id"]=o,c._prefix=l&&!c._termHasColon&&null!==o.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in c))if(c._termHasColon){const o=r.substr(0,d);if(t.hasOwnProperty(o)&&Fc.createTermDefinition({activeCtx:e,localCtx:t,term:o,defined:n,options:i}),e.mappings.has(o)){const t=r.substr(d+1);c["@id"]=e.mappings.get(o)["@id"]+t}else c["@id"]=r}else if("@type"===r)c["@id"]=r;else{if(!("@vocab"in e))throw new Sc("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:r});c["@id"]=e["@vocab"]+r}if((!0===a["@protected"]||!0===n.get("@protected")&&!1!==a["@protected"])&&(e.protected[r]=!0,c.protected=!0),n.set(r,!0),"@type"in a){let r=a["@type"];if(!Dc(r))throw new Sc("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if("@json"===r||"@none"===r){if(Fc.processingMode(e,1))throw new Sc(`Invalid JSON-LD syntax; an @context @type value must not be "${r}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:t})}else if("@id"!==r&&"@vocab"!==r){if(r=qc(e,r,{vocab:!0,base:!1},t,n,i),!Nc(r))throw new Sc("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(0===r.indexOf("_:"))throw new Sc("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}c["@type"]=r}if("@container"in a){const r=Dc(a["@container"])?[a["@container"]]:a["@container"]||[],n=["@list","@set","@index","@language"];let i=!0;const o=r.includes("@set");if(Fc.processingMode(e,1.1)){if(n.push("@graph","@id","@type"),r.includes("@list")){if(1!==r.length)throw new Sc("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else if(r.includes("@graph")){if(r.some((e=>"@graph"!==e&&"@id"!==e&&"@index"!==e&&"@set"!==e)))throw new Sc("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else i&=r.length<=(o?2:1);if(r.includes("@type")&&(c["@type"]=c["@type"]||"@id",!["@id","@vocab"].includes(c["@type"])))throw new Sc("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}else i&=!Rc(a["@container"]),i&=r.length<=1;if(i&=r.every((e=>n.includes(e))),i&=!(o&&r.includes("@list")),!i)throw new Sc("Invalid JSON-LD syntax; @context @container value must be one of the following: "+n.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(c.reverse&&!r.every((e=>["@index","@set"].includes(e))))throw new Sc("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});c["@container"]=r}if("@index"in a){if(!("@container"in a)||!c["@container"].includes("@index"))throw new Sc(`Invalid JSON-LD syntax; @index without @index in @container: "${a["@index"]}" on term "${r}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:t});if(!Dc(a["@index"])||0===a["@index"].indexOf("@"))throw new Sc(`Invalid JSON-LD syntax; @index must expand to an IRI: "${a["@index"]}" on term "${r}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:t});c["@index"]=a["@index"]}if("@context"in a&&(c["@context"]=a["@context"]),"@language"in a&&!("@type"in a)){let e=a["@language"];if(null!==e&&!Dc(e))throw new Sc("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});null!==e&&(e=e.toLowerCase()),c["@language"]=e}if("@prefix"in a){if(r.match(/:|\//))throw new Sc("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:t});if(Fc.isKeyword(c["@id"]))throw new Sc("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:t});if("boolean"!=typeof a["@prefix"])throw new Sc("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:t});c._prefix=!0===a["@prefix"]}if("@direction"in a){const e=a["@direction"];if(null!==e&&"ltr"!==e&&"rtl"!==e)throw new Sc('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:t});c["@direction"]=e}if("@nest"in a){const e=a["@nest"];if(!Dc(e)||"@nest"!==e&&0===e.indexOf("@"))throw new Sc("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:t});c["@nest"]=e}
// disallow aliasing @context and @preserve
const h=c["@id"];if("@context"===h||"@preserve"===h)throw new Sc("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t});if(s&&s.protected&&!o&&(e.protected[r]=!0,c.protected=!0,!Yc(s,c)))throw new Sc("Invalid JSON-LD syntax; tried to redefine a protected term.","jsonld.SyntaxError",{code:"protected term redefinition",context:t,term:r})},Fc.expandIri=(e,t,r,n)=>qc(e,t,r,void 0,void 0,n),Fc.getInitialContext=e=>{const t=JSON.stringify({processingMode:e.processingMode}),r=$c.get(t);if(r)return r;const n={processingMode:e.processingMode,mappings:new Map,inverse:null,getInverse:function(){const e=this;if(e.inverse)return e.inverse;const t=e.inverse={},r=e.fastCurieMap={},n={},a=(e["@language"]||"@none").toLowerCase(),s=e["@direction"],l=e.mappings,c=[...l.keys()].sort(Bc);for(const e of c){const i=l.get(e);if(null===i)continue;let c=i["@container"]||"@none";if(c=[].concat(c).sort().join(""),null===i["@id"])continue;const u=Pc(i["@id"]);for(const l of u){let u=t[l];const d=Fc.isKeyword(l);if(u)d||i._termHasColon||n[l].push(e);else if(t[l]=u={},!d&&!i._termHasColon){n[l]=[e];const t={iri:l,terms:n[l]};l[0]in r?r[l[0]].push(t):r[l[0]]=[t]}if(u[c]||(u[c]={"@language":{},"@type":{},"@any":{}}),u=u[c],o(e,u["@any"],"@none"),i.reverse)o(e,u["@type"],"@reverse");else if("@none"===i["@type"])o(e,u["@any"],"@none"),o(e,u["@language"],"@none"),o(e,u["@type"],"@none");else if("@type"in i)o(e,u["@type"],i["@type"]);else if("@language"in i&&"@direction"in i){const t=i["@language"],r=i["@direction"];o(e,u["@language"],t&&r?`${t}_${r}`.toLowerCase():t?t.toLowerCase():r?`_${r}`:"@null")}else"@language"in i?o(e,u["@language"],(i["@language"]||"@null").toLowerCase()):"@direction"in i?i["@direction"]?o(e,u["@language"],`_${i["@direction"]}`):o(e,u["@language"],"@none"):s?(o(e,u["@language"],`_${s}`),o(e,u["@language"],"@none"),o(e,u["@type"],"@none")):(o(e,u["@language"],a),o(e,u["@language"],"@none"),o(e,u["@type"],"@none"))}}for(const e in r)i(r,e,1);return t},clone:function(){const e={};e.mappings=Ic.clone(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,e.protected=Ic.clone(this.protected),this.previousContext&&(e.previousContext=this.previousContext.clone());e.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(e["@base"]=this["@base"]);"@language"in this&&(e["@language"]=this["@language"]);"@vocab"in this&&(e["@vocab"]=this["@vocab"]);return e},revertToPreviousContext:function(){if(!this.previousContext)return this;return this.previousContext.clone()},protected:{}};return 1e4===$c.size&&$c.clear(),$c.set(t,n),n;function i(e,t,r){const n=e[t],o=e[t]={};let a,s;for(const e of n)a=e.iri,s=r>=a.length?"":a[r],s in o?o[s].push(e):o[s]=[e];for(const e in o)""!==e&&i(o,e,r+1)}function o(e,t,r){t.hasOwnProperty(r)||(t[r]=e)}},Fc.getContextValue=(e,t,r)=>{if(null===t){if("@context"===r)return;return null}if(e.mappings.has(t)){const n=e.mappings.get(t);if(jc(r))return n;if(n.hasOwnProperty(r))return n[r]}return"@language"===r&&r in e||"@direction"===r&&r in e?e[r]:"@context"!==r?null:void 0},Fc.processingMode=(e,t)=>t.toString()>="1.1"?!e.processingMode||e.processingMode>="json-ld-"+t.toString():"json-ld-1.0"===e.processingMode,Fc.isKeyword=e=>{if(!Dc(e)||"@"!==e[0])return!1;switch(e){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1};const Wc=tl,{isArray:zc,isObject:Gc,isEmptyObject:Jc,isString:Hc,isUndefined:Vc}=Zs,{isList:Qc,isValue:Zc,isGraph:Kc,isSubject:Xc}=el,{expandIri:eu,getContextValue:tu,isKeyword:ru,process:nu,processingMode:iu}=Uc,{isAbsolute:ou}=El,{REGEX_BCP47:au,REGEX_KEYWORD:su,addValue:lu,asArray:cu,getValues:uu,validateTypeValue:du}=hl,{handleEvent:hu}=Ec,fu={};var pu=fu;function mu({value:e,count:t,options:r}){if(0===t||"@value"in e||"@list"in e||1===t&&"@id"in e){if(r.eventHandler){let n,i;0===t?(n="empty object",i="Dropping empty object."):"@value"in e?(n="object with only @value",i="Dropping object with only @value."):"@list"in e?(n="object with only @list",i="Dropping object with only @list."):1===t&&"@id"in e&&(n="object with only @id",i="Dropping object with only @id."),hu({event:{type:["JsonLdEvent"],code:n,level:"warning",message:i,details:{value:e}},options:r})}return null}return e}async function yu({activeCtx:e,activeProperty:t,expandedActiveProperty:r,element:n,expandedParent:i,options:o={},insideList:a,typeKey:s,typeScopedContext:l}){const c=Object.keys(n).sort(),u=[];let d;const h=n[s]&&"@json"===eu(e,zc(n[s])?n[s][0]:n[s],{vocab:!0},{...o,typeExpansion:!0});for(const a of c){let s,c=n[a];if("@context"===a)continue;const f=eu(e,a,{vocab:!0},o);if(null===f||!ou(f)&&!ru(f)){o.eventHandler&&hu({event:{type:["JsonLdEvent"],code:"invalid property",level:"warning",message:"Dropping property that did not expand into an absolute IRI or keyword.",details:{property:a,expandedProperty:f}},options:o});continue}if(ru(f)){if("@reverse"===r)throw new Wc("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:c});if(f in i&&"@included"!==f&&"@type"!==f)throw new Wc("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:f})}if("@id"===f){if(!Hc(c)){if(!o.isFrame)throw new Wc('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:c});if(Gc(c)){if(!Jc(c))throw new Wc('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:c})}else{if(!zc(c))throw new Wc('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:c});if(!c.every((e=>Hc(e))))throw new Wc('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:c})}}lu(i,"@id",cu(c).map((t=>{if(Hc(t)){const r=eu(e,t,{base:!0},o);return o.eventHandler&&(null===r?hu(null===t?{event:{type:["JsonLdEvent"],code:"null @id value",level:"warning",message:"Null @id found.",details:{id:t}},options:o}:{event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:"Reserved @id found.",details:{id:t}},options:o}):ou(r)||hu({event:{type:["JsonLdEvent"],code:"relative @id reference",level:"warning",message:"Relative @id reference found.",details:{id:t,expandedId:r}},options:o})),r}return t})),{propertyIsArray:o.isFrame});continue}if("@type"===f){Gc(c)&&(c=Object.fromEntries(Object.entries(c).map((([e,t])=>[eu(l,e,{vocab:!0}),cu(t).map((e=>eu(l,e,{base:!0,vocab:!0},{...o,typeExpansion:!0})))])))),du(c,o.isFrame),lu(i,"@type",cu(c).map((e=>{if(Hc(e)){const t=eu(l,e,{base:!0,vocab:!0},{...o,typeExpansion:!0});return"@json"===t||ou(t)||o.eventHandler&&hu({event:{type:["JsonLdEvent"],code:"relative @type reference",level:"warning",message:"Relative @type reference found.",details:{type:e}},options:o}),t}return e})),{propertyIsArray:!!o.isFrame});continue}if("@included"===f&&iu(e,1.1)){const r=cu(await fu.expand({activeCtx:e,activeProperty:t,element:c,options:o}));if(!r.every((e=>Xc(e))))throw new Wc("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:c});lu(i,"@included",r,{propertyIsArray:!0});continue}if("@graph"===f&&!Gc(c)&&!zc(c))throw new Wc('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:c});if("@value"===f){d=c,h&&iu(e,1.1)?i["@value"]=c:lu(i,"@value",c,{propertyIsArray:o.isFrame});continue}if("@language"===f){if(null===c)continue;if(!Hc(c)&&!o.isFrame)throw new Wc('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:c});c=cu(c).map((e=>Hc(e)?e.toLowerCase():e));for(const e of c)Hc(e)&&!e.match(au)&&o.eventHandler&&hu({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e}},options:o});lu(i,"@language",c,{propertyIsArray:o.isFrame});continue}if("@direction"===f){if(!Hc(c)&&!o.isFrame)throw new Wc('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:c});c=cu(c);for(const e of c)if(Hc(e)&&"ltr"!==e&&"rtl"!==e)throw new Wc('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:c});lu(i,"@direction",c,{propertyIsArray:o.isFrame});continue}if("@index"===f){if(!Hc(c))throw new Wc('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:c});lu(i,"@index",c);continue}if("@reverse"===f){if(!Gc(c))throw new Wc('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:c});if(s=await fu.expand({activeCtx:e,activeProperty:"@reverse",element:c,options:o}),"@reverse"in s)for(const e in s["@reverse"])lu(i,e,s["@reverse"][e],{propertyIsArray:!0});let t=i["@reverse"]||null;for(const e in s){if("@reverse"===e)continue;null===t&&(t=i["@reverse"]={}),lu(t,e,[],{propertyIsArray:!0});const r=s[e];for(let n=0;n<r.length;++n){const i=r[n];if(Zc(i)||Qc(i))throw new Wc('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:s});lu(t,e,i,{propertyIsArray:!0})}}continue}if("@nest"===f){u.push(a);continue}let p=e;const m=tu(e,a,"@context");Vc(m)||(p=await nu({activeCtx:e,localCtx:m,propagate:!0,overrideProtected:!0,options:o}));const y=tu(p,a,"@container")||[];if(y.includes("@language")&&Gc(c)){s=vu(p,c,tu(p,a,"@direction"),o)}else if(y.includes("@index")&&Gc(c)){const t=y.includes("@graph"),r=tu(p,a,"@index")||"@index",n="@index"!==r&&eu(e,r,{vocab:!0},o);s=await wu({activeCtx:p,options:o,activeProperty:a,value:c,asGraph:t,indexKey:r,propertyIndex:n})}else if(y.includes("@id")&&Gc(c)){const e=y.includes("@graph");s=await wu({activeCtx:p,options:o,activeProperty:a,value:c,asGraph:e,indexKey:"@id"})}else if(y.includes("@type")&&Gc(c))s=await wu({activeCtx:p.revertToPreviousContext(),options:o,activeProperty:a,value:c,asGraph:!1,indexKey:"@type"});else{const n="@list"===f;if(n||"@set"===f){let e=t;n&&"@graph"===r&&(e=null),s=await fu.expand({activeCtx:p,activeProperty:e,element:c,options:o,insideList:n})}else s="@json"===tu(e,a,"@type")?{"@type":"@json","@value":c}:await fu.expand({activeCtx:p,activeProperty:a,element:c,options:o,insideList:!1})}if(null!==s||"@value"===f){if("@list"!==f&&!Qc(s)&&y.includes("@list")&&(s={"@list":cu(s)}),y.includes("@graph")&&!y.some((e=>"@id"===e||"@index"===e))){if(s=cu(s),o.isFrame||(s=s.filter((e=>null!==mu({value:e,count:Object.keys(e).length,options:o})))),0===s.length)continue;s=s.map((e=>({"@graph":cu(e)})))}if(p.mappings.has(a)&&p.mappings.get(a).reverse){const e=i["@reverse"]=i["@reverse"]||{};s=cu(s);for(let t=0;t<s.length;++t){const r=s[t];if(Zc(r)||Qc(r))throw new Wc('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:s});lu(e,f,r,{propertyIsArray:!0})}}else lu(i,f,s,{propertyIsArray:!0})}}if("@value"in i)if("@json"===i["@type"]&&iu(e,1.1));else if((Gc(d)||zc(d))&&!o.isFrame)throw new Wc('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:d});for(const c of u){const u=zc(n[c])?n[c]:[n[c]];for(const n of u){if(!Gc(n)||Object.keys(n).some((t=>"@value"===eu(e,t,{vocab:!0},o))))throw new Wc("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:n});await yu({activeCtx:e,activeProperty:t,expandedActiveProperty:r,element:n,expandedParent:i,options:o,insideList:a,typeScopedContext:l,typeKey:s})}}}function gu({activeCtx:e,activeProperty:t,value:r,options:n}){if(null==r)return null;const i=eu(e,t,{vocab:!0},n);if("@id"===i)return eu(e,r,{base:!0},n);if("@type"===i)return eu(e,r,{vocab:!0,base:!0},{...n,typeExpansion:!0});const o=tu(e,t,"@type");if(("@id"===o||"@graph"===i)&&Hc(r)){const i=eu(e,r,{base:!0},n);return null===i&&r.match(su)&&n.eventHandler&&hu({event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:"Reserved @id found.",details:{id:t}},options:n}),{"@id":i}}if("@vocab"===o&&Hc(r))return{"@id":eu(e,r,{vocab:!0,base:!0},n)};if(ru(i))return r;const a={};if(o&&!["@id","@vocab","@none"].includes(o))a["@type"]=o;else if(Hc(r)){const r=tu(e,t,"@language");null!==r&&(a["@language"]=r);const n=tu(e,t,"@direction");null!==n&&(a["@direction"]=n)}return["boolean","number","string"].includes(typeof r)||(r=r.toString()),a["@value"]=r,a}function vu(e,t,r,n){const i=[],o=Object.keys(t).sort();for(const a of o){const o=eu(e,a,{vocab:!0},n);let s=t[a];zc(s)||(s=[s]);for(const e of s){if(null===e)continue;if(!Hc(e))throw new Wc("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:t});const s={"@value":e};"@none"!==o&&(a.match(au)||n.eventHandler&&hu({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:a}},options:n}),s["@language"]=a.toLowerCase()),r&&(s["@direction"]=r),i.push(s)}}return i}async function wu({activeCtx:e,options:t,activeProperty:r,value:n,asGraph:i,indexKey:o,propertyIndex:a}){const s=[],l=Object.keys(n).sort(),c="@type"===o;for(let u of l){if(c){const r=tu(e,u,"@context");Vc(r)||(e=await nu({activeCtx:e,localCtx:r,propagate:!1,options:t}))}let l,d=n[u];zc(d)||(d=[d]),d=await fu.expand({activeCtx:e,activeProperty:r,element:d,options:t,insideList:!1,insideIndex:!0}),l=a?"@none"===u?"@none":gu({activeCtx:e,activeProperty:o,value:u,options:t}):eu(e,u,{vocab:!0},t),"@id"===o?u=eu(e,u,{base:!0},t):c&&(u=l);for(let e of d){if(i&&!Kc(e)&&(e={"@graph":[e]}),"@type"===o)"@none"===l||(e["@type"]?e["@type"]=[u].concat(e["@type"]):e["@type"]=[u]);else{if(Zc(e)&&!["@language","@type","@index"].includes(o))throw new Wc(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${o}".`,"jsonld.SyntaxError",{code:"invalid value object",value:e});a?"@none"!==l&&lu(e,a,l,{propertyIsArray:!0,prependValue:!0}):"@none"===l||o in e||(e[o]=u)}s.push(e)}}return s}fu.expand=async({activeCtx:e,activeProperty:t=null,element:r,options:n={},insideList:i=!1,insideIndex:o=!1,typeScopedContext:a=null})=>{if(null==r)return null;if("@default"===t&&(n=Object.assign({},n,{isFrame:!1})),!zc(r)&&!Gc(r))return i||null!==t&&"@graph"!==eu(e,t,{vocab:!0},n)?gu({activeCtx:e,activeProperty:t,value:r,options:n}):(n.eventHandler&&hu({event:{type:["JsonLdEvent"],code:"free-floating scalar",level:"warning",message:"Dropping free-floating scalar not in a list.",details:{value:r}},options:n}),null);if(zc(r)){let s=[];const l=tu(e,t,"@container")||[];i=i||l.includes("@list");for(let l=0;l<r.length;++l){let c=await fu.expand({activeCtx:e,activeProperty:t,element:r[l],options:n,insideIndex:o,typeScopedContext:a});i&&zc(c)&&(c={"@list":c}),null!==c&&(zc(c)?s=s.concat(c):s.push(c))}return s}const s=eu(e,t,{vocab:!0},n),l=tu(e,t,"@context");a=a||(e.previousContext?e:null);let c=Object.keys(r).sort(),u=!o;if(u&&a&&c.length<=2&&!c.includes("@context"))for(const t of c){const r=eu(a,t,{vocab:!0},n);if("@value"===r){u=!1,e=a;break}if("@id"===r&&1===c.length){u=!1;break}}u&&(e=e.revertToPreviousContext()),Vc(l)||(e=await nu({activeCtx:e,localCtx:l,propagate:!0,overrideProtected:!0,options:n})),"@context"in r&&(e=await nu({activeCtx:e,localCtx:r["@context"],options:n})),a=e;let d=null;for(const t of c){if("@type"===eu(e,t,{vocab:!0},n)){d=d||t;const i=r[t],o=Array.isArray(i)?i.length>1?i.slice().sort():i:[i];for(const t of o){const r=tu(a,t,"@context");Vc(r)||(e=await nu({activeCtx:e,localCtx:r,options:n,propagate:!1}))}}}let h={};await yu({activeCtx:e,activeProperty:t,expandedActiveProperty:s,element:r,expandedParent:h,options:n,insideList:i,typeKey:d,typeScopedContext:a}),c=Object.keys(h);let f=c.length;if("@value"in h){if("@type"in h&&("@language"in h||"@direction"in h))throw new Wc('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:h});let t=f-1;if("@type"in h&&(t-=1),"@index"in h&&(t-=1),"@language"in h&&(t-=1),"@direction"in h&&(t-=1),0!==t)throw new Wc('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:h});const r=null===h["@value"]?[]:cu(h["@value"]),i=uu(h,"@type");if(iu(e,1.1)&&i.includes("@json")&&1===i.length);else if(0===r.length)n.eventHandler&&hu({event:{type:["JsonLdEvent"],code:"null @value value",level:"warning",message:"Dropping null @value value.",details:{value:h}},options:n}),h=null;else{if(!r.every((e=>Hc(e)||Jc(e)))&&"@language"in h)throw new Wc("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:h});if(!i.every((e=>ou(e)&&!(Hc(e)&&0===e.indexOf("_:"))||Jc(e))))throw new Wc('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:h})}}else if("@type"in h&&!zc(h["@type"]))h["@type"]=[h["@type"]];else if("@set"in h||"@list"in h){if(f>1&&(2!==f||!("@index"in h)))throw new Wc('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:h});"@set"in h&&(h=h["@set"],c=Object.keys(h),f=c.length)}else 1===f&&"@language"in h&&(n.eventHandler&&hu({event:{type:["JsonLdEvent"],code:"object with only @language",level:"warning",message:"Dropping object with only @language.",details:{value:h}},options:n}),h=null);return!Gc(h)||n.keepFreeFloatingNodes||i||null!==t&&"@graph"!==s&&!(tu(e,t,"@container")||[]).includes("@graph")||(h=mu({value:h,count:f,options:n})),h};const{isKeyword:bu}=Uc,_u=el,Eu=Zs,Tu=hl,xu=tl,Iu={};var Su=Iu;Iu.createMergedNodeMap=(e,t)=>{const r=(t=t||{}).issuer||new Tu.IdentifierIssuer("_:b"),n={"@default":{}};return Iu.createNodeMap(e,n,"@default",r),Iu.mergeNodeMaps(n)},Iu.createNodeMap=(e,t,r,n,i,o)=>{if(Eu.isArray(e)){for(const i of e)Iu.createNodeMap(i,t,r,n,void 0,o);return}if(!Eu.isObject(e))return void(o&&o.push(e));if(_u.isValue(e)){if("@type"in e){let t=e["@type"];0===t.indexOf("_:")&&(e["@type"]=t=n.getId(t))}return void(o&&o.push(e))}if(o&&_u.isList(e)){const a=[];return Iu.createNodeMap(e["@list"],t,r,n,i,a),void o.push({"@list":a})}if("@type"in e){const t=e["@type"];for(const e of t)0===e.indexOf("_:")&&n.getId(e)}Eu.isUndefined(i)&&(i=_u.isBlankNode(e)?n.getId(e["@id"]):e["@id"]),o&&o.push({"@id":i});const a=t[r],s=a[i]=a[i]||{};s["@id"]=i;const l=Object.keys(e).sort();for(let o of l){if("@id"===o)continue;if("@reverse"===o){const o={"@id":i},s=e["@reverse"];for(const e in s){const i=s[e];for(const s of i){let i=s["@id"];_u.isBlankNode(s)&&(i=n.getId(i)),Iu.createNodeMap(s,t,r,n,i),Tu.addValue(a[i],e,o,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===o){i in t||(t[i]={}),Iu.createNodeMap(e[o],t,i,n);continue}if("@included"===o){Iu.createNodeMap(e[o],t,r,n);continue}if("@type"!==o&&bu(o)){if("@index"===o&&o in s&&(e[o]!==s[o]||e[o]["@id"]!==s[o]["@id"]))throw new xu("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:s});s[o]=e[o];continue}const l=e[o];if(0===o.indexOf("_:")&&(o=n.getId(o)),0!==l.length)for(let e of l)if("@type"===o&&(e=0===e.indexOf("_:")?n.getId(e):e),_u.isSubject(e)||_u.isSubjectReference(e)){if("@id"in e&&!e["@id"])continue;const i=_u.isBlankNode(e)?n.getId(e["@id"]):e["@id"];Tu.addValue(s,o,{"@id":i},{propertyIsArray:!0,allowDuplicate:!1}),Iu.createNodeMap(e,t,r,n,i)}else if(_u.isValue(e))Tu.addValue(s,o,e,{propertyIsArray:!0,allowDuplicate:!1});else if(_u.isList(e)){const a=[];Iu.createNodeMap(e["@list"],t,r,n,i,a),e={"@list":a},Tu.addValue(s,o,e,{propertyIsArray:!0,allowDuplicate:!1})}else Iu.createNodeMap(e,t,r,n,i),Tu.addValue(s,o,e,{propertyIsArray:!0,allowDuplicate:!1});else Tu.addValue(s,o,[],{propertyIsArray:!0})}},Iu.mergeNodeMapGraphs=e=>{const t={};for(const r of Object.keys(e).sort())for(const n of Object.keys(e[r]).sort()){const i=e[r][n];n in t||(t[n]={"@id":n});const o=t[n];for(const e of Object.keys(i).sort())if(bu(e)&&"@type"!==e)o[e]=Tu.clone(i[e]);else for(const t of i[e])Tu.addValue(o,e,Tu.clone(t),{propertyIsArray:!0,allowDuplicate:!1})}return t},Iu.mergeNodeMaps=e=>{const t=e["@default"],r=Object.keys(e).sort();for(const n of r){if("@default"===n)continue;const r=e[n];let i=t[n];i?"@graph"in i||(i["@graph"]=[]):t[n]=i={"@id":n,"@graph":[]};const o=i["@graph"];for(const e of Object.keys(r).sort()){const t=r[e];_u.isSubjectReference(t)||o.push(t)}}return t};const{isSubjectReference:Ru}=el,{createMergedNodeMap:ku}=Su,Du={};var ju=Du;Du.flatten=e=>{const t=ku(e),r=[],n=Object.keys(t).sort();for(let e=0;e<n.length;++e){const i=t[n[e]];Ru(i)||r.push(i)}return r};const Nu=tl,Ou=el,Cu=Zs,{REGEX_BCP47:Au,addValue:Mu}=hl,{handleEvent:Lu}=Ec,{RDF_LIST:Pu,RDF_FIRST:Bu,RDF_REST:$u,RDF_NIL:Fu,RDF_TYPE:Uu,RDF_JSON_LITERAL:qu,XSD_BOOLEAN:Yu,XSD_DOUBLE:Wu,XSD_INTEGER:zu,XSD_STRING:Gu}=vl,Ju={};var Hu=Ju;function Vu(e,t,r,n){if(e.termType.endsWith("Node"))return{"@id":e.value};const i={"@value":e.value};if(e.language)e.language.match(Au)||n.eventHandler&&Lu({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e.language}},options:n}),i["@language"]=e.language;else{let o=e.datatype.value;if(o||(o=Gu),o===qu){o="@json";try{i["@value"]=JSON.parse(i["@value"])}catch(e){throw new Nu("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:i["@value"],cause:e})}}if(t){if(o===Yu)"true"===i["@value"]?i["@value"]=!0:"false"===i["@value"]&&(i["@value"]=!1);else if(Cu.isNumeric(i["@value"]))if(o===zu){const e=parseInt(i["@value"],10);e.toFixed(0)===i["@value"]&&(i["@value"]=e)}else o===Wu&&(i["@value"]=parseFloat(i["@value"]));[Yu,zu,Wu,Gu].includes(o)||(i["@type"]=o)}else if("i18n-datatype"===r&&o.startsWith("https://www.w3.org/ns/i18n#")){const[,e,t]=o.split(/[#_]/);e.length>0&&(i["@language"]=e,e.match(Au)||n.eventHandler&&Lu({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e}},options:n})),i["@direction"]=t}else o!==Gu&&(i["@type"]=o)}return i}Ju.fromRDF=async(e,t)=>{const{useRdfType:r=!1,useNativeTypes:n=!1,rdfDirection:i=null}=t,o={},a={"@default":o},s={};if(i){if("compound-literal"===i)throw new Nu("Unsupported rdfDirection value.","jsonld.InvalidRdfDirection",{value:i});if("i18n-datatype"!==i)throw new Nu("Unknown rdfDirection value.","jsonld.InvalidRdfDirection",{value:i})}for(const l of e){const e="DefaultGraph"===l.graph.termType?"@default":l.graph.value;e in a||(a[e]={}),"@default"===e||e in o||(o[e]={"@id":e});const c=a[e],u=l.subject.value,d=l.predicate.value,h=l.object;u in c||(c[u]={"@id":u});const f=c[u],p=h.termType.endsWith("Node");if(p&&!(h.value in c)&&(c[h.value]={"@id":h.value}),d===Uu&&!r&&p){Mu(f,"@type",h.value,{propertyIsArray:!0});continue}const m=Vu(h,n,i,t);if(Mu(f,d,m,{propertyIsArray:!0}),p)if(h.value===Fu){const e=c[h.value];"usages"in e||(e.usages=[]),e.usages.push({node:f,property:d,value:m})}else h.value in s?s[h.value]=!1:s[h.value]={node:f,property:d,value:m}}for(const e in a){const t=a[e];if(!(Fu in t))continue;const r=t[Fu];if(r.usages){for(let e of r.usages){let r=e.node,n=e.property,i=e.value;const o=[],a=[];let l=Object.keys(r).length;for(;n===$u&&Cu.isObject(s[r["@id"]])&&Cu.isArray(r[Bu])&&1===r[Bu].length&&Cu.isArray(r[$u])&&1===r[$u].length&&(3===l||4===l&&Cu.isArray(r["@type"])&&1===r["@type"].length&&r["@type"][0]===Pu)&&(o.push(r[Bu][0]),a.push(r["@id"]),e=s[r["@id"]],r=e.node,n=e.property,i=e.value,l=Object.keys(r).length,Ou.isBlankNode(r)););delete i["@id"],i["@list"]=o.reverse();for(const e of a)delete t[e]}delete r.usages}}const l=[],c=Object.keys(o).sort();for(const e of c){const t=o[e];if(e in a){const r=t["@graph"]=[],n=a[e],i=Object.keys(n).sort();for(const e of i){const t=n[e];Ou.isSubjectReference(t)||r.push(t)}}Ou.isSubjectReference(t)||l.push(t)}return l};const{createNodeMap:Qu}=Su,{isKeyword:Zu}=Uc,Ku=el,Xu=function e(t){return null===t||"object"!=typeof t||null!=t.toJSON?JSON.stringify(t):Array.isArray(t)?"["+t.reduce(((t,r,n)=>t+(0===n?"":",")+e(void 0===r||"symbol"==typeof r?null:r)),"")+"]":"{"+Object.keys(t).sort().reduce(((r,n,i)=>{if(void 0===t[n]||"symbol"==typeof t[n])return r;return r+(0===r.length?"":",")+e(n)+":"+e(t[n])}),"")+"}"},ed=tl,td=Zs,rd=hl,{handleEvent:nd}=Ec,{RDF_FIRST:id,RDF_REST:od,RDF_NIL:ad,RDF_TYPE:sd,RDF_JSON_LITERAL:ld,RDF_LANGSTRING:cd,XSD_BOOLEAN:ud,XSD_DOUBLE:dd,XSD_INTEGER:hd,XSD_STRING:fd}=vl,{isAbsolute:pd}=El,md={};var yd=md;function gd(e,t,r,n,i){const o=Object.keys(t).sort();for(const a of o){const o=t[a],s=Object.keys(o).sort();for(let t of s){const s=o[t];if("@type"===t)t=sd;else if(Zu(t))continue;for(const o of s){const s={termType:a.startsWith("_:")?"BlankNode":"NamedNode",value:a};if(!pd(a)){i.eventHandler&&nd({event:{type:["JsonLdEvent"],code:"relative subject reference",level:"warning",message:"Relative subject reference found.",details:{subject:a}},options:i});continue}const l={termType:t.startsWith("_:")?"BlankNode":"NamedNode",value:t};if(!pd(t)){i.eventHandler&&nd({event:{type:["JsonLdEvent"],code:"relative predicate reference",level:"warning",message:"Relative predicate reference found.",details:{predicate:t}},options:i});continue}if("BlankNode"===l.termType&&!i.produceGeneralizedRdf){i.eventHandler&&nd({event:{type:["JsonLdEvent"],code:"blank node predicate",level:"warning",message:"Dropping blank node predicate.",details:{property:n.getOldIds().find((e=>n.getId(e)===t))}},options:i});continue}const c=vd(o,n,e,r,i.rdfDirection,i);c&&e.push({subject:s,predicate:l,object:c,graph:r})}}}}function vd(e,t,r,n,i,o){const a={};if(Ku.isValue(e)){a.termType="Literal",a.value=void 0,a.datatype={termType:"NamedNode"};let t=e["@value"];const r=e["@type"]||null;if("@json"===r)a.value=Xu(t),a.datatype.value=ld;else if(td.isBoolean(t))a.value=t.toString(),a.datatype.value=r||ud;else if(td.isDouble(t)||r===dd)td.isDouble(t)||(t=parseFloat(t)),a.value=t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),a.datatype.value=r||dd;else if(td.isNumber(t))a.value=t.toFixed(0),a.datatype.value=r||hd;else if("@direction"in e&&"i18n-datatype"===i){const r=`https://www.w3.org/ns/i18n#${(e["@language"]||"").toLowerCase()}_${e["@direction"]}`;a.datatype.value=r,a.value=t}else{if("@direction"in e&&"compound-literal"===i)throw new ed("Unsupported rdfDirection value.","jsonld.InvalidRdfDirection",{value:i});if("@direction"in e&&i)throw new ed("Unknown rdfDirection value.","jsonld.InvalidRdfDirection",{value:i});"@language"in e?("@direction"in e&&!i&&o.eventHandler&&nd({event:{type:["JsonLdEvent"],code:"rdfDirection not set",level:"warning",message:"rdfDirection not set for @direction.",details:{object:a.value}},options:o}),a.value=t,a.datatype.value=r||cd,a.language=e["@language"]):("@direction"in e&&!i&&o.eventHandler&&nd({event:{type:["JsonLdEvent"],code:"rdfDirection not set",level:"warning",message:"rdfDirection not set for @direction.",details:{object:a.value}},options:o}),a.value=t,a.datatype.value=r||fd)}}else if(Ku.isList(e)){const s=function(e,t,r,n,i,o){const a={termType:"NamedNode",value:id},s={termType:"NamedNode",value:od},l={termType:"NamedNode",value:ad},c=e.pop(),u=c?{termType:"BlankNode",value:t.getId()}:l;let d=u;for(const l of e){const e=vd(l,t,r,n,i,o),c={termType:"BlankNode",value:t.getId()};r.push({subject:d,predicate:a,object:e,graph:n}),r.push({subject:d,predicate:s,object:c,graph:n}),d=c}if(c){const e=vd(c,t,r,n,i,o);r.push({subject:d,predicate:a,object:e,graph:n}),r.push({subject:d,predicate:s,object:l,graph:n})}return u}(e["@list"],t,r,n,i,o);a.termType=s.termType,a.value=s.value}else{const t=td.isObject(e)?e["@id"]:e;a.termType=t.startsWith("_:")?"BlankNode":"NamedNode",a.value=t}return"NamedNode"!==a.termType||pd(a.value)?a:(o.eventHandler&&nd({event:{type:["JsonLdEvent"],code:"relative object reference",level:"warning",message:"Relative object reference found.",details:{object:a.value}},options:o}),null)}md.toRDF=(e,t)=>{const r=new rd.IdentifierIssuer("_:b"),n={"@default":{}};Qu(e,n,"@default",r);const i=[],o=Object.keys(n).sort();for(const e of o){let o;if("@default"===e)o={termType:"DefaultGraph",value:""};else{if(!pd(e)){t.eventHandler&&nd({event:{type:["JsonLdEvent"],code:"relative graph reference",level:"warning",message:"Relative graph reference found.",details:{graph:e}},options:t});continue}o=e.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},o.value=e}gd(i,n[e],o,r,t)}return i};const{isKeyword:wd}=Uc,bd=el,_d=Zs,Ed=hl,Td=El,xd=tl,{createNodeMap:Id,mergeNodeMapGraphs:Sd}=Su,Rd={};var kd=Rd;function Dd(e){const t={};for(const r in e)void 0!==e[r]&&(t["@"+r]=[e[r]]);return[t]}function jd(e,t,r){for(let n=r.length-1;n>=0;--n){const i=r[n];if(i.graph===t&&i.subject["@id"]===e["@id"])return!0}return!1}function Nd(e,t,r){const n="@"+r;let i=n in e?e[n][0]:t[r];if("embed"===r)if(!0===i)i="@once";else if(!1===i)i="@never";else if("@always"!==i&&"@never"!==i&&"@link"!==i&&"@first"!==i&&"@last"!==i&&"@once"!==i)throw new xd("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:e});return i}function Od(e){if(!_d.isArray(e)||1!==e.length||!_d.isObject(e[0]))throw new xd("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e});if("@id"in e[0])for(const t of Ed.asArray(e[0]["@id"]))if(!_d.isObject(t)&&!Td.isAbsolute(t)||_d.isString(t)&&0===t.indexOf("_:"))throw new xd("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e});if("@type"in e[0])for(const t of Ed.asArray(e[0]["@type"]))if(!_d.isObject(t)&&!Td.isAbsolute(t)&&"@json"!==t||_d.isString(t)&&0===t.indexOf("_:"))throw new xd("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e})}function Cd(e,t,r,n){let i=!0,o=!1;for(const a in r){let s=!1;const l=Ed.getValues(t,a),c=0===Ed.getValues(r,a).length;if("@id"===a){if(_d.isEmptyObject(r["@id"][0]||{})?s=!0:r["@id"].length>=0&&(s=r["@id"].includes(l[0])),!n.requireAll)return s}else if("@type"===a){if(i=!1,c){if(l.length>0)return!1;s=!0}else if(1===r["@type"].length&&_d.isEmptyObject(r["@type"][0]))s=l.length>0;else for(const e of r["@type"])s=!(!_d.isObject(e)||!("@default"in e))||(s||l.some((t=>t===e)));if(!n.requireAll)return s}else{if(wd(a))continue;{const t=Ed.getValues(r,a)[0];let o=!1;if(t&&(Od([t]),o="@default"in t),i=!1,0===l.length&&o)continue;if(l.length>0&&c)return!1;if(void 0===t){if(l.length>0)return!1;s=!0}else if(bd.isList(t)){const r=t["@list"][0];if(bd.isList(l[0])){const t=l[0]["@list"];bd.isValue(r)?s=t.some((e=>Bd(r,e))):(bd.isSubject(r)||bd.isSubjectReference(r))&&(s=t.some((t=>Pd(e,r,t,n))))}}else s=bd.isValue(t)?l.some((e=>Bd(t,e))):bd.isSubjectReference(t)?l.some((r=>Pd(e,t,r,n))):!!_d.isObject(t)&&l.length>0}}if(!s&&n.requireAll)return!1;o=o||s}return i||o}function Ad(e,t){const r=e.uniqueEmbeds[e.graph],n=r[t],i=n.parent,o=n.property,a={"@id":t};if(_d.isArray(i)){for(let e=0;e<i.length;++e)if(Ed.compareValues(i[e],a)){i[e]=a;break}}else{const e=_d.isArray(i[o]);Ed.removeValue(i,o,a,{propertyIsArray:e}),Ed.addValue(i,o,a,{propertyIsArray:e})}const s=e=>{const t=Object.keys(r);for(const n of t)n in r&&_d.isObject(r[n].parent)&&r[n].parent["@id"]===e&&(delete r[n],s(n))};s(t)}
/**
 * Removes the @preserve keywords from expanded result of framing.
 *
 * @param input the framed, framed output.
 * @param options the framing options used.
 *
 * @return the resulting output.
 */function Md(e,t){if(_d.isArray(e))return e.map((e=>Md(e,t)));if(_d.isObject(e)){
// remove @preserve
if("@preserve"in e)return e["@preserve"][0];if(bd.isValue(e))return e;if(bd.isList(e))return e["@list"]=Md(e["@list"],t),e;if("@id"in e){const r=e["@id"];if(t.link.hasOwnProperty(r)){const n=t.link[r].indexOf(e);if(-1!==n)return t.link[r][n];t.link[r].push(e)}else t.link[r]=[e]}for(const r in e)"@id"===r&&t.bnodesToClear.includes(e[r])?delete e["@id"]:e[r]=Md(e[r],t)}return e}function Ld(e,t,r){_d.isObject(e)?Ed.addValue(e,t,r,{propertyIsArray:!0}):e.push(r)}function Pd(e,t,r,n){if(!("@id"in r))return!1;const i=e.subjects[r["@id"]];return i&&Cd(e,i,t,n)}function Bd(e,t){const r=t["@value"],n=t["@type"],i=t["@language"],o=e["@value"]?_d.isArray(e["@value"])?e["@value"]:[e["@value"]]:[],a=e["@type"]?_d.isArray(e["@type"])?e["@type"]:[e["@type"]]:[],s=e["@language"]?_d.isArray(e["@language"])?e["@language"]:[e["@language"]]:[];return 0===o.length&&0===a.length&&0===s.length||!(!o.includes(r)&&!_d.isEmptyObject(o[0]))&&(!!(!n&&0===a.length||a.includes(n)||n&&_d.isEmptyObject(a[0]))&&!!(!i&&0===s.length||s.includes(i)||i&&_d.isEmptyObject(s[0])))}Rd.frameMergedOrDefault=(e,t,r)=>{const n={options:r,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},i=new Ed.IdentifierIssuer("_:b");Id(e,n.graphMap,"@default",i),r.merged&&(n.graphMap["@merged"]=Sd(n.graphMap),n.graph="@merged"),n.subjects=n.graphMap[n.graph];const o=[];return Rd.frame(n,Object.keys(n.subjects).sort(),t,o),r.pruneBlankNodeIdentifiers&&(r.bnodesToClear=Object.keys(n.bnodeMap).filter((e=>1===n.bnodeMap[e].length))),
// remove @preserve from results
r.link={},Md(o,r)},Rd.frame=(e,t,r,n,i=null)=>{Od(r),r=r[0];const o=e.options,a={embed:Nd(r,o,"embed"),explicit:Nd(r,o,"explicit"),requireAll:Nd(r,o,"requireAll")};e.link.hasOwnProperty(e.graph)||(e.link[e.graph]={});const s=e.link[e.graph],l=function(e,t,r,n){const i={};for(const o of t){const t=e.graphMap[e.graph][o];Cd(e,t,r,n)&&(i[o]=t)}return i}(e,t,r,a),c=Object.keys(l).sort();for(const u of c){const c=l[u];if(null===i?e.uniqueEmbeds={[e.graph]:{}}:e.uniqueEmbeds[e.graph]=e.uniqueEmbeds[e.graph]||{},"@link"===a.embed&&u in s){Ld(n,i,s[u]);continue}const d={"@id":u};if(0===u.indexOf("_:")&&Ed.addValue(e.bnodeMap,u,d,{propertyIsArray:!0}),s[u]=d,("@first"===a.embed||"@last"===a.embed)&&e.is11)throw new xd("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:r});if(e.embedded||!e.uniqueEmbeds[e.graph].hasOwnProperty(u))if(!e.embedded||"@never"!==a.embed&&!jd(c,e.graph,e.subjectStack))if(!e.embedded||"@first"!=a.embed&&"@once"!=a.embed||!e.uniqueEmbeds[e.graph].hasOwnProperty(u)){if("@last"===a.embed&&u in e.uniqueEmbeds[e.graph]&&Ad(e,u),e.uniqueEmbeds[e.graph][u]={parent:n,property:i},e.subjectStack.push({subject:c,graph:e.graph}),u in e.graphMap){let t=!1,n=null;"@graph"in r?(n=r["@graph"][0],t=!("@merged"===u||"@default"===u),_d.isObject(n)||(n={})):(t="@merged"!==e.graph,n={}),t&&Rd.frame({...e,graph:u,embedded:!1},Object.keys(e.graphMap[u]).sort(),[n],d,"@graph")}"@included"in r&&Rd.frame({...e,embedded:!1},t,r["@included"],d,"@included");for(const t of Object.keys(c).sort())if(wd(t)){if(d[t]=Ed.clone(c[t]),"@type"===t)for(const t of c["@type"])0===t.indexOf("_:")&&Ed.addValue(e.bnodeMap,t,d,{propertyIsArray:!0})}else if(!a.explicit||t in r)for(const n of c[t]){const i=t in r?r[t]:Dd(a);if(bd.isList(n)){const i=r[t]&&r[t][0]&&r[t][0]["@list"]?r[t][0]["@list"]:Dd(a),o={"@list":[]};Ld(d,t,o);const s=n["@list"];for(const t of s)bd.isSubjectReference(t)?Rd.frame({...e,embedded:!0},[t["@id"]],i,o,"@list"):Ld(o,"@list",Ed.clone(t))}else bd.isSubjectReference(n)?Rd.frame({...e,embedded:!0},[n["@id"]],i,d,t):Bd(i[0],n)&&Ld(d,t,Ed.clone(n))}for(const e of Object.keys(r).sort()){if("@type"===e){if(!_d.isObject(r[e][0])||!("@default"in r[e][0]))continue}else if(wd(e))continue;const t=r[e][0]||{};if(!Nd(t,o,"omitDefault")&&!(e in d)){let r="@null";"@default"in t&&(r=Ed.clone(t["@default"])),_d.isArray(r)||(r=[r]),d[e]=[{"@preserve":r}]}}for(const t of Object.keys(r["@reverse"]||{}).sort()){const n=r["@reverse"][t];for(const r of Object.keys(e.subjects)){Ed.getValues(e.subjects[r],t).some((e=>e["@id"]===u))&&(d["@reverse"]=d["@reverse"]||{},Ed.addValue(d["@reverse"],t,[],{propertyIsArray:!0}),Rd.frame({...e,embedded:!0},[r],n,d["@reverse"][t],i))}}Ld(n,i,d),e.subjectStack.pop()}else Ld(n,i,d);else Ld(n,i,d)}},Rd.cleanupNull=(e,t)=>{if(_d.isArray(e)){const r=e.map((e=>Rd.cleanupNull(e,t)));return r.filter((e=>e))}if("@null"===e)return null;if(_d.isObject(e)){if("@id"in e){const r=e["@id"];if(t.link.hasOwnProperty(r)){const n=t.link[r].indexOf(e);if(-1!==n)return t.link[r][n];t.link[r].push(e)}else t.link[r]=[e]}for(const r in e)e[r]=Rd.cleanupNull(e[r],t)}return e};const $d=tl,{isArray:Fd,isObject:Ud,isString:qd,isUndefined:Yd}=Zs,{isList:Wd,isValue:zd,isGraph:Gd,isSimpleGraph:Jd,isSubjectReference:Hd}=el,{expandIri:Vd,getContextValue:Qd,isKeyword:Zd,process:Kd,processingMode:Xd}=Uc,{removeBase:eh,prependBase:th}=El,{REGEX_KEYWORD:rh,addValue:nh,asArray:ih,compareShortestLeast:oh}=hl,ah={};var sh,lh,ch=ah;function uh(e,t,r){if("@nest"!==Vd(e,t,{vocab:!0},r))throw new $d("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}ah.compact=async({activeCtx:e,activeProperty:t=null,element:r,options:n={}})=>{if(Fd(r)){let i=[];for(let o=0;o<r.length;++o){const a=await ah.compact({activeCtx:e,activeProperty:t,element:r[o],options:n});null!==a&&i.push(a)}if(n.compactArrays&&1===i.length){0===(Qd(e,t,"@container")||[]).length&&(i=i[0])}return i}const i=Qd(e,t,"@context");if(Yd(i)||(e=await Kd({activeCtx:e,localCtx:i,propagate:!0,overrideProtected:!0,options:n})),Ud(r)){if(n.link&&"@id"in r&&n.link.hasOwnProperty(r["@id"])){const e=n.link[r["@id"]];for(let t=0;t<e.length;++t)if(e[t].expanded===r)return e[t].compacted}if(zd(r)||Hd(r)){const i=ah.compactValue({activeCtx:e,activeProperty:t,value:r,options:n});return n.link&&Hd(r)&&(n.link.hasOwnProperty(r["@id"])||(n.link[r["@id"]]=[]),n.link[r["@id"]].push({expanded:r,compacted:i})),i}if(Wd(r)){if((Qd(e,t,"@container")||[]).includes("@list"))return ah.compact({activeCtx:e,activeProperty:t,element:r["@list"],options:n})}const i="@reverse"===t,o={},a=e;zd(r)||Hd(r)||(e=e.revertToPreviousContext());const s=Qd(a,t,"@context");Yd(s)||(e=await Kd({activeCtx:e,localCtx:s,propagate:!0,overrideProtected:!0,options:n})),n.link&&"@id"in r&&(n.link.hasOwnProperty(r["@id"])||(n.link[r["@id"]]=[]),n.link[r["@id"]].push({expanded:r,compacted:o}));let l=r["@type"]||[];l.length>1&&(l=Array.from(l).sort());const c=e;for(const t of l){const r=ah.compactIri({activeCtx:c,iri:t,relativeTo:{vocab:!0}}),i=Qd(a,r,"@context");Yd(i)||(e=await Kd({activeCtx:e,localCtx:i,options:n,propagate:!1}))}const u=Object.keys(r).sort();for(const s of u){const l=r[s];if("@id"!==s)if("@type"!==s)if("@reverse"!==s)if("@preserve"!==s)if("@index"!==s)if("@graph"!==s&&"@list"!==s&&"@included"!==s&&Zd(s)){const t=ah.compactIri({activeCtx:e,iri:s,relativeTo:{vocab:!0}});nh(o,t,l)}else{if(!Fd(l))throw new $d("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===l.length){const t=ah.compactIri({activeCtx:e,iri:s,value:l,relativeTo:{vocab:!0},reverse:i}),r=e.mappings.has(t)?e.mappings.get(t)["@nest"]:null;let a=o;r&&(uh(e,r,n),Ud(o[r])||(o[r]={}),a=o[r]),nh(a,t,l,{propertyIsArray:!0})}for(const t of l){const r=ah.compactIri({activeCtx:e,iri:s,value:t,relativeTo:{vocab:!0},reverse:i}),a=e.mappings.has(r)?e.mappings.get(r)["@nest"]:null;let l=o;a&&(uh(e,a,n),Ud(o[a])||(o[a]={}),l=o[a]);const c=Qd(e,r,"@container")||[],u=Gd(t),d=Wd(t);let h;d?h=t["@list"]:u&&(h=t["@graph"]);let f=await ah.compact({activeCtx:e,activeProperty:r,element:d||u?h:t,options:n});if(d){if(Fd(f)||(f=[f]),c.includes("@list")){nh(l,r,f,{valueIsArray:!0,allowDuplicate:!0});continue}f={[ah.compactIri({activeCtx:e,iri:"@list",relativeTo:{vocab:!0}})]:f},"@index"in t&&(f[ah.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"])}if(u)if(c.includes("@graph")&&(c.includes("@id")||c.includes("@index")&&Jd(t))){let i;l.hasOwnProperty(r)?i=l[r]:l[r]=i={};const o=(c.includes("@id")?t["@id"]:t["@index"])||ah.compactIri({activeCtx:e,iri:"@none",relativeTo:{vocab:!0}});nh(i,o,f,{propertyIsArray:!n.compactArrays||c.includes("@set")})}else c.includes("@graph")&&Jd(t)?(Fd(f)&&f.length>1&&(f={"@included":f}),nh(l,r,f,{propertyIsArray:!n.compactArrays||c.includes("@set")})):(Fd(f)&&1===f.length&&n.compactArrays&&(f=f[0]),f={[ah.compactIri({activeCtx:e,iri:"@graph",relativeTo:{vocab:!0}})]:f},"@id"in t&&(f[ah.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]=t["@id"]),"@index"in t&&(f[ah.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=t["@index"]),nh(l,r,f,{propertyIsArray:!n.compactArrays||c.includes("@set")}));else if(c.includes("@language")||c.includes("@index")||c.includes("@id")||c.includes("@type")){let i,o;if(l.hasOwnProperty(r)?i=l[r]:l[r]=i={},c.includes("@language"))zd(f)&&(f=f["@value"]),o=t["@language"];else if(c.includes("@index")){const n=Qd(e,r,"@index")||"@index",i=ah.compactIri({activeCtx:e,iri:n,relativeTo:{vocab:!0}});if("@index"===n)o=t["@index"],delete f[i];else{let e;if([o,...e]=ih(f[n]||[]),qd(o))switch(e.length){case 0:delete f[n];break;case 1:f[n]=e[0];break;default:f[n]=e}else o=null}}else if(c.includes("@id")){const t=ah.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}});o=f[t],delete f[t]}else if(c.includes("@type")){const i=ah.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}});let a;switch([o,...a]=ih(f[i]||[]),a.length){case 0:delete f[i];break;case 1:f[i]=a[0];break;default:f[i]=a}1===Object.keys(f).length&&"@id"in t&&(f=await ah.compact({activeCtx:e,activeProperty:r,element:{"@id":t["@id"]},options:n}))}o||(o=ah.compactIri({activeCtx:e,iri:"@none",relativeTo:{vocab:!0}})),nh(i,o,f,{propertyIsArray:c.includes("@set")})}else{const e=!n.compactArrays||c.includes("@set")||c.includes("@list")||Fd(f)&&0===f.length||"@list"===s||"@graph"===s;nh(l,r,f,{propertyIsArray:e})}}}else{if((Qd(e,t,"@container")||[]).includes("@index"))continue;const r=ah.compactIri({activeCtx:e,iri:s,relativeTo:{vocab:!0}});nh(o,r,l)}else{const r=await ah.compact({activeCtx:e,activeProperty:t,element:l,options:n});Fd(r)&&0===r.length||nh(o,s,r)}else{const t=await ah.compact({activeCtx:e,activeProperty:"@reverse",element:l,options:n});for(const r in t)if(e.mappings.has(r)&&e.mappings.get(r).reverse){const i=t[r],a=(Qd(e,r,"@container")||[]).includes("@set")||!n.compactArrays;nh(o,r,i,{propertyIsArray:a}),delete t[r]}if(Object.keys(t).length>0){const r=ah.compactIri({activeCtx:e,iri:s,relativeTo:{vocab:!0}});nh(o,r,t)}}else{let t=ih(l).map((e=>ah.compactIri({activeCtx:a,iri:e,relativeTo:{vocab:!0}})));1===t.length&&(t=t[0]);const r=ah.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}}),n=(Qd(e,r,"@container")||[]).includes("@set")&&Xd(e,1.1)||Fd(t)&&0===l.length;nh(o,r,t,{propertyIsArray:n})}else{let t=ih(l).map((t=>ah.compactIri({activeCtx:e,iri:t,relativeTo:{vocab:!1},base:n.base})));1===t.length&&(t=t[0]);o[ah.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]=t}}return o}return r},ah.compactIri=({activeCtx:e,iri:t,value:r=null,relativeTo:n={vocab:!1},reverse:i=!1,base:o=null})=>{if(null===t)return t;e.isPropertyTermScoped&&e.previousContext&&(e=e.previousContext);const a=e.getInverse();if(Zd(t)&&t in a&&"@none"in a[t]&&"@type"in a[t]["@none"]&&"@none"in a[t]["@none"]["@type"])return a[t]["@none"]["@type"]["@none"];if(n.vocab&&t in a){const n=e["@language"]||"@none",o=[];Ud(r)&&"@index"in r&&!("@graph"in r)&&o.push("@index","@index@set"),Ud(r)&&"@preserve"in r&&(r=r["@preserve"][0]),Gd(r)?("@index"in r&&o.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in r&&o.push("@graph@id","@graph@id@set"),o.push("@graph","@graph@set","@set"),"@index"in r||o.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in r||o.push("@graph@id","@graph@id@set")):Ud(r)&&!zd(r)&&o.push("@id","@id@set","@type","@set@type");let a="@language",s="@null";if(i)a="@type",s="@reverse",o.push("@set");else if(Wd(r)){"@index"in r||o.push("@list");const e=r["@list"];if(0===e.length)a="@any",s="@none";else{let t=0===e.length?n:null,r=null;for(let n=0;n<e.length;++n){const i=e[n];let o="@none",a="@none";if(zd(i))if("@direction"in i){o=`${(i["@language"]||"").toLowerCase()}_${i["@direction"]}`}else"@language"in i?o=i["@language"].toLowerCase():"@type"in i?a=i["@type"]:o="@null";else a="@id";if(null===t?t=o:o!==t&&zd(i)&&(t="@none"),null===r?r=a:a!==r&&(r="@none"),"@none"===t&&"@none"===r)break}t=t||"@none",r=r||"@none","@none"!==r?(a="@type",s=r):s=t}}else{if(zd(r))if("@language"in r&&!("@index"in r)){o.push("@language","@language@set"),s=r["@language"];const e=r["@direction"];e&&(s=`${s}_${e}`)}else"@direction"in r&&!("@index"in r)?s=`_${r["@direction"]}`:"@type"in r&&(a="@type",s=r["@type"]);else a="@type",s="@id";o.push("@set")}o.push("@none"),Ud(r)&&!("@index"in r)&&o.push("@index","@index@set"),zd(r)&&1===Object.keys(r).length&&o.push("@language","@language@set");const l=function(e,t,r,n,i,o){null===o&&(o="@null");const a=[];if(("@id"===o||"@reverse"===o)&&Ud(r)&&"@id"in r){"@reverse"===o&&a.push("@reverse");const t=ah.compactIri({activeCtx:e,iri:r["@id"],relativeTo:{vocab:!0}});e.mappings.has(t)&&e.mappings.get(t)&&e.mappings.get(t)["@id"]===r["@id"]?a.push.apply(a,["@vocab","@id"]):a.push.apply(a,["@id","@vocab"])}else{a.push(o);const e=a.find((e=>e.includes("_")));e&&a.push(e.replace(/^[^_]+_/,"_"))}a.push("@none");const s=e.inverse[t];for(const e of n){if(!(e in s))continue;const t=s[e][i];for(const e of a)if(e in t)return t[e]}return null}(e,t,r,o,a,s);if(null!==l)return l}if(n.vocab&&"@vocab"in e){const r=e["@vocab"];if(0===t.indexOf(r)&&t!==r){const n=t.substr(r.length);if(!e.mappings.has(n))return n}}let s=null;const l=[];let c=e.fastCurieMap;const u=t.length-1;for(let e=0;e<u&&t[e]in c;++e)c=c[t[e]],""in c&&l.push(c[""][0]);for(let n=l.length-1;n>=0;--n){const i=l[n],o=i.terms;for(const n of o){const o=n+":"+t.substr(i.iri.length);e.mappings.get(n)._prefix&&(!e.mappings.has(o)||null===r&&e.mappings.get(o)["@id"]===t)&&(null===s||oh(o,s)<0)&&(s=o)}}if(null!==s)return s;for(const[r,n]of e.mappings)if(n&&n._prefix&&t.startsWith(r+":"))throw new $d(`Absolute IRI "${t}" confused with prefix "${r}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:e});if(!n.vocab){if("@base"in e){if(e["@base"]){const r=eh(th(o,e["@base"]),t);return rh.test(r)?`./${r}`:r}return t}return eh(o,t)}return t},ah.compactValue=({activeCtx:e,activeProperty:t,value:r,options:n})=>{if(zd(r)){const n=Qd(e,t,"@type"),i=Qd(e,t,"@language"),o=Qd(e,t,"@direction"),a=Qd(e,t,"@container")||[],s="@index"in r&&!a.includes("@index");if(!s&&"@none"!==n){if(r["@type"]===n)return r["@value"];if("@language"in r&&r["@language"]===i&&"@direction"in r&&r["@direction"]===o)return r["@value"];if("@language"in r&&r["@language"]===i)return r["@value"];if("@direction"in r&&r["@direction"]===o)return r["@value"]}const l=Object.keys(r).length,c=1===l||2===l&&"@index"in r&&!s,u="@language"in e,d=qd(r["@value"]),h=e.mappings.has(t)&&null===e.mappings.get(t)["@language"];if(c&&"@none"!==n&&(!u||!d||h))return r["@value"];const f={};return s&&(f[ah.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=r["@index"]),"@type"in r?f[ah.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}})]=ah.compactIri({activeCtx:e,iri:r["@type"],relativeTo:{vocab:!0}}):"@language"in r&&(f[ah.compactIri({activeCtx:e,iri:"@language",relativeTo:{vocab:!0}})]=r["@language"]),"@direction"in r&&(f[ah.compactIri({activeCtx:e,iri:"@direction",relativeTo:{vocab:!0}})]=r["@direction"]),f[ah.compactIri({activeCtx:e,iri:"@value",relativeTo:{vocab:!0}})]=r["@value"],f}const i=Vd(e,t,{vocab:!0},n),o=Qd(e,t,"@type"),a=ah.compactIri({activeCtx:e,iri:r["@id"],relativeTo:{vocab:"@vocab"===o},base:n.base});return"@id"===o||"@vocab"===o||"@graph"===i?a:{[ah.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]:a}};
/**
 * A JavaScript implementation of the JSON-LD API.
 *
 * @author Dave Longley
 *
 * @license BSD 3-Clause License
 * Copyright (c) 2011-2022 Digital Bazaar, Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 *
 * Redistributions in binary form must reproduce the above copyright
 * notice, this list of conditions and the following disclaimer in the
 * documentation and/or other materials provided with the distribution.
 *
 * Neither the name of the Digital Bazaar, Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
 * IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
 * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
 * PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
 * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
const dh=Vs,hh=Ml,fh=hl,ph=class{constructor({sharedCache:e}){this.perOpCache=new Map,this.sharedCache=e}async resolve({activeCtx:e,context:t,documentLoader:r,base:n,cycles:i=new Set}){t&&cc(t)&&t["@context"]&&(t=t["@context"]),t=dc(t);const o=[];for(const a of t){if(uc(a)){let t=this._get(a);t||(t=await this._resolveRemoteContext({activeCtx:e,url:a,documentLoader:r,base:n,cycles:i})),lc(t)?o.push(...t):o.push(t);continue}if(null===a){o.push(new pc({document:null}));continue}cc(a)||mc(t);const s=JSON.stringify(a);let l=this._get(s);l||(l=new pc({document:a}),this._cacheResolvedContext({key:s,resolved:l,tag:"static"})),o.push(l)}return o}_get(e){let t=this.perOpCache.get(e);if(!t){const r=this.sharedCache.get(e);r&&(t=r.get("static"),t&&this.perOpCache.set(e,t))}return t}_cacheResolvedContext({key:e,resolved:t,tag:r}){if(this.perOpCache.set(e,t),void 0!==r){let n=this.sharedCache.get(e);n||(n=new Map,this.sharedCache.set(e,n)),n.set(r,t)}return t}async _resolveRemoteContext({activeCtx:e,url:t,documentLoader:r,base:n,cycles:i}){t=hc(n,t);const{context:o,remoteDoc:a}=await this._fetchContext({activeCtx:e,url:t,documentLoader:r,cycles:i});yc({context:o,base:n=a.documentUrl||t});const s=await this.resolve({activeCtx:e,context:o,documentLoader:r,base:n,cycles:i});return this._cacheResolvedContext({key:t,resolved:s,tag:a.tag}),s}async _fetchContext({activeCtx:e,url:t,documentLoader:r,cycles:n}){if(n.size>10)throw new fc("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===e.processingMode?"loading remote context failed":"context overflow",max:10});if(n.has(t))throw new fc("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===e.processingMode?"recursive context inclusion":"context overflow",url:t});let i,o;n.add(t);try{o=await r(t),i=o.document||null,uc(i)&&(i=JSON.parse(i))}catch(e){throw new fc("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:t,cause:e})}if(!cc(i))throw new fc("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:t});return i="@context"in i?{"@context":i["@context"]}:{"@context":{}},o.contextUrl&&(lc(i["@context"])||(i["@context"]=[i["@context"]]),i["@context"].push(o.contextUrl)),{context:i,remoteDoc:o}}},mh=fh.IdentifierIssuer,yh=tl,gh=ac,vh=gc,{expand:wh}=pu,{flatten:bh}=ju,{fromRDF:_h}=Hu,{toRDF:Eh}=yd,{frameMergedOrDefault:Th,cleanupNull:xh}=kd,{isArray:Ih,isObject:Sh,isString:Rh}=Zs,{isSubjectReference:kh}=el,{expandIri:Dh,getInitialContext:jh,process:Nh,processingMode:Oh}=Uc,{compact:Ch,compactIri:Ah}=ch,{createNodeMap:Mh,createMergedNodeMap:Lh,mergeNodeMaps:Ph}=Su,{logEventHandler:Bh,logWarningEventHandler:$h,safeEventHandler:Fh,setDefaultEventHandler:Uh,setupEventHandler:qh,strictEventHandler:Yh,unhandledEventHandler:Wh}=Ec,zh=function(e){const t={},r=new gh({max:100});function n(t,{documentLoader:r=e.documentLoader,...n}){if(t&&"compactionMap"in t)throw new yh('"compactionMap" not supported.',"jsonld.OptionsError");if(t&&"expansionMap"in t)throw new yh('"expansionMap" not supported.',"jsonld.OptionsError");return Object.assign({},{documentLoader:r},n,t,{eventHandler:qh({options:t})})}return e.compact=async function(t,i,o){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===i)throw new yh("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===t)return null;let a;(o=n(o,{base:Rh(t)?t:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new mh("_:b"),contextResolver:new ph({sharedCache:r})})).link&&(o.skipExpansion=!0),o.compactToRelative||delete o.base,a=o.skipExpansion?t:await e.expand(t,o);const s=await e.processContext(jh(o),i,o);let l=await Ch({activeCtx:s,element:a,options:o});o.compactArrays&&!o.graph&&Ih(l)?1===l.length?l=l[0]:0===l.length&&(l={}):o.graph&&Sh(l)&&(l=[l]),Sh(i)&&"@context"in i&&(i=i["@context"]),i=fh.clone(i),Ih(i)||(i=[i]);const c=i;i=[];for(let e=0;e<c.length;++e)(!Sh(c[e])||Object.keys(c[e]).length>0)&&i.push(c[e]);const u=i.length>0;if(1===i.length&&(i=i[0]),Ih(l)){const e=Ah({activeCtx:s,iri:"@graph",relativeTo:{vocab:!0}}),t=l;l={},u&&(l["@context"]=i),l[e]=t}else if(Sh(l)&&u){const e=l;l={"@context":i};for(const t in e)l[t]=e[t]}return l},e.expand=async function(t,i){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");const o={},a=[];if("expandContext"in(i=n(i,{keepFreeFloatingNodes:!1,contextResolver:new ph({sharedCache:r})}))){const e=fh.clone(i.expandContext);Sh(e)&&"@context"in e?o.expandContext=e:o.expandContext={"@context":e},a.push(o.expandContext)}let s;if(Rh(t)){const r=await e.get(t,i);s=r.documentUrl,o.input=r.document,r.contextUrl&&(o.remoteContext={"@context":r.contextUrl},a.push(o.remoteContext))}else o.input=fh.clone(t);"base"in i||(i.base=s||"");let l=jh(i);for(const e of a)l=await Nh({activeCtx:l,localCtx:e,options:i});let c=await wh({activeCtx:l,element:o.input,options:i});return Sh(c)&&"@graph"in c&&1===Object.keys(c).length?c=c["@graph"]:null===c&&(c=[]),Ih(c)||(c=[c]),c},e.flatten=async function(t,i,o){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");i="function"==typeof i?null:i||null,o=n(o,{base:Rh(t)?t:"",contextResolver:new ph({sharedCache:r})});const a=await e.expand(t,o),s=bh(a);if(null===i)return s;o.graph=!0,o.skipExpansion=!0;return await e.compact(s,i,o)},e.frame=async function(t,i,o){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(o=n(o,{base:Rh(t)?t:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new ph({sharedCache:r})}),Rh(i)){const t=await e.get(i,o);if(i=t.document,t.contextUrl){let e=i["@context"];e?Ih(e)?e.push(t.contextUrl):e=[e,t.contextUrl]:e=t.contextUrl,i["@context"]=e}}const a=i&&i["@context"]||{},s=await e.processContext(jh(o),a,o);o.hasOwnProperty("omitGraph")||(o.omitGraph=Oh(s,1.1)),o.hasOwnProperty("pruneBlankNodeIdentifiers")||(o.pruneBlankNodeIdentifiers=Oh(s,1.1));const l=await e.expand(t,o),c={...o};c.isFrame=!0,c.keepFreeFloatingNodes=!0;const u=await e.expand(i,c),d=Object.keys(i).map((e=>Dh(s,e,{vocab:!0})));c.merged=!d.includes("@graph"),c.is11=Oh(s,1.1);const h=Th(l,u,c);c.graph=!o.omitGraph,c.skipExpansion=!0,c.link={},c.framing=!0;let f=await e.compact(h,a,c);return c.link={},f=xh(f,c),f},e.link=async function(t,r,n){const i={};return r&&(i["@context"]=r),i["@embed"]="@link",e.frame(t,i,n)},e.normalize=e.canonize=async function(t,i){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(i=n(i,{base:Rh(t)?t:null,algorithm:"URDNA2015",skipExpansion:!1,safe:!0,contextResolver:new ph({sharedCache:r})}))){if("application/n-quads"!==i.inputFormat&&"application/nquads"!==i.inputFormat)throw new yh("Unknown canonicalization input format.","jsonld.CanonizeError");const e=vh.parse(t);return dh.canonize(e,i)}const o={...i};delete o.format,o.produceGeneralizedRdf=!1;const a=await e.toRDF(t,o);return dh.canonize(a,i)},e.fromRDF=async function(e,r){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");r=n(r,{format:Rh(e)?"application/n-quads":void 0});const{format:i}=r;let{rdfParser:o}=r;if(i){if(o=o||t[i],!o)throw new yh("Unknown input format.","jsonld.UnknownFormat",{format:i})}else o=()=>e;const a=await o(e);return _h(a,r)},e.toRDF=async function(t,i){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let o;o=(i=n(i,{base:Rh(t)?t:"",skipExpansion:!1,contextResolver:new ph({sharedCache:r})})).skipExpansion?t:await e.expand(t,i);const a=Eh(o,i);if(i.format){if("application/n-quads"===i.format||"application/nquads"===i.format)return vh.serialize(a);throw new yh("Unknown output format.","jsonld.UnknownFormat",{format:i.format})}return a},e.createNodeMap=async function(t,i){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");i=n(i,{base:Rh(t)?t:"",contextResolver:new ph({sharedCache:r})});const o=await e.expand(t,i);return Lh(o,i)},e.merge=async function(t,i,o){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!Ih(t))throw new TypeError('Could not merge, "docs" must be an array.');i="function"==typeof i?null:i||null,o=n(o,{contextResolver:new ph({sharedCache:r})});const a=await Promise.all(t.map((t=>{const r={...o};return e.expand(t,r)})));let s=!0;"mergeNodes"in o&&(s=o.mergeNodes);const l=o.issuer||new mh("_:b"),c={"@default":{}};for(let e=0;e<a.length;++e){const t=fh.relabelBlankNodes(a[e],{issuer:new mh("_:b"+e+"-")}),r=s||0===e?c:{"@default":{}};if(Mh(t,r,"@default",l),r!==c)for(const e in r){const t=r[e];if(!(e in c)){c[e]=t;continue}const n=c[e];for(const e in t)e in n||(n[e]=t[e])}}const u=Ph(c),d=[],h=Object.keys(u).sort();for(let e=0;e<h.length;++e){const t=u[h[e]];kh(t)||d.push(t)}if(null===i)return d;o.graph=!0,o.skipExpansion=!0;return await e.compact(d,i,o)},Object.defineProperty(e,"documentLoader",{get:()=>e._documentLoader,set:t=>e._documentLoader=t}),e.documentLoader=async e=>{throw new yh("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:e})},e.get=async function(t,r){let n;n="function"==typeof r.documentLoader?r.documentLoader:e.documentLoader;const i=await n(t);try{if(!i.document)throw new yh("No remote document found at the given URL.","jsonld.NullRemoteDocument");Rh(i.document)&&(i.document=JSON.parse(i.document))}catch(e){throw new yh("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:i})}return i},e.processContext=async function(e,t,i){return i=n(i,{base:"",contextResolver:new ph({sharedCache:r})}),null===t?jh(i):(t=fh.clone(t),Sh(t)&&"@context"in t||(t={"@context":t}),Nh({activeCtx:e,localCtx:t,options:i}))},e.getContextValue=Uc.getContextValue,e.documentLoaders={},e.useDocumentLoader=function(t){if(!(t in e.documentLoaders))throw new yh('Unknown document loader type: "'+t+'"',"jsonld.UnknownDocumentLoader",{type:t});e.documentLoader=e.documentLoaders[t].apply(e,Array.prototype.slice.call(arguments,1))},e.registerRDFParser=function(e,r){t[e]=r},e.unregisterRDFParser=function(e){delete t[e]},e.registerRDFParser("application/n-quads",vh.parse),e.registerRDFParser("application/nquads",vh.parse),e.url=El,e.logEventHandler=Bh,e.logWarningEventHandler=$h,e.safeEventHandler=Fh,e.setDefaultEventHandler=Uh,e.strictEventHandler=Yh,e.unhandledEventHandler=Wh,e.util=fh,Object.assign(e,fh),e.promises=e,e.RequestQueue=wl(),e.JsonLdProcessor=(lh||(lh=1,sh=e=>{class t{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(t,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(t.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:t}),t.compact=function(t,r){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):e.compact(t,r)},t.expand=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):e.expand(t)},t.flatten=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):e.flatten(t)},t}),sh)(e),hh.setupGlobals(e),hh.setupDocumentLoaders(e),e},Gh=function(){return zh((function(){return Gh()}))};zh(Gh);var Jh=Gh;function Hh(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Vh={exports:{}};Vh.exports=function(){function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){if(!s&&Hh)return Hh(a);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[a]={exports:{}};t[a][0].call(c.exports,(function(e){return i(t[a][1][e]||e)}),c,c.exports,e,t,r,n)}return r[a].exports}for(var o=Hh,a=0;a<n.length;a++)i(n[a]);return i}return e}()({1:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;const n="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i="http://www.w3.org/2001/XMLSchema#",o="http://www.w3.org/2000/10/swap/";var a={xsd:{decimal:`${i}decimal`,boolean:`${i}boolean`,double:`${i}double`,integer:`${i}integer`,string:`${i}string`},rdf:{type:`${n}type`,nil:`${n}nil`,first:`${n}first`,rest:`${n}rest`,langString:`${n}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${o}reify#forSome`,forAll:`${o}reify#forAll`},log:{implies:`${o}log#implies`}};r.default=a},{}],2:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.Variable=r.Triple=r.Term=r.Quad=r.NamedNode=r.Literal=r.DefaultGraph=r.BlankNode=void 0,r.escapeQuotes=T,r.termFromId=b,r.termToId=_,r.unescapeQuotes=x;var n=o(e("./IRIs")),i=e("./N3Util");function o(e){return e&&e.__esModule?e:{default:e}}const{rdf:a,xsd:s}=n.default;let l,c=0;const u=/^"(.*".*)(?="[^"]*$)/,d=/^<<("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ("(?:""|[^"])*"[^ ]*|[^ ]+) ?("(?:""|[^"])*"[^ ]*|[^ ]+)?>>$/,h={namedNode:I,blankNode:S,variable:k,literal:R,defaultGraph:D,quad:j,triple:j};var f=h;r.default=f;class p{constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof p?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}r.Term=p;class m extends p{get termType(){return"NamedNode"}}r.NamedNode=m;class y extends p{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const e=this.id;let t=e.lastIndexOf('"')+1;return t<e.length&&"@"===e[t++]?e.substr(t).toLowerCase():""}get datatype(){return new m(this.datatypeString)}get datatypeString(){const e=this.id,t=e.lastIndexOf('"')+1,r=t<e.length?e[t]:"";return"^"===r?e.substr(t+2):"@"!==r?s.string:a.langString}equals(e){return e instanceof y?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}}r.Literal=y;class g extends p{constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}}r.BlankNode=g;class v extends p{constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}}r.Variable=v;class w extends p{constructor(){return super(""),l||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}}function b(e,t){if(t=t||h,!e)return t.defaultGraph();switch(e[0]){case"?":return t.variable(e.substr(1));case"_":return t.blankNode(e.substr(2));case'"':if(t===h)return new y(e);if('"'===e[e.length-1])return t.literal(e.substr(1,e.length-2));const r=e.lastIndexOf('"',e.length-1);return t.literal(e.substr(1,r-1),"@"===e[r+1]?e.substr(r+2):t.namedNode(e.substr(r+3)));case"<":const n=d.exec(e);return t.quad(b(x(n[1]),t),b(x(n[2]),t),b(x(n[3]),t),n[4]&&b(x(n[4]),t));default:return t.namedNode(e)}}function _(e){if("string"==typeof e)return e;if(e instanceof p&&"Quad"!==e.termType)return e.id;if(!e)return l.id;switch(e.termType){case"NamedNode":return e.value;case"BlankNode":return`_:${e.value}`;case"Variable":return`?${e.value}`;case"DefaultGraph":return"";case"Literal":return`"${e.value}"${e.language?`@${e.language}`:e.datatype&&e.datatype.value!==s.string?`^^${e.datatype.value}`:""}`;case"Quad":return`<<${T(_(e.subject))} ${T(_(e.predicate))} ${T(_(e.object))}${(0,i.isDefaultGraph)(e.graph)?"":` ${_(e.graph)}`}>>`;default:throw new Error(`Unexpected termType: ${e.termType}`)}}r.DefaultGraph=w,l=new w;class E extends p{constructor(e,t,r,n){super(""),this._subject=e,this._predicate=t,this._object=r,this._graph=n||l}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}}function T(e){return e.replace(u,((e,t)=>`"${t.replace(/"/g,'""')}`))}function x(e){return e.replace(u,((e,t)=>`"${t.replace(/""/g,'"')}`))}function I(e){return new m(e)}function S(e){return new g(e||"n3-"+c++)}function R(e,t){if("string"==typeof t)return new y(`"${e}"@${t.toLowerCase()}`);let r=t?t.value:"";return""===r&&("boolean"==typeof e?r=s.boolean:"number"==typeof e&&(Number.isFinite(e)?r=Number.isInteger(e)?s.integer:s.double:(r=s.double,Number.isNaN(e)||(e=e>0?"INF":"-INF")))),""===r||r===s.string?new y(`"${e}"`):new y(`"${e}"^^${r}`)}function k(e){return new v(e)}function D(){return l}function j(e,t,r,n){return new E(e,t,r,n)}r.Triple=r.Quad=E},{"./IRIs":1,"./N3Util":8}],3:[function(e,t,r){(function(t){(function(){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./IRIs")),i=o(e("queue-microtask"));function o(e){return e&&e.__esModule?e:{default:e}}const{xsd:a}=n.default,s=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,l={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},c=/[\x00-\x20<>\\"\{\}\|\^\`]/,u={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},d=/$0^/;class h{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._lineMode=!!e.lineMode){this._n3Mode=!1;for(const e in this)!(e in u)&&this[e]instanceof RegExp&&(this[e]=d)}else this._n3Mode=!1!==e.n3;this._comments=!!e.comments,this._literalClosingPos=0}_tokenizeToEnd(e,t){let r=this._input,n=r.length;for(;;){let e,s;for(;e=this._newline.exec(r);)this._comments&&(s=this._comment.exec(e[0]))&&i("comment",s[1],"",this._line,e[0].length),r=r.substr(e[0].length,r.length),n=r.length,this._line++;if(!e&&(e=this._whitespace.exec(r))&&(r=r.substr(e[0].length,r.length)),this._endOfFile.test(r))return t&&(this._comments&&(s=this._comment.exec(r))&&i("comment",s[1],"",this._line,r.length),r=null,i("eof","","",this._line,0)),this._input=r;const l=this._line,u=r[0];let d="",h="",f="",p=null,m=0,y=!1;switch(u){case"^":if(r.length<3)break;if("^"!==r[1]){this._n3Mode&&(m=1,d="^");break}if(this._previousMarker="^^",r=r.substr(2),"<"!==r[0]){y=!0;break}case"<":if(p=this._unescapedIri.exec(r))d="IRI",h=p[1];else if(p=this._iri.exec(r)){if(h=this._unescape(p[1]),null===h||c.test(h))return o(this);d="IRI"}else r.length>1&&"<"===r[1]?(d="<<",m=2):this._n3Mode&&r.length>1&&"="===r[1]&&(d="inverse",m=2,h=">");break;case">":r.length>1&&">"===r[1]&&(d=">>",m=2);break;case"_":((p=this._blank.exec(r))||t&&(p=this._blank.exec(`${r} `)))&&(d="blank",f="_",h=p[1]);break;case'"':if(p=this._simpleQuotedString.exec(r))h=p[1];else if(({value:h,matchLength:m}=this._parseLiteral(r)),null===h)return o(this);null===p&&0===m||(d="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(p=this._simpleApostropheString.exec(r))h=p[1];else if(({value:h,matchLength:m}=this._parseLiteral(r)),null===h)return o(this);null===p&&0===m||(d="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(p=this._variable.exec(r))&&(d="var",h=p[0]);break;case"@":"literal"===this._previousMarker&&(p=this._langcode.exec(r))?(d="langcode",h=p[1]):(p=this._keyword.exec(r))&&(d=p[0]);break;case".":if(1===r.length?t:r[1]<"0"||r[1]>"9"){d=".",m=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(p=this._number.exec(r)||t&&(p=this._number.exec(`${r} `)))&&(d="literal",h=p[0],f="string"==typeof p[1]?a.double:"string"==typeof p[2]?a.decimal:a.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(p=this._sparqlKeyword.exec(r))?d=p[0].toUpperCase():y=!0;break;case"f":case"t":(p=this._boolean.exec(r))?(d="literal",h=p[0],f=a.boolean):y=!0;break;case"a":(p=this._shortPredicates.exec(r))?(d="abbreviation",h="a"):y=!0;break;case"=":this._n3Mode&&r.length>1&&(d="abbreviation",">"!==r[1]?(m=1,h="="):(m=2,h=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"}":this._lineMode||(m=1,d=u);break;case"{":!this._lineMode&&r.length>=2&&("|"===r[1]?(d="{|",m=2):(d=u,m=1));break;case"|":r.length>=2&&"}"===r[1]&&(d="|}",m=2);break;default:y=!0}if(y&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(p=this._prefix.exec(r))?((p=this._prefixed.exec(r))||t&&(p=this._prefixed.exec(`${r} `)))&&(d="prefixed",f=p[1]||"",h=this._unescape(p[2])):(d="prefix",h=p[1]||"")),"^^"===this._previousMarker)switch(d){case"prefixed":d="type";break;case"IRI":d="typeIRI";break;default:d=""}if(!d)return t||!/^'''|^"""/.test(r)&&/\n|\r/.test(r)?o(this):this._input=r;const g=m||p[0].length,v=i(d,h,f,l,g);this.previousToken=v,this._previousMarker=d,r=r.substr(g,r.length)}function i(t,i,o,a,s){const l=r?n-r.length:n,c={type:t,value:i,prefix:o,line:a,start:l,end:l+s};return e(null,c),c}function o(t){e(t._syntaxError(/^\S*/.exec(r)[0]))}}_unescape(e){let t=!1;const r=e.replace(s,((e,r,n,i)=>{if("string"==typeof r)return String.fromCharCode(Number.parseInt(r,16));if("string"==typeof n){let e=Number.parseInt(n,16);return e<=65535?String.fromCharCode(Number.parseInt(n,16)):String.fromCharCode(55296+((e-=65536)>>10),56320+(1023&e))}return i in l?l[i]:(t=!0,"")}));return t?null:r}_parseLiteral(e){if(e.length>=3){const t=e.match(/^(?:"""|"|'''|'|)/)[0],r=t.length;let n=Math.max(this._literalClosingPos,r);for(;(n=e.indexOf(t,n))>0;){let t=0;for(;"\\"===e[n-t-1];)t++;if(t%2==0){const t=e.substring(r,n),i=t.split(/\r\n|\r|\n/).length-1,o=n+r;if(1===r&&0!==i||3===r&&this._lineMode)break;return this._line+=i,{value:this._unescape(t),matchLength:o}}n++}this._literalClosingPos=e.length-r+1}return{value:"",matchLength:0}}_syntaxError(e){this._input=null;const t=new Error(`Unexpected "${e}" on line ${this._line}.`);return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t}_readStartingBom(e){return e.startsWith("\ufeff")?e.substr(1):e}tokenize(e,r){if(this._line=1,"string"==typeof e){if(this._input=this._readStartingBom(e),"function"!=typeof r){const e=[];let t;if(this._tokenizeToEnd(((r,n)=>r?t=r:e.push(n)),!0),t)throw t;return e}(0,i.default)((()=>this._tokenizeToEnd(r,!0)))}else this._pendingBuffer=null,"function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",(e=>{null!==this._input&&0!==e.length&&(this._pendingBuffer&&(e=t.concat([this._pendingBuffer,e]),this._pendingBuffer=null),128&e[e.length-1]?this._pendingBuffer=e:(void 0===this._input?this._input=this._readStartingBom("string"==typeof e?e:e.toString()):this._input+=e,this._tokenizeToEnd(r,!1)))})),e.on("end",(()=>{"string"==typeof this._input&&this._tokenizeToEnd(r,!0)})),e.on("error",r)}}r.default=h}).call(this)}).call(this,e("buffer").Buffer)},{"./IRIs":1,buffer:15,"queue-microtask":19}],4:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./N3Lexer")),i=a(e("./N3DataFactory")),o=a(e("./IRIs"));function a(e){return e&&e.__esModule?e:{default:e}}let s=0;class l{constructor(e){this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.baseIRI),e.factory&&u(this,e.factory);const t="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",r=/turtle/.test(t),i=/trig/.test(t),o=/triple/.test(t),a=/quad/.test(t),s=this._n3Mode=/n3/.test(t),l=o||a;(this._supportsNamedGraphs=!(r||s))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(r||i||o||s),this._supportsRDFStar=""===t||/star|\*$/.test(t),l&&(this._resolveRelativeIRI=e=>null),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new n.default({lineMode:l,n3:s}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodePrefix(){s=0}_setBase(e){if(e){const t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base="",this._basePath=""}_saveContext(e,t,r,n,i){const o=this._n3Mode;this._contextStack.push({type:e,subject:r,predicate:n,object:i,graph:t,inverse:!!o&&this._inversePredicate,blankPrefix:o?this._prefixes._:"",quantified:o?this._quantified:null}),o&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.value}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(e,t){const r=this._contextStack.pop();if(!r||r.type!==e)return this._error(`Unexpected ${t.type}`,t);this._subject=r.subject,this._predicate=r.predicate,this._object=r.object,this._graph=r.graph,this._n3Mode&&(this._inversePredicate=r.inverse,this._prefixes._=r.blankPrefix,this._quantified=r.quantified)}_readInTopContext(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,t){let r;switch(e.type){case"IRI":case"typeIRI":const t=this._resolveIRI(e.value);if(null===t)return this._error("Invalid IRI",e);r=this._namedNode(t);break;case"type":case"prefixed":const n=this._prefixes[e.prefix];if(void 0===n)return this._error(`Undefined prefix "${e.prefix}:"`,e);r=this._namedNode(n+e.value);break;case"blank":r=this._blankNode(this._prefixes[e.prefix]+e.value);break;case"var":r=this._variable(e.value.substr(1));break;default:return this._error(`Expected entity but got ${e.type}`,e)}return!t&&this._n3Mode&&r.id in this._quantified&&(r=this._quantified[r.id]),r}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blankNode(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',e);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",e);if(0===e.prefix.length)return this._literalValue=e.value,this._completeSubjectLiteral;this._subject=this._literal(e.value,this._namedNode(e.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){const t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${t}`,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(0===e.prefix.length)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._literal(e.value,this._namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF* syntax",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return"{"!==e.type?this._error(`Expected graph but got ${e.type}`,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const t=null===this._predicate;return this._restoreContext("blank",e),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){let t=null,r=null,n=this._readListItem;const i=this._subject,o=this._contextStack,a=o[o.length-1];switch(e.type){case"[":this._saveContext("blank",this._graph,r=this._blankNode(),this.RDF_FIRST,this._subject=t=this._blankNode()),n=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,r=this._blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",e),0!==o.length&&"list"===o[o.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(n=this._readPredicate,this._subject===this.RDF_NIL)return n}else if(n=this._getContextEndReader(),this._object===this.RDF_NIL)return n;r=this.RDF_NIL;break;case"literal":0===e.prefix.length?(this._literalValue=e.value,n=this._readListItemDataTypeOrLang):(t=this._literal(e.value,this._namedNode(e.prefix)),n=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blankNode()),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(t=this._readEntity(e)))return}if(null===r&&(this._subject=r=this._blankNode()),null===i?null===a.predicate?a.subject=r:a.object=r:this._emit(i,this.RDF_REST,r,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,r,this.RDF_FIRST,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);this._emit(r,this.RDF_FIRST,t,this._graph)}return n}_readDataTypeOrLang(e){return this._completeObjectLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeObjectLiteral(e,!0)}_completeLiteral(e){let t=this._literal(this._literalValue);switch(e.type){case"type":case"typeIRI":const r=this._readEntity(e);if(void 0===r)return;t=this._literal(this._literalValue,r),e=null;break;case"langcode":t=this._literal(this._literalValue,e.value),e=null}return{token:e,literal:t}}_completeSubjectLiteral(e){return this._subject=this._completeLiteral(e).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(e,t){const r=this._completeLiteral(e);if(r)return this._object=r.literal,t&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===r.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(r.token))}_readFormulaTail(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",e),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){let t,r=this._graph;const n=this._subject,i=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,i&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;case"{|":if(!this._supportsRDFStar)return this._error("Unexpected RDF* syntax",e);const o=this._predicate,a=this._object;this._subject=this._quad(n,o,a,this.DEFAULTGRAPH),t=this._readPredicate;break;case"|}":if("Quad"!==this._subject.termType)return this._error("Unexpected asserted triple closing",e);this._subject=null,t=this._readPunctuation;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(r=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}if(null!==n){const e=this._predicate,t=this._object;i?this._emit(t,e,n,r):this._emit(n,e,t,r)}return t}_readBlankNodePunctuation(e){let t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}return this._emit(this._subject,this._predicate,this._object,this._graph),t}_readQuadPunctuation(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if("IRI"!==e.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,e);const t=this._readEntity(e);return this._prefixes[this._prefix]=t.value,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation}_readBaseIRI(e){const t="IRI"===e.type&&this._resolveIRI(e.value);return t?(this._setBase(t),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject=this._blankNode(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){let t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error(`Unexpected ${e.type}`,e)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,t,this.QUANTIFIERS_GRAPH)):this._quantified[t.id]=this._quantifier(this._blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const t=this._contextStack,r=t.length&&t[t.length-1];if(r&&"item"===r.type){const t=this._subject;this._restoreContext("item",e),this._emit(this._subject,this.RDF_FIRST,t,this._graph)}return this._afterPath(e)}}_readForwardPath(e){let t,r;const n=this._blankNode();if(void 0!==(r=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=n):(t=this._object,this._object=n),this._emit(t,r,n,this._graph),this._readPath}_readBackwardPath(e){const t=this._blankNode();let r,n;if(void 0!==(r=this._readEntity(e)))return null===this._predicate?(n=this._subject,this._subject=t):(n=this._object,this._object=t),this._emit(t,r,n,this._graph),this._readPath}_readRDFStarTailOrGraph(e){return">>"!==e.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(e))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,e):this._readRDFStarTail(e)}_readRDFStarTail(e){if(">>"!==e.type)return this._error(`Expected >> but got ${e.type}`,e);const t=this._quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext("<<",e),null===this._subject?(this._subject=t,this._readPredicate):(this._object=t,this._getContextEndReader())}_getContextEndReader(){const e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(e,t,r,n){this._callback(null,this._quad(e,t,r,n||this.DEFAULTGRAPH))}_error(e,t){const r=new Error(`${e} on line ${t.line}.`);r.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(r),this._callback=c}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return("/"===e[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;const t=e.length;let r="",n=-1,i=-1,o=0,a="/";for(;n<t;){switch(a){case":":if(i<0&&"/"===e[++n]&&"/"===e[++n])for(;(i=n+1)<t&&"/"!==e[i];)n=i;break;case"?":case"#":n=t;break;case"/":if("."===e[n+1])switch(a=e[1+ ++n],a){case"/":r+=e.substring(o,n-1),o=n+1;break;case void 0:case"?":case"#":return r+e.substring(o,n)+e.substr(n+1);case".":if(a=e[1+ ++n],void 0===a||"/"===a||"?"===a||"#"===a){if(r+=e.substring(o,n-2),(o=r.lastIndexOf("/"))>=i&&(r=r.substr(0,o)),"/"!==a)return`${r}/${e.substr(n+1)}`;o=n+1}}}a=e[++n]}return r+e.substring(o)}parse(e,t,r){if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${s++}_`,this._prefixCallback=r||c,this._inversePredicate=!1,this._quantified=Object.create(null),!t){const t=[];let r;if(this._callback=(e,n)=>{e?r=e:n&&t.push(n)},this._lexer.tokenize(e).every((e=>this._readCallback=this._readCallback(e))),r)throw r;return t}this._callback=t,this._lexer.tokenize(e,((e,t)=>{null!==e?(this._callback(e),this._callback=c):this._readCallback&&(this._readCallback=this._readCallback(t))}))}}function c(){}function u(e,t){const r=t.namedNode;e._namedNode=r,e._blankNode=t.blankNode,e._literal=t.literal,e._variable=t.variable,e._quad=t.quad,e.DEFAULTGRAPH=t.defaultGraph(),e.RDF_FIRST=r(o.default.rdf.first),e.RDF_REST=r(o.default.rdf.rest),e.RDF_NIL=r(o.default.rdf.nil),e.N3_FORALL=r(o.default.r.forAll),e.N3_FORSOME=r(o.default.r.forSome),e.ABBREVIATIONS={a:r(o.default.rdf.type),"=":r(o.default.owl.sameAs),">":r(o.default.log.implies)},e.QUANTIFIERS_GRAPH=r("urn:n3:quantifiers")}r.default=l,u(l.prototype,i.default)},{"./IRIs":1,"./N3DataFactory":2,"./N3Lexer":3}],5:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=l(e("./N3DataFactory")),i=e("readable-stream"),o=a(e("./IRIs"));function a(e){return e&&e.__esModule?e:{default:e}}function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}class c{constructor(e,t){this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,t||!e||e[0]||(t=e,e=null),t=t||{},this._factory=t.factory||n.default,e&&this.addQuads(e)}get size(){let e=this._size;if(null!==e)return e;e=0;const t=this._graphs;let r,n;for(const i in t)for(const o in r=t[i].subjects)for(const t in n=r[o])e+=Object.keys(n[t]).length;return this._size=e}_addToIndex(e,t,r,n){const i=e[t]||(e[t]={}),o=i[r]||(i[r]={}),a=n in o;return a||(o[n]=null),!a}_removeFromIndex(e,t,r,n){const i=e[t],o=i[r];delete o[n];for(const e in o)return;delete i[r];for(const e in i)return;delete e[t]}*_findInIndex(e,t,r,i,o,a,s,l){let c,u,d;const h=this._entities,f=(0,n.termFromId)(l,this._factory),p={subject:null,predicate:null,object:null};t&&((c=e,e={})[t]=c[t]);for(const t in e)if(u=e[t]){p[o]=(0,n.termFromId)(h[t],this._factory),r&&((c=u,u={})[r]=c[r]);for(const e in u)if(d=u[e]){p[a]=(0,n.termFromId)(h[e],this._factory);const t=i?i in d?[i]:[]:Object.keys(d);for(let e=0;e<t.length;e++)p[s]=(0,n.termFromId)(h[t[e]],this._factory),yield this._factory.quad(p.subject,p.predicate,p.object,f)}}}_loop(e,t){for(const r in e)t(r)}_loopByKey0(e,t,r){let n,i;if(n=e[t])for(i in n)r(i)}_loopByKey1(e,t,r){let n,i;for(n in e)i=e[n],i[t]&&r(n)}_loopBy2Keys(e,t,r,n){let i,o,a;if((i=e[t])&&(o=i[r]))for(a in o)n(a)}_countInIndex(e,t,r,n){let i,o,a,s=0;t&&((i=e,e={})[t]=i[t]);for(const t in e)if(o=e[t]){r&&((i=o,o={})[r]=i[r]);for(const e in o)(a=o[e])&&(n?n in a&&s++:s+=Object.keys(a).length)}return s}_getGraphs(e){if(!u(e))return this._graphs;const t={};return t[e]=this._graphs[e],t}_uniqueEntities(e){const t=Object.create(null);return r=>{r in t||(t[r]=!0,e((0,n.termFromId)(this._entities[r],this._factory)))}}add(e){return this.addQuad(e),this}addQuad(e,t,r,i){t||(i=e.graph,r=e.object,t=e.predicate,e=e.subject),e=(0,n.termToId)(e),t=(0,n.termToId)(t),r=(0,n.termToId)(r),i=(0,n.termToId)(i);let o=this._graphs[i];o||(o=this._graphs[i]={subjects:{},predicates:{},objects:{}},Object.freeze(o));const a=this._ids,s=this._entities;e=a[e]||(a[s[++this._id]=e]=this._id),t=a[t]||(a[s[++this._id]=t]=this._id),r=a[r]||(a[s[++this._id]=r]=this._id);const l=this._addToIndex(o.subjects,e,t,r);return this._addToIndex(o.predicates,t,r,e),this._addToIndex(o.objects,r,e,t),this._size=null,l}addQuads(e){for(let t=0;t<e.length;t++)this.addQuad(e[t])}delete(e){return this.removeQuad(e),this}has(e,t,r,n){return e&&e.subject&&({subject:e,predicate:t,object:r,graph:n}=e),!this.readQuads(e,t,r,n).next().done}import(e){return e.on("data",(e=>{this.addQuad(e)})),e}removeQuad(e,t,r,i){t||(i=e.graph,r=e.object,t=e.predicate,e=e.subject),e=(0,n.termToId)(e),t=(0,n.termToId)(t),r=(0,n.termToId)(r),i=(0,n.termToId)(i);const o=this._ids,a=this._graphs;let s,l,c;if(!((e=o[e])&&(t=o[t])&&(r=o[r])&&(s=a[i])&&(l=s.subjects[e])&&(c=l[t])&&r in c))return!1;for(e in this._removeFromIndex(s.subjects,e,t,r),this._removeFromIndex(s.predicates,t,r,e),this._removeFromIndex(s.objects,r,e,t),null!==this._size&&this._size--,s.subjects)return!0;return delete a[i],!0}removeQuads(e){for(let t=0;t<e.length;t++)this.removeQuad(e[t])}remove(e){return e.on("data",(e=>{this.removeQuad(e)})),e}removeMatches(e,t,r,n){const o=new i.Readable({objectMode:!0});return o._read=()=>{for(const i of this.readQuads(e,t,r,n))o.push(i);o.push(null)},this.remove(o)}deleteGraph(e){return this.removeMatches(null,null,null,e)}getQuads(e,t,r,n){return[...this.readQuads(e,t,r,n)]}*readQuads(e,t,r,i){e=e&&(0,n.termToId)(e),t=t&&(0,n.termToId)(t),r=r&&(0,n.termToId)(r),i=i&&(0,n.termToId)(i);const o=this._getGraphs(i),a=this._ids;let s,l,c,d;if(!(u(e)&&!(l=a[e])||u(t)&&!(c=a[t])||u(r)&&!(d=a[r])))for(const e in o)(s=o[e])&&(l?d?yield*this._findInIndex(s.objects,d,l,c,"object","subject","predicate",e):yield*this._findInIndex(s.subjects,l,c,null,"subject","predicate","object",e):c?yield*this._findInIndex(s.predicates,c,d,null,"predicate","object","subject",e):d?yield*this._findInIndex(s.objects,d,null,null,"object","subject","predicate",e):yield*this._findInIndex(s.subjects,null,null,null,"subject","predicate","object",e))}match(e,t,r,n){return new d(this,e,t,r,n)}countQuads(e,t,r,i){e=e&&(0,n.termToId)(e),t=t&&(0,n.termToId)(t),r=r&&(0,n.termToId)(r),i=i&&(0,n.termToId)(i);const o=this._getGraphs(i),a=this._ids;let s,l,c,d,h=0;if(u(e)&&!(l=a[e])||u(t)&&!(c=a[t])||u(r)&&!(d=a[r]))return 0;for(const n in o)(s=o[n])&&(h+=e?r?this._countInIndex(s.objects,d,l,c):this._countInIndex(s.subjects,l,c,d):t?this._countInIndex(s.predicates,c,d,l):this._countInIndex(s.objects,d,l,c));return h}forEach(e,t,r,n,i){this.some((t=>(e(t),!1)),t,r,n,i)}every(e,t,r,n,i){let o=!1;const a=!this.some((t=>(o=!0,!e(t))),t,r,n,i);return o&&a}some(e,t,r,n,i){for(const o of this.readQuads(t,r,n,i))if(e(o))return!0;return!1}getSubjects(e,t,r){const n=[];return this.forSubjects((e=>{n.push(e)}),e,t,r),n}forSubjects(e,t,r,i){t=t&&(0,n.termToId)(t),r=r&&(0,n.termToId)(r),i=i&&(0,n.termToId)(i);const o=this._ids,a=this._getGraphs(i);let s,l,c;if(e=this._uniqueEntities(e),!(u(t)&&!(l=o[t])||u(r)&&!(c=o[r])))for(i in a)(s=a[i])&&(l?c?this._loopBy2Keys(s.predicates,l,c,e):this._loopByKey1(s.subjects,l,e):c?this._loopByKey0(s.objects,c,e):this._loop(s.subjects,e))}getPredicates(e,t,r){const n=[];return this.forPredicates((e=>{n.push(e)}),e,t,r),n}forPredicates(e,t,r,i){t=t&&(0,n.termToId)(t),r=r&&(0,n.termToId)(r),i=i&&(0,n.termToId)(i);const o=this._ids,a=this._getGraphs(i);let s,l,c;if(e=this._uniqueEntities(e),!(u(t)&&!(l=o[t])||u(r)&&!(c=o[r])))for(i in a)(s=a[i])&&(l?c?this._loopBy2Keys(s.objects,c,l,e):this._loopByKey0(s.subjects,l,e):c?this._loopByKey1(s.predicates,c,e):this._loop(s.predicates,e))}getObjects(e,t,r){const n=[];return this.forObjects((e=>{n.push(e)}),e,t,r),n}forObjects(e,t,r,i){t=t&&(0,n.termToId)(t),r=r&&(0,n.termToId)(r),i=i&&(0,n.termToId)(i);const o=this._ids,a=this._getGraphs(i);let s,l,c;if(e=this._uniqueEntities(e),!(u(t)&&!(l=o[t])||u(r)&&!(c=o[r])))for(i in a)(s=a[i])&&(l?c?this._loopBy2Keys(s.subjects,l,c,e):this._loopByKey1(s.objects,l,e):c?this._loopByKey0(s.predicates,c,e):this._loop(s.objects,e))}getGraphs(e,t,r){const n=[];return this.forGraphs((e=>{n.push(e)}),e,t,r),n}forGraphs(e,t,r,n){for(const i in this._graphs)this.some((t=>(e(t.graph),!0)),t,r,n,i)}createBlankNode(e){let t,r;if(e)for(t=e=`_:${e}`,r=1;this._ids[t];)t=e+r++;else do{t="_:b"+this._blankNodeIndex++}while(this._ids[t]);return this._ids[t]=++this._id,this._entities[this._id]=t,this._factory.blankNode(t.substr(2))}extractLists({remove:e=!1,ignoreErrors:t=!1}={}){const r={},n=t?()=>!0:(e,t)=>{throw new Error(`${e.value} ${t}`)},i=this.getQuads(null,o.default.rdf.rest,o.default.rdf.nil,null),a=e?[...i]:[];return i.forEach((t=>{const i=[];let s,l,c=!1;const u=t.graph;let d=t.subject;for(;d&&!c;){const e=this.getQuads(null,null,d,null),t=this.getQuads(d,null,null,null);let r,h=null,f=null,p=null;for(let i=0;i<t.length&&!c;i++)r=t[i],r.graph.equals(u)?s?c=n(d,"has non-list arcs out"):r.predicate.value===o.default.rdf.first?h?c=n(d,"has multiple rdf:first arcs"):a.push(h=r):r.predicate.value===o.default.rdf.rest?f?c=n(d,"has multiple rdf:rest arcs"):a.push(f=r):e.length?c=n(d,"can't be subject and object"):(s=r,l="subject"):c=n(d,"not confined to single graph");for(let t=0;t<e.length&&!c;++t)r=e[t],s?c=n(d,"can't have coreferences"):r.predicate.value===o.default.rdf.rest?p?c=n(d,"has incoming rdf:rest arcs"):p=r:(s=r,l="object");h?i.unshift(h.object):c=n(d,"has no list head"),d=p&&p.subject}c?e=!1:s&&(r[s[l].value]=i)})),e&&this.removeQuads(a),r}*[Symbol.iterator](){yield*this.readQuads()}}function u(e){return"string"==typeof e||e instanceof String}r.default=c;class d extends i.Readable{constructor(e,t,r,n,i){super({objectMode:!0}),Object.assign(this,{n3Store:e,subject:t,predicate:r,object:n,graph:i})}get filtered(){if(!this._filtered){const{n3Store:e,graph:t,object:r,predicate:n,subject:i}=this,o=this._filtered=new c({factory:e._factory});for(const a of e.readQuads(i,n,r,t))o.addQuad(a)}return this._filtered}get size(){return this.filtered.size}_read(){for(const e of this)this.push(e);this.push(null)}add(e){return this.filtered.add(e)}delete(e){return this.filtered.delete(e)}has(e){return this.filtered.has(e)}match(e,t,r,n){return new d(this.filtered,e,t,r,n)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}},{"./IRIs":1,"./N3DataFactory":2,"readable-stream":38}],6:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=o(e("./N3Parser")),i=e("readable-stream");function o(e){return e&&e.__esModule?e:{default:e}}class a extends i.Transform{constructor(e){let t,r;super({decodeStrings:!0}),this._readableState.objectMode=!0,new n.default(e).parse({on:(e,n)=>{switch(e){case"data":t=n;break;case"end":r=n}}},((e,t)=>{e&&this.emit("error",e)||t&&this.push(t)}),((e,t)=>{this.emit("prefix",e,t)})),this._transform=(e,r,n)=>{t(e),n()},this._flush=e=>{r(),e()}}import(e){return e.on("data",(e=>{this.write(e)})),e.on("end",(()=>{this.end()})),e.on("error",(e=>{this.emit("error",e)})),this}}r.default=a},{"./N3Parser":4,"readable-stream":38}],7:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("readable-stream"),i=o(e("./N3Writer"));function o(e){return e&&e.__esModule?e:{default:e}}class a extends n.Transform{constructor(e){super({encoding:"utf8",writableObjectMode:!0});const t=this._writer=new i.default({write:(e,t,r)=>{this.push(e),r&&r()},end:e=>{this.push(null),e&&e()}},e);this._transform=(e,r,n)=>{t.addQuad(e,n)},this._flush=e=>{t.end(e)}}import(e){return e.on("data",(e=>{this.write(e)})),e.on("end",(()=>{this.end()})),e.on("error",(e=>{this.emit("error",e)})),e.on("prefix",((e,t)=>{this._writer.addPrefix(e,t)})),this}}r.default=a},{"./N3Writer":9,"readable-stream":38}],8:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.inDefaultGraph=u,r.isBlankNode=a,r.isDefaultGraph=c,r.isLiteral=s,r.isNamedNode=o,r.isVariable=l,r.prefix=d,r.prefixes=h;var n=i(e("./N3DataFactory"));function i(e){return e&&e.__esModule?e:{default:e}}function o(e){return!!e&&"NamedNode"===e.termType}function a(e){return!!e&&"BlankNode"===e.termType}function s(e){return!!e&&"Literal"===e.termType}function l(e){return!!e&&"Variable"===e.termType}function c(e){return!!e&&"DefaultGraph"===e.termType}function u(e){return c(e.graph)}function d(e,t){return h({"":e.value||e},t)("")}function h(e,t){const r=Object.create(null);for(const t in e)i(t,e[t]);function i(e,n){if("string"==typeof n){const i=Object.create(null);r[e]=e=>i[e]||(i[e]=t.namedNode(n+e))}else if(!(e in r))throw new Error(`Unknown prefix: ${e}`);return r[e]}return t=t||n.default,i}},{"./N3DataFactory":2}],9:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=l(e("./IRIs")),i=s(e("./N3DataFactory")),o=e("./N3Util");function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(a=function(e){return e?r:t})(e)}function s(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=a(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=i?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(n,o,s):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function l(e){return e&&e.__esModule?e:{default:e}}const c=i.default.defaultGraph(),{rdf:u,xsd:d}=n.default,h=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,f=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,p={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class m extends i.Term{equals(e){return e===this}}class y{constructor(e,t){if(this._prefixRegex=/$0^/,e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},this._lists=t.lists,e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{let e="";this._outputStream={write(t,r,n){e+=t,n&&n()},end:t=>{t&&t(null,e)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=c,this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes),t.baseIRI&&(this._baseMatcher=new RegExp(`^${v(t.baseIRI)}${t.baseIRI.endsWith("/")?"":"[#?]"}`),this._baseLength=t.baseIRI.length))}get _inDefaultGraph(){return c.equals(this._graph)}_write(e,t){this._outputStream.write(e,"utf8",t)}_writeQuad(e,t,r,n,i){try{n.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(c.equals(n)?"":`${this._encodeIriOrBlank(n)} {\n`)),this._graph=n,this._subject=null),e.equals(this._subject)?t.equals(this._predicate)?this._write(`, ${this._encodeObject(r)}`,i):this._write(`;\n    ${this._encodePredicate(this._predicate=t)} ${this._encodeObject(r)}`,i):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)} ${this._encodePredicate(this._predicate=t)} ${this._encodeObject(r)}`,i)}catch(e){i&&i(e)}}_writeQuadLine(e,t,r,n,i){delete this._prefixMatch,this._write(this.quadToString(e,t,r,n),i)}quadToString(e,t,r,n){return`${this._encodeSubject(e)} ${this._encodeIriOrBlank(t)} ${this._encodeObject(r)}${n&&n.value?` ${this._encodeIriOrBlank(n)} .\n`:" .\n"}`}quadsToString(e){return e.map((e=>this.quadToString(e.subject,e.predicate,e.object,e.graph))).join("")}_encodeSubject(e){return"Quad"===e.termType?this._encodeQuad(e):this._encodeIriOrBlank(e)}_encodeIriOrBlank(e){if("NamedNode"!==e.termType)return this._lists&&e.value in this._lists&&(e=this.list(this._lists[e.value])),"id"in e?e.id:`_:${e.value}`;let t=e.value;this._baseMatcher&&this._baseMatcher.test(t)&&(t=t.substr(this._baseLength)),h.test(t)&&(t=t.replace(f,g));const r=this._prefixRegex.exec(t);return r?r[1]?this._prefixIRIs[r[1]]+r[2]:t:`<${t}>`}_encodeLiteral(e){let t=e.value;if(h.test(t)&&(t=t.replace(f,g)),e.language)return`"${t}"@${e.language}`;if(this._lineMode){if(e.datatype.value===d.string)return`"${t}"`}else switch(e.datatype.value){case d.string:return`"${t}"`;case d.boolean:if("true"===t||"false"===t)return t;break;case d.integer:if(/^[+-]?\d+$/.test(t))return t;break;case d.decimal:if(/^[+-]?\d*\.\d+$/.test(t))return t;break;case d.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(t))return t}return`"${t}"^^${this._encodeIriOrBlank(e.datatype)}`}_encodePredicate(e){return e.value===u.type?"a":this._encodeIriOrBlank(e)}_encodeObject(e){switch(e.termType){case"Quad":return this._encodeQuad(e);case"Literal":return this._encodeLiteral(e);default:return this._encodeIriOrBlank(e)}}_encodeQuad({subject:e,predicate:t,object:r,graph:n}){return`<<${this._encodeSubject(e)} ${this._encodePredicate(t)} ${this._encodeObject(r)}${(0,o.isDefaultGraph)(n)?"":` ${this._encodeIriOrBlank(n)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(e,t,r,n,i){void 0===r?this._writeQuad(e.subject,e.predicate,e.object,e.graph,t):"function"==typeof n?this._writeQuad(e,t,r,c,n):this._writeQuad(e,t,r,n||c,i)}addQuads(e){for(let t=0;t<e.length;t++)this.addQuad(e[t])}addPrefix(e,t,r){const n={};n[e]=t,this.addPrefixes(n,r)}addPrefixes(e,t){if(!this._prefixIRIs)return t&&t();let r=!1;for(let t in e){let n=e[t];"string"!=typeof n&&(n=n.value),r=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[n]=t+=":",this._write(`@prefix ${t} <${n}>.\n`)}if(r){let e="",t="";for(const r in this._prefixIRIs)e+=e?`|${r}`:r,t+=(t?"|":"")+this._prefixIRIs[r];e=v(e),this._prefixRegex=new RegExp(`^(?:${t})[^/]*$|^(${e})([_a-zA-Z][\\-_a-zA-Z0-9]*)$`)}this._write(r?"\n":"",t)}blank(e,t){let r,n,i=e;switch(void 0===e?i=[]:e.termType?i=[{predicate:e,object:t}]:"length"in e||(i=[e]),n=i.length){case 0:return new m("[]");case 1:if(r=i[0],!(r.object instanceof m))return new m(`[ ${this._encodePredicate(r.predicate)} ${this._encodeObject(r.object)} ]`);default:let t="[";for(let o=0;o<n;o++)r=i[o],r.predicate.equals(e)?t+=`, ${this._encodeObject(r.object)}`:(t+=`${(o?";\n  ":"\n  ")+this._encodePredicate(r.predicate)} ${this._encodeObject(r.object)}`,e=r.predicate);return new m(`${t}\n]`)}}list(e){const t=e&&e.length||0,r=new Array(t);for(let n=0;n<t;n++)r[n]=this._encodeObject(e[n]);return new m(`(${r.join(" ")})`)}end(e){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let t=e&&((r,n)=>{t=null,e(r,n)});if(this._endStream)try{return this._outputStream.end(t)}catch(e){}t&&t()}}function g(e){let t=p[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}function v(e){return e.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}r.default=y},{"./IRIs":1,"./N3DataFactory":2,"./N3Util":8}],10:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"BlankNode",{enumerable:!0,get:function(){return u.BlankNode}}),Object.defineProperty(r,"DataFactory",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(r,"DefaultGraph",{enumerable:!0,get:function(){return u.DefaultGraph}}),Object.defineProperty(r,"Lexer",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(r,"Literal",{enumerable:!0,get:function(){return u.Literal}}),Object.defineProperty(r,"NamedNode",{enumerable:!0,get:function(){return u.NamedNode}}),Object.defineProperty(r,"Parser",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(r,"Quad",{enumerable:!0,get:function(){return u.Quad}}),Object.defineProperty(r,"Store",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(r,"StreamParser",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(r,"StreamWriter",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(r,"Term",{enumerable:!0,get:function(){return u.Term}}),Object.defineProperty(r,"Triple",{enumerable:!0,get:function(){return u.Triple}}),r.Util=void 0,Object.defineProperty(r,"Variable",{enumerable:!0,get:function(){return u.Variable}}),Object.defineProperty(r,"Writer",{enumerable:!0,get:function(){return o.default}}),r.default=void 0,Object.defineProperty(r,"termFromId",{enumerable:!0,get:function(){return u.termFromId}}),Object.defineProperty(r,"termToId",{enumerable:!0,get:function(){return u.termToId}});var n=f(e("./N3Lexer")),i=f(e("./N3Parser")),o=f(e("./N3Writer")),a=f(e("./N3Store")),s=f(e("./N3StreamParser")),l=f(e("./N3StreamWriter")),c=h(e("./N3Util"));r.Util=c;var u=h(e("./N3DataFactory"));function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}function h(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function f(e){return e&&e.__esModule?e:{default:e}}var p={Lexer:n.default,Parser:i.default,Writer:o.default,Store:a.default,StreamParser:s.default,StreamWriter:l.default,Util:c,DataFactory:u.default,Term:u.Term,NamedNode:u.NamedNode,Literal:u.Literal,BlankNode:u.BlankNode,Variable:u.Variable,DefaultGraph:u.DefaultGraph,Quad:u.Quad,Triple:u.Triple,termFromId:u.termFromId,termToId:u.termToId};r.default=p},{"./N3DataFactory":2,"./N3Lexer":3,"./N3Parser":4,"./N3Store":5,"./N3StreamParser":6,"./N3StreamWriter":7,"./N3Util":8,"./N3Writer":9}],11:[function(e,t,r){const{AbortController:n,AbortSignal:i}="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;t.exports=n,t.exports.AbortSignal=i,t.exports.default=n},{}],12:[function(e,t,r){r.byteLength=u,r.toByteArray=h,r.fromByteArray=m;for(var n=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)n[s]=a[s],i[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e){var t=c(e),r=t[0],n=t[1];return 3*(r+n)/4-n}function d(e,t,r){return 3*(t+r)/4-r}function h(e){var t,r,n=c(e),a=n[0],s=n[1],l=new o(d(e,a,s)),u=0,h=s>0?a-4:a;for(r=0;r<h;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;return 2===s&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,l[u++]=255&t),1===s&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t),l}function f(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function p(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(f(n));return i.join("")}function m(e){for(var t,r=e.length,i=r%3,o=[],a=16383,s=0,l=r-i;s<l;s+=a)o.push(p(e,s,s+a>l?l:s+a));return 1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},{}],13:[function(e,t,r){var n=e("buffer"),i=n.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(o(n,r),r.Buffer=a),o(i,a),a.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},{buffer:15}],14:[function(e,t,r){var n=e("safe-buffer").Buffer,i=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function a(e){var t=o(e);if("string"!=typeof t&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}function s(e){var t;switch(this.encoding=a(e),this.encoding){case"utf16le":this.text=p,this.end=m,t=4;break;case"utf8":this.fillLast=d,t=4;break;case"base64":this.text=y,this.end=g,t=3;break;default:return this.write=v,void(this.end=w)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function l(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function c(e,t,r){var n=t.length-1;if(n<r)return 0;var i=l(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r||-2===i?0:(i=l(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r||-2===i?0:(i=l(t[n]))>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0}function u(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}function d(e){var t=this.lastTotal-this.lastNeed,r=u(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function h(e,t){var r=c(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)}function f(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t}function p(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function m(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function y(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function g(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function v(e){return e.toString(this.encoding)}function w(e){return e&&e.length?this.write(e):""}r.StringDecoder=s,s.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},s.prototype.end=f,s.prototype.text=h,s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},{"safe-buffer":13}],15:[function(e,t,r){(function(t){(function(){var t=e("base64-js"),n=e("ieee754");r.Buffer=s,r.SlowBuffer=g,r.INSPECT_MAX_BYTES=50;var i=2147483647;function o(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()}catch(e){return!1}}function a(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return t.__proto__=s.prototype,t}function s(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return l(e,t,r)}function l(e,t,r){if("string"==typeof e)return h(e,t);if(ArrayBuffer.isView(e))return f(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Q(e,ArrayBuffer)||e&&Q(e.buffer,ArrayBuffer))return p(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return s.from(n,t,r);var i=m(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e,t,r){return c(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}function d(e){return c(e),a(e<0?0:0|y(e))}function h(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|v(e,t),n=a(r),i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}function f(e){for(var t=e.length<0?0:0|y(e.length),r=a(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function p(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r)).__proto__=s.prototype,n}function m(e){if(s.isBuffer(e)){var t=0|y(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||Z(e.length)?a(0):f(e):"Buffer"===e.type&&Array.isArray(e.data)?f(e.data):void 0}function y(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function g(e){return+e!=e&&(e=0),s.alloc(+e)}function v(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Q(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return H(e).length;default:if(i)return n?-1:z(e).length;t=(""+t).toLowerCase(),i=!0}}function w(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,r);case"utf8":case"utf-8":return j(this,t,r);case"ascii":return C(this,t,r);case"latin1":case"binary":return A(this,t,r);case"base64":return D(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function b(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function _(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=s.from(t,n)),s.isBuffer(t))return 0===t.length?-1:E(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):E(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function E(e,t,r,n,i){var o,a=1,s=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var u=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*a}else-1!==u&&(o-=o-u),u=-1}else for(r+l>s&&(r=s-l),o=r;o>=0;o--){for(var d=!0,h=0;h<l;h++)if(c(e,o+h)!==c(t,h)){d=!1;break}if(d)return o}return-1}function T(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;n>o/2&&(n=o/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(Z(s))return a;e[r+a]=s}return a}function x(e,t,r,n){return V(z(t,e.length-r),e,r,n)}function I(e,t,r,n){return V(G(t),e,r,n)}function S(e,t,r,n){return I(e,t,r,n)}function R(e,t,r,n){return V(H(t),e,r,n)}function k(e,t,r,n){return V(J(t,e.length-r),e,r,n)}function D(e,r,n){return 0===r&&n===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n))}function j(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,a,s,l,c=e[i],u=null,d=c>239?4:c>223?3:c>191?2:1;if(i+d<=r)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(o=e[i+1]))&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(l=(15&c)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),i+=d}return O(n)}r.kMaxLength=i,s.TYPED_ARRAY_SUPPORT=o(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192,s.from=function(e,t,r){return l(e,t,r)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array,s.alloc=function(e,t,r){return u(e,t,r)},s.allocUnsafe=function(e){return d(e)},s.allocUnsafeSlow=function(e){return d(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(Q(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),Q(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=s.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(Q(o,Uint8Array)&&(o=s.from(o)),!s.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},s.byteLength=v,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)b(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)b(this,t,t+3),b(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)b(this,t,t+7),b(this,t+1,t+6),b(this,t+2,t+5),b(this,t+3,t+4);return this},s.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?j(this,0,e):w.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},s.prototype.compare=function(e,t,r,n,i){if(Q(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),l=Math.min(o,a),c=this.slice(n,i),u=e.slice(t,r),d=0;d<l;++d)if(c[d]!==u[d]){o=c[d],a=u[d];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},s.prototype.indexOf=function(e,t,r){return _(this,e,t,r,!0)},s.prototype.lastIndexOf=function(e,t,r){return _(this,e,t,r,!1)},s.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return T(this,e,t,r);case"utf8":case"utf-8":return x(this,e,t,r);case"ascii":return I(this,e,t,r);case"latin1":case"binary":return S(this,e,t,r);case"base64":return R(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var N=4096;function O(e){var t=e.length;if(t<=N)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=N));return r}function C(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function A(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function M(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=W(e[o]);return i}function L(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function P(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,r,n,i,o){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function $(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function F(e,t,r,i,o){return t=+t,r>>>=0,o||$(e,t,r,4),n.write(e,t,r,i,23,4),r+4}function U(e,t,r,i,o){return t=+t,r>>>=0,o||$(e,t,r,8),n.write(e,t,r,i,52,8),r+8}s.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return n.__proto__=s.prototype,n},s.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},s.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},s.prototype.readUInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},s.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},s.prototype.readInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||P(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(e,t){e>>>=0,t||P(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return e>>>=0,t||P(e,4,this.length),n.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||P(e,4,this.length),n.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||P(e,8,this.length),n.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||P(e,8,this.length),n.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||B(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},s.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||B(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},s.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);B(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},s.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);B(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},s.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeFloatLE=function(e,t,r){return F(this,e,t,!0,r)},s.prototype.writeFloatBE=function(e,t,r){return F(this,e,t,!1,r)},s.prototype.writeDoubleLE=function(e,t,r){return U(this,e,t,!0,r)},s.prototype.writeDoubleBE=function(e,t,r){return U(this,e,t,!1,r)},s.prototype.copy=function(e,t,r,n){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var o=i-1;o>=0;--o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return i},s.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=s.isBuffer(e)?e:s.from(e,n),l=a.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=a[o%l]}return this};var q=/[^+/0-9A-Za-z-_]/g;function Y(e){if((e=(e=e.split("=")[0]).trim().replace(q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function W(e){return e<16?"0"+e.toString(16):e.toString(16)}function z(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function G(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function J(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}function H(e){return t.toByteArray(Y(e))}function V(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function Q(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Z(e){return e!=e}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":12,buffer:15,ieee754:17}],16:[function(e,t,r){var n,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};function a(e){console&&console.warn&&console.warn(e)}n=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function l(){l.init.call(this)}t.exports=l,t.exports.once=b,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var c=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function d(e){return void 0===e._maxListeners?l.defaultMaxListeners:e._maxListeners}function h(e,t,r,n){var i,o,s;if(u(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=d(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,a(l)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=f.bind(n);return i.listener=r,n.wrapFn=i,i}function m(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?w(i):g(i,i.length)}function y(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function g(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function v(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function w(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function b(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}E(e,t,o,{once:!0}),"error"!==t&&_(e,i,{once:!0})}))}function _(e,t,r){"function"==typeof e.on&&E(e,"error",t,r)}function E(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),l.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},l.prototype.getMaxListeners=function(){return d(this)},l.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=i[e];if(void 0===l)return!1;if("function"==typeof l)o(l,this,t);else{var c=l.length,u=g(l,c);for(r=0;r<c;++r)o(u[r],this,t)}return!0},l.prototype.addListener=function(e,t){return h(this,e,t,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(e,t){return h(this,e,t,!0)},l.prototype.once=function(e,t){return u(t),this.on(e,p(this,e,t)),this},l.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,p(this,e,t)),this},l.prototype.removeListener=function(e,t){var r,n,i,o,a;if(u(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():v(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},l.prototype.listeners=function(e){return m(this,e,!0)},l.prototype.rawListeners=function(e){return m(this,e,!1)},l.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):y.call(e,t)},l.prototype.listenerCount=y,l.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},{}],17:[function(e,t,r){r.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,l=(1<<s)-1,c=l>>1,u=-7,d=r?i-1:0,h=r?-1:1,f=e[t+d];for(d+=h,o=f&(1<<-u)-1,f>>=-u,u+=s;u>0;o=256*o+e[t+d],d+=h,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=n;u>0;a=256*a+e[t+d],d+=h,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(f?-1:1);a+=Math.pow(2,n),o-=c}return(f?-1:1)*a*Math.pow(2,o-n)},r.write=function(e,t,r,n,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,d=u>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*l-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[r+f]=255&s,f+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+f]=255&a,f+=p,a/=256,c-=8);e[r+f-p]|=128*m}},{}],18:[function(e,t,r){var n,i,o=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function l(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function c(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var u,d=[],h=!1,f=-1;function p(){h&&u&&(h=!1,u.length?d=u.concat(d):f=-1,d.length&&m())}function m(){if(!h){var e=l(p);h=!0;for(var t=d.length;t;){for(u=d,d=[];++f<t;)u&&u[f].run();f=-1,t=d.length}u=null,h=!1,c(e)}}function y(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new y(e,t)),1!==d.length||h||l(m)},y.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],19:[function(e,t,r){(function(e){(function(){let r;t.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:e):e=>(r||(r=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))}).call(this)}).call(this,void 0!==s?s:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(e,t,r){const{AbortError:n,codes:i}=e("../../ours/errors"),o=e("./end-of-stream"),{ERR_INVALID_ARG_TYPE:a}=i,s=(e,t)=>{if("object"!=typeof e||!("aborted"in e))throw new a(t,"AbortSignal",e)};function l(e){return!(!e||"function"!=typeof e.pipe)}t.exports.addAbortSignal=function(e,r){if(s(e,"signal"),!l(r))throw new a("stream","stream.Stream",r);return t.exports.addAbortSignalNoValidate(e,r)},t.exports.addAbortSignalNoValidate=function(e,t){if("object"!=typeof e||!("aborted"in e))return t;const r=()=>{t.destroy(new n(void 0,{cause:e.reason}))};return e.aborted?r():(e.addEventListener("abort",r),o(t,(()=>e.removeEventListener("abort",r)))),t}},{"../../ours/errors":39,"./end-of-stream":26}],21:[function(e,t,r){(function(r){(function(){const{StringPrototypeSlice:n,SymbolIterator:i,TypedArrayPrototypeSet:o,Uint8Array:a}=e("../../ours/primordials"),{inspect:s}=e("../../ours/util");t.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}shift(){if(0===this.length)return;const e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(0===this.length)return"";let t=this.head,r=""+t.data;for(;null!==(t=t.next);)r+=e+t.data;return r}concat(e){if(0===this.length)return r.alloc(0);const t=r.allocUnsafe(e>>>0);let n=this.head,i=0;for(;n;)o(t,n.data,i),i+=n.data.length,n=n.next;return t}consume(e,t){const r=this.head.data;if(e<r.length){const t=r.slice(0,e);return this.head.data=r.slice(e),t}return e===r.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[i](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",r=this.head,i=0;do{const o=r.data;if(!(e>o.length)){e===o.length?(t+=o,++i,r.next?this.head=r.next:this.head=this.tail=null):(t+=n(o,0,e),this.head=r,r.data=n(o,e));break}t+=o,e-=o.length,++i}while(null!==(r=r.next));return this.length-=i,t}_getBuffer(e){const t=r.allocUnsafe(e),n=e;let i=this.head,s=0;do{const r=i.data;if(!(e>r.length)){e===r.length?(o(t,r,n-e),++s,i.next?this.head=i.next:this.head=this.tail=null):(o(t,new a(r.buffer,r.byteOffset,e),n-e),this.head=i,i.data=r.slice(e));break}o(t,r,n-e),e-=r.length,++s}while(null!==(i=i.next));return this.length-=s,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return s(this,{...t,depth:0,customInspect:!1})}}}).call(this)}).call(this,e("buffer").Buffer)},{"../../ours/primordials":40,"../../ours/util":41,buffer:15}],22:[function(e,t,r){const{pipeline:n}=e("./pipeline"),i=e("./duplex"),{destroyer:o}=e("./destroy"),{isNodeStream:a,isReadable:s,isWritable:l}=e("./utils"),{AbortError:c,codes:{ERR_INVALID_ARG_VALUE:u,ERR_MISSING_ARGS:d}}=e("../../ours/errors");t.exports=function(...e){if(0===e.length)throw new d("streams");if(1===e.length)return i.from(e[0]);const t=[...e];if("function"==typeof e[0]&&(e[0]=i.from(e[0])),"function"==typeof e[e.length-1]){const t=e.length-1;e[t]=i.from(e[t])}for(let r=0;r<e.length;++r)if(a(e[r])){if(r<e.length-1&&!s(e[r]))throw new u(`streams[${r}]`,t[r],"must be readable");if(r>0&&!l(e[r]))throw new u(`streams[${r}]`,t[r],"must be writable")}let r,h,f,p,m;function y(e){const t=p;p=null,t?t(e):e?m.destroy(e):b||w||m.destroy()}const g=e[0],v=n(e,y),w=!!l(g),b=!!s(v);return m=new i({writableObjectMode:!(null==g||!g.writableObjectMode),readableObjectMode:!(null==v||!v.writableObjectMode),writable:w,readable:b}),w&&(m._write=function(e,t,n){g.write(e,t)?n():r=n},m._final=function(e){g.end(),h=e},g.on("drain",(function(){if(r){const e=r;r=null,e()}})),v.on("finish",(function(){if(h){const e=h;h=null,e()}}))),b&&(v.on("readable",(function(){if(f){const e=f;f=null,e()}})),v.on("end",(function(){m.push(null)})),m._read=function(){for(;;){const e=v.read();if(null===e)return void(f=m._read);if(!m.push(e))return}}),m._destroy=function(e,t){e||null===p||(e=new c),f=null,r=null,h=null,null===p?t(e):(p=t,o(v,e))},m}},{"../../ours/errors":39,"./destroy":23,"./duplex":24,"./pipeline":31,"./utils":35}],23:[function(e,t,r){(function(r){(function(){const{aggregateTwoErrors:n,codes:{ERR_MULTIPLE_CALLBACK:i},AbortError:o}=e("../../ours/errors"),{Symbol:a}=e("../../ours/primordials"),{kDestroyed:s,isDestroyed:l,isFinished:c,isServerRequest:u}=e("./utils"),d=a("kDestroy"),h=a("kConstruct");function f(e,t,r){e&&(t&&!t.errored&&(t.errored=e),r&&!r.errored&&(r.errored=e))}function p(e,t){const r=this._readableState,i=this._writableState,o=i||r;return i&&i.destroyed||r&&r.destroyed?("function"==typeof t&&t(),this):(f(e,i,r),i&&(i.destroyed=!0),r&&(r.destroyed=!0),o.constructed?m(this,e,t):this.once(d,(function(r){m(this,n(r,e),t)})),this)}function m(e,t,n){let i=!1;function o(t){if(i)return;i=!0;const o=e._readableState,a=e._writableState;f(t,a,o),a&&(a.closed=!0),o&&(o.closed=!0),"function"==typeof n&&n(t),t?r.nextTick(y,e,t):r.nextTick(g,e)}try{e._destroy(t||null,o)}catch(t){o(t)}}function y(e,t){v(e,t),g(e)}function g(e){const t=e._readableState,r=e._writableState;r&&(r.closeEmitted=!0),t&&(t.closeEmitted=!0),(r&&r.emitClose||t&&t.emitClose)&&e.emit("close")}function v(e,t){const r=e._readableState,n=e._writableState;n&&n.errorEmitted||r&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),e.emit("error",t))}function w(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)}function b(e,t,n){const i=e._readableState,o=e._writableState;if(o&&o.destroyed||i&&i.destroyed)return this;i&&i.autoDestroy||o&&o.autoDestroy?e.destroy(t):t&&(o&&!o.errored&&(o.errored=t),i&&!i.errored&&(i.errored=t),n?r.nextTick(v,e,t):v(e,t))}function _(e,t){if("function"!=typeof e._construct)return;const n=e._readableState,i=e._writableState;n&&(n.constructed=!1),i&&(i.constructed=!1),e.once(h,t),e.listenerCount(h)>1||r.nextTick(E,e)}function E(e){let t=!1;function n(n){if(t)return void b(e,null!=n?n:new i);t=!0;const o=e._readableState,a=e._writableState,s=a||o;o&&(o.constructed=!0),a&&(a.constructed=!0),s.destroyed?e.emit(d,n):n?b(e,n,!0):r.nextTick(T,e)}try{e._construct(n)}catch(e){n(e)}}function T(e){e.emit(h)}function x(e){return e&&e.setHeader&&"function"==typeof e.abort}function I(e){e.emit("close")}function S(e,t){e.emit("error",t),r.nextTick(I,e)}function R(e,t){e&&!l(e)&&(t||c(e)||(t=new o),u(e)?(e.socket=null,e.destroy(t)):x(e)?e.abort():x(e.req)?e.req.abort():"function"==typeof e.destroy?e.destroy(t):"function"==typeof e.close?e.close():t?r.nextTick(S,e):r.nextTick(I,e),e.destroyed||(e[s]=!0))}t.exports={construct:_,destroyer:R,destroy:p,undestroy:w,errorOrDestroy:b}}).call(this)}).call(this,e("_process"))},{"../../ours/errors":39,"../../ours/primordials":40,"./utils":35,_process:18}],24:[function(e,t,r){const{ObjectDefineProperties:n,ObjectGetOwnPropertyDescriptor:i,ObjectKeys:o,ObjectSetPrototypeOf:a}=e("../../ours/primordials");t.exports=c;const s=e("./readable"),l=e("./writable");a(c.prototype,s.prototype),a(c,s);{const e=o(l.prototype);for(let t=0;t<e.length;t++){const r=e[t];c.prototype[r]||(c.prototype[r]=l.prototype[r])}}function c(e){if(!(this instanceof c))return new c(e);s.call(this,e),l.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}let u,d;function h(){return void 0===u&&(u={}),u}n(c.prototype,{writable:i(l.prototype,"writable"),writableHighWaterMark:i(l.prototype,"writableHighWaterMark"),writableObjectMode:i(l.prototype,"writableObjectMode"),writableBuffer:i(l.prototype,"writableBuffer"),writableLength:i(l.prototype,"writableLength"),writableFinished:i(l.prototype,"writableFinished"),writableCorked:i(l.prototype,"writableCorked"),writableEnded:i(l.prototype,"writableEnded"),writableNeedDrain:i(l.prototype,"writableNeedDrain"),destroyed:{get(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),c.fromWeb=function(e,t){return h().newStreamDuplexFromReadableWritablePair(e,t)},c.toWeb=function(e){return h().newReadableWritablePairFromDuplex(e)},c.from=function(t){return d||(d=e("./duplexify")),d(t,"body")}},{"../../ours/primordials":40,"./duplexify":25,"./readable":32,"./writable":36}],25:[function(e,t,r){(function(r){(function(){const n=e("buffer"),{isReadable:i,isWritable:o,isIterable:a,isNodeStream:s,isReadableNodeStream:l,isWritableNodeStream:c,isDuplexNodeStream:u}=e("./utils"),d=e("./end-of-stream"),{AbortError:h,codes:{ERR_INVALID_ARG_TYPE:f,ERR_INVALID_RETURN_VALUE:p}}=e("../../ours/errors"),{destroyer:m}=e("./destroy"),y=e("./duplex"),g=e("./readable"),{createDeferredPromise:v}=e("../../ours/util"),w=e("./from"),b=globalThis.Blob||n.Blob,_=void 0!==b?function(e){return e instanceof b}:function(e){return!1},E=globalThis.AbortController||e("abort-controller").AbortController,{FunctionPrototypeCall:T}=e("../../ours/primordials");class x extends y{constructor(e){super(e),!1===(null==e?void 0:e.readable)&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===(null==e?void 0:e.writable)&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function I(e){let{promise:t,resolve:n}=v();const i=new E,o=i.signal;return{value:e(async function*(){for(;;){const e=t;t=null;const{chunk:i,done:a,cb:s}=await e;if(r.nextTick(s),a)return;if(o.aborted)throw new h(void 0,{cause:o.reason});({promise:t,resolve:n}=v()),yield i}}(),{signal:o}),write(e,t,r){const i=n;n=null,i({chunk:e,done:!1,cb:r})},final(e){const t=n;n=null,t({done:!0,cb:e})},destroy(e,t){i.abort(),t(e)}}}function S(e){const t=e.readable&&"function"!=typeof e.readable.read?g.wrap(e.readable):e.readable,r=e.writable;let n,a,s,l,c,u=!!i(t),f=!!o(r);function p(e){const t=l;l=null,t?t(e):e?c.destroy(e):u||f||c.destroy()}return c=new x({readableObjectMode:!(null==t||!t.readableObjectMode),writableObjectMode:!(null==r||!r.writableObjectMode),readable:u,writable:f}),f&&(d(r,(e=>{f=!1,e&&m(t,e),p(e)})),c._write=function(e,t,i){r.write(e,t)?i():n=i},c._final=function(e){r.end(),a=e},r.on("drain",(function(){if(n){const e=n;n=null,e()}})),r.on("finish",(function(){if(a){const e=a;a=null,e()}}))),u&&(d(t,(e=>{u=!1,e&&m(t,e),p(e)})),t.on("readable",(function(){if(s){const e=s;s=null,e()}})),t.on("end",(function(){c.push(null)})),c._read=function(){for(;;){const e=t.read();if(null===e)return void(s=c._read);if(!c.push(e))return}}),c._destroy=function(e,i){e||null===l||(e=new h),s=null,n=null,a=null,null===l?i(e):(l=i,m(r,e),m(t,e))},c}t.exports=function e(t,n){if(u(t))return t;if(l(t))return S({readable:t});if(c(t))return S({writable:t});if(s(t))return S({writable:!1,readable:!1});if("function"==typeof t){const{value:e,write:i,final:o,destroy:s}=I(t);if(a(e))return w(x,e,{objectMode:!0,write:i,final:o,destroy:s});const l=null==e?void 0:e.then;if("function"==typeof l){let t;const n=T(l,e,(e=>{if(null!=e)throw new p("nully","body",e)}),(e=>{m(t,e)}));return t=new x({objectMode:!0,readable:!1,write:i,final(e){o((async()=>{try{await n,r.nextTick(e,null)}catch(t){r.nextTick(e,t)}}))},destroy:s})}throw new p("Iterable, AsyncIterable or AsyncFunction",n,e)}if(_(t))return e(t.arrayBuffer());if(a(t))return w(x,t,{objectMode:!0,writable:!1});if("object"==typeof(null==t?void 0:t.writable)||"object"==typeof(null==t?void 0:t.readable))return S({readable:null!=t&&t.readable?l(null==t?void 0:t.readable)?null==t?void 0:t.readable:e(t.readable):void 0,writable:null!=t&&t.writable?c(null==t?void 0:t.writable)?null==t?void 0:t.writable:e(t.writable):void 0});const i=null==t?void 0:t.then;if("function"==typeof i){let e;return T(i,t,(t=>{null!=t&&e.push(t),e.push(null)}),(t=>{m(e,t)})),e=new x({objectMode:!0,writable:!1,read(){}})}throw new f(n,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],t)}}).call(this)}).call(this,e("_process"))},{"../../ours/errors":39,"../../ours/primordials":40,"../../ours/util":41,"./destroy":23,"./duplex":24,"./end-of-stream":26,"./from":27,"./readable":32,"./utils":35,_process:18,"abort-controller":11,buffer:15}],26:[function(e,t,r){(function(r){(function(){const{AbortError:n,codes:i}=e("../../ours/errors"),{ERR_INVALID_ARG_TYPE:o,ERR_STREAM_PREMATURE_CLOSE:a}=i,{once:s}=e("../../ours/util"),{validateAbortSignal:l,validateFunction:c,validateObject:u}=e("../validators"),{Promise:d}=e("../../ours/primordials"),{isClosed:h,isReadable:f,isReadableNodeStream:p,isReadableFinished:m,isReadableErrored:y,isWritable:g,isWritableNodeStream:v,isWritableFinished:w,isWritableErrored:b,isNodeStream:_,willEmitClose:E}=e("./utils");function T(e){return e.setHeader&&"function"==typeof e.abort}const x=()=>{};function I(e,t,i){var d,I;2===arguments.length?(i=t,t={}):null==t?t={}:u(t,"options"),c(i,"callback"),l(t.signal,"options.signal"),i=s(i);const S=null!==(d=t.readable)&&void 0!==d?d:p(e),R=null!==(I=t.writable)&&void 0!==I?I:v(e);if(!_(e))throw new o("stream","Stream",e);const k=e._writableState,D=e._readableState,j=()=>{e.writable||C()};let N=E(e)&&p(e)===S&&v(e)===R,O=w(e,!1);const C=()=>{O=!0,e.destroyed&&(N=!1),(!N||e.readable&&!S)&&(S&&!A||i.call(e))};let A=m(e,!1);const M=()=>{A=!0,e.destroyed&&(N=!1),(!N||e.writable&&!R)&&(R&&!O||i.call(e))},L=t=>{i.call(e,t)};let P=h(e);const B=()=>{P=!0;const t=b(e)||y(e);return t&&"boolean"!=typeof t?i.call(e,t):S&&!A&&p(e,!0)&&!m(e,!1)?i.call(e,new a):!R||O||w(e,!1)?void i.call(e):i.call(e,new a)},$=()=>{e.req.on("finish",C)};T(e)?(e.on("complete",C),N||e.on("abort",B),e.req?$():e.on("request",$)):R&&!k&&(e.on("end",j),e.on("close",j)),N||"boolean"!=typeof e.aborted||e.on("aborted",B),e.on("end",M),e.on("finish",C),!1!==t.error&&e.on("error",L),e.on("close",B),P?r.nextTick(B):null!=k&&k.errorEmitted||null!=D&&D.errorEmitted?N||r.nextTick(B):(S||N&&!f(e)||!O&&!1!==g(e))&&(R||N&&!g(e)||!A&&!1!==f(e))?D&&e.req&&e.aborted&&r.nextTick(B):r.nextTick(B);const F=()=>{i=x,e.removeListener("aborted",B),e.removeListener("complete",C),e.removeListener("abort",B),e.removeListener("request",$),e.req&&e.req.removeListener("finish",C),e.removeListener("end",j),e.removeListener("close",j),e.removeListener("finish",C),e.removeListener("end",M),e.removeListener("error",L),e.removeListener("close",B)};if(t.signal&&!P){const o=()=>{const r=i;F(),r.call(e,new n(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)r.nextTick(o);else{const r=i;i=s(((...n)=>{t.signal.removeEventListener("abort",o),r.apply(e,n)})),t.signal.addEventListener("abort",o)}}return F}function S(e,t){return new d(((r,n)=>{I(e,t,(e=>{e?n(e):r()}))}))}t.exports=I,t.exports.finished=S}).call(this)}).call(this,e("_process"))},{"../../ours/errors":39,"../../ours/primordials":40,"../../ours/util":41,"../validators":37,"./utils":35,_process:18}],27:[function(e,t,r){(function(r,n){(function(){const{PromisePrototypeThen:i,SymbolAsyncIterator:o,SymbolIterator:a}=e("../../ours/primordials"),{ERR_INVALID_ARG_TYPE:s,ERR_STREAM_NULL_VALUES:l}=e("../../ours/errors").codes;function c(e,t,c){let u,d;if("string"==typeof t||t instanceof n)return new e({objectMode:!0,...c,read(){this.push(t),this.push(null)}});if(t&&t[o])d=!0,u=t[o]();else{if(!t||!t[a])throw new s("iterable",["Iterable"],t);d=!1,u=t[a]()}const h=new e({objectMode:!0,highWaterMark:1,...c});let f=!1;async function p(e){const t=null!=e,r="function"==typeof u.throw;if(t&&r){const{value:t,done:r}=await u.throw(e);if(await t,r)return}if("function"==typeof u.return){const{value:e}=await u.return();await e}}async function m(){for(;;){try{const{value:e,done:t}=d?await u.next():u.next();if(t)h.push(null);else{const t=e&&"function"==typeof e.then?await e:e;if(null===t)throw f=!1,new l;if(h.push(t))continue;f=!1}}catch(e){h.destroy(e)}break}}return h._read=function(){f||(f=!0,m())},h._destroy=function(e,t){i(p(e),(()=>r.nextTick(t,e)),(n=>r.nextTick(t,n||e)))},h}t.exports=c}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"../../ours/errors":39,"../../ours/primordials":40,_process:18,buffer:15}],28:[function(e,t,r){const{ArrayIsArray:n,ObjectSetPrototypeOf:i}=e("../../ours/primordials"),{EventEmitter:o}=e("events");function a(e){o.call(this,e)}function s(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?n(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}i(a.prototype,o.prototype),i(a,o),a.prototype.pipe=function(e,t){const r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",i),e._isStdio||t&&!1===t.end||(r.on("end",l),r.on("close",c));let a=!1;function l(){a||(a=!0,e.end())}function c(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){d(),0===o.listenerCount(this,"error")&&this.emit("error",e)}function d(){r.removeListener("data",n),e.removeListener("drain",i),r.removeListener("end",l),r.removeListener("close",c),r.removeListener("error",u),e.removeListener("error",u),r.removeListener("end",d),r.removeListener("close",d),e.removeListener("close",d)}return s(r,"error",u),s(e,"error",u),r.on("end",d),r.on("close",d),e.on("close",d),e.emit("pipe",r),e},t.exports={Stream:a,prependListener:s}},{"../../ours/primordials":40,events:16}],29:[function(e,t,r){const n=globalThis.AbortController||e("abort-controller").AbortController,{codes:{ERR_INVALID_ARG_TYPE:i,ERR_MISSING_ARGS:o,ERR_OUT_OF_RANGE:a},AbortError:s}=e("../../ours/errors"),{validateAbortSignal:l,validateInteger:c,validateObject:u}=e("../validators"),d=e("../../ours/primordials").Symbol("kWeak"),{finished:h}=e("./end-of-stream"),{ArrayPrototypePush:f,MathFloor:p,Number:m,NumberIsNaN:y,Promise:g,PromiseReject:v,PromisePrototypeCatch:w,Symbol:b}=e("../../ours/primordials"),_=b("kEmpty"),E=b("kEof");function T(e,t){if("function"!=typeof e)throw new i("fn",["Function","AsyncFunction"],e);null!=t&&u(t,"options"),null!=(null==t?void 0:t.signal)&&l(t.signal,"options.signal");let r=1;return null!=(null==t?void 0:t.concurrency)&&(r=p(t.concurrency)),c(r,"concurrency",1),async function*(){var i,o;const a=new n,l=this,c=[],u=a.signal,d={signal:u},h=()=>a.abort();let f,p;null!=t&&null!==(i=t.signal)&&void 0!==i&&i.aborted&&h(),null==t||null===(o=t.signal)||void 0===o||o.addEventListener("abort",h);let m=!1;function y(){m=!0}async function b(){try{for await(let t of l){var n;if(m)return;if(u.aborted)throw new s;try{t=e(t,d)}catch(e){t=v(e)}t!==_&&("function"==typeof(null===(n=t)||void 0===n?void 0:n.catch)&&t.catch(y),c.push(t),f&&(f(),f=null),!m&&c.length&&c.length>=r&&await new g((e=>{p=e})))}c.push(E)}catch(e){const t=v(e);w(t,y),c.push(t)}finally{var i;m=!0,f&&(f(),f=null),null==t||null===(i=t.signal)||void 0===i||i.removeEventListener("abort",h)}}b();try{for(;;){for(;c.length>0;){const e=await c[0];if(e===E)return;if(u.aborted)throw new s;e!==_&&(yield e),c.shift(),p&&(p(),p=null)}await new g((e=>{f=e}))}}finally{a.abort(),m=!0,p&&(p(),p=null)}}.call(this)}function x(e=void 0){return null!=e&&u(e,"options"),null!=(null==e?void 0:e.signal)&&l(e.signal,"options.signal"),async function*(){let t=0;for await(const n of this){var r;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new s({cause:e.signal.reason});yield[t++,n]}}.call(this)}async function I(e,t=void 0){for await(const r of D.call(this,e,t))return!0;return!1}async function S(e,t=void 0){if("function"!=typeof e)throw new i("fn",["Function","AsyncFunction"],e);return!await I.call(this,(async(...t)=>!await e(...t)),t)}async function R(e,t){for await(const r of D.call(this,e,t))return r}async function k(e,t){if("function"!=typeof e)throw new i("fn",["Function","AsyncFunction"],e);async function r(t,r){return await e(t,r),_}for await(const e of T.call(this,r,t));}function D(e,t){if("function"!=typeof e)throw new i("fn",["Function","AsyncFunction"],e);async function r(t,r){return await e(t,r)?t:_}return T.call(this,r,t)}class j extends o{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function N(e,t,r){var o;if("function"!=typeof e)throw new i("reducer",["Function","AsyncFunction"],e);null!=r&&u(r,"options"),null!=(null==r?void 0:r.signal)&&l(r.signal,"options.signal");let a=arguments.length>1;if(null!=r&&null!==(o=r.signal)&&void 0!==o&&o.aborted){const e=new s(void 0,{cause:r.signal.reason});throw this.once("error",(()=>{})),await h(this.destroy(e)),e}const c=new n,f=c.signal;if(null!=r&&r.signal){const e={once:!0,[d]:this};r.signal.addEventListener("abort",(()=>c.abort()),e)}let p=!1;try{for await(const n of this){var m;if(p=!0,null!=r&&null!==(m=r.signal)&&void 0!==m&&m.aborted)throw new s;a?t=await e(t,n,{signal:f}):(t=n,a=!0)}if(!p&&!a)throw new j}finally{c.abort()}return t}async function O(e){null!=e&&u(e,"options"),null!=(null==e?void 0:e.signal)&&l(e.signal,"options.signal");const t=[];for await(const n of this){var r;if(null!=e&&null!==(r=e.signal)&&void 0!==r&&r.aborted)throw new s(void 0,{cause:e.signal.reason});f(t,n)}return t}function C(e,t){const r=T.call(this,e,t);return async function*(){for await(const e of r)yield*e}.call(this)}function A(e){if(e=m(e),y(e))return 0;if(e<0)throw new a("number",">= 0",e);return e}function M(e,t=void 0){return null!=t&&u(t,"options"),null!=(null==t?void 0:t.signal)&&l(t.signal,"options.signal"),e=A(e),async function*(){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new s;for await(const r of this){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new s;e--<=0&&(yield r)}}.call(this)}function L(e,t=void 0){return null!=t&&u(t,"options"),null!=(null==t?void 0:t.signal)&&l(t.signal,"options.signal"),e=A(e),async function*(){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new s;for await(const r of this){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new s;if(!(e-- >0))return;yield r}}.call(this)}t.exports.streamReturningOperators={asIndexedPairs:x,drop:M,filter:D,flatMap:C,map:T,take:L},t.exports.promiseReturningOperators={every:S,forEach:k,reduce:N,toArray:O,some:I,find:R}},{"../../ours/errors":39,"../../ours/primordials":40,"../validators":37,"./end-of-stream":26,"abort-controller":11}],30:[function(e,t,r){const{ObjectSetPrototypeOf:n}=e("../../ours/primordials");t.exports=o;const i=e("./transform");function o(e){if(!(this instanceof o))return new o(e);i.call(this,e)}n(o.prototype,i.prototype),n(o,i),o.prototype._transform=function(e,t,r){r(null,e)}},{"../../ours/primordials":40,"./transform":34}],31:[function(e,t,r){(function(r){(function(){const{ArrayIsArray:n,Promise:i,SymbolAsyncIterator:o}=e("../../ours/primordials"),a=e("./end-of-stream"),{once:s}=e("../../ours/util"),l=e("./destroy"),c=e("./duplex"),{aggregateTwoErrors:u,codes:{ERR_INVALID_ARG_TYPE:d,ERR_INVALID_RETURN_VALUE:h,ERR_MISSING_ARGS:f,ERR_STREAM_DESTROYED:p},AbortError:m}=e("../../ours/errors"),{validateFunction:y,validateAbortSignal:g}=e("../validators"),{isIterable:v,isReadable:w,isReadableNodeStream:b,isNodeStream:_}=e("./utils"),E=globalThis.AbortController||e("abort-controller").AbortController;let T,x;function I(e,t,r){let n=!1;return e.on("close",(()=>{n=!0})),{destroy:t=>{n||(n=!0,l.destroyer(e,t||new p("pipe")))},cleanup:a(e,{readable:t,writable:r},(e=>{n=!e}))}}function S(e){return y(e[e.length-1],"streams[stream.length - 1]"),e.pop()}function R(e){if(v(e))return e;if(b(e))return k(e);throw new d("val",["Readable","Iterable","AsyncIterable"],e)}async function*k(t){x||(x=e("./readable")),yield*x.prototype[o].call(t)}async function D(e,t,r,{end:n}){let o,s=null;const l=e=>{if(e&&(o=e),s){const e=s;s=null,e()}},c=()=>new i(((e,t)=>{o?t(o):s=()=>{o?t(o):e()}}));t.on("drain",l);const d=a(t,{readable:!1},l);try{t.writableNeedDrain&&await c();for await(const r of e)t.write(r)||await c();n&&t.end(),await c(),r()}catch(e){r(o!==e?u(o,e):e)}finally{d(),t.off("drain",l)}}function j(...e){return N(e,s(S(e)))}function N(t,i,o){if(1===t.length&&n(t[0])&&(t=t[0]),t.length<2)throw new f("streams");const a=new E,s=a.signal,l=null==o?void 0:o.signal,u=[];function p(){C(new m)}let y,x;g(l,"options.signal"),null==l||l.addEventListener("abort",p);const S=[];let k,j=0;function N(e){C(e,0==--j)}function C(e,t){if(!e||y&&"ERR_STREAM_PREMATURE_CLOSE"!==y.code||(y=e),y||t){for(;S.length;)S.shift()(y);null==l||l.removeEventListener("abort",p),a.abort(),t&&(y||u.forEach((e=>e())),r.nextTick(i,y,x))}}for(let M=0;M<t.length;M++){const L=t[M],P=M<t.length-1,B=M>0,$=P||!1!==(null==o?void 0:o.end),F=M===t.length-1;if(_(L)){if($){const{destroy:q,cleanup:Y}=I(L,P,B);S.push(q),w(L)&&F&&u.push(Y)}function U(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&N(e)}L.on("error",U),w(L)&&F&&u.push((()=>{L.removeListener("error",U)}))}if(0===M)if("function"==typeof L){if(k=L({signal:s}),!v(k))throw new h("Iterable, AsyncIterable or Stream","source",k)}else k=v(L)||b(L)?L:c.from(L);else if("function"==typeof L)if(k=R(k),k=L(k,{signal:s}),P){if(!v(k,!0))throw new h("AsyncIterable",`transform[${M-1}]`,k)}else{var A;T||(T=e("./passthrough"));const W=new T({objectMode:!0}),z=null===(A=k)||void 0===A?void 0:A.then;if("function"==typeof z)j++,z.call(k,(e=>{x=e,null!=e&&W.write(e),$&&W.end(),r.nextTick(N)}),(e=>{W.destroy(e),r.nextTick(N,e)}));else{if(!v(k,!0))throw new h("AsyncIterable or Promise","destination",k);j++,D(k,W,N,{end:$})}k=W;const{destroy:G,cleanup:J}=I(k,!1,!0);S.push(G),F&&u.push(J)}else if(_(L)){if(b(k)){j+=2;const H=O(k,L,N,{end:$});w(L)&&F&&u.push(H)}else{if(!v(k))throw new d("val",["Readable","Iterable","AsyncIterable"],k);j++,D(k,L,N,{end:$})}k=L}else k=c.from(L)}return(null!=s&&s.aborted||null!=l&&l.aborted)&&r.nextTick(p),k}function O(e,t,r,{end:n}){return e.pipe(t,{end:n}),n?e.once("end",(()=>t.end())):r(),a(e,{readable:!0,writable:!1},(t=>{const n=e._readableState;t&&"ERR_STREAM_PREMATURE_CLOSE"===t.code&&n&&n.ended&&!n.errored&&!n.errorEmitted?e.once("end",r).once("error",r):r(t)})),a(t,{readable:!1,writable:!0},r)}t.exports={pipelineImpl:N,pipeline:j}}).call(this)}).call(this,e("_process"))},{"../../ours/errors":39,"../../ours/primordials":40,"../../ours/util":41,"../validators":37,"./destroy":23,"./duplex":24,"./end-of-stream":26,"./passthrough":30,"./readable":32,"./utils":35,_process:18,"abort-controller":11}],32:[function(e,t,r){(function(r,n){(function(){const{ArrayPrototypeIndexOf:i,NumberIsInteger:o,NumberIsNaN:a,NumberParseInt:s,ObjectDefineProperties:l,ObjectKeys:c,ObjectSetPrototypeOf:u,Promise:d,SafeSet:h,SymbolAsyncIterator:f,Symbol:p}=e("../../ours/primordials");t.exports=B,B.ReadableState=P;const{EventEmitter:m}=e("events"),{Stream:y,prependListener:g}=e("./legacy"),{addAbortSignal:v}=e("./add-abort-signal"),w=e("./end-of-stream");let b=e("../../ours/util").debuglog("stream",(e=>{b=e}));const _=e("./buffer_list"),E=e("./destroy"),{getHighWaterMark:T,getDefaultHighWaterMark:x}=e("./state"),{aggregateTwoErrors:I,codes:{ERR_INVALID_ARG_TYPE:S,ERR_METHOD_NOT_IMPLEMENTED:R,ERR_OUT_OF_RANGE:k,ERR_STREAM_PUSH_AFTER_EOF:D,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:j}}=e("../../ours/errors"),{validateObject:N}=e("../validators"),O=p("kPaused"),{StringDecoder:C}=e("string_decoder"),A=e("./from");u(B.prototype,y.prototype),u(B,y);const M=()=>{},{errorOrDestroy:L}=E;function P(t,r,n){"boolean"!=typeof n&&(n=r instanceof e("./duplex")),this.objectMode=!(!t||!t.objectMode),n&&(this.objectMode=this.objectMode||!(!t||!t.readableObjectMode)),this.highWaterMark=t?T(this,t,"readableHighWaterMark",n):x(!1),this.buffer=new _,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[O]=null,this.errorEmitted=!1,this.emitClose=!t||!1!==t.emitClose,this.autoDestroy=!t||!1!==t.autoDestroy,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=t&&t.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,t&&t.encoding&&(this.decoder=new C(t.encoding),this.encoding=t.encoding)}function B(t){if(!(this instanceof B))return new B(t);const r=this instanceof e("./duplex");this._readableState=new P(t,this,r),t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.construct&&(this._construct=t.construct),t.signal&&!r&&v(t.signal,this)),y.call(this,t),E.construct(this,(()=>{this._readableState.needReadable&&J(this,this._readableState)}))}function $(e,t,r,i){b("readableAddChunk",t);const o=e._readableState;let a;if(o.objectMode||("string"==typeof t?(r=r||o.defaultEncoding,o.encoding!==r&&(i&&o.encoding?t=n.from(t,r).toString(o.encoding):(t=n.from(t,r),r=""))):t instanceof n?r="":y._isUint8Array(t)?(t=y._uint8ArrayToBuffer(t),r=""):null!=t&&(a=new S("chunk",["string","Buffer","Uint8Array"],t))),a)L(e,a);else if(null===t)o.reading=!1,W(e,o);else if(o.objectMode||t&&t.length>0)if(i)if(o.endEmitted)L(e,new j);else{if(o.destroyed||o.errored)return!1;F(e,o,t,!0)}else if(o.ended)L(e,new D);else{if(o.destroyed||o.errored)return!1;o.reading=!1,o.decoder&&!r?(t=o.decoder.write(t),o.objectMode||0!==t.length?F(e,o,t,!1):J(e,o)):F(e,o,t,!1)}else i||(o.reading=!1,J(e,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function F(e,t,r,n){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",r)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&z(e)),J(e,t)}B.prototype.destroy=E.destroy,B.prototype._undestroy=E.undestroy,B.prototype._destroy=function(e,t){t(e)},B.prototype[m.captureRejectionSymbol]=function(e){this.destroy(e)},B.prototype.push=function(e,t){return $(this,e,t,!1)},B.prototype.unshift=function(e,t){return $(this,e,t,!0)},B.prototype.isPaused=function(){const e=this._readableState;return!0===e[O]||!1===e.flowing},B.prototype.setEncoding=function(e){const t=new C(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;const r=this._readableState.buffer;let n="";for(const e of r)n+=t.write(e);return r.clear(),""!==n&&r.push(n),this._readableState.length=n.length,this};const U=1073741824;function q(e){if(e>U)throw new k("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e}function Y(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:a(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function W(e,t){if(b("onEofChunk"),!t.ended){if(t.decoder){const e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,t.sync?z(e):(t.needReadable=!1,t.emittedReadable=!0,G(e))}}function z(e){const t=e._readableState;b("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(b("emitReadable",t.flowing),t.emittedReadable=!0,r.nextTick(G,e))}function G(e){const t=e._readableState;b("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||t.errored||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,ee(e)}function J(e,t){!t.readingMore&&t.constructed&&(t.readingMore=!0,r.nextTick(H,e,t))}function H(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){const r=t.length;if(b("maybeReadMore read 0"),e.read(0),r===t.length)break}t.readingMore=!1}function V(e,t){return function(){const r=e._readableState;r.awaitDrainWriters===t?(b("pipeOnDrain",1),r.awaitDrainWriters=null):r.multiAwaitDrain&&(b("pipeOnDrain",r.awaitDrainWriters.size),r.awaitDrainWriters.delete(t)),r.awaitDrainWriters&&0!==r.awaitDrainWriters.size||!e.listenerCount("data")||e.resume()}}function Q(e){const t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[O]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function Z(e){b("readable nexttick read 0"),e.read(0)}function K(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(X,e,t))}function X(e,t){b("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),ee(e),t.flowing&&!t.reading&&e.read(0)}function ee(e){const t=e._readableState;for(b("flow",t.flowing);t.flowing&&null!==e.read(););}function te(e,t){"function"!=typeof e.read&&(e=B.wrap(e,{objectMode:!0}));const r=re(e,t);return r.stream=e,r}async function*re(e,t){let r,n=M;function i(t){this===e?(n(),n=M):n=t}e.on("readable",i);const o=w(e,{writable:!1},(e=>{r=e?I(r,e):null,n(),n=M}));try{for(;;){const t=e.destroyed?null:e.read();if(null!==t)yield t;else{if(r)throw r;if(null===r)return;await new d(i)}}}catch(e){throw r=I(r,e),r}finally{!r&&!1===(null==t?void 0:t.destroyOnReturn)||void 0!==r&&!e._readableState.autoDestroy?(e.off("readable",i),o()):E.destroyer(e,null)}}function ne(e,t){if(0===t.length)return null;let r;return t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):r=t.buffer.consume(e,t.decoder),r}function ie(e){const t=e._readableState;b("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,r.nextTick(oe,t,e))}function oe(e,t){if(b("endReadableNT",e.endEmitted,e.length),!e.errored&&!e.closeEmitted&&!e.endEmitted&&0===e.length)if(e.endEmitted=!0,t.emit("end"),t.writable&&!1===t.allowHalfOpen)r.nextTick(ae,t);else if(e.autoDestroy){const e=t._writableState;(!e||e.autoDestroy&&(e.finished||!1===e.writable))&&t.destroy()}}function ae(e){e.writable&&!e.writableEnded&&!e.destroyed&&e.end()}let se;function le(){return void 0===se&&(se={}),se}B.prototype.read=function(e){b("read",e),void 0===e?e=NaN:o(e)||(e=s(e,10));const t=this._readableState,r=e;if(e>t.highWaterMark&&(t.highWaterMark=q(e)),0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return b("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?ie(this):z(this),null;if(0===(e=Y(e,t))&&t.ended)return 0===t.length&&ie(this),null;let n,i=t.needReadable;if(b("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&(i=!0,b("length less than watermark",i)),t.ended||t.reading||t.destroyed||t.errored||!t.constructed)i=!1,b("reading, ended or constructing",i);else if(i){b("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0);try{this._read(t.highWaterMark)}catch(e){L(this,e)}t.sync=!1,t.reading||(e=Y(r,t))}return n=e>0?ne(e,t):null,null===n?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&ie(this)),null===n||t.errorEmitted||t.closeEmitted||(t.dataEmitted=!0,this.emit("data",n)),n},B.prototype._read=function(e){throw new R("_read()")},B.prototype.pipe=function(e,t){const n=this,i=this._readableState;1===i.pipes.length&&(i.multiAwaitDrain||(i.multiAwaitDrain=!0,i.awaitDrainWriters=new h(i.awaitDrainWriters?[i.awaitDrainWriters]:[]))),i.pipes.push(e),b("pipe count=%d opts=%j",i.pipes.length,t);const o=t&&!1===t.end||e===r.stdout||e===r.stderr?v:s;function a(e,t){b("onunpipe"),e===n&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,u())}function s(){b("onend"),e.end()}let l;i.endEmitted?r.nextTick(o):n.once("end",o),e.on("unpipe",a);let c=!1;function u(){b("cleanup"),e.removeListener("close",m),e.removeListener("finish",y),l&&e.removeListener("drain",l),e.removeListener("error",p),e.removeListener("unpipe",a),n.removeListener("end",s),n.removeListener("end",v),n.removeListener("data",f),c=!0,l&&i.awaitDrainWriters&&(!e._writableState||e._writableState.needDrain)&&l()}function d(){c||(1===i.pipes.length&&i.pipes[0]===e?(b("false write response, pause",0),i.awaitDrainWriters=e,i.multiAwaitDrain=!1):i.pipes.length>1&&i.pipes.includes(e)&&(b("false write response, pause",i.awaitDrainWriters.size),i.awaitDrainWriters.add(e)),n.pause()),l||(l=V(n,e),e.on("drain",l))}function f(t){b("ondata");const r=e.write(t);b("dest.write",r),!1===r&&d()}function p(t){if(b("onerror",t),v(),e.removeListener("error",p),0===e.listenerCount("error")){const r=e._writableState||e._readableState;r&&!r.errorEmitted?L(e,t):e.emit("error",t)}}function m(){e.removeListener("finish",y),v()}function y(){b("onfinish"),e.removeListener("close",m),v()}function v(){b("unpipe"),n.unpipe(e)}return n.on("data",f),g(e,"error",p),e.once("close",m),e.once("finish",y),e.emit("pipe",n),!0===e.writableNeedDrain?i.flowing&&d():i.flowing||(b("pipe resume"),n.resume()),e},B.prototype.unpipe=function(e){const t=this._readableState,r={hasUnpiped:!1};if(0===t.pipes.length)return this;if(!e){const e=t.pipes;t.pipes=[],this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:!1});return this}const n=i(t.pipes,e);return-1===n||(t.pipes.splice(n,1),0===t.pipes.length&&this.pause(),e.emit("unpipe",this,r)),this},B.prototype.on=function(e,t){const n=y.prototype.on.call(this,e,t),i=this._readableState;return"data"===e?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===e&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,b("on readable",i.length,i.reading),i.length?z(this):i.reading||r.nextTick(Z,this))),n},B.prototype.addListener=B.prototype.on,B.prototype.removeListener=function(e,t){const n=y.prototype.removeListener.call(this,e,t);return"readable"===e&&r.nextTick(Q,this),n},B.prototype.off=B.prototype.removeListener,B.prototype.removeAllListeners=function(e){const t=y.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||r.nextTick(Q,this),t},B.prototype.resume=function(){const e=this._readableState;return e.flowing||(b("resume"),e.flowing=!e.readableListening,K(this,e)),e[O]=!1,this},B.prototype.pause=function(){return b("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(b("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[O]=!0,this},B.prototype.wrap=function(e){let t=!1;e.on("data",(r=>{!this.push(r)&&e.pause&&(t=!0,e.pause())})),e.on("end",(()=>{this.push(null)})),e.on("error",(e=>{L(this,e)})),e.on("close",(()=>{this.destroy()})),e.on("destroy",(()=>{this.destroy()})),this._read=()=>{t&&e.resume&&(t=!1,e.resume())};const r=c(e);for(let t=1;t<r.length;t++){const n=r[t];void 0===this[n]&&"function"==typeof e[n]&&(this[n]=e[n].bind(e))}return this},B.prototype[f]=function(){return te(this)},B.prototype.iterator=function(e){return void 0!==e&&N(e,"options"),te(this,e)},l(B.prototype,{readable:{get(){const e=this._readableState;return!(!e||!1===e.readable||e.destroyed||e.errorEmitted||e.endEmitted)},set(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{enumerable:!1,get:function(){return!(!1===this._readableState.readable||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{get(){return!!this._readableState&&this._readableState.closed}},destroyed:{enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),l(P.prototype,{pipesCount:{get(){return this.pipes.length}},paused:{get(){return!1!==this[O]},set(e){this[O]=!!e}}}),B._fromList=ne,B.from=function(e,t){return A(B,e,t)},B.fromWeb=function(e,t){return le().newStreamReadableFromReadableStream(e,t)},B.toWeb=function(e){return le().newReadableStreamFromStreamReadable(e)},B.wrap=function(e,t){var r,n;return new B({objectMode:null===(r=null!==(n=e.readableObjectMode)&&void 0!==n?n:e.objectMode)||void 0===r||r,...t,destroy(t,r){E.destroyer(e,t),r(t)}}).wrap(e)}}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"../../ours/errors":39,"../../ours/primordials":40,"../../ours/util":41,"../validators":37,"./add-abort-signal":20,"./buffer_list":21,"./destroy":23,"./duplex":24,"./end-of-stream":26,"./from":27,"./legacy":28,"./state":33,_process:18,buffer:15,events:16,string_decoder:14}],33:[function(e,t,r){const{MathFloor:n,NumberIsInteger:i}=e("../../ours/primordials"),{ERR_INVALID_ARG_VALUE:o}=e("../../ours/errors").codes;function a(e,t,r){return null!=e.highWaterMark?e.highWaterMark:t?e[r]:null}function s(e){return e?16:16384}function l(e,t,r,l){const c=a(t,l,r);if(null!=c){if(!i(c)||c<0)throw new o(l?`options.${r}`:"options.highWaterMark",c);return n(c)}return s(e.objectMode)}t.exports={getHighWaterMark:l,getDefaultHighWaterMark:s}},{"../../ours/errors":39,"../../ours/primordials":40}],34:[function(e,t,r){const{ObjectSetPrototypeOf:n,Symbol:i}=e("../../ours/primordials");t.exports=l;const{ERR_METHOD_NOT_IMPLEMENTED:o}=e("../../ours/errors").codes,a=e("./duplex");n(l.prototype,a.prototype),n(l,a);const s=i("kCallback");function l(e){if(!(this instanceof l))return new l(e);a.call(this,e),this._readableState.sync=!1,this[s]=null,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",u)}function c(e){"function"!=typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush(((t,r)=>{t?e?e(t):this.destroy(t):(null!=r&&this.push(r),this.push(null),e&&e())}))}function u(){this._final!==c&&c.call(this)}l.prototype._final=c,l.prototype._transform=function(e,t,r){throw new o("_transform()")},l.prototype._write=function(e,t,r){const n=this._readableState,i=this._writableState,o=n.length;this._transform(e,t,((e,t)=>{e?r(e):(null!=t&&this.push(t),i.ended||o===n.length||n.length<n.highWaterMark||0===n.highWaterMark||0===n.length?r():this[s]=r)}))},l.prototype._read=function(){if(this[s]){const e=this[s];this[s]=null,e()}}},{"../../ours/errors":39,"../../ours/primordials":40,"./duplex":24}],35:[function(e,t,r){const{Symbol:n,SymbolAsyncIterator:i,SymbolIterator:o}=e("../../ours/primordials"),a=n("kDestroyed"),s=n("kIsErrored"),l=n("kIsReadable"),c=n("kIsDisturbed");function u(e,t=!1){var r;return!(!e||"function"!=typeof e.pipe||"function"!=typeof e.on||t&&("function"!=typeof e.pause||"function"!=typeof e.resume)||e._writableState&&!1===(null===(r=e._readableState)||void 0===r?void 0:r.readable)||e._writableState&&!e._readableState)}function d(e){var t;return!(!e||"function"!=typeof e.write||"function"!=typeof e.on||e._readableState&&!1===(null===(t=e._writableState)||void 0===t?void 0:t.writable))}function h(e){return!(!e||"function"!=typeof e.pipe||!e._readableState||"function"!=typeof e.on||"function"!=typeof e.write)}function f(e){return e&&(e._readableState||e._writableState||"function"==typeof e.write&&"function"==typeof e.on||"function"==typeof e.pipe&&"function"==typeof e.on)}function p(e,t){return null!=e&&(!0===t?"function"==typeof e[i]:!1===t?"function"==typeof e[o]:"function"==typeof e[i]||"function"==typeof e[o])}function m(e){if(!f(e))return null;const t=e._writableState,r=e._readableState,n=t||r;return!!(e.destroyed||e[a]||null!=n&&n.destroyed)}function y(e){if(!d(e))return null;if(!0===e.writableEnded)return!0;const t=e._writableState;return(null==t||!t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}function g(e,t){if(!d(e))return null;if(!0===e.writableFinished)return!0;const r=e._writableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.finished)?null:!!(r.finished||!1===t&&!0===r.ended&&0===r.length))}function v(e){if(!u(e))return null;if(!0===e.readableEnded)return!0;const t=e._readableState;return!(!t||t.errored)&&("boolean"!=typeof(null==t?void 0:t.ended)?null:t.ended)}function w(e,t){if(!u(e))return null;const r=e._readableState;return(null==r||!r.errored)&&("boolean"!=typeof(null==r?void 0:r.endEmitted)?null:!!(r.endEmitted||!1===t&&!0===r.ended&&0===r.length))}function b(e){return e&&null!=e[l]?e[l]:"boolean"!=typeof(null==e?void 0:e.readable)?null:!m(e)&&u(e)&&e.readable&&!w(e)}function _(e){return"boolean"!=typeof(null==e?void 0:e.writable)?null:!m(e)&&d(e)&&e.writable&&!y(e)}function E(e,t){return f(e)?!(!m(e)&&(!1!==(null==t?void 0:t.readable)&&b(e)||!1!==(null==t?void 0:t.writable)&&_(e))):null}function T(e){var t,r;return f(e)?e.writableErrored?e.writableErrored:null!==(t=null===(r=e._writableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null}function x(e){var t,r;return f(e)?e.readableErrored?e.readableErrored:null!==(t=null===(r=e._readableState)||void 0===r?void 0:r.errored)&&void 0!==t?t:null:null}function I(e){if(!f(e))return null;if("boolean"==typeof e.closed)return e.closed;const t=e._writableState,r=e._readableState;return"boolean"==typeof(null==t?void 0:t.closed)||"boolean"==typeof(null==r?void 0:r.closed)?(null==t?void 0:t.closed)||(null==r?void 0:r.closed):"boolean"==typeof e._closed&&S(e)?e._closed:null}function S(e){return"boolean"==typeof e._closed&&"boolean"==typeof e._defaultKeepAlive&&"boolean"==typeof e._removedConnection&&"boolean"==typeof e._removedContLen}function R(e){return"boolean"==typeof e._sent100&&S(e)}function k(e){var t;return"boolean"==typeof e._consuming&&"boolean"==typeof e._dumped&&void 0===(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)}function D(e){if(!f(e))return null;const t=e._writableState,r=e._readableState,n=t||r;return!n&&R(e)||!!(n&&n.autoDestroy&&n.emitClose&&!1===n.closed)}function j(e){var t;return!(!e||!(null!==(t=e[c])&&void 0!==t?t:e.readableDidRead||e.readableAborted))}function N(e){var t,r,n,i,o,a,l,c,u,d;return!(!e||!(null!==(t=null!==(r=null!==(n=null!==(i=null!==(o=null!==(a=e[s])&&void 0!==a?a:e.readableErrored)&&void 0!==o?o:e.writableErrored)&&void 0!==i?i:null===(l=e._readableState)||void 0===l?void 0:l.errorEmitted)&&void 0!==n?n:null===(c=e._writableState)||void 0===c?void 0:c.errorEmitted)&&void 0!==r?r:null===(u=e._readableState)||void 0===u?void 0:u.errored)&&void 0!==t?t:null===(d=e._writableState)||void 0===d?void 0:d.errored))}t.exports={kDestroyed:a,isDisturbed:j,kIsDisturbed:c,isErrored:N,kIsErrored:s,isReadable:b,kIsReadable:l,isClosed:I,isDestroyed:m,isDuplexNodeStream:h,isFinished:E,isIterable:p,isReadableNodeStream:u,isReadableEnded:v,isReadableFinished:w,isReadableErrored:x,isNodeStream:f,isWritable:_,isWritableNodeStream:d,isWritableEnded:y,isWritableFinished:g,isWritableErrored:T,isServerRequest:k,isServerResponse:R,willEmitClose:D}},{"../../ours/primordials":40}],36:[function(e,t,r){(function(r,n){(function(){const{ArrayPrototypeSlice:i,Error:o,FunctionPrototypeSymbolHasInstance:a,ObjectDefineProperty:s,ObjectDefineProperties:l,ObjectSetPrototypeOf:c,StringPrototypeToLowerCase:u,Symbol:d,SymbolHasInstance:h}=e("../../ours/primordials");t.exports=C,C.WritableState=N;const{EventEmitter:f}=e("events"),p=e("./legacy").Stream,m=e("./destroy"),{addAbortSignal:y}=e("./add-abort-signal"),{getHighWaterMark:g,getDefaultHighWaterMark:v}=e("./state"),{ERR_INVALID_ARG_TYPE:w,ERR_METHOD_NOT_IMPLEMENTED:b,ERR_MULTIPLE_CALLBACK:_,ERR_STREAM_CANNOT_PIPE:E,ERR_STREAM_DESTROYED:T,ERR_STREAM_ALREADY_FINISHED:x,ERR_STREAM_NULL_VALUES:I,ERR_STREAM_WRITE_AFTER_END:S,ERR_UNKNOWN_ENCODING:R}=e("../../ours/errors").codes,{errorOrDestroy:k}=m;function D(){}c(C.prototype,p.prototype),c(C,p);const j=d("kOnFinished");function N(t,r,n){"boolean"!=typeof n&&(n=r instanceof e("./duplex")),this.objectMode=!(!t||!t.objectMode),n&&(this.objectMode=this.objectMode||!(!t||!t.writableObjectMode)),this.highWaterMark=t?g(this,t,"writableHighWaterMark",n):v(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const i=!(!t||!1!==t.decodeStrings);this.decodeStrings=!i,this.defaultEncoding=t&&t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=B.bind(void 0,r),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,O(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!t||!1!==t.emitClose,this.autoDestroy=!t||!1!==t.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[j]=[]}function O(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function C(t){const r=this instanceof e("./duplex");if(!r&&!a(C,this))return new C(t);this._writableState=new N(t,this,r),t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final),"function"==typeof t.construct&&(this._construct=t.construct),t.signal&&y(t.signal,this)),p.call(this,t),m.construct(this,(()=>{const e=this._writableState;e.writing||q(this,e),G(this,e)}))}function A(e,t,i,o){const a=e._writableState;if("function"==typeof i)o=i,i=a.defaultEncoding;else{if(i){if("buffer"!==i&&!n.isEncoding(i))throw new R(i)}else i=a.defaultEncoding;"function"!=typeof o&&(o=D)}if(null===t)throw new I;if(!a.objectMode)if("string"==typeof t)!1!==a.decodeStrings&&(t=n.from(t,i),i="buffer");else if(t instanceof n)i="buffer";else{if(!p._isUint8Array(t))throw new w("chunk",["string","Buffer","Uint8Array"],t);t=p._uint8ArrayToBuffer(t),i="buffer"}let s;return a.ending?s=new S:a.destroyed&&(s=new T("write")),s?(r.nextTick(o,s),k(e,s,!0),s):(a.pendingcb++,M(e,a,t,i,o))}function M(e,t,r,n,i){const o=t.objectMode?1:r.length;t.length+=o;const a=t.length<t.highWaterMark;return a||(t.needDrain=!0),t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:r,encoding:n,callback:i}),t.allBuffers&&"buffer"!==n&&(t.allBuffers=!1),t.allNoop&&i!==D&&(t.allNoop=!1)):(t.writelen=o,t.writecb=i,t.writing=!0,t.sync=!0,e._write(r,n,t.onwrite),t.sync=!1),a&&!t.errored&&!t.destroyed}function L(e,t,r,n,i,o,a){t.writelen=n,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new T("write")):r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function P(e,t,r,n){--t.pendingcb,n(r),U(t),k(e,r)}function B(e,t){const n=e._writableState,i=n.sync,o=n.writecb;"function"==typeof o?(n.writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0,t?(n.errored||(n.errored=t),e._readableState&&!e._readableState.errored&&(e._readableState.errored=t),i?r.nextTick(P,e,n,t,o):P(e,n,t,o)):(n.buffered.length>n.bufferedIndex&&q(e,n),i?null!==n.afterWriteTickInfo&&n.afterWriteTickInfo.cb===o?n.afterWriteTickInfo.count++:(n.afterWriteTickInfo={count:1,cb:o,stream:e,state:n},r.nextTick($,n.afterWriteTickInfo)):F(e,n,1,o))):k(e,new _)}function $({stream:e,state:t,count:r,cb:n}){return t.afterWriteTickInfo=null,F(e,t,r,n)}function F(e,t,r,n){for(!t.ending&&!e.destroyed&&0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"));r-- >0;)t.pendingcb--,n();t.destroyed&&U(t),G(e,t)}function U(e){if(e.writing)return;for(let r=e.bufferedIndex;r<e.buffered.length;++r){var t;const{chunk:n,callback:i}=e.buffered[r],o=e.objectMode?1:n.length;e.length-=o,i(null!==(t=e.errored)&&void 0!==t?t:new T("write"))}const r=e[j].splice(0);for(let t=0;t<r.length;t++){var n;r[t](null!==(n=e.errored)&&void 0!==n?n:new T("end"))}O(e)}function q(e,t){if(t.corked||t.bufferProcessing||t.destroyed||!t.constructed)return;const{buffered:r,bufferedIndex:n,objectMode:o}=t,a=r.length-n;if(!a)return;let s=n;if(t.bufferProcessing=!0,a>1&&e._writev){t.pendingcb-=a-1;const n=t.allNoop?D:e=>{for(let t=s;t<r.length;++t)r[t].callback(e)},o=t.allNoop&&0===s?r:i(r,s);o.allBuffers=t.allBuffers,L(e,t,!0,t.length,o,"",n),O(t)}else{do{const{chunk:n,encoding:i,callback:a}=r[s];r[s++]=null,L(e,t,!1,o?1:n.length,n,i,a)}while(s<r.length&&!t.writing);s===r.length?O(t):s>256?(r.splice(0,s),t.bufferedIndex=0):t.bufferedIndex=s}t.bufferProcessing=!1}function Y(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function W(e,t){let n=!1;function i(i){if(n)k(e,null!=i?i:_());else if(n=!0,t.pendingcb--,i){const r=t[j].splice(0);for(let e=0;e<r.length;e++)r[e](i);k(e,i,t.sync)}else Y(t)&&(t.prefinished=!0,e.emit("prefinish"),t.pendingcb++,r.nextTick(J,e,t))}t.sync=!0,t.pendingcb++;try{e._final(i)}catch(e){i(e)}t.sync=!1}function z(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.finalCalled=!0,W(e,t)))}function G(e,t,n){Y(t)&&(z(e,t),0===t.pendingcb&&(n?(t.pendingcb++,r.nextTick(((e,t)=>{Y(t)?J(e,t):t.pendingcb--}),e,t)):Y(t)&&(t.pendingcb++,J(e,t))))}function J(e,t){t.pendingcb--,t.finished=!0;const r=t[j].splice(0);for(let e=0;e<r.length;e++)r[e]();if(e.emit("finish"),t.autoDestroy){const t=e._readableState;(!t||t.autoDestroy&&(t.endEmitted||!1===t.readable))&&e.destroy()}}N.prototype.getBuffer=function(){return i(this.buffered,this.bufferedIndex)},s(N.prototype,"bufferedRequestCount",{get(){return this.buffered.length-this.bufferedIndex}}),s(C,h,{value:function(e){return!!a(this,e)||this===C&&e&&e._writableState instanceof N}}),C.prototype.pipe=function(){k(this,new E)},C.prototype.write=function(e,t,r){return!0===A(this,e,t,r)},C.prototype.cork=function(){this._writableState.corked++},C.prototype.uncork=function(){const e=this._writableState;e.corked&&(e.corked--,e.writing||q(this,e))},C.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=u(e)),!n.isEncoding(e))throw new R(e);return this._writableState.defaultEncoding=e,this},C.prototype._write=function(e,t,r){if(!this._writev)throw new b("_write()");this._writev([{chunk:e,encoding:t}],r)},C.prototype._writev=null,C.prototype.end=function(e,t,n){const i=this._writableState;let a;if("function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e){const r=A(this,e,t);r instanceof o&&(a=r)}return i.corked&&(i.corked=1,this.uncork()),a||(i.errored||i.ending?i.finished?a=new x("end"):i.destroyed&&(a=new T("end")):(i.ending=!0,G(this,i,!0),i.ended=!0)),"function"==typeof n&&(a||i.finished?r.nextTick(n,a):i[j].push(n)),this},l(C.prototype,{closed:{get(){return!!this._writableState&&this._writableState.closed}},destroyed:{get(){return!!this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{get(){const e=this._writableState;return!(!e||!1===e.writable||e.destroyed||e.errored||e.ending||e.ended)},set(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{get(){const e=this._writableState;return!!e&&!e.destroyed&&!e.ending&&e.needDrain}},writableHighWaterMark:{get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{get(){return this._writableState?this._writableState.corked:0}},writableLength:{get(){return this._writableState&&this._writableState.length}},errored:{enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{enumerable:!1,get:function(){return!(!1===this._writableState.writable||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});const H=m.destroy;let V;function Q(){return void 0===V&&(V={}),V}C.prototype.destroy=function(e,t){const n=this._writableState;return!n.destroyed&&(n.bufferedIndex<n.buffered.length||n[j].length)&&r.nextTick(U,n),H.call(this,e,t),this},C.prototype._undestroy=m.undestroy,C.prototype._destroy=function(e,t){t(e)},C.prototype[f.captureRejectionSymbol]=function(e){this.destroy(e)},C.fromWeb=function(e,t){return Q().newStreamWritableFromWritableStream(e,t)},C.toWeb=function(e){return Q().newWritableStreamFromStreamWritable(e)}}).call(this)}).call(this,e("_process"),e("buffer").Buffer)},{"../../ours/errors":39,"../../ours/primordials":40,"./add-abort-signal":20,"./destroy":23,"./duplex":24,"./legacy":28,"./state":33,_process:18,buffer:15,events:16}],37:[function(e,t,r){const{ArrayIsArray:n,ArrayPrototypeIncludes:i,ArrayPrototypeJoin:o,ArrayPrototypeMap:a,NumberIsInteger:s,NumberMAX_SAFE_INTEGER:l,NumberMIN_SAFE_INTEGER:c,NumberParseInt:u,RegExpPrototypeTest:d,String:h,StringPrototypeToUpperCase:f,StringPrototypeTrim:p}=e("../ours/primordials"),{hideStackFrames:m,codes:{ERR_SOCKET_BAD_PORT:y,ERR_INVALID_ARG_TYPE:g,ERR_INVALID_ARG_VALUE:v,ERR_OUT_OF_RANGE:w,ERR_UNKNOWN_SIGNAL:b}}=e("../ours/errors"),{normalizeEncoding:_}=e("../ours/util"),{isAsyncFunction:E,isArrayBufferView:T}=e("../ours/util").types,x={};function I(e){return e===(0|e)}function S(e){return e===e>>>0}const R=/^[0-7]+$/,k="must be a 32-bit unsigned integer or an octal string";function D(e,t,r){if(void 0===e&&(e=r),"string"==typeof e){if(!d(R,e))throw new v(t,e,k);e=u(e,8)}return N(e,t,0,2**32-1),e}const j=m(((e,t,r=c,n=l)=>{if("number"!=typeof e)throw new g(t,"number",e);if(!s(e))throw new w(t,"an integer",e);if(e<r||e>n)throw new w(t,`>= ${r} && <= ${n}`,e)})),N=m(((e,t,r=-2147483648,n=2147483647)=>{if("number"!=typeof e)throw new g(t,"number",e);if(!I(e)){if(!s(e))throw new w(t,"an integer",e);throw new w(t,`>= ${r} && <= ${n}`,e)}if(e<r||e>n)throw new w(t,`>= ${r} && <= ${n}`,e)})),O=m(((e,t,r)=>{if("number"!=typeof e)throw new g(t,"number",e);if(!S(e)){if(!s(e))throw new w(t,"an integer",e);throw new w(t,`>= ${r?1:0} && < 4294967296`,e)}if(r&&0===e)throw new w(t,">= 1 && < 4294967296",e)}));function C(e,t){if("string"!=typeof e)throw new g(t,"string",e)}function A(e,t){if("number"!=typeof e)throw new g(t,"number",e)}const M=m(((e,t,r)=>{if(!i(r,e)){const n=o(a(r,(e=>"string"==typeof e?`'${e}'`:h(e))),", ");throw new v(t,e,"must be one of: "+n)}}));function L(e,t){if("boolean"!=typeof e)throw new g(t,"boolean",e)}const P=m(((e,t,r)=>{const i=null==r,o=!i&&r.allowArray,a=!i&&r.allowFunction;if((i||!r.nullable)&&null===e||!o&&n(e)||"object"!=typeof e&&(!a||"function"!=typeof e))throw new g(t,"Object",e)})),B=m(((e,t,r=0)=>{if(!n(e))throw new g(t,"Array",e);if(e.length<r)throw new v(t,e,`must be longer than ${r}`)}));function $(e,t="signal"){if(C(e,t),void 0===x[e]){if(void 0!==x[f(e)])throw new b(e+" (signals must use all capital letters)");throw new b(e)}}const F=m(((e,t="buffer")=>{if(!T(e))throw new g(t,["Buffer","TypedArray","DataView"],e)}));function U(e,t){const r=_(t),n=e.length;if("hex"===r&&n%2!=0)throw new v("encoding",t,`is invalid for data of length ${n}`)}function q(e,t="Port",r=!0){if("number"!=typeof e&&"string"!=typeof e||"string"==typeof e&&0===p(e).length||+e!=+e>>>0||e>65535||0===e&&!r)throw new y(t,e,r);return 0|e}const Y=m(((e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new g(t,"AbortSignal",e)})),W=m(((e,t)=>{if("function"!=typeof e)throw new g(t,"Function",e)})),z=m(((e,t)=>{if("function"!=typeof e||E(e))throw new g(t,"Function",e)})),G=m(((e,t)=>{if(void 0!==e)throw new g(t,"undefined",e)}));t.exports={isInt32:I,isUint32:S,parseFileMode:D,validateArray:B,validateBoolean:L,validateBuffer:F,validateEncoding:U,validateFunction:W,validateInt32:N,validateInteger:j,validateNumber:A,validateObject:P,validateOneOf:M,validatePlainFunction:z,validatePort:q,validateSignalName:$,validateString:C,validateUint32:O,validateUndefined:G,validateAbortSignal:Y}},{"../ours/errors":39,"../ours/primordials":40,"../ours/util":41}],38:[function(e,t,r){const n=e("../stream"),i=e("../stream/promises"),o=n.Readable.destroy;t.exports=n.Readable,t.exports._uint8ArrayToBuffer=n._uint8ArrayToBuffer,t.exports._isUint8Array=n._isUint8Array,t.exports.isDisturbed=n.isDisturbed,t.exports.isErrored=n.isErrored,t.exports.isReadable=n.isReadable,t.exports.Readable=n.Readable,t.exports.Writable=n.Writable,t.exports.Duplex=n.Duplex,t.exports.Transform=n.Transform,t.exports.PassThrough=n.PassThrough,t.exports.addAbortSignal=n.addAbortSignal,t.exports.finished=n.finished,t.exports.destroy=n.destroy,t.exports.destroy=o,t.exports.pipeline=n.pipeline,t.exports.compose=n.compose,Object.defineProperty(n,"promises",{configurable:!0,enumerable:!0,get:()=>i}),t.exports.Stream=n.Stream,t.exports.default=t.exports},{"../stream":42,"../stream/promises":43}],39:[function(e,t,r){const{format:n,inspect:i,AggregateError:o}=e("./util"),a=globalThis.AggregateError||o,s=Symbol("kIsNodeError"),l=["string","function","number","object","Function","Object","boolean","bigint","symbol"],c=/^([A-Z][a-z0-9]*)+$/,u="__node_internal_",d={};function h(e,t){if(!e)throw new d.ERR_INTERNAL_ASSERTION(t)}function f(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function p(e,t,r){if("function"==typeof t)return h(t.length<=r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${t.length}).`),t(...r);const i=(t.match(/%[dfijoOs]/g)||[]).length;return h(i===r.length,`Code: ${e}; The provided arguments length (${r.length}) does not match the required ones (${i}).`),0===r.length?t:n(t,...r)}function m(e,t,r){r||(r=Error);class n extends r{constructor(...r){super(p(e,t,r))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(n.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),n.prototype.code=e,n.prototype[s]=!0,d[e]=n}function y(e){const t=u+e.name;return Object.defineProperty(e,"name",{value:t}),e}function g(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const r=new a([t,e],t.message);return r.code=t.code,r}return e||t}class v extends Error{constructor(e="The operation was aborted",t=void 0){if(void 0!==t&&"object"!=typeof t)throw new d.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}}m("ERR_ASSERTION","%s",Error),m("ERR_INVALID_ARG_TYPE",((e,t,r)=>{h("string"==typeof e,"'name' must be a string"),Array.isArray(t)||(t=[t]);let n="The ";e.endsWith(" argument")?n+=`${e} `:n+=`"${e}" ${e.includes(".")?"property":"argument"} `,n+="must be ";const o=[],a=[],s=[];for(const e of t)h("string"==typeof e,"All expected entries have to be of type string"),l.includes(e)?o.push(e.toLowerCase()):c.test(e)?a.push(e):(h("object"!==e,'The value "object" should be written as "Object"'),s.push(e));if(a.length>0){const e=o.indexOf("object");-1!==e&&(o.splice(o,e,1),a.push("Object"))}if(o.length>0){switch(o.length){case 1:n+=`of type ${o[0]}`;break;case 2:n+=`one of type ${o[0]} or ${o[1]}`;break;default:{const e=o.pop();n+=`one of type ${o.join(", ")}, or ${e}`}}(a.length>0||s.length>0)&&(n+=" or ")}if(a.length>0){switch(a.length){case 1:n+=`an instance of ${a[0]}`;break;case 2:n+=`an instance of ${a[0]} or ${a[1]}`;break;default:{const e=a.pop();n+=`an instance of ${a.join(", ")}, or ${e}`}}s.length>0&&(n+=" or ")}switch(s.length){case 0:break;case 1:s[0].toLowerCase()!==s[0]&&(n+="an "),n+=`${s[0]}`;break;case 2:n+=`one of ${s[0]} or ${s[1]}`;break;default:{const e=s.pop();n+=`one of ${s.join(", ")}, or ${e}`}}if(null==r)n+=`. Received ${r}`;else if("function"==typeof r&&r.name)n+=`. Received function ${r.name}`;else if("object"==typeof r){var u;null!==(u=r.constructor)&&void 0!==u&&u.name?n+=`. Received an instance of ${r.constructor.name}`:n+=`. Received ${i(r,{depth:-1})}`}else{let e=i(r,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),n+=`. Received type ${typeof r} (${e})`}return n}),TypeError),m("ERR_INVALID_ARG_VALUE",((e,t,r="is invalid")=>{let n=i(t);return n.length>128&&(n=n.slice(0,128)+"..."),`The ${e.includes(".")?"property":"argument"} '${e}' ${r}. Received ${n}`}),TypeError),m("ERR_INVALID_RETURN_VALUE",((e,t,r)=>{var n;return`Expected ${e} to be returned from the "${t}" function but got ${null!=r&&null!==(n=r.constructor)&&void 0!==n&&n.name?`instance of ${r.constructor.name}`:"type "+typeof r}.`}),TypeError),m("ERR_MISSING_ARGS",((...e)=>{let t;h(e.length>0,"At least one arg needs to be specified");const r=e.length;switch(e=(Array.isArray(e)?e:[e]).map((e=>`"${e}"`)).join(" or "),r){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const r=e.pop();t+=`The ${e.join(", ")}, and ${r} arguments`}}return`${t} must be specified`}),TypeError),m("ERR_OUT_OF_RANGE",((e,t,r)=>{let n;return h(t,'Missing "range" argument'),Number.isInteger(r)&&Math.abs(r)>2**32?n=f(String(r)):"bigint"==typeof r?(n=String(r),(r>2n**32n||r<-(2n**32n))&&(n=f(n)),n+="n"):n=i(r),`The value of "${e}" is out of range. It must be ${t}. Received ${n}`}),RangeError),m("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),m("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),m("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),m("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),m("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),m("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),m("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),m("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),m("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),m("ERR_STREAM_WRITE_AFTER_END","write after end",Error),m("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),t.exports={AbortError:v,aggregateTwoErrors:y(g),hideStackFrames:y,codes:d}},{"./util":41}],40:[function(e,t,r){t.exports={ArrayIsArray:e=>Array.isArray(e),ArrayPrototypeIncludes:(e,t)=>e.includes(t),ArrayPrototypeIndexOf:(e,t)=>e.indexOf(t),ArrayPrototypeJoin:(e,t)=>e.join(t),ArrayPrototypeMap:(e,t)=>e.map(t),ArrayPrototypePop:(e,t)=>e.pop(t),ArrayPrototypePush:(e,t)=>e.push(t),ArrayPrototypeSlice:(e,t,r)=>e.slice(t,r),Error:Error,FunctionPrototypeCall:(e,t,...r)=>e.call(t,...r),FunctionPrototypeSymbolHasInstance:(e,t)=>Function.prototype[Symbol.hasInstance].call(e,t),MathFloor:Math.floor,Number:Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(e,t)=>Object.defineProperties(e,t),ObjectDefineProperty:(e,t,r)=>Object.defineProperty(e,t,r),ObjectGetOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(e,t),ObjectKeys:e=>Object.keys(e),ObjectSetPrototypeOf:(e,t)=>Object.setPrototypeOf(e,t),Promise:Promise,PromisePrototypeCatch:(e,t)=>e.catch(t),PromisePrototypeThen:(e,t,r)=>e.then(t,r),PromiseReject:e=>Promise.reject(e),ReflectApply:Reflect.apply,RegExpPrototypeTest:(e,t)=>e.test(t),SafeSet:Set,String:String,StringPrototypeSlice:(e,t,r)=>e.slice(t,r),StringPrototypeToLowerCase:e=>e.toLowerCase(),StringPrototypeToUpperCase:e=>e.toUpperCase(),StringPrototypeTrim:e=>e.trim(),Symbol:Symbol,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet:(e,t,r)=>e.set(t,r),Uint8Array:Uint8Array}},{}],41:[function(e,t,r){const n=e("buffer"),i=Object.getPrototypeOf((async function(){})).constructor,o=globalThis.Blob||n.Blob,a=void 0!==o?function(e){return e instanceof o}:function(e){return!1};class s extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t="";for(let r=0;r<e.length;r++)t+=`    ${e[r].stack}\n`;super(t),this.name="AggregateError",this.errors=e}}t.exports={AggregateError:s,once(e){let t=!1;return function(...r){t||(t=!0,e.apply(this,r))}},createDeferredPromise:function(){let e,t;return{promise:new Promise(((r,n)=>{e=r,t=n})),resolve:e,reject:t}},promisify:e=>new Promise(((t,r)=>{e(((e,...n)=>e?r(e):t(...n)))})),debuglog:()=>function(){},format:(e,...t)=>e.replace(/%([sdifj])/g,(function(...[e,r]){const n=t.shift();return"f"===r?n.toFixed(6):"j"===r?JSON.stringify(n):"s"===r&&"object"==typeof n?`${n.constructor!==Object?n.constructor.name:""} {}`.trim():n.toString()})),inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"'))return`"${e}"`;if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}},types:{isAsyncFunction:e=>e instanceof i,isArrayBufferView:e=>ArrayBuffer.isView(e)},isBlob:a},t.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")},{buffer:15}],42:[function(e,t,r){(function(r){(function(){const{ObjectDefineProperty:n,ObjectKeys:i,ReflectApply:o}=e("./ours/primordials"),{promisify:{custom:a}}=e("./ours/util"),{streamReturningOperators:s,promiseReturningOperators:l}=e("./internal/streams/operators"),{codes:{ERR_ILLEGAL_CONSTRUCTOR:c}}=e("./ours/errors"),u=e("./internal/streams/compose"),{pipeline:d}=e("./internal/streams/pipeline"),{destroyer:h}=e("./internal/streams/destroy"),f=e("./internal/streams/end-of-stream"),p=e("./stream/promises"),m=e("./internal/streams/utils"),y=t.exports=e("./internal/streams/legacy").Stream;y.isDisturbed=m.isDisturbed,y.isErrored=m.isErrored,y.isReadable=m.isReadable,y.Readable=e("./internal/streams/readable");for(const v of i(s)){const w=s[v];function b(...e){if(new.target)throw c();return y.Readable.from(o(w,this,e))}n(b,"name",{value:w.name}),n(b,"length",{value:w.length}),n(y.Readable.prototype,v,{value:b,enumerable:!1,configurable:!0,writable:!0})}for(const _ of i(l)){const E=l[_];function T(...e){if(new.target)throw c();return o(E,this,e)}n(T,"name",{value:E.name}),n(T,"length",{value:E.length}),n(y.Readable.prototype,_,{value:T,enumerable:!1,configurable:!0,writable:!0})}y.Writable=e("./internal/streams/writable"),y.Duplex=e("./internal/streams/duplex"),y.Transform=e("./internal/streams/transform"),y.PassThrough=e("./internal/streams/passthrough"),y.pipeline=d;const{addAbortSignal:g}=e("./internal/streams/add-abort-signal");y.addAbortSignal=g,y.finished=f,y.destroy=h,y.compose=u,n(y,"promises",{configurable:!0,enumerable:!0,get:()=>p}),n(d,a,{enumerable:!0,get:()=>p.pipeline}),n(f,a,{enumerable:!0,get:()=>p.finished}),y.Stream=y,y._isUint8Array=function(e){return e instanceof Uint8Array},y._uint8ArrayToBuffer=function(e){return r.from(e.buffer,e.byteOffset,e.byteLength)}}).call(this)}).call(this,e("buffer").Buffer)},{"./internal/streams/add-abort-signal":20,"./internal/streams/compose":22,"./internal/streams/destroy":23,"./internal/streams/duplex":24,"./internal/streams/end-of-stream":26,"./internal/streams/legacy":28,"./internal/streams/operators":29,"./internal/streams/passthrough":30,"./internal/streams/pipeline":31,"./internal/streams/readable":32,"./internal/streams/transform":34,"./internal/streams/utils":35,"./internal/streams/writable":36,"./ours/errors":39,"./ours/primordials":40,"./ours/util":41,"./stream/promises":43,buffer:15}],43:[function(e,t,r){const{ArrayPrototypePop:n,Promise:i}=e("../ours/primordials"),{isIterable:o,isNodeStream:a}=e("../internal/streams/utils"),{pipelineImpl:s}=e("../internal/streams/pipeline"),{finished:l}=e("../internal/streams/end-of-stream");function c(...e){return new i(((t,r)=>{let i,l;const c=e[e.length-1];if(c&&"object"==typeof c&&!a(c)&&!o(c)){const t=n(e);i=t.signal,l=t.end}s(e,((e,n)=>{e?r(e):t(n)}),{signal:i,end:l})}))}t.exports={finished:l,pipeline:c}},{"../internal/streams/end-of-stream":26,"../internal/streams/pipeline":31,"../internal/streams/utils":35,"../ours/primordials":40}]},{},[10])(10);var Qh=Vh.exports;class Zh{constructor(e,t){this.graphName=e,this.idx=t}toString(){return`${this.graphName}:${this.idx}`}}class Kh{constructor(e,t){this.tp=e,this.val=t}toString(){return JSON.stringify(this)}static getRefFromQuad(e){return e.termType===rs.IRI?new Kh(rs.IRI,e.value):e.termType===rs.BlankNode?new Kh(rs.BlankNode,e.value):new Kh(rs.Undefined,"")}}class Xh{async loadDocument(e,t=[]){const r=e.startsWith("http:"),n=e.startsWith("https:");if(!r&&!n)throw new rl('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:e});let i=null;const{res:o,body:a}=await rf({url:e}),s={contextUrl:null,documentUrl:e,document:a||null};if(o.status>=400)throw new rl(`URL "${e}" could not be dereferenced: ${o.statusText}`,"jsonld.InvalidUrl",{code:"loading document failed",url:e,httpStatusCode:o.status});const l=o.headers.get("link");let c=o.headers.get("location");const u=o.headers.get("content-type");if(l&&"application/ld+json"!==u&&"application/json"!==u){const t=hl.parseLinkHeader(l),r=t[vl.LINK_HEADER_CONTEXT];if(Array.isArray(r))throw new rl("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:e});r&&(s.contextUrl=r.target),i=t.alternate,i&&"application/ld+json"==i.type&&!(u||"").match(/^application\/(\w*\+)?json$/)&&(c=El.prependBase(e,i.target))}if((i||o.status>=300&&o.status<400)&&c){if(-1===t.length)throw new rl("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:e,httpStatusCode:o.status,redirects:t});if(-1!==t.indexOf(e))throw new rl("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:e,httpStatusCode:o.status,redirects:t});t.push(e);const r=new URL(c,e).href;return this.loadDocument(r,t)}return t.push(e),s}}const ef="cat";async function tf(e,t,r){if(!t&&!r)throw new rl("IPFS is not configured","jsonld.IPFSNotConfigured",{code:"loading document failed",url:nf+e});return null!==t?await async function(e,t){const r=new URL(function(e,t){const r="/api/v0";for(;e.endsWith("/");)e=e.slice(0,-1);return e.endsWith(r)||(e+=r),e+"/"+t}(t,ef));r.searchParams.append("arg",e);const{res:n,body:i}=await rf({url:r,method:"POST"});if(200!=n.status){let e;try{e=await n.text()}catch(e){console.warn(e)}throw new Error(`Error calling IPFS node: [${n.status}] ${n.statusText}\n${e}`)}return{contextUrl:null,document:i||null,documentUrl:nf+e}}(e,t):await async function(e,t){const r=new Xh,n=await r.loadDocument(function(e,t){return function(e){for(;e.endsWith("/");)e=e.slice(0,-1);return e}(e)+"/ipfs/"+function(e){for(;e.startsWith("/");)e=e.slice(1);return e}(t)}(t,e),[]);return n.contextUrl=null,n.documentUrl=nf+e,n}(e,r)}async function rf({url:e,method:t}){const r={};void 0!==t&&(r.method=t);try{(e=new URL(e)).username&&e.password&&(r.headers={...r.headers??{},authorization:`Basic ${btoa(e.username+":"+e.password)}`},e=function(e){const t=new URL(e);return t.username="",t.password="",t.href}(e));const t=await fetch(e,r);if(t.status>=300&&t.status<400)return{res:t,body:null};const n=await t.text();return n&&n.length>0&&n.startsWith("{")?{res:t,body:JSON.parse(n)}:{res:t,body:n}}catch(t){if(t.response)return{res:t.response,body:null};throw new rl("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:e,cause:t})}}const nf="ipfs://";function of(e){return e?.hasher??a}function af(e){const t=e?.ipfsNodeURL??null,r=e?.ipfsGatewayURL??null;return e?.documentLoader??((e=null,t=null)=>async r=>{if(r.startsWith(nf)){const n=r.slice(nf.length);return await tf(n,e,t)}return(new Xh).loadDocument(r,[])})(t,r)}class sf{constructor(e=new Map){this.graphs=e}static async fromDocument(e,t=af()){const r=await Jh.canonize(e,{format:i.QUADS_FORMAT,documentLoader:t}),n=new Qh.Parser({format:i.QUADS_FORMAT}).parse(r),o=new sf;for(const e of n){const t=e.graph.termType===i.DEFAULT_GRAPH_TERM_TYPE?i.DEFAULT_GRAPH_NODE_NAME:e.graph.value,r=o.graphs.get(t)??[];r.push(e),o.graphs.set(t,r)}return o}static getQuad(e,t){const r=e.graphs.get(t.graphName);if(!r)throw i.ERRORS.GRAPH_NOT_FOUND;if(t.idx>=r.length)throw i.ERRORS.QUAD_NOT_FOUND;return r[t.idx]}static iterGraphsOrdered(e,t){const r=[];for(const t of e.graphs.keys())r.push(t);r.sort(((e,t)=>e.localeCompare(t)));for(const n of r){t(n,e.graphs.get(n))}}static findParent(e,t){const r=sf.findParentInsideGraph(e,t);return r||sf.findGraphParent(e,t)}static findParentInsideGraph(e,t){const r=os(t);let n;const o=e.graphs.get(r);if(!o)return;const a=Kh.getRefFromQuad(t.subject);if(a.tp===rs.Undefined)return;let s=!1;for(let e=0;e<o.length;e++){const l=o[e];if(l.equals(t))continue;const c=Kh.getRefFromQuad(l.object);if(c.tp!==rs.Undefined&&(a?.tp===c?.tp&&a?.val===c?.val)){if(s)throw i.ERRORS.MULTIPLE_PARENTS_FOUND;s=!0,n=new Zh(r,e)}}return n}static findGraphParent(e,t){if(!t.graph)return;const r=Kh.getRefFromQuad(t.graph);if(r.tp===rs.Undefined)return;if(r.tp!==rs.BlankNode)throw new Error("graph parent can only be a blank node");let n,o=!1;for(const[a,s]of e.graphs)for(let e=0;e<s.length;e++){const l=s[e];if(l.equals(t))continue;const c=Kh.getRefFromQuad(l.object);if(c.tp!==rs.Undefined&&r.toString()==c.toString()){if(o)throw i.ERRORS.MULTIPLE_PARENTS_FOUND;o=!0,n=new Zh(a,e)}}if(o)return n;throw i.ERRORS.PARENT_NOT_FOUND}}sf.assertDatasetConsistency=e=>{for(const[t,r]of e.graphs)for(const e of r){if(!t)throw new Error("empty graph name");if(t===i.DEFAULT_GRAPH_NODE_NAME&&e.graph.id)throw new Error("graph should be nil for @default graph");if(!e.graph.id&&t!==i.DEFAULT_GRAPH_NODE_NAME)throw new Error("graph should not be nil for non-@default graph")}};class lf{constructor(e=[],t=a){this.parts=e,this.hasher=t}reverse(){return this.parts.reverse()}append(e){this.parts=[...this.parts,...e]}prepend(e){this.parts=[...e,...this.parts]}async mtEntry(){const e=this.hasher??a,t=new Array(this.parts.length).fill(BigInt(0));for(let r=0;r<this.parts.length;r+=1){const n=this.parts[r];if("string"==typeof n){const i=ss.encode(n);t[r]=await e.hashBytes(i)}else{if("number"!=typeof n)throw new Error("error: unexpected type "+typeof n);t[r]=BigInt(n)}}return e.hash(t)}async pathFromContext(e,t,r){const n=JSON.parse(e);if(!n["@context"])throw i.ERRORS.CONTEXT_NOT_DEFINED;const o={documentLoader:af(r)},a=await Jh.processContext(null,null,o);let s=await Jh.processContext(a,n,o);const l=t.split(".");for(const e in l){const t=l[e];if(i.DIGITS_ONLY_REGEX.test(t))this.parts.push(parseInt(t));else{const e=s.mappings.get(t);if("object"!=typeof e)throw i.ERRORS.TERM_IS_NOT_DEFINED;const r=e["@id"];if(!r)throw i.ERRORS.NO_ID_ATTR;e["@context"]&&(s=await Jh.processContext(s,e,o)),this.parts.push(r)}}}async typeFromContext(e,t,r){const n=JSON.parse(e);if(!("@context"in n))throw i.ERRORS.PARSED_CONTEXT_IS_NULL;const o={documentLoader:af(r)},a=await Jh.processContext(null,null,o);let s=await Jh.processContext(a,n,o);const l=t.split(".");for(const e in l){const t=cf(s,l[e]);t.hasContext&&(s=await Jh.processContext(s,t.typeDef,o)),this.parts.push(t["@id"])}return lf.getTypeMapping(s,l[l.length-1])}static getTypeMapping(e,t){let r="";const n=e.mappings.get("@type");n&&(r=n);const i=e.mappings.get(t);return i&&i["@type"]&&(r=i["@type"]),r}static async pathFromDocument(e,t,r,n,o){if(0===r.length)return[];const a=r[0],s=r.slice(1),l={documentLoader:af(o)};if(i.DIGITS_ONLY_REGEX.test(a)){return[parseInt(a),...await lf.pathFromDocument(e,t,s,!0,o)]}if("object"!=typeof t)throw new Error("error: expected type object got "+typeof t);if(Array.isArray(t)){if(!t.length)throw new Error("error: can't generate path on zero-sized array");if(!n)throw i.ERRORS.UNEXPECTED_ARR_ELEMENT;return lf.pathFromDocument(e,t[0],r,!1,o)}if("@context"in t)if(e)e=await Jh.processContext(e,t,l);else{const r=await Jh.processContext(null,null,l);e=await Jh.processContext(r,t,l)}const c=as(Object.keys(t)),u=e;for(const r in c){const n=c[r];if("@type"!==n){const t=e.mappings.get(n);if("object"!=typeof t)continue;if("@type"!==t["@id"])continue}let i=[];if(Array.isArray(t[n]))t[n].forEach((e=>{if("string"!=typeof e)throw new Error("error: @type value must be an array of strings: "+typeof e);i.push(e),i=as(i)}));else{if("string"!=typeof t[n])throw new Error("error: unexpected @type field type: "+typeof t[n]);i.push(t[n])}for(const t of i){const r=u.mappings.get(t);"object"==typeof r&&"@context"in r&&(e=await Jh.processContext(e,r,l))}break}const d=cf(e,a);if(d.hasContext)if(e)e=await Jh.processContext(e,d.typeDef,l);else{const t=await Jh.processContext(null,null,l);e=await Jh.processContext(t,d.typeDef,l)}const h=await lf.pathFromDocument(e,t[a],s,!0,o);return[d["@id"],...h]}static async newPathFromCtx(e,t,r){const n=new lf([],of(r));return await n.pathFromContext(e,t,r),n}static async fromDocument(e,t,r,n){const o=JSON.parse(t),a=r.split(".");if(0===a.length)throw i.ERRORS.FIELD_PATH_IS_EMPTY;const s=await lf.pathFromDocument(e,o,a,!1,n);return new lf(s,of(n))}static async newTypeFromContext(e,t,r){const n=new lf([],of(r));return await n.typeFromContext(e,t,r)}static async getTypeIDFromContext(e,t,r){const n=JSON.parse(e),i={documentLoader:af(r)},o=await Jh.processContext(null,null,i),a=(await Jh.processContext(o,n,i)).mappings.get(t);if(!a)throw new Error(`looks like ${t} is not a type`);const s=a["@id"];if(!s)throw new Error(`@id attribute is not found for type ${t}`);if("string"!=typeof s)throw new Error(`@id attribute is not a string for type ${t}`);return s}}function cf(e,t){const r=e.mappings.get(t);if("object"!=typeof r)throw i.ERRORS.TERM_IS_NOT_DEFINED;const n=r["@id"];if(!n)throw i.ERRORS.NO_ID_ATTR;if("string"!=typeof n)throw new Error("error: @id attr is not of type string: "+typeof n);return{"@id":n,hasContext:"@context"in r,typeDef:r}}lf.newPath=e=>{const t=new lf;return t.append(e),t},lf.getContextPathKey=async(e,t,r,n)=>{if(""===t)throw i.ERRORS.CTX_TYP_IS_EMPTY;if(""===r)throw i.ERRORS.FIELD_PATH_IS_EMPTY;const o=await lf.newPathFromCtx(e,`${t}.${r}`,n),a=await lf.newPathFromCtx(e,t,n);return new lf(o.parts.slice(a.parts.length))};class uf{constructor(e){this.graph=os(e);const t=e.subject;switch(t.termType){case rs.IRI:this.subject={tp:rs.IRI,val:t.value};break;case rs.BlankNode:this.subject={tp:rs.BlankNode,val:t.value};break;default:throw new Error("invalid subject type")}if(e.predicate.termType!==rs.IRI)throw new Error("invalid predicate type");this.predicate=e.predicate.value}toString(){return JSON.stringify(this)}}uf.countEntries=e=>{const t=new Map;for(const r of e){const e=new uf(r);let n=t.get(e.toString())??0;t.set(e.toString(),++n)}return t};class df{constructor(e=new Map,t=new Map,r=a){this.parents=e,this.children=t,this.hasher=r}static getIriValue(e){if(e.predicate.termType===rs.IRI)return e.predicate.value;throw new Error("type is not IRI")}path(e,t,r){const n=new lf([],this.hasher);"number"==typeof r&&n.append([r]);const i=sf.getQuad(t,e),o=df.getIriValue(i);n.append([o]);let a=e;for(;;){const e=this.parents.get(a.toString());if(!e)break;const r=sf.getQuad(t,e),i=new uf(r),o=this.children.get(i.toString());if(!o)throw new Error("parent mapping not found");const s=sf.getQuad(t,a),l=Kh.getRefFromQuad(s.subject),c=o.get(l.toString());if("number"!=typeof c)throw new Error("child not found in parents mapping");const u=df.getIriValue(r);1===o.size?n.append([u]):n.append([c,u]),a=e}return n.reverse(),n}static async newRelationship(e,t){const r=new df(new Map,new Map,t);return sf.iterGraphsOrdered(e,((t,n)=>{for(let i=0;i<n.length;i++){const o=n[i],a=sf.findParent(e,o);if(!a)continue;const s=new Zh(t,i);r.parents.set(s.toString(),a);const l=sf.getQuad(e,a),c=new uf(l);let u=r.children.get(c.toString());u||(u=new Map,r.children.set(c.toString(),u));const d=Kh.getRefFromQuad(o.subject);if("number"!=typeof u.get(d.toString())){const e=u.size;u.set(d.toString(),e)}}})),r}}class hf{constructor(e,t,r="",n=a){if(this.key=e,this.value=t,this.dataType=r,this.hasher=n,!e.parts.length)throw new Error("key length is zero");(e=>{switch(typeof e){case"boolean":case"string":case"bigint":case"number":return;case"object":if(e instanceof es.Instant)return}throw new Error(`unexpected value type ${typeof e}, expected boolean | number | Temporal.Instant | string`)})(t)}getHasher(){return this.hasher}getKeyMtEntry(){return this.key.mtEntry()}getValueMtEntry(){return hs.mkValueMtEntry(this.getHasher(),this.value)}async getKeyValueMTEntry(){return{k:await this.getKeyMtEntry(),v:await this.getValueMtEntry()}}static async fromDataSet(e,t=a){sf.assertDatasetConsistency(e);if(!e.graphs.get(i.DEFAULT_GRAPH_NODE_NAME).length)throw new Error("@default graph not found in dataset");const r=await df.newRelationship(e,t),n=[];return sf.iterGraphsOrdered(e,((i,o)=>{const a=uf.countEntries(o),s=new Map;for(let l=0;l<o.length;l++){let c="";const u=o[l],d=new Zh(i,l),h=new uf(u);let f;const p=u.object.termType,m=u.object.value;switch(p){case rs.Literal:c=u?.object?.datatype?.value,f=cs(c,m,t.prime());break;case rs.IRI:if(!p)throw new Error("object IRI is nil");f=m;break;case rs.BlankNode:if(r.children.get(h.toString()))continue;throw new Error("BlankNode is not supported yet");case"Variable":f=m;break;default:throw new Error("unexpected Quad's Object type")}let y;switch(a.get(h.toString())){case 0:throw new Error("[assertion] key not found in counts");case 1:break;default:const e=h.toString();y=s.get(e)??0,s.set(e,y+1)}const g=r.path(d,e,y),v=new hf(g,f,c,t);n.push(v)}})),n}}hf.newRDFEntry=(e,t)=>{const r=new hf(e,t);switch(typeof t){case"number":case"string":case"boolean":r.value=t;break;default:if(!(t instanceof es.Instant))throw new Error("error: incorrect value type "+typeof t);r.value=t}return r};class ff{constructor(e=null,i=null,o=a,s=new Map,l=null,c=af()){if(this.srcDoc=e,this.mt=i,this.hasher=o,this.entries=s,this.compacted=l,this.documentLoader=c,!i){const{db:e,writable:i,maxLevels:o}=((e="",n=!0,i=40)=>({db:new t(r(e)),writable:n,maxLevels:i}))();this.mt=new n(e,i,o)}}async proof(e){const t=await e.mtEntry(),{proof:r}=await this.mt.generateProof(t);if(r.existence){if(!this.entries.has(t.toString()))throw new Error("error: [assertion] no entry found while existence is true");const e=this.entries.get(t.toString());return{proof:r,value:new hs(e.value,this.hasher)}}return{proof:r}}mkValue(e){return new hs(e,this.hasher)}async resolveDocPath(e,t){const r=await lf.fromDocument(null,this.srcDoc,e,t);return r.hasher=this.hasher,r}async entry(e){const t=await e.mtEntry(),r=this.entries.get(t.toString());if(!r)throw new Error("entry not found");return r}async jsonLDType(e){return(await this.entry(e)).dataType}async root(){return this.mt.root()}rawValue(e){let t=e.parts,r=this.compacted;const n=[];for(;t.length>0;){const e=t[0];if("string"==typeof e){if(n.push(e),r=r[e]??r["@graph"][e],!r)throw new Error("value not found")}else{if("number"!=typeof e)throw new Error(`unexpected type of path ${n.join(" / ")}`);n.push(e.toString()),r=this.rvExtractArrayIdx(r,e)}t=t.slice(1)}return void 0!==r["@value"]?r["@value"]:r}rvExtractArrayIdx(e,t){if(!Array.isArray(e))throw new Error("expected array");if(t<0||t>=e.length)throw new Error("index is out of range");return e[t]}static async merklizeJSONLD(e,t){const r=of(t),n=af(t),i=new ff(e,null,r,new Map,null,n),o=JSON.parse(i.srcDoc),a=await sf.fromDocument(o,n),s=await hf.fromDataSet(a,r);for(const e of s){const t=await e.getKeyMtEntry();i.entries.set(t.toString(),e)}return await(async(e,t)=>{for(const r of t){const{k:t,v:n}=await r.getKeyValueMTEntry();await e.add(t,n)}})(i.mt,s),i.compacted=await Jh.compact(o,{},{documentLoader:n,base:null,compactArrays:!0,compactToRelative:!0}),i}static async hashValue(e,t){return this.hashValueWithHasher(a,e,t)}static async hashValueWithHasher(e,t,r){const n=((e,t)=>{const r=t===ns.Double;switch(typeof e){case"string":return r?is(parseFloat(e)):e;case"boolean":return`${e}`;case"number":return r?is(e):`${e}`;default:throw new Error("unsupported type")}})(r,t),i=cs(t,n,e.prime());return await hs.mkValueMtEntry(e,i)}get options(){return{hasher:this.hasher,documentLoader:this.documentLoader}}}export{i as MerklizationConstants,ff as Merklizer,hs as MtValue,lf as Path,o as PoseidonHasher,es as Temporal,af as getDocumentLoader};
//# sourceMappingURL=index.js.map
