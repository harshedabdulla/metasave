"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.withAlchemyUserOpSimulation = void 0;
const aa_core_1 = require("@alchemy/aa-core");
const withAlchemyUserOpSimulation = (provider) => {
    provider.withSimulateUOMiddleware(async (uoStruct) => {
        const uoSimResult = await provider.rpcClient.request({
            method: "alchemy_simulateUserOperationAssetChanges",
            params: [
                (0, aa_core_1.deepHexlify)(await (0, aa_core_1.resolveProperties)(uoStruct)),
                provider.getEntryPointAddress(),
            ],
        });
        if (uoSimResult.error) {
            throw new Error(uoSimResult.error.message);
        }
        return uoStruct;
    });
    return provider;
};
exports.withAlchemyUserOpSimulation = withAlchemyUserOpSimulation;
//# sourceMappingURL=simulate-uo.js.map