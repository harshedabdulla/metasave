import { deepHexlify, resolveProperties, } from "@alchemy/aa-core";
export const withAlchemyUserOpSimulation = (provider) => {
    provider.withSimulateUOMiddleware(async (uoStruct) => {
        const uoSimResult = await provider.rpcClient.request({
            method: "alchemy_simulateUserOperationAssetChanges",
            params: [
                deepHexlify(await resolveProperties(uoStruct)),
                provider.getEntryPointAddress(),
            ],
        });
        if (uoSimResult.error) {
            throw new Error(uoSimResult.error.message);
        }
        return uoStruct;
    });
    return provider;
};
//# sourceMappingURL=simulate-uo.js.map