(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsUnixfsImporter = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var IpfsUnixfsImporter=(()=>{var gi=Object.create;var jt=Object.defineProperty;var wi=Object.getOwnPropertyDescriptor;var yi=Object.getOwnPropertyNames;var xi=Object.getPrototypeOf,vi=Object.prototype.hasOwnProperty;var Jt=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),D=(r,t)=>{for(var e in t)jt(r,e,{get:t[e],enumerable:!0})},Er=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of yi(t))!vi.call(r,i)&&i!==e&&jt(r,i,{get:()=>t[i],enumerable:!(n=wi(t,i))||n.enumerable});return r};var it=(r,t,e)=>(e=r!=null?gi(xi(r)):{},Er(t||!r||!r.__esModule?jt(e,"default",{value:r,enumerable:!0}):e,r)),Ai=r=>Er(jt({},"__esModule",{value:!0}),r);var xt=Jt((ja,Cr)=>{"use strict";function kr(r,t){for(let e in t)Object.defineProperty(r,e,{value:t[e],enumerable:!0,configurable:!0});return r}function Bi(r,t,e){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");e||(e={}),typeof t=="object"&&(e=t,t=""),t&&(e.code=t);try{return kr(r,e)}catch{e.message=r.message,e.stack=r.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(r)),kr(new i,e)}}Cr.exports=Bi});var kn=Jt((Mt,re)=>{(function(r,t){"use strict";var e={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function n(a){if(!Array.isArray(a)&&!ArrayBuffer.isView(a))return!1;for(var h=0;h<a.length;h++)if(!Number.isInteger(a[h])||a[h]<0||a[h]>255)return!1;return!0}function i(a,h){return(a&65535)*h+(((a>>>16)*h&65535)<<16)}function o(a,h){return a<<h|a>>>32-h}function s(a){return a^=a>>>16,a=i(a,2246822507),a^=a>>>13,a=i(a,3266489909),a^=a>>>16,a}function c(a,h){a=[a[0]>>>16,a[0]&65535,a[1]>>>16,a[1]&65535],h=[h[0]>>>16,h[0]&65535,h[1]>>>16,h[1]&65535];var d=[0,0,0,0];return d[3]+=a[3]+h[3],d[2]+=d[3]>>>16,d[3]&=65535,d[2]+=a[2]+h[2],d[1]+=d[2]>>>16,d[2]&=65535,d[1]+=a[1]+h[1],d[0]+=d[1]>>>16,d[1]&=65535,d[0]+=a[0]+h[0],d[0]&=65535,[d[0]<<16|d[1],d[2]<<16|d[3]]}function u(a,h){a=[a[0]>>>16,a[0]&65535,a[1]>>>16,a[1]&65535],h=[h[0]>>>16,h[0]&65535,h[1]>>>16,h[1]&65535];var d=[0,0,0,0];return d[3]+=a[3]*h[3],d[2]+=d[3]>>>16,d[3]&=65535,d[2]+=a[2]*h[3],d[1]+=d[2]>>>16,d[2]&=65535,d[2]+=a[3]*h[2],d[1]+=d[2]>>>16,d[2]&=65535,d[1]+=a[1]*h[3],d[0]+=d[1]>>>16,d[1]&=65535,d[1]+=a[2]*h[2],d[0]+=d[1]>>>16,d[1]&=65535,d[1]+=a[3]*h[1],d[0]+=d[1]>>>16,d[1]&=65535,d[0]+=a[0]*h[3]+a[1]*h[2]+a[2]*h[1]+a[3]*h[0],d[0]&=65535,[d[0]<<16|d[1],d[2]<<16|d[3]]}function x(a,h){return h%=64,h===32?[a[1],a[0]]:h<32?[a[0]<<h|a[1]>>>32-h,a[1]<<h|a[0]>>>32-h]:(h-=32,[a[1]<<h|a[0]>>>32-h,a[0]<<h|a[1]>>>32-h])}function f(a,h){return h%=64,h===0?a:h<32?[a[0]<<h|a[1]>>>32-h,a[1]<<h]:[a[1]<<h-32,0]}function w(a,h){return[a[0]^h[0],a[1]^h[1]]}function S(a){return a=w(a,[0,a[0]>>>1]),a=u(a,[4283543511,3981806797]),a=w(a,[0,a[0]>>>1]),a=u(a,[3301882366,444984403]),a=w(a,[0,a[0]>>>1]),a}e.x86.hash32=function(a,h){if(e.inputValidation&&!n(a))return t;h=h||0;for(var d=a.length%4,_=a.length-d,l=h,p=0,m=3432918353,g=461845907,y=0;y<_;y=y+4)p=a[y]|a[y+1]<<8|a[y+2]<<16|a[y+3]<<24,p=i(p,m),p=o(p,15),p=i(p,g),l^=p,l=o(l,13),l=i(l,5)+3864292196;switch(p=0,d){case 3:p^=a[y+2]<<16;case 2:p^=a[y+1]<<8;case 1:p^=a[y],p=i(p,m),p=o(p,15),p=i(p,g),l^=p}return l^=a.length,l=s(l),l>>>0},e.x86.hash128=function(a,h){if(e.inputValidation&&!n(a))return t;h=h||0;for(var d=a.length%16,_=a.length-d,l=h,p=h,m=h,g=h,y=0,v=0,b=0,A=0,I=597399067,$t=2869860233,Gt=951274213,qt=2716044179,B=0;B<_;B=B+16)y=a[B]|a[B+1]<<8|a[B+2]<<16|a[B+3]<<24,v=a[B+4]|a[B+5]<<8|a[B+6]<<16|a[B+7]<<24,b=a[B+8]|a[B+9]<<8|a[B+10]<<16|a[B+11]<<24,A=a[B+12]|a[B+13]<<8|a[B+14]<<16|a[B+15]<<24,y=i(y,I),y=o(y,15),y=i(y,$t),l^=y,l=o(l,19),l+=p,l=i(l,5)+1444728091,v=i(v,$t),v=o(v,16),v=i(v,Gt),p^=v,p=o(p,17),p+=m,p=i(p,5)+197830471,b=i(b,Gt),b=o(b,17),b=i(b,qt),m^=b,m=o(m,15),m+=g,m=i(m,5)+2530024501,A=i(A,qt),A=o(A,18),A=i(A,I),g^=A,g=o(g,13),g+=l,g=i(g,5)+850148119;switch(y=0,v=0,b=0,A=0,d){case 15:A^=a[B+14]<<16;case 14:A^=a[B+13]<<8;case 13:A^=a[B+12],A=i(A,qt),A=o(A,18),A=i(A,I),g^=A;case 12:b^=a[B+11]<<24;case 11:b^=a[B+10]<<16;case 10:b^=a[B+9]<<8;case 9:b^=a[B+8],b=i(b,Gt),b=o(b,17),b=i(b,qt),m^=b;case 8:v^=a[B+7]<<24;case 7:v^=a[B+6]<<16;case 6:v^=a[B+5]<<8;case 5:v^=a[B+4],v=i(v,$t),v=o(v,16),v=i(v,Gt),p^=v;case 4:y^=a[B+3]<<24;case 3:y^=a[B+2]<<16;case 2:y^=a[B+1]<<8;case 1:y^=a[B],y=i(y,I),y=o(y,15),y=i(y,$t),l^=y}return l^=a.length,p^=a.length,m^=a.length,g^=a.length,l+=p,l+=m,l+=g,p+=l,m+=l,g+=l,l=s(l),p=s(p),m=s(m),g=s(g),l+=p,l+=m,l+=g,p+=l,m+=l,g+=l,("00000000"+(l>>>0).toString(16)).slice(-8)+("00000000"+(p>>>0).toString(16)).slice(-8)+("00000000"+(m>>>0).toString(16)).slice(-8)+("00000000"+(g>>>0).toString(16)).slice(-8)},e.x64.hash128=function(a,h){if(e.inputValidation&&!n(a))return t;h=h||0;for(var d=a.length%16,_=a.length-d,l=[0,h],p=[0,h],m=[0,0],g=[0,0],y=[2277735313,289559509],v=[1291169091,658871167],b=0;b<_;b=b+16)m=[a[b+4]|a[b+5]<<8|a[b+6]<<16|a[b+7]<<24,a[b]|a[b+1]<<8|a[b+2]<<16|a[b+3]<<24],g=[a[b+12]|a[b+13]<<8|a[b+14]<<16|a[b+15]<<24,a[b+8]|a[b+9]<<8|a[b+10]<<16|a[b+11]<<24],m=u(m,y),m=x(m,31),m=u(m,v),l=w(l,m),l=x(l,27),l=c(l,p),l=c(u(l,[0,5]),[0,1390208809]),g=u(g,v),g=x(g,33),g=u(g,y),p=w(p,g),p=x(p,31),p=c(p,l),p=c(u(p,[0,5]),[0,944331445]);switch(m=[0,0],g=[0,0],d){case 15:g=w(g,f([0,a[b+14]],48));case 14:g=w(g,f([0,a[b+13]],40));case 13:g=w(g,f([0,a[b+12]],32));case 12:g=w(g,f([0,a[b+11]],24));case 11:g=w(g,f([0,a[b+10]],16));case 10:g=w(g,f([0,a[b+9]],8));case 9:g=w(g,[0,a[b+8]]),g=u(g,v),g=x(g,33),g=u(g,y),p=w(p,g);case 8:m=w(m,f([0,a[b+7]],56));case 7:m=w(m,f([0,a[b+6]],48));case 6:m=w(m,f([0,a[b+5]],40));case 5:m=w(m,f([0,a[b+4]],32));case 4:m=w(m,f([0,a[b+3]],24));case 3:m=w(m,f([0,a[b+2]],16));case 2:m=w(m,f([0,a[b+1]],8));case 1:m=w(m,[0,a[b]]),m=u(m,y),m=x(m,31),m=u(m,v),l=w(l,m)}return l=w(l,[0,a.length]),p=w(p,[0,a.length]),l=c(l,p),p=c(p,l),l=S(l),p=S(p),l=c(l,p),p=c(p,l),("00000000"+(l[0]>>>0).toString(16)).slice(-8)+("00000000"+(l[1]>>>0).toString(16)).slice(-8)+("00000000"+(p[0]>>>0).toString(16)).slice(-8)+("00000000"+(p[1]>>>0).toString(16)).slice(-8)},typeof Mt<"u"?(typeof re<"u"&&re.exports&&(Mt=re.exports=e),Mt.murmurHash3=e):typeof define=="function"&&define.amd?define([],function(){return e}):(e._murmurHash3=r.murmurHash3,e.noConflict=function(){return r.murmurHash3=e._murmurHash3,e._murmurHash3=t,e.noConflict=t,e},r.murmurHash3=e)})(Mt)});var In=Jt((zf,Cn)=>{Cn.exports=kn()});var Pn=Jt((Of,zn)=>{"use strict";zn.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(t,e){let n=this._internalPositionFor(t,!1);if(e===void 0)n!==-1&&(this._unsetInternalPos(n),this._unsetBit(t),this._changedLength=!0,this._changedData=!0);else{let i=!1;n===-1?(n=this._data.length,this._setBit(t),this._changedData=!0):i=!0,this._setInternalPos(n,t,e,i),this._changedLength=!0}}unset(t){this.set(t,void 0)}get(t){this._sortData();let e=this._internalPositionFor(t,!0);if(e!==-1)return this._data[e][1]}push(t){return this.set(this.length,t),this.length}get length(){if(this._sortData(),this._changedLength){let t=this._data[this._data.length-1];this._length=t?t[0]+1:0,this._changedLength=!1}return this._length}forEach(t){let e=0;for(;e<this.length;)t(this.get(e),e,this),e++}map(t){let e=0,n=new Array(this.length);for(;e<this.length;)n[e]=t(this.get(e),e,this),e++;return n}reduce(t,e){let n=0,i=e;for(;n<this.length;){let o=this.get(n);i=t(i,o,n),n++}return i}find(t){let e=0,n,i;for(;e<this.length&&!n;)i=this.get(e),n=t(i),e++;return n?i:void 0}_internalPositionFor(t,e){let n=this._bytePosFor(t,e);if(n>=this._bitArrays.length)return-1;let i=this._bitArrays[n],o=t-n*7;if(!((i&1<<o)>0))return-1;let c=this._bitArrays.slice(0,n).reduce(ws,0),u=~(4294967295<<o+1),x=Ln(i&u);return c+x-1}_bytePosFor(t,e){let n=Math.floor(t/7),i=n+1;for(;!e&&this._bitArrays.length<i;)this._bitArrays.push(0);return n}_setBit(t){let e=this._bytePosFor(t,!1);this._bitArrays[e]|=1<<t-e*7}_unsetBit(t){let e=this._bytePosFor(t,!1);this._bitArrays[e]&=~(1<<t-e*7)}_setInternalPos(t,e,n,i){let o=this._data,s=[e,n];if(i)this._sortData(),o[t]=s;else{if(o.length)if(o[o.length-1][0]>=e)o.push(s);else if(o[0][0]<=e)o.unshift(s);else{let c=Math.round(o.length/2);this._data=o.slice(0,c).concat(s).concat(o.slice(c))}else this._data.push(s);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(t){this._data.splice(t,1)}_sortData(){this._changedData&&this._data.sort(ys),this._changedData=!1}bitField(){let t=[],e=8,n=0,i=0,o,s=this._bitArrays.slice();for(;s.length||n;){n===0&&(o=s.shift(),n=7);let u=Math.min(n,e),x=~(255<<u),f=o&x;i|=f<<8-e,o=o>>>u,n-=u,e-=u,(!e||!n&&!s.length)&&(t.push(i),i=0,e=8)}for(var c=t.length-1;c>0&&t[c]===0;c--)t.pop();return t}compactArray(){return this._sortData(),this._data.map(xs)}};function ws(r,t){return r+Ln(t)}function Ln(r){let t=r;return t=t-(t>>1&1431655765),t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>24}function ys(r,t){return r[0]-t[0]}function xs(r){return r[1]}});var Ga={};D(Ga,{importByteStream:()=>$a,importBytes:()=>Ha,importDirectory:()=>Oa,importFile:()=>Tr,importer:()=>_r});var Dr=it(xt(),1);function Si(r){return r[Symbol.asyncIterator]!=null}function Di(r){if(Si(r))return(async()=>{for await(let t of r)return t})();for(let t of r)return t}var he=Di;function _i(r){return r[Symbol.asyncIterator]!=null}function Ti(r,t=1){return t=Number(t),_i(r)?async function*(){let e=[];if(t<1&&(t=1),t!==Math.round(t))throw new Error("Batch size must be an integer");for await(let n of r)for(e.push(n);e.length>=t;)yield e.slice(0,t),e=e.slice(t);for(;e.length>0;)yield e.slice(0,t),e=e.slice(t)}():function*(){let e=[];if(t<1&&(t=1),t!==Math.round(t))throw new Error("Batch size must be an integer");for(let n of r)for(e.push(n);e.length>=t;)yield e.slice(0,t),e=e.slice(t);for(;e.length>0;)yield e.slice(0,t),e=e.slice(t)}()}var vt=Ti;async function*At(r,t=1){for await(let e of vt(r,t)){let n=e.map(async i=>i().then(o=>({ok:!0,value:o}),o=>({ok:!1,err:o})));for(let i=0;i<n.length;i++){let o=await n[i];if(o.ok)yield o.value;else throw o.err}}}function J(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function G(r=0){return globalThis.Buffer?.alloc!=null?J(globalThis.Buffer.alloc(r)):new Uint8Array(r)}function U(r=0){return globalThis.Buffer?.allocUnsafe!=null?J(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function fe(r,t){if(globalThis.Buffer!=null)return J(globalThis.Buffer.concat(r,t));t==null&&(t=r.reduce((i,o)=>i+o.length,0));let e=U(t),n=0;for(let i of r)e.set(i,n),n+=i.length;return J(e)}function Ir(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}var Lr=Symbol.for("@achingbrain/uint8arraylist");function Nr(r,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let e=0;for(let n of r){let i=e+n.byteLength;if(t<i)return{buf:n,index:t-e};e=i}throw new RangeError("index is out of bounds")}function Xt(r){return!!r?.[Lr]}var ot=class r{bufs;length;[Lr]=!0;constructor(...t){this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let e=0;for(let n of t)if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.push(n);else if(Xt(n))e+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}prepend(...t){this.prependAll(t)}prependAll(t){let e=0;for(let n of t.reverse())if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.unshift(n);else if(Xt(n))e+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}get(t){let e=Nr(this.bufs,t);return e.buf[e.index]}set(t,e){let n=Nr(this.bufs,t);n.buf[n.index]=e}write(t,e=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(e+n,t[n]);else if(Xt(t))for(let n=0;n<t.length;n++)this.set(e+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,e){let{bufs:n,length:i}=this._subList(t,e);return fe(n,i)}subarray(t,e){let{bufs:n,length:i}=this._subList(t,e);return n.length===1?n[0]:fe(n,i)}sublist(t,e){let{bufs:n,length:i}=this._subList(t,e),o=new r;return o.length=i,o.bufs=[...n],o}_subList(t,e){if(t=t??0,e=e??this.length,t<0&&(t=this.length+t),e<0&&(e=this.length+e),t<0||e>this.length)throw new RangeError("index is out of bounds");if(t===e)return{bufs:[],length:0};if(t===0&&e===this.length)return{bufs:this.bufs,length:this.length};let n=[],i=0;for(let o=0;o<this.bufs.length;o++){let s=this.bufs[o],c=i,u=c+s.byteLength;if(i=u,t>=u)continue;let x=t>=c&&t<u,f=e>c&&e<=u;if(x&&f){if(t===c&&e===u){n.push(s);break}let w=t-c;n.push(s.subarray(w,w+(e-t)));break}if(x){if(t===0){n.push(s);continue}n.push(s.subarray(t-c));continue}if(f){if(e===u){n.push(s);break}n.push(s.subarray(0,e-c));break}n.push(s)}return{bufs:n,length:e-t}}indexOf(t,e=0){if(!Xt(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(e=Number(e??0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let o=256,s=new Int32Array(o);for(let w=0;w<o;w++)s[w]=-1;for(let w=0;w<i;w++)s[n[w]]=w;let c=s,u=this.byteLength-n.byteLength,x=n.byteLength-1,f;for(let w=e;w<=u;w+=f){f=0;for(let S=x;S>=0;S--){let a=this.get(w+S);if(n[S]!==a){f=Math.max(1,S-c[a]);break}}if(f===0)return w}return-1}getInt8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getInt8(0)}setInt8(t,e){let n=U(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,e),this.write(n,t)}getInt16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,e)}setInt16(t,e,n){let i=G(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,e,n),this.write(i,t)}getInt32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,e)}setInt32(t,e,n){let i=G(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,e,n),this.write(i,t)}getBigInt64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,e)}setBigInt64(t,e,n){let i=G(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,e,n),this.write(i,t)}getUint8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0)}setUint8(t,e){let n=U(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,e),this.write(n,t)}getUint16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,e)}setUint16(t,e,n){let i=G(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,e,n),this.write(i,t)}getUint32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,e)}setUint32(t,e,n){let i=G(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,e,n),this.write(i,t)}getBigUint64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,e)}setBigUint64(t,e,n){let i=G(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,e,n),this.write(i,t)}getFloat32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,e)}setFloat32(t,e,n){let i=G(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,e,n),this.write(i,t)}getFloat64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,e)}setFloat64(t,e,n){let i=G(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,e,n),this.write(i,t)}equals(t){if(t==null||!(t instanceof r)||t.bufs.length!==this.bufs.length)return!1;for(let e=0;e<this.bufs.length;e++)if(!Ir(this.bufs[e],t.bufs[e]))return!1;return!0}static fromUint8Arrays(t,e){let n=new r;return n.bufs=t,e==null&&(e=t.reduce((i,o)=>i+o.byteLength,0)),n.length=e,n}};var Ei=262144,zr=(r={})=>{let t=r.chunkSize??Ei;return async function*(n){let i=new ot,o=0,s=!1;for await(let c of n)for(i.append(c),o+=c.length;o>=t;)if(yield i.slice(0,t),s=!0,t===i.length)i=new ot,o=0;else{let u=new ot;u.append(i.sublist(t)),i=u,o-=t}(!s||o>0)&&(yield i.subarray(0,o))}};var Et={};D(Et,{code:()=>To,createLink:()=>en,createNode:()=>tn,decode:()=>Eo,encode:()=>P,name:()=>_o,prepare:()=>z,validate:()=>Se});var we={};D(we,{base32:()=>ct,base32hex:()=>Ri,base32hexpad:()=>Hi,base32hexpadupper:()=>$i,base32hexupper:()=>Oi,base32pad:()=>Mi,base32padupper:()=>Vi,base32upper:()=>Fi,base32z:()=>Gi});var st={};D(st,{coerce:()=>F,empty:()=>Pr,equals:()=>ue,fromHex:()=>Ci,fromString:()=>le,isBinary:()=>Ii,toHex:()=>ki,toString:()=>de});var Pr=new Uint8Array(0);function ki(r){return r.reduce((t,e)=>t+e.toString(16).padStart(2,"0"),"")}function Ci(r){let t=r.match(/../g);return t!=null?new Uint8Array(t.map(e=>parseInt(e,16))):Pr}function ue(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}function F(r){if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}function Ii(r){return r instanceof ArrayBuffer||ArrayBuffer.isView(r)}function le(r){return new TextEncoder().encode(r)}function de(r){return new TextDecoder().decode(r)}function Ni(r,t){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var i=0;i<r.length;i++){var o=r.charAt(i),s=o.charCodeAt(0);if(e[s]!==255)throw new TypeError(o+" is ambiguous");e[s]=i}var c=r.length,u=r.charAt(0),x=Math.log(c)/Math.log(256),f=Math.log(256)/Math.log(c);function w(h){if(h instanceof Uint8Array||(ArrayBuffer.isView(h)?h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength):Array.isArray(h)&&(h=Uint8Array.from(h))),!(h instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(h.length===0)return"";for(var d=0,_=0,l=0,p=h.length;l!==p&&h[l]===0;)l++,d++;for(var m=(p-l)*f+1>>>0,g=new Uint8Array(m);l!==p;){for(var y=h[l],v=0,b=m-1;(y!==0||v<_)&&b!==-1;b--,v++)y+=256*g[b]>>>0,g[b]=y%c>>>0,y=y/c>>>0;if(y!==0)throw new Error("Non-zero carry");_=v,l++}for(var A=m-_;A!==m&&g[A]===0;)A++;for(var I=u.repeat(d);A<m;++A)I+=r.charAt(g[A]);return I}function S(h){if(typeof h!="string")throw new TypeError("Expected String");if(h.length===0)return new Uint8Array;var d=0;if(h[d]!==" "){for(var _=0,l=0;h[d]===u;)_++,d++;for(var p=(h.length-d)*x+1>>>0,m=new Uint8Array(p);h[d];){var g=e[h.charCodeAt(d)];if(g===255)return;for(var y=0,v=p-1;(g!==0||y<l)&&v!==-1;v--,y++)g+=c*m[v]>>>0,m[v]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");l=y,d++}if(h[d]!==" "){for(var b=p-l;b!==p&&m[b]===0;)b++;for(var A=new Uint8Array(_+(p-b)),I=_;b!==p;)A[I++]=m[b++];return A}}}function a(h){var d=S(h);if(d)return d;throw new Error(`Non-${t} character`)}return{encode:w,decodeUnsafe:S,decode:a}}var Li=Ni,zi=Li,Ur=zi;var pe=class{name;prefix;baseEncode;constructor(t,e,n){this.name=t,this.prefix=e,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},me=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,e,n){if(this.name=t,this.prefix=e,e.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Fr(this,t)}},be=class{decoders;constructor(t){this.decoders=t}or(t){return Fr(this,t)}decode(t){let e=t[0],n=this.decoders[e];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function Fr(r,t){return new be({...r.decoders??{[r.prefix]:r},...t.decoders??{[t.prefix]:t}})}var ge=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,e,n,i){this.name=t,this.prefix=e,this.baseEncode=n,this.baseDecode=i,this.encoder=new pe(t,e,n),this.decoder=new me(t,e,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function at({name:r,prefix:t,encode:e,decode:n}){return new ge(r,t,e,n)}function X({name:r,prefix:t,alphabet:e}){let{encode:n,decode:i}=Ur(e,r);return at({prefix:t,name:r,encode:n,decode:o=>F(i(o))})}function Pi(r,t,e,n){let i={};for(let f=0;f<t.length;++f)i[t[f]]=f;let o=r.length;for(;r[o-1]==="=";)--o;let s=new Uint8Array(o*e/8|0),c=0,u=0,x=0;for(let f=0;f<o;++f){let w=i[r[f]];if(w===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<e|w,c+=e,c>=8&&(c-=8,s[x++]=255&u>>c)}if(c>=e||255&u<<8-c)throw new SyntaxError("Unexpected end of data");return s}function Ui(r,t,e){let n=t[t.length-1]==="=",i=(1<<e)-1,o="",s=0,c=0;for(let u=0;u<r.length;++u)for(c=c<<8|r[u],s+=8;s>e;)s-=e,o+=t[i&c>>s];if(s!==0&&(o+=t[i&c<<e-s]),n)for(;o.length*e&7;)o+="=";return o}function T({name:r,prefix:t,bitsPerChar:e,alphabet:n}){return at({prefix:t,name:r,encode(i){return Ui(i,n,e)},decode(i){return Pi(i,n,e,r)}})}var ct=T({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Fi=T({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Mi=T({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Vi=T({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ri=T({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Oi=T({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Hi=T({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$i=T({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Gi=T({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ye={};D(ye,{base58btc:()=>O,base58flickr:()=>qi});var O=X({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),qi=X({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ji=Rr,Mr=128,Ji=127,Xi=~Ji,Ki=Math.pow(2,31);function Rr(r,t,e){t=t||[],e=e||0;for(var n=e;r>=Ki;)t[e++]=r&255|Mr,r/=128;for(;r&Xi;)t[e++]=r&255|Mr,r>>>=7;return t[e]=r|0,Rr.bytes=e-n+1,t}var Wi=xe,Qi=128,Vr=127;function xe(r,n){var e=0,n=n||0,i=0,o=n,s,c=r.length;do{if(o>=c)throw xe.bytes=0,new RangeError("Could not decode varint");s=r[o++],e+=i<28?(s&Vr)<<i:(s&Vr)*Math.pow(2,i),i+=7}while(s>=Qi);return xe.bytes=o-n,e}var Yi=Math.pow(2,7),Zi=Math.pow(2,14),to=Math.pow(2,21),eo=Math.pow(2,28),ro=Math.pow(2,35),no=Math.pow(2,42),io=Math.pow(2,49),oo=Math.pow(2,56),so=Math.pow(2,63),ao=function(r){return r<Yi?1:r<Zi?2:r<to?3:r<eo?4:r<ro?5:r<no?6:r<io?7:r<oo?8:r<so?9:10},co={encode:ji,decode:Wi,encodingLength:ao},ho=co,Bt=ho;function St(r,t=0){return[Bt.decode(r,t),Bt.decode.bytes]}function ht(r,t,e=0){return Bt.encode(r,t,e),t}function ft(r){return Bt.encodingLength(r)}function Y(r,t){let e=t.byteLength,n=ft(r),i=n+ft(e),o=new Uint8Array(i+e);return ht(r,o,0),ht(e,o,n),o.set(t,i),new ut(r,e,t,o)}function Or(r){let t=F(r),[e,n]=St(t),[i,o]=St(t.subarray(n)),s=t.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new ut(e,i,s,t)}function Hr(r,t){if(r===t)return!0;{let e=t;return r.code===e.code&&r.size===e.size&&e.bytes instanceof Uint8Array&&ue(r.bytes,e.bytes)}}var ut=class{code;size;digest;bytes;constructor(t,e,n,i){this.code=t,this.size=e,this.digest=n,this.bytes=i}};function $r(r,t){let{bytes:e,version:n}=r;switch(n){case 0:return uo(e,ve(r),t??O.encoder);default:return lo(e,ve(r),t??ct.encoder)}}var Gr=new WeakMap;function ve(r){let t=Gr.get(r);if(t==null){let e=new Map;return Gr.set(r,e),e}return t}var k=class r{code;version;multihash;bytes;"/";constructor(t,e,n,i){this.code=e,this.version=t,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:e}=this;if(t!==_t)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==po)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:e}=this.multihash,n=Y(t,e);return r.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return r.equals(this,t)}static equals(t,e){let n=e;return n!=null&&t.code===n.code&&t.version===n.version&&Hr(t.multihash,n.multihash)}toString(t){return $r(this,t)}toJSON(){return{"/":$r(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let e=t;if(e instanceof r)return e;if(e["/"]!=null&&e["/"]===e.bytes||e.asCID===e){let{version:n,code:i,multihash:o,bytes:s}=e;return new r(n,i,o,s??qr(n,i,o.bytes))}else if(e[mo]===!0){let{version:n,multihash:i,code:o}=e,s=Or(i);return r.create(n,o,s)}else return null}static create(t,e,n){if(typeof e!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(e!==_t)throw new Error(`Version 0 CID must use dag-pb (code: ${_t}) block encoding`);return new r(t,e,n,n.bytes)}case 1:{let i=qr(t,e,n.bytes);return new r(t,e,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return r.create(0,_t,t)}static createV1(t,e){return r.create(1,t,e)}static decode(t){let[e,n]=r.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return e}static decodeFirst(t){let e=r.inspectBytes(t),n=e.size-e.multihashSize,i=F(t.subarray(n,n+e.multihashSize));if(i.byteLength!==e.multihashSize)throw new Error("Incorrect length");let o=i.subarray(e.multihashSize-e.digestSize),s=new ut(e.multihashCode,e.digestSize,o,i);return[e.version===0?r.createV0(s):r.createV1(e.codec,s),t.subarray(e.size)]}static inspectBytes(t){let e=0,n=()=>{let[w,S]=St(t.subarray(e));return e+=S,w},i=n(),o=_t;if(i===18?(i=0,e=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=e,c=n(),u=n(),x=e+u,f=x-s;return{version:i,codec:o,multihashCode:c,digestSize:u,multihashSize:f,size:x}}static parse(t,e){let[n,i]=fo(t,e),o=r.decode(i);if(o.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return ve(o).set(n,t),o}};function fo(r,t){switch(r[0]){case"Q":{let e=t??O;return[O.prefix,e.decode(`${O.prefix}${r}`)]}case O.prefix:{let e=t??O;return[O.prefix,e.decode(r)]}case ct.prefix:{let e=t??ct;return[ct.prefix,e.decode(r)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],t.decode(r)]}}}function uo(r,t,e){let{prefix:n}=e;if(n!==O.prefix)throw Error(`Cannot string encode V0 in ${e.name} encoding`);let i=t.get(n);if(i==null){let o=e.encode(r).slice(1);return t.set(n,o),o}else return i}function lo(r,t,e){let{prefix:n}=e,i=t.get(n);if(i==null){let o=e.encode(r);return t.set(n,o),o}else return i}var _t=112,po=18;function qr(r,t,e){let n=ft(r),i=n+ft(t),o=new Uint8Array(i+e.byteLength);return ht(r,o,0),ht(t,o,n),o.set(e,i),o}var mo=Symbol.for("@ipld/js-cid/CID");var bo=new TextDecoder;function Ae(r,t){let e=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=r.length)throw new Error("protobuf: unexpected end of data");let i=r[t++];if(e+=n<28?(i&127)<<n:(i&127)*2**n,i<128)break}return[e,t]}function Wt(r,t){let e;[e,t]=Ae(r,t);let n=t+e;if(e<0||n<0)throw new Error("protobuf: invalid length");if(n>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(t,n),n]}function jr(r,t){let e;return[e,t]=Ae(r,t),[e&7,e>>3,t]}function go(r){let t={},e=r.length,n=0;for(;n<e;){let i,o;if([i,o,n]=jr(r,n),o===1){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Hash`);if(t.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=Wt(r,n)}else if(o===2){if(t.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Name`);if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let s;[s,n]=Wt(r,n),t.Name=bo.decode(s)}else if(o===3){if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(i!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Tsize`);[t.Tsize,n]=Ae(r,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`)}if(n>e)throw new Error("protobuf: (PBLink) unexpected end of data");return t}function Jr(r){let t=r.length,e=0,n,i=!1,o;for(;e<t;){let c,u;if([c,u,e]=jr(r,e),c!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${c}`);if(u===1){if(o)throw new Error("protobuf: (PBNode) duplicate Data section");[o,e]=Wt(r,e),n&&(i=!0)}else if(u===2){if(i)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let x;[x,e]=Wt(r,e),n.push(go(x))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${u}`)}if(e>t)throw new Error("protobuf: (PBNode) unexpected end of data");let s={};return o&&(s.Data=o),s.Links=n||[],s}var Kr=new TextEncoder,Xr=2**32,wo=2**31;function yo(r,t){let e=t.length;if(typeof r.Tsize=="number"){if(r.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(r.Tsize))throw new Error("Tsize too large for encoding");e=Tt(t,e,r.Tsize)-1,t[e]=24}if(typeof r.Name=="string"){let n=Kr.encode(r.Name);e-=n.length,t.set(n,e),e=Tt(t,e,n.length)-1,t[e]=18}return r.Hash&&(e-=r.Hash.length,t.set(r.Hash,e),e=Tt(t,e,r.Hash.length)-1,t[e]=10),t.length-e}function Wr(r){let t=vo(r),e=new Uint8Array(t),n=t;if(r.Data&&(n-=r.Data.length,e.set(r.Data,n),n=Tt(e,n,r.Data.length)-1,e[n]=10),r.Links)for(let i=r.Links.length-1;i>=0;i--){let o=yo(r.Links[i],e.subarray(0,n));n-=o,n=Tt(e,n,o)-1,e[n]=18}return e}function xo(r){let t=0;if(r.Hash){let e=r.Hash.length;t+=1+e+lt(e)}if(typeof r.Name=="string"){let e=Kr.encode(r.Name).length;t+=1+e+lt(e)}return typeof r.Tsize=="number"&&(t+=1+lt(r.Tsize)),t}function vo(r){let t=0;if(r.Data){let e=r.Data.length;t+=1+e+lt(e)}if(r.Links)for(let e of r.Links){let n=xo(e);t+=1+n+lt(n)}return t}function Tt(r,t,e){t-=lt(e);let n=t;for(;e>=wo;)r[t++]=e&127|128,e/=128;for(;e>=128;)r[t++]=e&127|128,e>>>=7;return r[t]=e,n}function lt(r){return r%2===0&&r++,Math.floor((Ao(r)+6)/7)}function Ao(r){let t=0;return r>=Xr&&(r=Math.floor(r/Xr),t=32),r>=65536&&(r>>>=16,t+=16),r>=256&&(r>>>=8,t+=8),t+Bo[r]}var Bo=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];var So=["Data","Links"],Do=["Hash","Name","Tsize"],Be=new TextEncoder;function Yr(r,t){if(r===t)return 0;let e=r.Name?Be.encode(r.Name):[],n=t.Name?Be.encode(t.Name):[],i=e.length,o=n.length;for(let s=0,c=Math.min(i,o);s<c;++s)if(e[s]!==n[s]){i=e[s],o=n[s];break}return i<o?-1:o<i?1:0}function Qr(r,t){return!Object.keys(r).some(e=>!t.includes(e))}function Zr(r){if(typeof r.asCID=="object"){let e=k.asCID(r);if(!e)throw new TypeError("Invalid DAG-PB form");return{Hash:e}}if(typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");let t={};if(r.Hash){let e=k.asCID(r.Hash);try{e||(typeof r.Hash=="string"?e=k.parse(r.Hash):r.Hash instanceof Uint8Array&&(e=k.decode(r.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}e&&(t.Hash=e)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return typeof r.Name=="string"&&(t.Name=r.Name),typeof r.Tsize=="number"&&(t.Tsize=r.Tsize),t}function z(r){if((r instanceof Uint8Array||typeof r=="string")&&(r={Data:r}),typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");let t={};if(r.Data!==void 0)if(typeof r.Data=="string")t.Data=Be.encode(r.Data);else if(r.Data instanceof Uint8Array)t.Data=r.Data;else throw new TypeError("Invalid DAG-PB form");if(r.Links!==void 0)if(Array.isArray(r.Links))t.Links=r.Links.map(Zr),t.Links.sort(Yr);else throw new TypeError("Invalid DAG-PB form");else t.Links=[];return t}function Se(r){if(!r||typeof r!="object"||Array.isArray(r)||r instanceof Uint8Array||r["/"]&&r["/"]===r.bytes)throw new TypeError("Invalid DAG-PB form");if(!Qr(r,So))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(r.Data!==void 0&&!(r.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(r.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let t=0;t<r.Links.length;t++){let e=r.Links[t];if(!e||typeof e!="object"||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!Qr(e,Do))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(e.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(e.Hash==null||!e.Hash["/"]||e.Hash["/"]!==e.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(e.Name!==void 0&&typeof e.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(e.Tsize!==void 0){if(typeof e.Tsize!="number"||e.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(t>0&&Yr(e,r.Links[t-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function tn(r,t=[]){return z({Data:r,Links:t})}function en(r,t,e){return Zr({Hash:e,Name:r,Tsize:t})}var _o="dag-pb",To=112;function P(r){Se(r);let t={};return r.Links&&(t.Links=r.Links.map(e=>{let n={};return e.Hash&&(n.Hash=e.Hash.bytes),e.Name!==void 0&&(n.Name=e.Name),e.Tsize!==void 0&&(n.Tsize=e.Tsize),n})),r.Data&&(t.Data=r.Data),Wr(t)}function Eo(r){let t=Jr(r),e={};return t.Data&&(e.Data=t.Data),t.Links&&(e.Links=t.Links.map(n=>{let i={};try{i.Hash=k.decode(n.Hash)}catch{}if(!i.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(i.Name=n.Name),n.Tsize!==void 0&&(i.Tsize=n.Tsize),i})),e}var Qe=it(xt(),1);var De=new Float32Array([-0]),K=new Uint8Array(De.buffer);function rn(r,t,e){De[0]=r,t[e]=K[0],t[e+1]=K[1],t[e+2]=K[2],t[e+3]=K[3]}function nn(r,t){return K[0]=r[t],K[1]=r[t+1],K[2]=r[t+2],K[3]=r[t+3],De[0]}var _e=new Float64Array([-0]),C=new Uint8Array(_e.buffer);function on(r,t,e){_e[0]=r,t[e]=C[0],t[e+1]=C[1],t[e+2]=C[2],t[e+3]=C[3],t[e+4]=C[4],t[e+5]=C[5],t[e+6]=C[6],t[e+7]=C[7]}function sn(r,t){return C[0]=r[t],C[1]=r[t+1],C[2]=r[t+2],C[3]=r[t+3],C[4]=r[t+4],C[5]=r[t+5],C[6]=r[t+6],C[7]=r[t+7],_e[0]}var ko=BigInt(Number.MAX_SAFE_INTEGER),Co=BigInt(Number.MIN_SAFE_INTEGER),N=class r{lo;hi;constructor(t,e){this.lo=t|0,this.hi=e|0}toNumber(t=!1){if(!t&&this.hi>>>31>0){let e=~this.lo+1>>>0,n=~this.hi>>>0;return e===0&&(n=n+1>>>0),-(e+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(t=!1){if(t)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let e=~this.lo+1>>>0,n=~this.hi>>>0;return e===0&&(n=n+1>>>0),-(BigInt(e)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(t=!1){return this.toBigInt(t).toString()}zzEncode(){let t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){let t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){let t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?e===0?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}static fromBigInt(t){if(t===0n)return Z;if(t<ko&&t>Co)return this.fromNumber(Number(t));let e=t<0n;e&&(t=-t);let n=t>>32n,i=t-(n<<32n);return e&&(n=~n|0n,i=~i|0n,++i>an&&(i=0n,++n>an&&(n=0n))),new r(Number(i),Number(n))}static fromNumber(t){if(t===0)return Z;let e=t<0;e&&(t=-t);let n=t>>>0,i=(t-n)/4294967296>>>0;return e&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new r(n,i)}static from(t){return typeof t=="number"?r.fromNumber(t):typeof t=="bigint"?r.fromBigInt(t):typeof t=="string"?r.fromBigInt(BigInt(t)):t.low!=null||t.high!=null?new r(t.low>>>0,t.high>>>0):Z}},Z=new N(0,0);Z.toBigInt=function(){return 0n};Z.zzEncode=Z.zzDecode=function(){return this};Z.length=function(){return 1};var an=4294967296n;function cn(r){let t=0,e=0;for(let n=0;n<r.length;++n)e=r.charCodeAt(n),e<128?t+=1:e<2048?t+=2:(e&64512)===55296&&(r.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t}function hn(r,t,e){if(e-t<1)return"";let i,o=[],s=0,c;for(;t<e;)c=r[t++],c<128?o[s++]=c:c>191&&c<224?o[s++]=(c&31)<<6|r[t++]&63:c>239&&c<365?(c=((c&7)<<18|(r[t++]&63)<<12|(r[t++]&63)<<6|r[t++]&63)-65536,o[s++]=55296+(c>>10),o[s++]=56320+(c&1023)):o[s++]=(c&15)<<12|(r[t++]&63)<<6|r[t++]&63,s>8191&&((i??(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i!=null?(s>0&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))}function Te(r,t,e){let n=e,i,o;for(let s=0;s<r.length;++s)i=r.charCodeAt(s),i<128?t[e++]=i:i<2048?(t[e++]=i>>6|192,t[e++]=i&63|128):(i&64512)===55296&&((o=r.charCodeAt(s+1))&64512)===56320?(i=65536+((i&1023)<<10)+(o&1023),++s,t[e++]=i>>18|240,t[e++]=i>>12&63|128,t[e++]=i>>6&63|128,t[e++]=i&63|128):(t[e++]=i>>12|224,t[e++]=i>>6&63|128,t[e++]=i&63|128);return e-n}function M(r,t){return RangeError(`index out of range: ${r.pos} + ${t??1} > ${r.len}`)}function Qt(r,t){return(r[t-4]|r[t-3]<<8|r[t-2]<<16|r[t-1]<<24)>>>0}var Ee=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,M(this,10);return t}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw M(this,4);return Qt(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw M(this,4);return Qt(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw M(this,4);let t=nn(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw M(this,4);let t=sn(this.buf,this.pos);return this.pos+=8,t}bytes(){let t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw M(this,t);return this.pos+=t,e===n?new Uint8Array(0):this.buf.subarray(e,n)}string(){let t=this.bytes();return hn(t,0,t.length)}skip(t){if(typeof t=="number"){if(this.pos+t>this.len)throw M(this,t);this.pos+=t}else do if(this.pos>=this.len)throw M(this);while(this.buf[this.pos++]&128);return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){let t=new N(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw M(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw M(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw M(this,8);let t=Qt(this.buf,this.pos+=4),e=Qt(this.buf,this.pos+=4);return new N(t,e)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){return this.readLongVarint().toNumber(!0)}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function ke(r){return new Ee(r instanceof Uint8Array?r:r.subarray())}function kt(r,t){let e=ke(r);return t.decode(e)}var Ce={};D(Ce,{base10:()=>Io});var Io=X({prefix:"9",name:"base10",alphabet:"0123456789"});var Ie={};D(Ie,{base16:()=>No,base16upper:()=>Lo});var No=T({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Lo=T({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ne={};D(Ne,{base2:()=>zo});var zo=T({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Le={};D(Le,{base256emoji:()=>Vo});var un=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Po=un.reduce((r,t,e)=>(r[e]=t,r),[]),Uo=un.reduce((r,t,e)=>(r[t.codePointAt(0)]=e,r),[]);function Fo(r){return r.reduce((t,e)=>(t+=Po[e],t),"")}function Mo(r){let t=[];for(let e of r){let n=Uo[e.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${e}`);t.push(n)}return new Uint8Array(t)}var Vo=at({prefix:"\u{1F680}",name:"base256emoji",encode:Fo,decode:Mo});var ze={};D(ze,{base36:()=>Ro,base36upper:()=>Oo});var Ro=X({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Oo=X({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Pe={};D(Pe,{base64:()=>Ho,base64pad:()=>$o,base64url:()=>Go,base64urlpad:()=>qo});var Ho=T({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),$o=T({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Go=T({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),qo=T({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Ue={};D(Ue,{base8:()=>jo});var jo=T({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Fe={};D(Fe,{identity:()=>Jo});var Jo=at({prefix:"\0",name:"identity",encode:r=>de(r),decode:r=>le(r)});var Xc=new TextEncoder,Kc=new TextDecoder;var Ct={};D(Ct,{code:()=>Yt,decode:()=>Qo,encode:()=>Wo,name:()=>Ko});var Ko="raw",Yt=85;function Wo(r){return F(r)}function Qo(r){return F(r)}var Me={};D(Me,{identity:()=>ts});var ln=0,Yo="identity",dn=F;function Zo(r){return Y(ln,dn(r))}var ts={code:ln,name:Yo,encode:dn,digest:Zo};var Oe={};D(Oe,{sha256:()=>Re,sha512:()=>es});function tt({name:r,code:t,encode:e}){return new Ve(r,t,e)}var Ve=class{name;code;encode;constructor(t,e,n){this.name=t,this.code=e,this.encode=n}digest(t){if(t instanceof Uint8Array){let e=this.encode(t);return e instanceof Uint8Array?Y(this.code,e):e.then(n=>Y(this.code,n))}else throw Error("Unknown type, must be binary type")}};function mn(r){return async t=>new Uint8Array(await crypto.subtle.digest(r,t))}var Re=tt({name:"sha2-256",code:18,encode:mn("SHA-256")}),es=tt({name:"sha2-512",code:19,encode:mn("SHA-512")});var He={...Fe,...Ne,...Ue,...Ce,...Ie,...we,...ze,...ye,...Pe,...Le},ch={...Oe,...Me};function gn(r,t,e,n){return{name:r,prefix:t,encoder:{name:r,prefix:t,encode:e},decoder:{decode:n}}}var bn=gn("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),$e=gn("ascii","a",r=>{let t="a";for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},r=>{r=r.substring(1);let t=U(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}),rs={utf8:bn,"utf-8":bn,hex:He.base16,latin1:$e,ascii:$e,binary:$e,...He},wn=rs;function Zt(r,t="utf8"){let e=wn[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?J(globalThis.Buffer.from(r,"utf-8")):e.decoder.decode(`${e.prefix}${r}`)}function Ge(r){let t=r??8192,e=t>>>1,n,i=t;return function(s){if(s<1||s>e)return U(s);i+s>t&&(n=U(t),i=0);let c=n.subarray(i,i+=s);return i&7&&(i=(i|7)+1),c}}var et=class{fn;len;next;val;constructor(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}};function qe(){}var Je=class{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}},ns=Ge();function is(r){return globalThis.Buffer!=null?U(r):ns(r)}var Lt=class{len;head;tail;states;constructor(){this.len=0,this.head=new et(qe,0,0),this.tail=this.head,this.states=null}_push(t,e,n){return this.tail=this.tail.next=new et(t,e,n),this.len+=e,this}uint32(t){return this.len+=(this.tail=this.tail.next=new Xe((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(It,10,N.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){let e=N.fromBigInt(t);return this._push(It,e.length(),e)}uint64Number(t){let e=N.fromNumber(t);return this._push(It,e.length(),e)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){let e=N.fromBigInt(t).zzEncode();return this._push(It,e.length(),e)}sint64Number(t){let e=N.fromNumber(t).zzEncode();return this._push(It,e.length(),e)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push(je,1,t?1:0)}fixed32(t){return this._push(Nt,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){let e=N.fromBigInt(t);return this._push(Nt,4,e.lo)._push(Nt,4,e.hi)}fixed64Number(t){let e=N.fromNumber(t);return this._push(Nt,4,e.lo)._push(Nt,4,e.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(rn,4,t)}double(t){return this._push(on,8,t)}bytes(t){let e=t.length>>>0;return e===0?this._push(je,1,0):this.uint32(e)._push(ss,e,t)}string(t){let e=cn(t);return e!==0?this.uint32(e)._push(Te,e,t):this._push(je,1,0)}fork(){return this.states=new Je(this),this.head=this.tail=new et(qe,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new et(qe,0,0),this.len=0),this}ldelim(){let t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=t.next,this.tail=e,this.len+=n),this}finish(){let t=this.head.next,e=is(this.len),n=0;for(;t!=null;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e}};function je(r,t,e){t[e]=r&255}function os(r,t,e){for(;r>127;)t[e++]=r&127|128,r>>>=7;t[e]=r}var Xe=class extends et{next;constructor(t,e){super(os,t,e),this.next=void 0}};function It(r,t,e){for(;r.hi!==0;)t[e++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)t[e++]=r.lo&127|128,r.lo=r.lo>>>7;t[e++]=r.lo}function Nt(r,t,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24}function ss(r,t,e){t.set(r,e)}globalThis.Buffer!=null&&(Lt.prototype.bytes=function(r){let t=r.length>>>0;return this.uint32(t),t>0&&this._push(as,t,r),this},Lt.prototype.string=function(r){let t=globalThis.Buffer.byteLength(r);return this.uint32(t),t>0&&this._push(cs,t,r),this});function as(r,t,e){t.set(r,e)}function cs(r,t,e){r.length<40?Te(r,t,e):t.utf8Write!=null?t.utf8Write(r,e):t.set(Zt(r),e)}function Ke(){return new Lt}function zt(r,t){let e=Ke();return t.encode(r,e,{lengthDelimited:!1}),e.finish()}var dt;(function(r){r[r.VARINT=0]="VARINT",r[r.BIT64=1]="BIT64",r[r.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",r[r.START_GROUP=3]="START_GROUP",r[r.END_GROUP=4]="END_GROUP",r[r.BIT32=5]="BIT32"})(dt||(dt={}));function te(r,t,e,n){return{name:r,type:t,encode:e,decode:n}}function We(r){function t(i){if(r[i.toString()]==null)throw new Error("Invalid enum value");return r[i]}let e=function(o,s){let c=t(o);s.int32(c)},n=function(o){let s=o.int32();return t(s)};return te("enum",dt.VARINT,e,n)}function Pt(r,t){return te("message",dt.LENGTH_DELIMITED,r,t)}var V;(function(r){let t;(function(i){i.Raw="Raw",i.Directory="Directory",i.File="File",i.Metadata="Metadata",i.Symlink="Symlink",i.HAMTShard="HAMTShard"})(t=r.DataType||(r.DataType={}));let e;(function(i){i[i.Raw=0]="Raw",i[i.Directory=1]="Directory",i[i.File=2]="File",i[i.Metadata=3]="Metadata",i[i.Symlink=4]="Symlink",i[i.HAMTShard=5]="HAMTShard"})(e||(e={})),function(i){i.codec=()=>We(e)}(t=r.DataType||(r.DataType={}));let n;r.codec=()=>(n==null&&(n=Pt((i,o,s={})=>{if(s.lengthDelimited!==!1&&o.fork(),i.Type!=null&&(o.uint32(8),r.DataType.codec().encode(i.Type,o)),i.Data!=null&&(o.uint32(18),o.bytes(i.Data)),i.filesize!=null&&(o.uint32(24),o.uint64(i.filesize)),i.blocksizes!=null)for(let c of i.blocksizes)o.uint32(32),o.uint64(c);i.hashType!=null&&(o.uint32(40),o.uint64(i.hashType)),i.fanout!=null&&(o.uint32(48),o.uint64(i.fanout)),i.mode!=null&&(o.uint32(56),o.uint32(i.mode)),i.mtime!=null&&(o.uint32(66),ee.codec().encode(i.mtime,o)),s.lengthDelimited!==!1&&o.ldelim()},(i,o)=>{let s={blocksizes:[]},c=o==null?i.len:i.pos+o;for(;i.pos<c;){let u=i.uint32();switch(u>>>3){case 1:s.Type=r.DataType.codec().decode(i);break;case 2:s.Data=i.bytes();break;case 3:s.filesize=i.uint64();break;case 4:s.blocksizes.push(i.uint64());break;case 5:s.hashType=i.uint64();break;case 6:s.fanout=i.uint64();break;case 7:s.mode=i.uint32();break;case 8:s.mtime=ee.codec().decode(i,i.uint32());break;default:i.skipType(u&7);break}}return s})),n),r.encode=i=>zt(i,r.codec()),r.decode=i=>kt(i,r.codec())})(V||(V={}));var ee;(function(r){let t;r.codec=()=>(t==null&&(t=Pt((e,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),e.Seconds!=null&&(n.uint32(8),n.int64(e.Seconds)),e.FractionalNanoseconds!=null&&(n.uint32(21),n.fixed32(e.FractionalNanoseconds)),i.lengthDelimited!==!1&&n.ldelim()},(e,n)=>{let i={},o=n==null?e.len:e.pos+n;for(;e.pos<o;){let s=e.uint32();switch(s>>>3){case 1:i.Seconds=e.int64();break;case 2:i.FractionalNanoseconds=e.fixed32();break;default:e.skipType(s&7);break}}return i})),t),r.encode=e=>zt(e,r.codec()),r.decode=e=>kt(e,r.codec())})(ee||(ee={}));var yn;(function(r){let t;r.codec=()=>(t==null&&(t=Pt((e,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),e.MimeType!=null&&(n.uint32(10),n.string(e.MimeType)),i.lengthDelimited!==!1&&n.ldelim()},(e,n)=>{let i={},o=n==null?e.len:e.pos+n;for(;e.pos<o;){let s=e.uint32();switch(s>>>3){case 1:i.MimeType=e.string();break;default:e.skipType(s&7);break}}return i})),t),r.encode=e=>zt(e,r.codec()),r.decode=e=>kt(e,r.codec())})(yn||(yn={}));var xn={Raw:"raw",Directory:"directory",File:"file",Metadata:"metadata",Symlink:"symlink",HAMTShard:"hamt-sharded-directory"},hs=["directory","hamt-sharded-directory"],vn=parseInt("0644",8),An=parseInt("0755",8),L=class r{static unmarshal(t){let e=V.decode(t),n=new r({type:xn[e.Type!=null?e.Type.toString():"File"],data:e.Data,blockSizes:e.blocksizes,mode:e.mode,mtime:e.mtime!=null?{secs:e.mtime.Seconds??0n,nsecs:e.mtime.FractionalNanoseconds}:void 0,fanout:e.fanout});return n._originalMode=e.mode??0,n}type;data;blockSizes;hashType;fanout;mtime;_mode;_originalMode;constructor(t={type:"file"}){let{type:e,data:n,blockSizes:i,hashType:o,fanout:s,mtime:c,mode:u}=t;if(e!=null&&!Object.values(xn).includes(e))throw(0,Qe.default)(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE");this.type=e??"file",this.data=n,this.hashType=o,this.fanout=s,this.blockSizes=i??[],this._originalMode=0,this.mode=u,this.mtime=c}set mode(t){t==null?this._mode=this.isDirectory()?An:vn:this._mode=t&4095}get mode(){return this._mode}isDirectory(){return hs.includes(this.type)}addBlockSize(t){this.blockSizes.push(t)}removeBlockSize(t){this.blockSizes.splice(t,1)}fileSize(){if(this.isDirectory())return 0n;let t=0n;return this.blockSizes.forEach(e=>{t+=e}),this.data!=null&&(t+=BigInt(this.data.length)),t}marshal(){let t;switch(this.type){case"raw":t=V.DataType.Raw;break;case"directory":t=V.DataType.Directory;break;case"file":t=V.DataType.File;break;case"metadata":t=V.DataType.Metadata;break;case"symlink":t=V.DataType.Symlink;break;case"hamt-sharded-directory":t=V.DataType.HAMTShard;break;default:throw(0,Qe.default)(new Error(`Type: ${t} is not valid`),"ERR_INVALID_TYPE")}let e=this.data;(this.data==null||this.data.length===0)&&(e=void 0);let n;this.mode!=null&&(n=this._originalMode&4294963200|(this.mode??0),n===vn&&!this.isDirectory()&&(n=void 0),n===An&&this.isDirectory()&&(n=void 0));let i;return this.mtime!=null&&(i={Seconds:this.mtime.secs,FractionalNanoseconds:this.mtime.nsecs}),V.encode({Type:t,Data:e,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:n,mtime:i})}};var q=class extends Event{constructor(t,e){super(t),this.detail=e}};var R=async(r,t,e)=>{e.codec==null&&(e.codec=Et);let n=await Re.digest(r),i=k.create(e.cidVersion,e.codec.code,n);return await t.put(i,r,e),i};function Bn(r){return async function*(e,n){let i=0n;for await(let o of e.content)yield async()=>{let s,c={codec:Et,cidVersion:r.cidVersion,onProgress:r.onProgress};r.rawLeaves?(c.codec=Ct,c.cidVersion=1):(s=new L({type:r.leafType,data:o}),o=P({Data:s.marshal(),Links:[]}));let u=await R(o,n,c);return i+=BigInt(o.byteLength),r.onProgress?.(new q("unixfs:importer:progress:file:write",{bytesWritten:i,cid:u,path:e.path})),{cid:u,unixfs:s,size:BigInt(o.length),block:o}}}}var Ye=it(xt(),1);var Sn=async(r,t,e)=>{let n=new L({type:"directory",mtime:r.mtime,mode:r.mode}),i=P(z({Data:n.marshal()})),o=await R(i,t,e),s=r.path;return{cid:o,path:s,unixfs:n,size:BigInt(i.length),originalPath:r.originalPath,block:i}};async function*fs(r,t,e){let n=-1,i;for await(let o of At(e.bufferImporter(r,t),e.blockWriteConcurrency)){if(n++,n===0){i={...o,single:!0};continue}else n===1&&i!=null&&(yield{...i,block:void 0,single:void 0},i=void 0);yield{...o,block:void 0}}i!=null&&(yield i)}function Dn(r){return r.single===!0}var us=(r,t,e)=>async function(i){if(i.length===1&&Dn(i[0])&&e.reduceSingleLeafToSelf){let f=i[0],w=f.block;return Dn(f)&&(r.mtime!==void 0||r.mode!==void 0)&&(f.unixfs=new L({type:"file",mtime:r.mtime,mode:r.mode,data:f.block}),w={Data:f.unixfs.marshal(),Links:[]},f.block=P(z(w)),f.cid=await R(f.block,t,{...e,cidVersion:e.cidVersion}),f.size=BigInt(f.block.length)),e.onProgress?.(new q("unixfs:importer:progress:file:layout",{cid:f.cid,path:f.originalPath})),{cid:f.cid,path:r.path,unixfs:f.unixfs,size:f.size,originalPath:f.originalPath}}let o=new L({type:"file",mtime:r.mtime,mode:r.mode}),s=i.filter(f=>f.cid.code===Yt&&f.size>0||f.unixfs!=null&&f.unixfs.data==null&&f.unixfs.fileSize()>0n?!0:!!f.unixfs?.data?.length).map(f=>f.cid.code===Yt?(o.addBlockSize(f.size),{Name:"",Tsize:Number(f.size),Hash:f.cid}):(f.unixfs==null||f.unixfs.data==null?o.addBlockSize(f.unixfs?.fileSize()??0n):o.addBlockSize(BigInt(f.unixfs.data.length)),{Name:"",Tsize:Number(f.size),Hash:f.cid})),c={Data:o.marshal(),Links:s},u=P(z(c)),x=await R(u,t,e);return e.onProgress?.(new q("unixfs:importer:progress:file:layout",{cid:x,path:r.originalPath})),{cid:x,path:r.path,unixfs:o,size:BigInt(u.length+c.Links.reduce((f,w)=>f+(w.Tsize??0),0)),originalPath:r.originalPath,block:u}},_n=async(r,t,e)=>e.layout(fs(r,t,e),us(r,t,e));function ls(r){return Symbol.iterator in r}function ds(r){return Symbol.asyncIterator in r}function ps(r){try{if(r instanceof Uint8Array)return async function*(){yield r}();if(ls(r))return async function*(){yield*r}();if(ds(r))return r}catch{throw(0,Ye.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw(0,Ye.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}function Tn(r){return async function*(e,n){for await(let i of e){let o;if(i.path!=null&&(o=i.path,i.path=i.path.split("/").filter(s=>s!=null&&s!==".").join("/")),ms(i)){let s={path:i.path,mtime:i.mtime,mode:i.mode,content:async function*(){let c=0n;for await(let u of r.chunker(r.chunkValidator(ps(i.content)))){let x=BigInt(u.byteLength);c+=x,r.onProgress?.(new q("unixfs:importer:progress:file:read",{bytesRead:c,chunkSize:x,path:i.path})),yield u}}(),originalPath:o};yield async()=>_n(s,n,r)}else if(i.path!=null){let s={path:i.path,mtime:i.mtime,mode:i.mode,originalPath:o};yield async()=>Sn(s,n,r)}else throw new Error("Import candidate must have content or path or both")}}}function ms(r){return r.content!=null}var Ze=it(xt(),1);var En=()=>async function*(t){for await(let e of t){if(e.length===void 0)throw(0,Ze.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof e=="string"||e instanceof String)yield Zt(e.toString());else if(Array.isArray(e))yield Uint8Array.from(e);else if(e instanceof Uint8Array)yield e;else throw(0,Ze.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}};var bs=174;function tr(r){let t=r?.maxChildrenPerNode??bs;return async function e(n,i){let o=[];for await(let s of vt(n,t))o.push(await i(s));return o.length>1?e(o,i):o[0]}}var H=class{options;root;dir;path;dirty;flat;parent;parentKey;unixfs;mode;mtime;cid;size;nodeSize;constructor(t,e){this.options=e??{},this.root=t.root,this.dir=t.dir,this.path=t.path,this.dirty=t.dirty,this.flat=t.flat,this.parent=t.parent,this.parentKey=t.parentKey,this.unixfs=t.unixfs,this.mode=t.mode,this.mtime=t.mtime}},Ut=k.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),Ft=k.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi");var rt=class extends H{_children;constructor(t,e){super(t,e),this._children=new Map}async put(t,e){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,this._children.set(t,e)}async get(t){return Promise.resolve(this._children.get(t))}childCount(){return this._children.size}directChildrenCount(){return this.childCount()}onlyChild(){return this._children.values().next().value}async*eachChildSeries(){for(let[t,e]of this._children.entries())yield{key:t,child:e}}estimateNodeSize(){if(this.nodeSize!==void 0)return this.nodeSize;this.nodeSize=0;for(let[t,e]of this._children.entries())e.size!=null&&e.cid!=null&&(this.nodeSize+=t.length+(this.options.cidVersion===1?Ft.bytes.byteLength:Ut.bytes.byteLength));return this.nodeSize}async*flush(t){let e=[];for(let[u,x]of this._children.entries()){let f=x;if(x instanceof H)for await(let w of x.flush(t))f=w,yield w;f.size!=null&&f.cid!=null&&e.push({Name:u,Tsize:Number(f.size),Hash:f.cid})}let n=new L({type:"directory",mtime:this.mtime,mode:this.mode}),i={Data:n.marshal(),Links:e},o=P(z(i)),s=await R(o,t,this.options),c=o.length+i.Links.reduce((u,x)=>u+(x.Tsize==null?0:x.Tsize),0);this.cid=s,this.size=c,yield{cid:s,unixfs:n,path:this.path,size:BigInt(c)}}};var ne=it(In(),1);function gs(r){let t=new Array(4);for(let e=0;e<4;e++)t[e]=r&255,r=r>>8;return new Uint8Array(t)}var Ff=tt({name:"murmur3-32",code:35,encode:r=>gs(ne.default.x86.hash32(r))}),Nn=tt({name:"murmur3-128",code:34,encode:r=>st.fromHex(ne.default.x64.hash128(r))}),Mf=tt({name:"murmur3-x64-64",code:34,encode:r=>st.fromHex(ne.default.x64.hash128(r)).subarray(0,8)});var oi=it(Pn(),1);function pt(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}var or={};D(or,{base10:()=>_s});function vs(r,t){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var i=0;i<r.length;i++){var o=r.charAt(i),s=o.charCodeAt(0);if(e[s]!==255)throw new TypeError(o+" is ambiguous");e[s]=i}var c=r.length,u=r.charAt(0),x=Math.log(c)/Math.log(256),f=Math.log(256)/Math.log(c);function w(h){if(h instanceof Uint8Array||(ArrayBuffer.isView(h)?h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength):Array.isArray(h)&&(h=Uint8Array.from(h))),!(h instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(h.length===0)return"";for(var d=0,_=0,l=0,p=h.length;l!==p&&h[l]===0;)l++,d++;for(var m=(p-l)*f+1>>>0,g=new Uint8Array(m);l!==p;){for(var y=h[l],v=0,b=m-1;(y!==0||v<_)&&b!==-1;b--,v++)y+=256*g[b]>>>0,g[b]=y%c>>>0,y=y/c>>>0;if(y!==0)throw new Error("Non-zero carry");_=v,l++}for(var A=m-_;A!==m&&g[A]===0;)A++;for(var I=u.repeat(d);A<m;++A)I+=r.charAt(g[A]);return I}function S(h){if(typeof h!="string")throw new TypeError("Expected String");if(h.length===0)return new Uint8Array;var d=0;if(h[d]!==" "){for(var _=0,l=0;h[d]===u;)_++,d++;for(var p=(h.length-d)*x+1>>>0,m=new Uint8Array(p);h[d];){var g=e[h.charCodeAt(d)];if(g===255)return;for(var y=0,v=p-1;(g!==0||y<l)&&v!==-1;v--,y++)g+=c*m[v]>>>0,m[v]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");l=y,d++}if(h[d]!==" "){for(var b=p-l;b!==p&&m[b]===0;)b++;for(var A=new Uint8Array(_+(p-b)),I=_;b!==p;)A[I++]=m[b++];return A}}}function a(h){var d=S(h);if(d)return d;throw new Error(`Non-${t} character`)}return{encode:w,decodeUnsafe:S,decode:a}}var As=vs,Bs=As,Un=Bs;var Gf=new Uint8Array(0);var Fn=(r,t)=>{if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0},j=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")};var Mn=r=>new TextEncoder().encode(r),Vn=r=>new TextDecoder().decode(r);var er=class{constructor(t,e,n){this.name=t,this.prefix=e,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},rr=class{constructor(t,e,n){if(this.name=t,this.prefix=e,e.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return On(this,t)}},nr=class{constructor(t){this.decoders=t}or(t){return On(this,t)}decode(t){let e=t[0],n=this.decoders[e];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},On=(r,t)=>new nr({...r.decoders||{[r.prefix]:r},...t.decoders||{[t.prefix]:t}}),ir=class{constructor(t,e,n,i){this.name=t,this.prefix=e,this.baseEncode=n,this.baseDecode=i,this.encoder=new er(t,e,n),this.decoder=new rr(t,e,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},mt=({name:r,prefix:t,encode:e,decode:n})=>new ir(r,t,e,n),W=({prefix:r,name:t,alphabet:e})=>{let{encode:n,decode:i}=Un(e,t);return mt({prefix:r,name:t,encode:n,decode:o=>j(i(o))})},Ss=(r,t,e,n)=>{let i={};for(let f=0;f<t.length;++f)i[t[f]]=f;let o=r.length;for(;r[o-1]==="=";)--o;let s=new Uint8Array(o*e/8|0),c=0,u=0,x=0;for(let f=0;f<o;++f){let w=i[r[f]];if(w===void 0)throw new SyntaxError(`Non-${n} character`);u=u<<e|w,c+=e,c>=8&&(c-=8,s[x++]=255&u>>c)}if(c>=e||255&u<<8-c)throw new SyntaxError("Unexpected end of data");return s},Ds=(r,t,e)=>{let n=t[t.length-1]==="=",i=(1<<e)-1,o="",s=0,c=0;for(let u=0;u<r.length;++u)for(c=c<<8|r[u],s+=8;s>e;)s-=e,o+=t[i&c>>s];if(s&&(o+=t[i&c<<e-s]),n)for(;o.length*e&7;)o+="=";return o},E=({name:r,prefix:t,bitsPerChar:e,alphabet:n})=>mt({prefix:t,name:r,encode(i){return Ds(i,n,e)},decode(i){return Ss(i,n,e,r)}});var _s=W({prefix:"9",name:"base10",alphabet:"0123456789"});var sr={};D(sr,{base16:()=>Ts,base16upper:()=>Es});var Ts=E({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Es=E({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ar={};D(ar,{base2:()=>ks});var ks=E({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var cr={};D(cr,{base256emoji:()=>zs});var Hn=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Cs=Hn.reduce((r,t,e)=>(r[e]=t,r),[]),Is=Hn.reduce((r,t,e)=>(r[t.codePointAt(0)]=e,r),[]);function Ns(r){return r.reduce((t,e)=>(t+=Cs[e],t),"")}function Ls(r){let t=[];for(let e of r){let n=Is[e.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${e}`);t.push(n)}return new Uint8Array(t)}var zs=mt({prefix:"\u{1F680}",name:"base256emoji",encode:Ns,decode:Ls});var hr={};D(hr,{base32:()=>bt,base32hex:()=>Ms,base32hexpad:()=>Rs,base32hexpadupper:()=>Os,base32hexupper:()=>Vs,base32pad:()=>Us,base32padupper:()=>Fs,base32upper:()=>Ps,base32z:()=>Hs});var bt=E({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ps=E({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Us=E({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Fs=E({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ms=E({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Vs=E({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Rs=E({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Os=E({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Hs=E({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var fr={};D(fr,{base36:()=>$s,base36upper:()=>Gs});var $s=W({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Gs=W({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ur={};D(ur,{base58btc:()=>$,base58flickr:()=>qs});var $=W({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),qs=W({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var lr={};D(lr,{base64:()=>js,base64pad:()=>Js,base64url:()=>Xs,base64urlpad:()=>Ks});var js=E({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Js=E({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Xs=E({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ks=E({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var dr={};D(dr,{base8:()=>Ws});var Ws=E({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var pr={};D(pr,{identity:()=>Qs});var Qs=mt({prefix:"\0",name:"identity",encode:r=>Vn(r),decode:r=>Mn(r)});var ou=new TextEncoder,su=new TextDecoder;var br={};D(br,{identity:()=>xa});var ta=qn,$n=128,ea=127,ra=~ea,na=Math.pow(2,31);function qn(r,t,e){t=t||[],e=e||0;for(var n=e;r>=na;)t[e++]=r&255|$n,r/=128;for(;r&ra;)t[e++]=r&255|$n,r>>>=7;return t[e]=r|0,qn.bytes=e-n+1,t}var ia=mr,oa=128,Gn=127;function mr(r,n){var e=0,n=n||0,i=0,o=n,s,c=r.length;do{if(o>=c)throw mr.bytes=0,new RangeError("Could not decode varint");s=r[o++],e+=i<28?(s&Gn)<<i:(s&Gn)*Math.pow(2,i),i+=7}while(s>=oa);return mr.bytes=o-n,e}var sa=Math.pow(2,7),aa=Math.pow(2,14),ca=Math.pow(2,21),ha=Math.pow(2,28),fa=Math.pow(2,35),ua=Math.pow(2,42),la=Math.pow(2,49),da=Math.pow(2,56),pa=Math.pow(2,63),ma=function(r){return r<sa?1:r<aa?2:r<ca?3:r<ha?4:r<fa?5:r<ua?6:r<la?7:r<da?8:r<pa?9:10},ba={encode:ta,decode:ia,encodingLength:ma},ga=ba,Vt=ga;var Rt=(r,t=0)=>[Vt.decode(r,t),Vt.decode.bytes],gt=(r,t,e=0)=>(Vt.encode(r,t,e),t),wt=r=>Vt.encodingLength(r);var nt=(r,t)=>{let e=t.byteLength,n=wt(r),i=n+wt(e),o=new Uint8Array(i+e);return gt(r,o,0),gt(e,o,n),o.set(t,i),new yt(r,e,t,o)},jn=r=>{let t=j(r),[e,n]=Rt(t),[i,o]=Rt(t.subarray(n)),s=t.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new yt(e,i,s,t)},Jn=(r,t)=>{if(r===t)return!0;{let e=t;return r.code===e.code&&r.size===e.size&&e.bytes instanceof Uint8Array&&Fn(r.bytes,e.bytes)}},yt=class{constructor(t,e,n,i){this.code=t,this.size=e,this.digest=n,this.bytes=i}};var Xn=0,wa="identity",Kn=j,ya=r=>nt(Xn,Kn(r)),xa={code:Xn,name:wa,encode:Kn,digest:ya};var yr={};D(yr,{sha256:()=>va,sha512:()=>Aa});var wr=({name:r,code:t,encode:e})=>new gr(r,t,e),gr=class{constructor(t,e,n){this.name=t,this.code=e,this.encode=n}digest(t){if(t instanceof Uint8Array){let e=this.encode(t);return e instanceof Uint8Array?nt(this.code,e):e.then(n=>nt(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Qn=r=>async t=>new Uint8Array(await crypto.subtle.digest(r,t)),va=wr({name:"sha2-256",code:18,encode:Qn("SHA-256")}),Aa=wr({name:"sha2-512",code:19,encode:Qn("SHA-512")});var Yn=(r,t)=>{let{bytes:e,version:n}=r;switch(n){case 0:return Sa(e,xr(r),t||$.encoder);default:return Da(e,xr(r),t||bt.encoder)}};var Zn=new WeakMap,xr=r=>{let t=Zn.get(r);if(t==null){let e=new Map;return Zn.set(r,e),e}return t},oe=class r{constructor(t,e,n,i){this.code=e,this.version=t,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:e}=this;if(t!==Ht)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==_a)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:e}=this.multihash,n=nt(t,e);return r.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return r.equals(this,t)}static equals(t,e){let n=e;return n&&t.code===n.code&&t.version===n.version&&Jn(t.multihash,n.multihash)}toString(t){return Yn(this,t)}toJSON(){return{"/":Yn(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let e=t;if(e instanceof r)return e;if(e["/"]!=null&&e["/"]===e.bytes||e.asCID===e){let{version:n,code:i,multihash:o,bytes:s}=e;return new r(n,i,o,s||ti(n,i,o.bytes))}else if(e[Ta]===!0){let{version:n,multihash:i,code:o}=e,s=jn(i);return r.create(n,o,s)}else return null}static create(t,e,n){if(typeof e!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(e!==Ht)throw new Error(`Version 0 CID must use dag-pb (code: ${Ht}) block encoding`);return new r(t,e,n,n.bytes)}case 1:{let i=ti(t,e,n.bytes);return new r(t,e,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return r.create(0,Ht,t)}static createV1(t,e){return r.create(1,t,e)}static decode(t){let[e,n]=r.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return e}static decodeFirst(t){let e=r.inspectBytes(t),n=e.size-e.multihashSize,i=j(t.subarray(n,n+e.multihashSize));if(i.byteLength!==e.multihashSize)throw new Error("Incorrect length");let o=i.subarray(e.multihashSize-e.digestSize),s=new yt(e.multihashCode,e.digestSize,o,i);return[e.version===0?r.createV0(s):r.createV1(e.codec,s),t.subarray(e.size)]}static inspectBytes(t){let e=0,n=()=>{let[w,S]=Rt(t.subarray(e));return e+=S,w},i=n(),o=Ht;if(i===18?(i=0,e=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=e,c=n(),u=n(),x=e+u,f=x-s;return{version:i,codec:o,multihashCode:c,digestSize:u,multihashSize:f,size:x}}static parse(t,e){let[n,i]=Ba(t,e),o=r.decode(i);if(o.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return xr(o).set(n,t),o}},Ba=(r,t)=>{switch(r[0]){case"Q":{let e=t||$;return[$.prefix,e.decode(`${$.prefix}${r}`)]}case $.prefix:{let e=t||$;return[$.prefix,e.decode(r)]}case bt.prefix:{let e=t||bt;return[bt.prefix,e.decode(r)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],t.decode(r)]}}},Sa=(r,t,e)=>{let{prefix:n}=e;if(n!==$.prefix)throw Error(`Cannot string encode V0 in ${e.name} encoding`);let i=t.get(n);if(i==null){let o=e.encode(r).slice(1);return t.set(n,o),o}else return i},Da=(r,t,e)=>{let{prefix:n}=e,i=t.get(n);if(i==null){let o=e.encode(r);return t.set(n,o),o}else return i},Ht=112,_a=18,ti=(r,t,e)=>{let n=wt(r),i=n+wt(t),o=new Uint8Array(i+e.byteLength);return gt(r,o,0),gt(t,o,n),o.set(e,i),o},Ta=Symbol.for("@ipld/js-cid/CID");var vr={...pr,...ar,...dr,...or,...sr,...hr,...fr,...ur,...lr,...cr},Au={...yr,...br};function se(r=0){return globalThis.Buffer?.allocUnsafe!=null?pt(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function ri(r,t,e,n){return{name:r,prefix:t,encoder:{name:r,prefix:t,encode:e},decoder:{decode:n}}}var ei=ri("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Ar=ri("ascii","a",r=>{let t="a";for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},r=>{r=r.substring(1);let t=se(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}),Ea={utf8:ei,"utf-8":ei,hex:vr.base16,latin1:Ar,ascii:Ar,binary:Ar,...vr},ni=Ea;function ii(r,t="utf8"){let e=ni[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?pt(globalThis.Buffer.from(r,"utf-8")):e.decoder.decode(`${e.prefix}${r}`)}var Q=class r{constructor(t,e,n=0){this._options=t,this._popCount=0,this._parent=e,this._posAtParent=n,this._children=new oi.default,this.key=null}async put(t,e){let n=await this._findNewBucketAndPos(t);await n.bucket._putAt(n,t,e)}async get(t){let e=await this._findChild(t);if(e!=null)return e.value}async del(t){let e=await this._findPlace(t),n=e.bucket._at(e.pos);n!=null&&n.key===t&&e.bucket._delAt(e.pos)}leafCount(){return this._children.compactArray().reduce((e,n)=>n instanceof r?e+n.leafCount():e+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let t=this._children.compactArray();for(let e of t)e instanceof r?yield*e.eachLeafSeries():yield e}serialize(t,e){let n=[];return e(this._children.reduce((i,o,s)=>(o!=null&&(o instanceof r?i.push(o.serialize(t,e)):i.push(t(o,s))),i),n))}async asyncTransform(t,e){return await si(this,t,e)}toJSON(){return this.serialize(Ca,Ia)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(t){let e=await this._findPlace(t),n=e.bucket._at(e.pos);if(!(n instanceof r)&&n!=null&&n.key===t)return n}async _findPlace(t){let e=this._options.hash(typeof t=="string"?ii(t):t),n=await e.take(this._options.bits),i=this._children.get(n);return i instanceof r?await i._findPlace(e):{bucket:this,pos:n,hash:e,existingChild:i}}async _findNewBucketAndPos(t){let e=await this._findPlace(t);if(e.existingChild!=null&&e.existingChild.key!==t){let n=new r(this._options,e.bucket,e.pos);e.bucket._putObjectAt(e.pos,n);let i=await n._findPlace(e.existingChild.hash);return i.bucket._putAt(i,e.existingChild.key,e.existingChild.value),await n._findNewBucketAndPos(e.hash)}return e}_putAt(t,e,n){this._putObjectAt(t.pos,{key:e,value:n,hash:t.hash})}_putObjectAt(t,e){this._children.get(t)==null&&this._popCount++,this._children.set(t,e)}_delAt(t){if(t===-1)throw new Error("Invalid position");this._children.get(t)!=null&&this._popCount--,this._children.unset(t),this._level()}_level(){if(this._parent!=null&&this._popCount<=1)if(this._popCount===1){let t=this._children.find(ka);if(t!=null&&!(t instanceof r)){let e=t.hash;e.untake(this._options.bits);let n={pos:this._posAtParent,hash:e,bucket:this._parent};this._parent._putAt(n,t.key,t.value)}}else this._parent._delAt(this._posAtParent)}_at(t){return this._children.get(t)}};function ka(r){return!!r}function Ca(r,t){return r.key}function Ia(r){return r}async function si(r,t,e){let n=[];for(let i of r._children.compactArray())if(i instanceof Q)await si(i,t,e);else{let o=await t(i);n.push({bitField:r._children.bitField(),children:o})}return await e(n)}var Na=[255,254,252,248,240,224,192,128],La=[1,3,7,15,31,63,127,255],ae=class{constructor(t){this._value=t,this._currentBytePos=t.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(t){let e=t,n=0;for(;e>0&&this._haveBits();){let i=this._value[this._currentBytePos],o=this._currentBitPos+1,s=Math.min(o,e),c=za(i,o-s,s);n=(n<<s)+c,e-=s,this._currentBitPos-=s,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return n}untake(t){for(this._currentBitPos+=t;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function za(r,t,e){let n=Pa(t,e);return(r&n)>>>t}function Pa(r,t){return Na[r]&La[Math.min(t+r-1,7)]}function ai(r,t){t==null&&(t=r.reduce((i,o)=>i+o.length,0));let e=se(t),n=0;for(let i of r)e.set(i,n),n+=i.length;return pt(e)}function ci(r){function t(e){return e instanceof ce?e:new ce(e,r)}return t}var ce=class{constructor(t,e){if(!(t instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=t,this._hashFn=e,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(t){let e=t;for(;this._availableBits<e;)await this._produceMoreBits();let n=0;for(;e>0;){let i=this._buffers[this._currentBufferIndex],o=Math.min(i.availableBits(),e),s=i.take(o);n=(n<<o)+s,e-=o,this._availableBits-=o,i.availableBits()===0&&this._currentBufferIndex++}return n}untake(t){let e=t;for(;e>0;){let n=this._buffers[this._currentBufferIndex],i=Math.min(n.totalBits()-n.availableBits(),e);n.untake(i),e-=i,this._availableBits+=i,this._currentBufferIndex>0&&n.totalBits()===n.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let t=this._depth>0?ai([this._value,Uint8Array.from([this._depth])]):this._value,e=await this._hashFn(t),n=new ae(e);this._buffers.push(n),this._availableBits+=n.availableBits()}};function hi(r){if(r==null||r.hashFn==null)throw new Error("please define an options.hashFn");let t={bits:r.bits??8,hash:ci(r.hashFn)};return new Q(t)}async function Ua(r){return(await Nn.encode(r)).slice(0,8).reverse()}var fi=BigInt(34),Fa=8,Br=class extends H{_bucket;constructor(t,e){super(t,e),this._bucket=hi({hashFn:Ua,bits:e.shardFanoutBits??Fa})}async put(t,e){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,await this._bucket.put(t,e)}async get(t){return this._bucket.get(t)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:t,value:e}of this._bucket.eachLeafSeries())yield{key:t,child:e}}estimateNodeSize(){return this.nodeSize!==void 0?this.nodeSize:(this.nodeSize=di(this._bucket,this,this.options),this.nodeSize)}async*flush(t){for await(let e of li(this._bucket,t,this,this.options))yield{...e,path:this.path}}},ui=Br;async function*li(r,t,e,n){let i=r._children,o=(r.tableSize()-1).toString(16).length,s=[],c=0n;for(let h=0;h<i.length;h++){let d=i.get(h);if(d==null)continue;let _=h.toString(16).toUpperCase().padStart(o,"0");if(d instanceof Q){let l;for await(let p of li(d,t,null,n))l=p;if(l==null)throw new Error("Could not flush sharded directory, no subshard found");s.push({Name:_,Tsize:Number(l.size),Hash:l.cid}),c+=l.size}else if(Ma(d.value)){let l=d.value,p;for await(let g of l.flush(t))p=g,yield p;if(p==null)throw new Error("Did not flush dir");let m=_+d.key;s.push({Name:m,Tsize:Number(p.size),Hash:p.cid}),c+=p.size}else{let l=d.value;if(l.cid==null)continue;let p=_+d.key,m=l.size;s.push({Name:p,Tsize:Number(m),Hash:l.cid}),c+=BigInt(m??0)}}let u=Uint8Array.from(i.bitField().reverse()),x=new L({type:"hamt-sharded-directory",data:u,fanout:BigInt(r.tableSize()),hashType:fi,mtime:e?.mtime,mode:e?.mode}),f={Data:x.marshal(),Links:s},w=P(z(f)),S=await R(w,t,n),a=BigInt(w.byteLength)+c;yield{cid:S,unixfs:x,size:a}}function Ma(r){return typeof r.flush=="function"}function di(r,t,e){let n=r._children,i=(r.tableSize()-1).toString(16).length,o=[];for(let x=0;x<n.length;x++){let f=n.get(x);if(f==null)continue;let w=x.toString(16).toUpperCase().padStart(i,"0");if(f instanceof Q){let S=di(f,null,e);o.push({Name:w,Tsize:Number(S),Hash:e.cidVersion===0?Ut:Ft})}else if(typeof f.value.flush=="function"){let a=f.value.nodeSize();o.push({Name:w+f.key,Tsize:Number(a),Hash:e.cidVersion===0?Ut:Ft})}else{let S=f.value;if(S.cid==null)continue;let a=w+f.key,h=S.size;o.push({Name:a,Tsize:Number(h),Hash:S.cid})}}let s=Uint8Array.from(n.bitField().reverse()),c=new L({type:"hamt-sharded-directory",data:s,fanout:BigInt(r.tableSize()),hashType:fi,mtime:t?.mtime,mode:t?.mode});return P(z({Data:c.marshal(),Links:o})).length}async function Sr(r,t,e,n){let i=t;t instanceof rt&&t.estimateNodeSize()>e&&(i=await Va(t,n));let o=i.parent;if(o!=null){if(i!==t){if(r!=null&&(r.parent=i),i.parentKey==null)throw new Error("No parent key found");await o.put(i.parentKey,i)}return Sr(i,o,e,n)}return i}async function Va(r,t){let e=new ui({root:r.root,dir:!0,parent:r.parent,parentKey:r.parentKey,path:r.path,dirty:r.dirty,flat:!1,mtime:r.mtime,mode:r.mode},t);for await(let{key:n,child:i}of r.eachChildSeries())await e.put(n,i);return e}var pi=(r="")=>r.split(/(?<!\\)\//).filter(Boolean);async function Ra(r,t,e){let n=pi(r.path??""),i=n.length-1,o=t,s="";for(let c=0;c<n.length;c++){let u=n[c];s+=`${s!==""?"/":""}${u}`;let x=c===i;if(o.dirty=!0,o.cid=void 0,o.size=void 0,x)await o.put(u,r),t=await Sr(null,o,e.shardSplitThresholdBytes,e);else{let f=await o.get(u);(f==null||!(f instanceof H))&&(f=new rt({root:!1,dir:!0,parent:o,parentKey:u,path:s,dirty:!0,flat:!0,mtime:f?.unixfs?.mtime,mode:f?.unixfs?.mode},e)),await o.put(u,f),o=f}}return t}async function*mi(r,t){if(!(r instanceof H)){r.unixfs?.isDirectory()===!0&&(yield r);return}yield*r.flush(t)}function bi(r){return async function*(e,n){let i=new rt({root:!0,dir:!0,path:"",dirty:!0,flat:!0},r),o,s=!1;for await(let c of e){if(c==null)continue;let u=`${c.originalPath??""}`.split("/")[0];u!=null&&u!==""&&(o==null?(o=u,s=!0):o!==u&&(s=!1)),i=await Ra(c,i,r),(c.unixfs==null||!c.unixfs.isDirectory())&&(yield c)}if(r.wrapWithDirectory||s&&i.childCount()>1)yield*mi(i,n);else for await(let c of i.eachChildSeries())c!=null&&(yield*mi(c.child,n))}}async function*_r(r,t,e={}){let n;Symbol.asyncIterator in r||Symbol.iterator in r?n=r:n=[r];let i=e.wrapWithDirectory??!1,o=e.shardSplitThresholdBytes??262144,s=e.shardFanoutBits??8,c=e.cidVersion??1,u=e.rawLeaves??!0,x=e.leafType??"file",f=e.fileImportConcurrency??50,w=e.blockWriteConcurrency??10,S=e.reduceSingleLeafToSelf??!0,a=e.chunker??zr(),h=e.chunkValidator??En(),d=e.dagBuilder??Tn({chunker:a,chunkValidator:h,wrapWithDirectory:i,layout:e.layout??tr(),bufferImporter:e.bufferImporter??Bn({cidVersion:c,rawLeaves:u,leafType:x,onProgress:e.onProgress}),blockWriteConcurrency:w,reduceSingleLeafToSelf:S,cidVersion:c,onProgress:e.onProgress}),_=e.treeBuilder??bi({wrapWithDirectory:i,shardSplitThresholdBytes:o,shardFanoutBits:s,cidVersion:c,onProgress:e.onProgress});for await(let l of _(At(d(n,t),f),t))yield{cid:l.cid,path:l.path,unixfs:l.unixfs,size:l.size}}async function Tr(r,t,e={}){let n=await he(_r([r],t,e));if(n==null)throw(0,Dr.default)(new Error("Nothing imported"),"ERR_INVALID_PARAMS");return n}async function Oa(r,t,e={}){let n=await he(_r([r],t,e));if(n==null)throw(0,Dr.default)(new Error("Nothing imported"),"ERR_INVALID_PARAMS");return n}async function Ha(r,t,e={}){return Tr({content:r},t,e)}async function $a(r,t,e={}){return Tr({content:r},t,e)}return Ai(Ga);})();
return IpfsUnixfsImporter}));
